/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __commonJS = (cb, mod) => function __require() {
  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target, mod));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// node_modules/valid-url/index.js
var require_valid_url = __commonJS({
  "node_modules/valid-url/index.js"(exports, module2) {
    (function(module3) {
      "use strict";
      module3.exports.is_uri = is_iri;
      module3.exports.is_http_uri = is_http_iri;
      module3.exports.is_https_uri = is_https_iri;
      module3.exports.is_web_uri = is_web_iri;
      module3.exports.isUri = is_iri;
      module3.exports.isHttpUri = is_http_iri;
      module3.exports.isHttpsUri = is_https_iri;
      module3.exports.isWebUri = is_web_iri;
      var splitUri = function(uri) {
        var splitted = uri.match(/(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/);
        return splitted;
      };
      function is_iri(value) {
        if (!value) {
          return;
        }
        if (/[^a-z0-9\:\/\?\#\[\]\@\!\$\&\'\(\)\*\+\,\;\=\.\-\_\~\%]/i.test(value))
          return;
        if (/%[^0-9a-f]/i.test(value))
          return;
        if (/%[0-9a-f](:?[^0-9a-f]|$)/i.test(value))
          return;
        var splitted = [];
        var scheme = "";
        var authority = "";
        var path = "";
        var query = "";
        var fragment = "";
        var out = "";
        splitted = splitUri(value);
        scheme = splitted[1];
        authority = splitted[2];
        path = splitted[3];
        query = splitted[4];
        fragment = splitted[5];
        if (!(scheme && scheme.length && path.length >= 0))
          return;
        if (authority && authority.length) {
          if (!(path.length === 0 || /^\//.test(path)))
            return;
        } else {
          if (/^\/\//.test(path))
            return;
        }
        if (!/^[a-z][a-z0-9\+\-\.]*$/.test(scheme.toLowerCase()))
          return;
        out += scheme + ":";
        if (authority && authority.length) {
          out += "//" + authority;
        }
        out += path;
        if (query && query.length) {
          out += "?" + query;
        }
        if (fragment && fragment.length) {
          out += "#" + fragment;
        }
        return out;
      }
      function is_http_iri(value, allowHttps) {
        if (!is_iri(value)) {
          return;
        }
        var splitted = [];
        var scheme = "";
        var authority = "";
        var path = "";
        var port = "";
        var query = "";
        var fragment = "";
        var out = "";
        splitted = splitUri(value);
        scheme = splitted[1];
        authority = splitted[2];
        path = splitted[3];
        query = splitted[4];
        fragment = splitted[5];
        if (!scheme)
          return;
        if (allowHttps) {
          if (scheme.toLowerCase() != "https")
            return;
        } else {
          if (scheme.toLowerCase() != "http")
            return;
        }
        if (!authority) {
          return;
        }
        if (/:(\d+)$/.test(authority)) {
          port = authority.match(/:(\d+)$/)[0];
          authority = authority.replace(/:\d+$/, "");
        }
        out += scheme + ":";
        out += "//" + authority;
        if (port) {
          out += port;
        }
        out += path;
        if (query && query.length) {
          out += "?" + query;
        }
        if (fragment && fragment.length) {
          out += "#" + fragment;
        }
        return out;
      }
      function is_https_iri(value) {
        return is_http_iri(value, true);
      }
      function is_web_iri(value) {
        return is_http_iri(value) || is_https_iri(value);
      }
    })(module2);
  }
});

// node_modules/@opd-libs/opd-metadata-lib/lib/Utils.js
var require_Utils = __commonJS({
  "node_modules/@opd-libs/opd-metadata-lib/lib/Utils.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.OPDTraversalError = exports.validatePath = exports.parsePath = exports.traverseObjectByPath = exports.traverseObjectToParent = exports.traverseObject = void 0;
    function traverseObject(path, o) {
      let pathParts = parsePath(path);
      return traverseObjectByPath(pathParts, o);
    }
    exports.traverseObject = traverseObject;
    function traverseObjectToParent(path, o) {
      var _a;
      let pathParts = parsePath(path);
      if (pathParts[0] === "") {
        throw new OPDTraversalError("can not traverse to parent on self reference");
      }
      let parentPath = pathParts.slice(0, -1);
      let childKey = (_a = pathParts.at(-1)) !== null && _a !== void 0 ? _a : "";
      let parentObject = traverseObjectByPath(parentPath, o);
      return {
        parent: { key: parentPath, value: parentObject },
        child: { key: childKey, value: parentObject[childKey] }
      };
    }
    exports.traverseObjectToParent = traverseObjectToParent;
    function traverseObjectByPath(pathParts, o) {
      for (const pathPart of pathParts) {
        if (pathPart === "") {
          return o;
        }
        if (o === void 0) {
          return void 0;
        }
        o = o[pathPart];
      }
      return o;
    }
    exports.traverseObjectByPath = traverseObjectByPath;
    function parsePath(path) {
      path = path.replace(/'/g, '"');
      validatePath(path);
      return path.split(".").map((x) => x.split("[").map((y) => {
        if (y.endsWith("]")) {
          y = y.slice(0, -1);
        }
        if (y.startsWith('"') && y.endsWith('"')) {
          y = y.slice(1, -1);
        }
        return y;
      })).flat();
    }
    exports.parsePath = parsePath;
    function validatePath(path) {
      const numbers = "0123456789";
      const letters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
      let insideStringBrackets = false;
      let insideNumberBrackets = false;
      for (let i = 0; i < path.length; i++) {
        const char = path[i];
        const nextChar = path[i + 1];
        if (char === ".") {
          if (i === 0) {
            throw new OPDTraversalError(`Invalid character '${char}' at position ${i} in "${path}", path may not start with '.'`);
          }
          if (!(letters.includes(nextChar) || nextChar === "_" || nextChar === "$")) {
            throw new OPDTraversalError(`Invalid character '${nextChar}' at position ${i + 1} in "${path}", expected a letter, '_' or '$' to follow '.'`);
          }
        }
        if (char === "[") {
          if (numbers.includes(nextChar)) {
            insideNumberBrackets = true;
            continue;
          } else if (nextChar === '"') {
            if (path[i + 2] === '"') {
              throw new OPDTraversalError(`Invalid character '${path[i + 2]}' at position ${i + 2} in "${path}", the string between the quotation-marks may not be empty`);
            }
            insideStringBrackets = true;
            i += 1;
            continue;
          } else {
            throw new OPDTraversalError(`Invalid character '${nextChar}' at position ${i + 1} in "${path}", expected number or '"' to follow a '['`);
          }
        }
        if (insideStringBrackets && char === '"') {
          if (nextChar === "]") {
            insideStringBrackets = false;
            i += 1;
            continue;
          } else {
            throw new OPDTraversalError(`Invalid character '${nextChar}' at position ${i + 1} in "${path}", expected ']' to follow a '"'`);
          }
        }
        if (insideNumberBrackets && char === "]") {
          insideNumberBrackets = false;
          continue;
        }
        if (insideStringBrackets && (char === "." || char === "]" || char === "[")) {
          throw new OPDTraversalError(`Invalid character '${char}' at position ${i} in "${path}"`);
        }
        if (insideNumberBrackets && !numbers.includes(char)) {
          throw new OPDTraversalError(`Invalid character '${char}' at position ${i} in "${path}", number expected inside of brackets`);
        }
        if (!insideNumberBrackets && !insideStringBrackets) {
          if (char === "]") {
            throw new OPDTraversalError(`Invalid character '${char}' at position ${i} in "${path}", expected '[' to proceed`);
          }
        }
      }
    }
    exports.validatePath = validatePath;
    var OPDTraversalError = class extends Error {
      constructor(message) {
        super(message);
      }
    };
    exports.OPDTraversalError = OPDTraversalError;
  }
});

// node_modules/@opd-libs/opd-metadata-lib/lib/ObsUtils.js
var require_ObsUtils = __commonJS({
  "node_modules/@opd-libs/opd-metadata-lib/lib/ObsUtils.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.stringifyFrontmatter = void 0;
    var obsidian_1 = require("obsidian");
    function stringifyFrontmatter(frontmatter) {
      return `---
${(0, obsidian_1.stringifyYaml)(frontmatter)}---`;
    }
    exports.stringifyFrontmatter = stringifyFrontmatter;
  }
});

// node_modules/@opd-libs/opd-metadata-lib/lib/Internal.js
var require_Internal = __commonJS({
  "node_modules/@opd-libs/opd-metadata-lib/lib/Internal.js"(exports) {
    "use strict";
    var __awaiter = exports && exports.__awaiter || function(thisArg, _arguments, P, generator) {
      function adopt(value) {
        return value instanceof P ? value : new P(function(resolve) {
          resolve(value);
        });
      }
      return new (P || (P = Promise))(function(resolve, reject) {
        function fulfilled(value) {
          try {
            step(generator.next(value));
          } catch (e) {
            reject(e);
          }
        }
        function rejected(value) {
          try {
            step(generator["throw"](value));
          } catch (e) {
            reject(e);
          }
        }
        function step(result) {
          result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
        }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
      });
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.Internal = void 0;
    var obsidian_1 = require("obsidian");
    var Utils_1 = require_Utils();
    var ObsUtils_1 = require_ObsUtils();
    var Internal;
    (function(Internal2) {
      Internal2.frontMatterRexExpPattern = "^(---)\\n[\\s\\S]*?\\n---";
      function getMetaDataFromFileContent(fileContent) {
        const regExp = new RegExp(Internal2.frontMatterRexExpPattern);
        const frontMatterRegExpResult = regExp.exec(fileContent);
        if (!frontMatterRegExpResult) {
          return [];
        }
        let frontMatter = frontMatterRegExpResult[0];
        if (!frontMatter) {
          return [];
        }
        frontMatter = frontMatter.substring(4);
        frontMatter = frontMatter.substring(0, frontMatter.length - 3);
        return getMetaDataFromYAML(frontMatter);
      }
      Internal2.getMetaDataFromFileContent = getMetaDataFromFileContent;
      function getMetaDataFromYAML(yaml) {
        if (!yaml) {
          return {};
        }
        const obj = (0, obsidian_1.parseYaml)(yaml);
        if (!obj) {
          return {};
        }
        return obj;
      }
      Internal2.getMetaDataFromYAML = getMetaDataFromYAML;
      function getMetadataFromFileCache(file, plugin) {
        var _a;
        let metadata = (_a = plugin.app.metadataCache.getFileCache(file)) === null || _a === void 0 ? void 0 : _a.frontmatter;
        if (metadata) {
          metadata = Object.assign({}, metadata);
          delete metadata.position;
        } else {
          return {};
        }
        return metadata;
      }
      Internal2.getMetadataFromFileCache = getMetadataFromFileCache;
      function removeFrontmatter(fileContent) {
        return fileContent.replace(new RegExp(Internal2.frontMatterRexExpPattern), "");
      }
      Internal2.removeFrontmatter = removeFrontmatter;
      function updateFrontmatter(metadata, file, plugin) {
        return __awaiter(this, void 0, void 0, function* () {
          let fileContent = yield plugin.app.vault.cachedRead(file);
          fileContent = removeFrontmatter(fileContent);
          fileContent = `${(0, ObsUtils_1.stringifyFrontmatter)(metadata)}${fileContent}`;
          yield plugin.app.vault.modify(file, fileContent);
        });
      }
      Internal2.updateFrontmatter = updateFrontmatter;
      function hasField(path, metadata) {
        return getField(path, metadata) !== void 0;
      }
      Internal2.hasField = hasField;
      function getField(path, metadata) {
        return (0, Utils_1.traverseObject)(path, metadata);
      }
      Internal2.getField = getField;
      function deleteField(path, metadata) {
        let { parent, child } = (0, Utils_1.traverseObjectToParent)(path, metadata);
        if (parent.value === void 0) {
          throw Error(`The parent of "${path}" does not exist in Object, can not delete child from non existing parent`);
        }
        if (Array.isArray(parent.value)) {
          const index = Number.parseInt(child.key);
          if (Number.isNaN(index)) {
            return metadata;
          }
          parent.value.splice(index, 1);
        } else {
          delete parent.value[child.key];
        }
        return metadata;
      }
      Internal2.deleteField = deleteField;
      function updateField(path, value, metadata) {
        let { parent, child } = (0, Utils_1.traverseObjectToParent)(path, metadata);
        if (parent.value === void 0) {
          throw Error(`The parent of "${path}" does not exist in Object, please create the parent first`);
        }
        if (child.value === void 0) {
          throw Error(`Field with key "${path}" does not exist in Object`);
        }
        parent.value[child.key] = value;
        return metadata;
      }
      Internal2.updateField = updateField;
      function insertField(path, value, metadata) {
        let { parent, child } = (0, Utils_1.traverseObjectToParent)(path, metadata);
        if (parent.value === void 0) {
          throw Error(`The parent of "${path}" does not exist in Object, please create the parent first`);
        }
        if (child.value !== void 0) {
          throw Error(`Field with key "${path}" does already exist in Object`);
        }
        parent.value[child.key] = value;
        return metadata;
      }
      Internal2.insertField = insertField;
      function updateOrInsertField(path, value, metadata) {
        let { parent, child } = (0, Utils_1.traverseObjectToParent)(path, metadata);
        if (parent.value === void 0) {
          throw Error(`The parent of "${path}" does not exist in Object, please create the parent first`);
        }
        parent.value[child.key] = value;
        return metadata;
      }
      Internal2.updateOrInsertField = updateOrInsertField;
    })(Internal = exports.Internal || (exports.Internal = {}));
  }
});

// node_modules/@opd-libs/opd-metadata-lib/lib/API.js
var require_API = __commonJS({
  "node_modules/@opd-libs/opd-metadata-lib/lib/API.js"(exports) {
    "use strict";
    var __awaiter = exports && exports.__awaiter || function(thisArg, _arguments, P, generator) {
      function adopt(value) {
        return value instanceof P ? value : new P(function(resolve) {
          resolve(value);
        });
      }
      return new (P || (P = Promise))(function(resolve, reject) {
        function fulfilled(value) {
          try {
            step(generator.next(value));
          } catch (e) {
            reject(e);
          }
        }
        function rejected(value) {
          try {
            step(generator["throw"](value));
          } catch (e) {
            reject(e);
          }
        }
        function step(result) {
          result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);
        }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
      });
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.setFrontmatterOfTFile = exports.getFrontmatterOfTFile = exports.deleteFieldInTFile = exports.updateOrInsertFieldInTFile = exports.updateFieldInTFile = exports.insertFieldInTFile = exports.getFieldFromTFile = exports.doesFieldExistInTFile = void 0;
    var Internal_1 = require_Internal();
    function doesFieldExistInTFile(field, file, plugin, isInline = false) {
      const metadata = Internal_1.Internal.getMetadataFromFileCache(file, plugin);
      return Internal_1.Internal.hasField(field, metadata);
    }
    exports.doesFieldExistInTFile = doesFieldExistInTFile;
    function getFieldFromTFile(field, file, plugin, isInline = false) {
      const metadata = Internal_1.Internal.getMetadataFromFileCache(file, plugin);
      return Internal_1.Internal.getField(field, metadata);
    }
    exports.getFieldFromTFile = getFieldFromTFile;
    function insertFieldInTFile(field, value, file, plugin, isInline = false) {
      return __awaiter(this, void 0, void 0, function* () {
        const metadata = Internal_1.Internal.getMetadataFromFileCache(file, plugin);
        Internal_1.Internal.insertField(field, value, metadata);
        yield Internal_1.Internal.updateFrontmatter(metadata, file, plugin);
      });
    }
    exports.insertFieldInTFile = insertFieldInTFile;
    function updateFieldInTFile(field, value, file, plugin, isInline = false) {
      return __awaiter(this, void 0, void 0, function* () {
        const metadata = Internal_1.Internal.getMetadataFromFileCache(file, plugin);
        Internal_1.Internal.updateField(field, value, metadata);
        yield Internal_1.Internal.updateFrontmatter(metadata, file, plugin);
      });
    }
    exports.updateFieldInTFile = updateFieldInTFile;
    function updateOrInsertFieldInTFile(field, value, file, plugin, isInline = false) {
      return __awaiter(this, void 0, void 0, function* () {
        let metadata = Internal_1.Internal.getMetadataFromFileCache(file, plugin);
        Internal_1.Internal.updateOrInsertField(field, value, metadata);
        yield Internal_1.Internal.updateFrontmatter(metadata, file, plugin);
      });
    }
    exports.updateOrInsertFieldInTFile = updateOrInsertFieldInTFile;
    function deleteFieldInTFile(field, file, plugin, isInline = false) {
      return __awaiter(this, void 0, void 0, function* () {
        const metadata = Internal_1.Internal.getMetadataFromFileCache(file, plugin);
        Internal_1.Internal.deleteField(field, metadata);
        yield Internal_1.Internal.updateFrontmatter(metadata, file, plugin);
      });
    }
    exports.deleteFieldInTFile = deleteFieldInTFile;
    function getFrontmatterOfTFile2(file, plugin) {
      return Internal_1.Internal.getMetadataFromFileCache(file, plugin);
    }
    exports.getFrontmatterOfTFile = getFrontmatterOfTFile2;
    function setFrontmatterOfTFile2(metadata, file, plugin) {
      return __awaiter(this, void 0, void 0, function* () {
        yield Internal_1.Internal.updateFrontmatter(metadata, file, plugin);
      });
    }
    exports.setFrontmatterOfTFile = setFrontmatterOfTFile2;
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => FrontmatterLinksPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/editor_plugin.ts
var import_language = require("@codemirror/language");
var import_state = require("@codemirror/state");
var import_view2 = require("@codemirror/view");

// src/link_widget.ts
var import_view = require("@codemirror/view");
var import_obsidian = require("obsidian");
var import_valid_url = __toESM(require_valid_url());
var FrontmatterLinkWidget = class extends import_view.WidgetType {
  constructor(linkSlice) {
    super();
    this.linkSlice = linkSlice;
  }
  toDOM(view) {
    const aElement = document.createElement("a");
    aElement.href = this.linkSlice.href;
    aElement.innerText = this.linkSlice.alias || this.linkSlice.href;
    if ((0, import_valid_url.isUri)(this.linkSlice.href)) {
      aElement.addClass(this.linkSlice.markdownLink ? "external-link" : "cm-url");
    } else {
      aElement.addClass("internal-link");
      if (!(app.metadataCache.getFirstLinkpathDest(this.linkSlice.href, "") instanceof import_obsidian.TFile) && !this.linkSlice.markdownLink) {
        aElement.addClass("is-unresolved");
      }
    }
    return aElement;
  }
};

// src/editor_plugin.ts
var import_valid_url2 = __toESM(require_valid_url());
var import_obsidian2 = require("obsidian");
var FrontmatterLinksEditorPlugin = class {
  constructor(view) {
    this.linkSlices = new Array();
    this.linkSlices = new Array();
    this.decorations = this.buildDecorations(view);
  }
  update(update) {
    if (update.docChanged || update.viewportChanged || update.selectionSet) {
      this.decorations = this.buildDecorations(update.view);
    }
  }
  destroy() {
  }
  buildDecorations(view) {
    const builder = new import_state.RangeSetBuilder();
    this.linkSlices = new Array();
    this.findLinks(view, this.linkSlices);
    this.processLinks(view, builder);
    return builder.finish();
  }
  findLinks(view, linkSlices) {
    const settings = app.plugins.plugins["frontmatter-links"].settings;
    let externalLinkFrom;
    let externalLinkTo;
    for (let { from, to } of view.visibleRanges) {
      (0, import_language.syntaxTree)(view.state).iterate({
        from,
        to,
        enter(node) {
          if (externalLinkFrom === null) {
            if (node.name === "hmd-frontmatter") {
              externalLinkFrom = node.from;
              externalLinkTo = node.to;
            }
          } else {
            if (node.name === "atom_hmd-frontmatter" || node.name === "def_hmd-frontmatter") {
              let text = view.state.sliceDoc(externalLinkFrom, externalLinkTo);
              if ((0, import_valid_url2.isUri)(text)) {
                linkSlices.push({
                  originalText: text,
                  href: text,
                  from: externalLinkFrom,
                  to: externalLinkTo
                });
              }
              externalLinkFrom = null;
            } else {
              externalLinkTo = node.to;
            }
          }
          if (node.name === "hmd-frontmatter_string") {
            const text = view.state.sliceDoc(node.from + 1, node.to - 1);
            let match;
            let href;
            let alias;
            let markdownLink;
            if (match = text.match(/\[\[(.+)\|(.+)\]\]/m)) {
              href = match[1];
              alias = match[2];
            } else if (match = text.match(/\[\[(.+)\]\]/m)) {
              href = match[1];
            } else if (match = text.match(/\[(.+)\]\((.+)\)/m)) {
              href = match[2];
              alias = match[1];
              markdownLink = true;
            } else if ((0, import_valid_url2.isUri)(text)) {
              href = text;
            }
            if (href) {
              linkSlices.push({
                originalText: text,
                href,
                alias,
                from: node.from + (settings.hideQuotes ? 0 : 1),
                to: node.to - (settings.hideQuotes ? 0 : 1),
                markdownLink
              });
            }
          }
        }
      });
    }
  }
  processLinks(view, builder) {
    for (let linkSlice of this.linkSlices) {
      const cursorHead = view.state.selection.main.head;
      if (linkSlice.from - 1 <= cursorHead && cursorHead <= linkSlice.to + 1) {
        this.styleLink(view, builder, linkSlice);
      } else {
        builder.add(linkSlice.from, linkSlice.to, import_view2.Decoration.replace({ widget: new FrontmatterLinkWidget(linkSlice) }));
      }
    }
  }
  styleLink(view, builder, linkSlice) {
    const settings = app.plugins.plugins["frontmatter-links"].settings;
    const unresolved = !(app.metadataCache.getFirstLinkpathDest(linkSlice.href, "") instanceof import_obsidian2.TFile);
    const text = view.state.sliceDoc(linkSlice.from, linkSlice.to);
    let match;
    if (match = text.match(/\[\[(.+)\|(.+)\]\]/m)) {
      builder.add(linkSlice.from + (settings.hideQuotes ? 1 : 0), linkSlice.from + 2 + (settings.hideQuotes ? 1 : 0), import_view2.Decoration.mark({ class: "cm-formatting-link cm-formatting-link-start" }));
      builder.add(linkSlice.from + text.indexOf(match[1]), linkSlice.from + text.indexOf(match[1]) + match[1].length, import_view2.Decoration.mark({ class: "cm-link" + (unresolved ? " is-unresolved" : "") }));
      builder.add(linkSlice.from + text.indexOf(match[1]) + match[1].length, linkSlice.from + text.indexOf(match[1]) + match[1].length + 1, import_view2.Decoration.mark({ class: "cm-hmd-internal-link" }));
      builder.add(linkSlice.from + text.indexOf(match[2]), linkSlice.from + text.indexOf(match[2]) + match[2].length, import_view2.Decoration.mark({ class: "cm-link" + (unresolved ? " is-unresolved" : "") }));
      builder.add(linkSlice.to - 2 - (settings.hideQuotes ? 1 : 0), linkSlice.to - (settings.hideQuotes ? 1 : 0), import_view2.Decoration.mark({ class: "cm-formatting-link cm-formatting-link-end" }));
    } else if (match = text.match(/\[\[(.+)\]\]/m)) {
      builder.add(linkSlice.from + (settings.hideQuotes ? 1 : 0), linkSlice.from + 2 + (settings.hideQuotes ? 1 : 0), import_view2.Decoration.mark({ class: "cm-formatting-link cm-formatting-link-start" }));
      builder.add(linkSlice.from + text.indexOf(match[1]), linkSlice.from + text.indexOf(match[1]) + match[1].length, import_view2.Decoration.mark({ class: "cm-link" + (unresolved ? " is-unresolved" : "") }));
      builder.add(linkSlice.to - 2 - (settings.hideQuotes ? 1 : 0), linkSlice.to - (settings.hideQuotes ? 1 : 0), import_view2.Decoration.mark({ class: "cm-formatting-link cm-formatting-link-end" }));
    } else if (match = text.match(/\[(.+)\](\(.+\))/m)) {
      builder.add(linkSlice.from + (settings.hideQuotes ? 1 : 0), linkSlice.from + 1 + (settings.hideQuotes ? 1 : 0), import_view2.Decoration.mark({ class: "cm-formatting-link cm-formatting-link-start" }));
      builder.add(linkSlice.from + text.indexOf(match[1]), linkSlice.from + text.indexOf(match[1]) + match[1].length, import_view2.Decoration.mark({ class: "cm-link" }));
      builder.add(linkSlice.from + text.indexOf("]"), linkSlice.from + text.indexOf("]") + 1, import_view2.Decoration.mark({ class: "cm-formatting-link cm-formatting-link-end" }));
      builder.add(linkSlice.from + text.indexOf(match[2]), linkSlice.from + text.indexOf(match[2]) + match[2].length, import_view2.Decoration.mark({ class: (0, import_valid_url2.isUri)(linkSlice.href) ? "external-link" : "cm-url" }));
    } else if (match = text.match(/\"(.+)\"/m)) {
      builder.add(linkSlice.from + text.indexOf(match[1]), linkSlice.from + text.indexOf(match[1]) + match[1].length, import_view2.Decoration.mark({ class: "cm-url" }));
    } else if ((0, import_valid_url2.isUri)(text)) {
      builder.add(linkSlice.from, linkSlice.to, import_view2.Decoration.mark({ class: "cm-url" }));
    }
  }
};
var FRONTMATTER_LINKS_EDITOR_PLUGIN = import_view2.ViewPlugin.fromClass(FrontmatterLinksEditorPlugin, {
  decorations: (value) => value.decorations
});

// src/metadata_cache.ts
var import_obsidian3 = require("obsidian");
var import_valid_url3 = __toESM(require_valid_url());
function onMetadataCacheResolve(file) {
  const cache = app.metadataCache.getFileCache(file);
  if (!cache) {
    return;
  }
  const frontmatter = cache.frontmatter;
  if (!frontmatter) {
    return;
  }
  addFrontmatterLinksToCache(file, frontmatter);
}
function addFrontmatterLinksToCache(file, frontmatter) {
  if (!frontmatter) {
    return;
  }
  for (let key of Object.keys(frontmatter)) {
    const value = frontmatter[key];
    if (typeof value === "string") {
      const match = value.match(/\[\[(.+)\|.+\]\]/m) || value.match(/\[\[(.+)\]\]/m) || value.match(/\[.+\]\((.+)\)/m);
      if (!match) {
        continue;
      }
      let href = match[1];
      if ((0, import_valid_url3.isUri)(href)) {
        continue;
      }
      let f = app.metadataCache.getFirstLinkpathDest(href, "");
      let links;
      if (f instanceof import_obsidian3.TFile) {
        href = f.path;
        links = app.metadataCache.resolvedLinks;
      } else {
        links = app.metadataCache.unresolvedLinks;
      }
      if (links[file.path][href]) {
        links[file.path][href] += 1;
      } else {
        links[file.path][href] = 1;
      }
    } else if (typeof value === "object") {
      addFrontmatterLinksToCache(file, value);
    }
  }
}

// src/rename_links.ts
var import_API = __toESM(require_API());
var import_obsidian4 = require("obsidian");
function onVaultFileRename(file, oldPath, plugin) {
  for (let fileName of Object.keys(app.metadataCache.resolvedLinks)) {
    const links = app.metadataCache.resolvedLinks[fileName];
    let oldName = oldPath;
    let match = oldPath.match(/.+\/(.+\.md)/m);
    if (match) {
      oldName = match[1];
    }
    if (links[oldPath]) {
      const f = app.metadataCache.getFirstLinkpathDest(fileName, "");
      if (f instanceof import_obsidian4.TFile) {
        const frontmatter = (0, import_API.getFrontmatterOfTFile)(f, plugin);
        renameFrontmatterLinks(frontmatter, oldName.substring(0, oldName.length - 3), file.name.substring(0, file.name.length - 3));
        (0, import_API.setFrontmatterOfTFile)(frontmatter, f, plugin);
        app.metadataCache.initialize();
      }
    }
  }
}
function renameFrontmatterLinks(frontmatter, oldName, newName) {
  for (let key of Object.keys(frontmatter)) {
    const value = frontmatter[key];
    if (typeof value === "string") {
      let match;
      if (match = value.match(/\[\[(.+)\|(.+)\]\]/m)) {
        if (match[1] === oldName) {
          frontmatter[key] = "[[" + newName + "|" + match[2] + "]]";
        }
      } else if (match = value.match(/\[\[(.+)\]\]/m)) {
        if (match[1] === oldName) {
          frontmatter[key] = "[[" + newName + "]]";
        }
      } else if (match = value.match(/\[(.+)\]\((.+)\)/m)) {
        if (match[2] === oldName) {
          frontmatter[key] = "[" + match[1] + "](" + newName + ")";
        }
      }
    } else if (typeof value === "object") {
      renameFrontmatterLinks(value, oldName, newName);
    }
  }
}

// src/settings.ts
var import_obsidian5 = require("obsidian");
var DEFAULT_SETTINGS = {
  hideQuotes: false,
  addToGraph: true,
  updateLinks: true
};
var FrontmatterLinksSettingTab = class extends import_obsidian5.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    new import_obsidian5.Setting(this.containerEl).setName("Hide quotation marks").setDesc("Don't render quotation marks surrounding frontmatter links.").addToggle((component) => {
      component.setValue(this.plugin.settings.hideQuotes);
      component.onChange((value) => {
        this.plugin.settings.hideQuotes = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian5.Setting(this.containerEl).setName("Add to graph").setDesc("Add frontmatter link connections to the graph view.").addToggle((component) => {
      component.setValue(this.plugin.settings.addToGraph);
      component.onChange((value) => {
        app.metadataCache.initialize();
        this.plugin.settings.addToGraph = value;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian5.Setting(this.containerEl).setName("Automatically update internal frontmatter links").setDesc("Turn on to update frontmatter links when a note is renamed.<br>'Automatically update internal links' in 'Files & Links' must also be enabled.").setDesc(createFragment((el) => {
      el.appendText("Turn on to update frontmatter links when a note is renamed.");
      el.createEl("br");
      el.createEl("div", {
        cls: "mod-warning",
        text: "'Automatically update internal links' in 'Files & Links' must also be enabled."
      });
    })).addToggle((component) => {
      component.setValue(this.plugin.settings.updateLinks);
      component.onChange((value) => {
        this.plugin.settings.updateLinks = value;
        this.plugin.saveSettings();
      });
    });
  }
  hide() {
    this.containerEl.empty();
  }
};

// src/main.ts
var FrontmatterLinksPlugin = class extends import_obsidian6.Plugin {
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new FrontmatterLinksSettingTab(this.app, this));
    this.registerEditorExtension(FRONTMATTER_LINKS_EDITOR_PLUGIN);
    if (this.settings.addToGraph) {
      app.metadataCache.initialize();
    }
    const plugin = this;
    this.registerEvent(app.metadataCache.on("resolve", (file) => {
      if (!plugin.settings.addToGraph) {
        return;
      }
      onMetadataCacheResolve(file);
    }));
    this.registerEvent(app.vault.on("rename", (file, oldPath) => {
      if (plugin.settings.updateLinks && app.vault.getConfig("alwaysUpdateLinks")) {
        onVaultFileRename(file, oldPath, plugin);
      }
    }));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
    this.saveSettings();
  }
  async saveSettings() {
    this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibm9kZV9tb2R1bGVzL3ZhbGlkLXVybC9pbmRleC5qcyIsICJub2RlX21vZHVsZXMvQG9wZC1saWJzL29wZC1tZXRhZGF0YS1saWIvbGliL1V0aWxzLmpzIiwgIm5vZGVfbW9kdWxlcy9Ab3BkLWxpYnMvb3BkLW1ldGFkYXRhLWxpYi9saWIvT2JzVXRpbHMuanMiLCAibm9kZV9tb2R1bGVzL0BvcGQtbGlicy9vcGQtbWV0YWRhdGEtbGliL2xpYi9JbnRlcm5hbC5qcyIsICJub2RlX21vZHVsZXMvQG9wZC1saWJzL29wZC1tZXRhZGF0YS1saWIvbGliL0FQSS5qcyIsICJzcmMvbWFpbi50cyIsICJzcmMvZWRpdG9yX3BsdWdpbi50cyIsICJzcmMvbGlua193aWRnZXQudHMiLCAic3JjL21ldGFkYXRhX2NhY2hlLnRzIiwgInNyYy9yZW5hbWVfbGlua3MudHMiLCAic3JjL3NldHRpbmdzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIoZnVuY3Rpb24obW9kdWxlKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgbW9kdWxlLmV4cG9ydHMuaXNfdXJpID0gaXNfaXJpO1xuICAgIG1vZHVsZS5leHBvcnRzLmlzX2h0dHBfdXJpID0gaXNfaHR0cF9pcmk7XG4gICAgbW9kdWxlLmV4cG9ydHMuaXNfaHR0cHNfdXJpID0gaXNfaHR0cHNfaXJpO1xuICAgIG1vZHVsZS5leHBvcnRzLmlzX3dlYl91cmkgPSBpc193ZWJfaXJpO1xuICAgIC8vIENyZWF0ZSBhbGlhc2VzXG4gICAgbW9kdWxlLmV4cG9ydHMuaXNVcmkgPSBpc19pcmk7XG4gICAgbW9kdWxlLmV4cG9ydHMuaXNIdHRwVXJpID0gaXNfaHR0cF9pcmk7XG4gICAgbW9kdWxlLmV4cG9ydHMuaXNIdHRwc1VyaSA9IGlzX2h0dHBzX2lyaTtcbiAgICBtb2R1bGUuZXhwb3J0cy5pc1dlYlVyaSA9IGlzX3dlYl9pcmk7XG5cblxuICAgIC8vIHByaXZhdGUgZnVuY3Rpb25cbiAgICAvLyBpbnRlcm5hbCBVUkkgc3BpdHRlciBtZXRob2QgLSBkaXJlY3QgZnJvbSBSRkMgMzk4NlxuICAgIHZhciBzcGxpdFVyaSA9IGZ1bmN0aW9uKHVyaSkge1xuICAgICAgICB2YXIgc3BsaXR0ZWQgPSB1cmkubWF0Y2goLyg/OihbXjpcXC8/I10rKTopPyg/OlxcL1xcLyhbXlxcLz8jXSopKT8oW14/I10qKSg/OlxcPyhbXiNdKikpPyg/OiMoLiopKT8vKTtcbiAgICAgICAgcmV0dXJuIHNwbGl0dGVkO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBpc19pcmkodmFsdWUpIHtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgZm9yIGlsbGVnYWwgY2hhcmFjdGVyc1xuICAgICAgICBpZiAoL1teYS16MC05XFw6XFwvXFw/XFwjXFxbXFxdXFxAXFwhXFwkXFwmXFwnXFwoXFwpXFwqXFwrXFwsXFw7XFw9XFwuXFwtXFxfXFx+XFwlXS9pLnRlc3QodmFsdWUpKSByZXR1cm47XG5cbiAgICAgICAgLy8gY2hlY2sgZm9yIGhleCBlc2NhcGVzIHRoYXQgYXJlbid0IGNvbXBsZXRlXG4gICAgICAgIGlmICgvJVteMC05YS1mXS9pLnRlc3QodmFsdWUpKSByZXR1cm47XG4gICAgICAgIGlmICgvJVswLTlhLWZdKDo/W14wLTlhLWZdfCQpL2kudGVzdCh2YWx1ZSkpIHJldHVybjtcblxuICAgICAgICB2YXIgc3BsaXR0ZWQgPSBbXTtcbiAgICAgICAgdmFyIHNjaGVtZSA9ICcnO1xuICAgICAgICB2YXIgYXV0aG9yaXR5ID0gJyc7XG4gICAgICAgIHZhciBwYXRoID0gJyc7XG4gICAgICAgIHZhciBxdWVyeSA9ICcnO1xuICAgICAgICB2YXIgZnJhZ21lbnQgPSAnJztcbiAgICAgICAgdmFyIG91dCA9ICcnO1xuXG4gICAgICAgIC8vIGZyb20gUkZDIDM5ODZcbiAgICAgICAgc3BsaXR0ZWQgPSBzcGxpdFVyaSh2YWx1ZSk7XG4gICAgICAgIHNjaGVtZSA9IHNwbGl0dGVkWzFdOyBcbiAgICAgICAgYXV0aG9yaXR5ID0gc3BsaXR0ZWRbMl07XG4gICAgICAgIHBhdGggPSBzcGxpdHRlZFszXTtcbiAgICAgICAgcXVlcnkgPSBzcGxpdHRlZFs0XTtcbiAgICAgICAgZnJhZ21lbnQgPSBzcGxpdHRlZFs1XTtcblxuICAgICAgICAvLyBzY2hlbWUgYW5kIHBhdGggYXJlIHJlcXVpcmVkLCB0aG91Z2ggdGhlIHBhdGggY2FuIGJlIGVtcHR5XG4gICAgICAgIGlmICghKHNjaGVtZSAmJiBzY2hlbWUubGVuZ3RoICYmIHBhdGgubGVuZ3RoID49IDApKSByZXR1cm47XG5cbiAgICAgICAgLy8gaWYgYXV0aG9yaXR5IGlzIHByZXNlbnQsIHRoZSBwYXRoIG11c3QgYmUgZW1wdHkgb3IgYmVnaW4gd2l0aCBhIC9cbiAgICAgICAgaWYgKGF1dGhvcml0eSAmJiBhdXRob3JpdHkubGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoIShwYXRoLmxlbmd0aCA9PT0gMCB8fCAvXlxcLy8udGVzdChwYXRoKSkpIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGlmIGF1dGhvcml0eSBpcyBub3QgcHJlc2VudCwgdGhlIHBhdGggbXVzdCBub3Qgc3RhcnQgd2l0aCAvL1xuICAgICAgICAgICAgaWYgKC9eXFwvXFwvLy50ZXN0KHBhdGgpKSByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzY2hlbWUgbXVzdCBiZWdpbiB3aXRoIGEgbGV0dGVyLCB0aGVuIGNvbnNpc3Qgb2YgbGV0dGVycywgZGlnaXRzLCArLCAuLCBvciAtXG4gICAgICAgIGlmICghL15bYS16XVthLXowLTlcXCtcXC1cXC5dKiQvLnRlc3Qoc2NoZW1lLnRvTG93ZXJDYXNlKCkpKSAgcmV0dXJuO1xuXG4gICAgICAgIC8vIHJlLWFzc2VtYmxlIHRoZSBVUkwgcGVyIHNlY3Rpb24gNS4zIGluIFJGQyAzOTg2XG4gICAgICAgIG91dCArPSBzY2hlbWUgKyAnOic7XG4gICAgICAgIGlmIChhdXRob3JpdHkgJiYgYXV0aG9yaXR5Lmxlbmd0aCkge1xuICAgICAgICAgICAgb3V0ICs9ICcvLycgKyBhdXRob3JpdHk7XG4gICAgICAgIH1cblxuICAgICAgICBvdXQgKz0gcGF0aDtcblxuICAgICAgICBpZiAocXVlcnkgJiYgcXVlcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICBvdXQgKz0gJz8nICsgcXVlcnk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZnJhZ21lbnQgJiYgZnJhZ21lbnQubGVuZ3RoKSB7XG4gICAgICAgICAgICBvdXQgKz0gJyMnICsgZnJhZ21lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzX2h0dHBfaXJpKHZhbHVlLCBhbGxvd0h0dHBzKSB7XG4gICAgICAgIGlmICghaXNfaXJpKHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNwbGl0dGVkID0gW107XG4gICAgICAgIHZhciBzY2hlbWUgPSAnJztcbiAgICAgICAgdmFyIGF1dGhvcml0eSA9ICcnO1xuICAgICAgICB2YXIgcGF0aCA9ICcnO1xuICAgICAgICB2YXIgcG9ydCA9ICcnO1xuICAgICAgICB2YXIgcXVlcnkgPSAnJztcbiAgICAgICAgdmFyIGZyYWdtZW50ID0gJyc7XG4gICAgICAgIHZhciBvdXQgPSAnJztcblxuICAgICAgICAvLyBmcm9tIFJGQyAzOTg2XG4gICAgICAgIHNwbGl0dGVkID0gc3BsaXRVcmkodmFsdWUpO1xuICAgICAgICBzY2hlbWUgPSBzcGxpdHRlZFsxXTsgXG4gICAgICAgIGF1dGhvcml0eSA9IHNwbGl0dGVkWzJdO1xuICAgICAgICBwYXRoID0gc3BsaXR0ZWRbM107XG4gICAgICAgIHF1ZXJ5ID0gc3BsaXR0ZWRbNF07XG4gICAgICAgIGZyYWdtZW50ID0gc3BsaXR0ZWRbNV07XG5cbiAgICAgICAgaWYgKCFzY2hlbWUpICByZXR1cm47XG5cbiAgICAgICAgaWYoYWxsb3dIdHRwcykge1xuICAgICAgICAgICAgaWYgKHNjaGVtZS50b0xvd2VyQ2FzZSgpICE9ICdodHRwcycpIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChzY2hlbWUudG9Mb3dlckNhc2UoKSAhPSAnaHR0cCcpIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZ1bGx5LXF1YWxpZmllZCBVUklzIG11c3QgaGF2ZSBhbiBhdXRob3JpdHkgc2VjdGlvbiB0aGF0IGlzXG4gICAgICAgIC8vIGEgdmFsaWQgaG9zdFxuICAgICAgICBpZiAoIWF1dGhvcml0eSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZW5hYmxlIHBvcnQgY29tcG9uZW50XG4gICAgICAgIGlmICgvOihcXGQrKSQvLnRlc3QoYXV0aG9yaXR5KSkge1xuICAgICAgICAgICAgcG9ydCA9IGF1dGhvcml0eS5tYXRjaCgvOihcXGQrKSQvKVswXTtcbiAgICAgICAgICAgIGF1dGhvcml0eSA9IGF1dGhvcml0eS5yZXBsYWNlKC86XFxkKyQvLCAnJyk7XG4gICAgICAgIH1cblxuICAgICAgICBvdXQgKz0gc2NoZW1lICsgJzonO1xuICAgICAgICBvdXQgKz0gJy8vJyArIGF1dGhvcml0eTtcbiAgICAgICAgXG4gICAgICAgIGlmIChwb3J0KSB7XG4gICAgICAgICAgICBvdXQgKz0gcG9ydDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgb3V0ICs9IHBhdGg7XG4gICAgICAgIFxuICAgICAgICBpZihxdWVyeSAmJiBxdWVyeS5sZW5ndGgpe1xuICAgICAgICAgICAgb3V0ICs9ICc/JyArIHF1ZXJ5O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoZnJhZ21lbnQgJiYgZnJhZ21lbnQubGVuZ3RoKXtcbiAgICAgICAgICAgIG91dCArPSAnIycgKyBmcmFnbWVudDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc19odHRwc19pcmkodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGlzX2h0dHBfaXJpKHZhbHVlLCB0cnVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc193ZWJfaXJpKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiAoaXNfaHR0cF9pcmkodmFsdWUpIHx8IGlzX2h0dHBzX2lyaSh2YWx1ZSkpO1xuICAgIH1cblxufSkobW9kdWxlKTtcbiIsICJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuT1BEVHJhdmVyc2FsRXJyb3IgPSBleHBvcnRzLnZhbGlkYXRlUGF0aCA9IGV4cG9ydHMucGFyc2VQYXRoID0gZXhwb3J0cy50cmF2ZXJzZU9iamVjdEJ5UGF0aCA9IGV4cG9ydHMudHJhdmVyc2VPYmplY3RUb1BhcmVudCA9IGV4cG9ydHMudHJhdmVyc2VPYmplY3QgPSB2b2lkIDA7XG5mdW5jdGlvbiB0cmF2ZXJzZU9iamVjdChwYXRoLCBvKSB7XG4gICAgbGV0IHBhdGhQYXJ0cyA9IHBhcnNlUGF0aChwYXRoKTtcbiAgICByZXR1cm4gdHJhdmVyc2VPYmplY3RCeVBhdGgocGF0aFBhcnRzLCBvKTtcbn1cbmV4cG9ydHMudHJhdmVyc2VPYmplY3QgPSB0cmF2ZXJzZU9iamVjdDtcbmZ1bmN0aW9uIHRyYXZlcnNlT2JqZWN0VG9QYXJlbnQocGF0aCwgbykge1xuICAgIHZhciBfYTtcbiAgICBsZXQgcGF0aFBhcnRzID0gcGFyc2VQYXRoKHBhdGgpO1xuICAgIGlmIChwYXRoUGFydHNbMF0gPT09ICcnKSB7XG4gICAgICAgIHRocm93IG5ldyBPUERUcmF2ZXJzYWxFcnJvcignY2FuIG5vdCB0cmF2ZXJzZSB0byBwYXJlbnQgb24gc2VsZiByZWZlcmVuY2UnKTtcbiAgICB9XG4gICAgbGV0IHBhcmVudFBhdGggPSBwYXRoUGFydHMuc2xpY2UoMCwgLTEpO1xuICAgIGxldCBjaGlsZEtleSA9IChfYSA9IHBhdGhQYXJ0cy5hdCgtMSkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6ICcnO1xuICAgIGxldCBwYXJlbnRPYmplY3QgPSB0cmF2ZXJzZU9iamVjdEJ5UGF0aChwYXJlbnRQYXRoLCBvKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBwYXJlbnQ6IHsga2V5OiBwYXJlbnRQYXRoLCB2YWx1ZTogcGFyZW50T2JqZWN0IH0sXG4gICAgICAgIGNoaWxkOiB7IGtleTogY2hpbGRLZXksIHZhbHVlOiBwYXJlbnRPYmplY3RbY2hpbGRLZXldIH0sXG4gICAgfTtcbn1cbmV4cG9ydHMudHJhdmVyc2VPYmplY3RUb1BhcmVudCA9IHRyYXZlcnNlT2JqZWN0VG9QYXJlbnQ7XG5mdW5jdGlvbiB0cmF2ZXJzZU9iamVjdEJ5UGF0aChwYXRoUGFydHMsIG8pIHtcbiAgICBmb3IgKGNvbnN0IHBhdGhQYXJ0IG9mIHBhdGhQYXJ0cykge1xuICAgICAgICBpZiAocGF0aFBhcnQgPT09ICcnKSB7XG4gICAgICAgICAgICByZXR1cm4gbztcbiAgICAgICAgfVxuICAgICAgICBpZiAobyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIG8gPSBvW3BhdGhQYXJ0XTtcbiAgICB9XG4gICAgcmV0dXJuIG87XG59XG5leHBvcnRzLnRyYXZlcnNlT2JqZWN0QnlQYXRoID0gdHJhdmVyc2VPYmplY3RCeVBhdGg7XG5mdW5jdGlvbiBwYXJzZVBhdGgocGF0aCkge1xuICAgIHBhdGggPSBwYXRoLnJlcGxhY2UoLycvZywgJ1wiJyk7XG4gICAgdmFsaWRhdGVQYXRoKHBhdGgpO1xuICAgIHJldHVybiBwYXRoXG4gICAgICAgIC5zcGxpdCgnLicpXG4gICAgICAgIC5tYXAoeCA9PiB4LnNwbGl0KCdbJykubWFwKHkgPT4ge1xuICAgICAgICBpZiAoeS5lbmRzV2l0aCgnXScpKSB7XG4gICAgICAgICAgICB5ID0geS5zbGljZSgwLCAtMSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHkuc3RhcnRzV2l0aCgnXCInKSAmJiB5LmVuZHNXaXRoKCdcIicpKSB7XG4gICAgICAgICAgICB5ID0geS5zbGljZSgxLCAtMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHk7XG4gICAgfSkpXG4gICAgICAgIC5mbGF0KCk7XG59XG5leHBvcnRzLnBhcnNlUGF0aCA9IHBhcnNlUGF0aDtcbmZ1bmN0aW9uIHZhbGlkYXRlUGF0aChwYXRoKSB7XG4gICAgY29uc3QgbnVtYmVycyA9ICcwMTIzNDU2Nzg5JztcbiAgICBjb25zdCBsZXR0ZXJzID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonO1xuICAgIGxldCBpbnNpZGVTdHJpbmdCcmFja2V0cyA9IGZhbHNlO1xuICAgIGxldCBpbnNpZGVOdW1iZXJCcmFja2V0cyA9IGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGF0aC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBjaGFyID0gcGF0aFtpXTtcbiAgICAgICAgY29uc3QgbmV4dENoYXIgPSBwYXRoW2kgKyAxXTtcbiAgICAgICAgLy8gaWYgY2hhciBpcyBhIGRvdFxuICAgICAgICBpZiAoY2hhciA9PT0gJy4nKSB7XG4gICAgICAgICAgICAvLyBhIGRvdCBtYXkgbm90IGJlIGF0IHRoZSBiZWdpbm5pbmcgb2YgYSBwYXRoXG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBPUERUcmF2ZXJzYWxFcnJvcihgSW52YWxpZCBjaGFyYWN0ZXIgJyR7Y2hhcn0nIGF0IHBvc2l0aW9uICR7aX0gaW4gXCIke3BhdGh9XCIsIHBhdGggbWF5IG5vdCBzdGFydCB3aXRoICcuJ2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdGhlIHRoaW5nIGZvbGxvd2luZyBhIGRvdCBtdXN0IGJlIGEgdmFsaWQgdmFyaWFibGUgbmFtZSwgc28gaXQgbXVzdCBzdGFydCB3aXRoIGEgbGV0dGVyIG9yIGFuIHVuZGVyc2NvcmVcbiAgICAgICAgICAgIGlmICghKGxldHRlcnMuaW5jbHVkZXMobmV4dENoYXIpIHx8IG5leHRDaGFyID09PSAnXycgfHwgbmV4dENoYXIgPT09ICckJykpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgT1BEVHJhdmVyc2FsRXJyb3IoYEludmFsaWQgY2hhcmFjdGVyICcke25leHRDaGFyfScgYXQgcG9zaXRpb24gJHtpICsgMX0gaW4gXCIke3BhdGh9XCIsIGV4cGVjdGVkIGEgbGV0dGVyLCAnXycgb3IgJyQnIHRvIGZvbGxvdyAnLidgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBicmFja2V0IGVudGVyIGNvbmRpdGlvblxuICAgICAgICBpZiAoY2hhciA9PT0gJ1snKSB7XG4gICAgICAgICAgICBpZiAobnVtYmVycy5pbmNsdWRlcyhuZXh0Q2hhcikpIHtcbiAgICAgICAgICAgICAgICAvLyB0aGUgYnJhY2tldCBpcyB1c2VkIHRvIGFjY2VzcyBhbiBhcnJheVxuICAgICAgICAgICAgICAgIGluc2lkZU51bWJlckJyYWNrZXRzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gc2tpcCByZXN0IG9mIGN1cnJlbnQgY2hhclxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmV4dENoYXIgPT09ICdcIicpIHtcbiAgICAgICAgICAgICAgICAvLyB0aGUgc3RyaW5nIGJldHdlZW4gdGhlIHF1b3RhdGlvbi1tYXJrcyBtYXkgbm90IGJlIGVtcHR5XG4gICAgICAgICAgICAgICAgaWYgKHBhdGhbaSArIDJdID09PSAnXCInKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBPUERUcmF2ZXJzYWxFcnJvcihgSW52YWxpZCBjaGFyYWN0ZXIgJyR7cGF0aFtpICsgMl19JyBhdCBwb3NpdGlvbiAke2kgKyAyfSBpbiBcIiR7cGF0aH1cIiwgdGhlIHN0cmluZyBiZXR3ZWVuIHRoZSBxdW90YXRpb24tbWFya3MgbWF5IG5vdCBiZSBlbXB0eWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpbnNpZGVTdHJpbmdCcmFja2V0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgaSArPSAxOyAvLyBza2lwIG5leHQgY2hhclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBza2lwIHJlc3Qgb2YgY3VycmVudCBjaGFyXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgT1BEVHJhdmVyc2FsRXJyb3IoYEludmFsaWQgY2hhcmFjdGVyICcke25leHRDaGFyfScgYXQgcG9zaXRpb24gJHtpICsgMX0gaW4gXCIke3BhdGh9XCIsIGV4cGVjdGVkIG51bWJlciBvciAnXCInIHRvIGZvbGxvdyBhICdbJ2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIHN0cmluZyBicmFja2V0IGV4aXQgY29uZGl0aW9uXG4gICAgICAgIGlmIChpbnNpZGVTdHJpbmdCcmFja2V0cyAmJiBjaGFyID09PSAnXCInKSB7XG4gICAgICAgICAgICBpZiAobmV4dENoYXIgPT09ICddJykge1xuICAgICAgICAgICAgICAgIGluc2lkZVN0cmluZ0JyYWNrZXRzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaSArPSAxOyAvLyBza2lwIG5leHQgY2hhclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBza2lwIHJlc3Qgb2YgY3VycmVudCBjaGFyXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgT1BEVHJhdmVyc2FsRXJyb3IoYEludmFsaWQgY2hhcmFjdGVyICcke25leHRDaGFyfScgYXQgcG9zaXRpb24gJHtpICsgMX0gaW4gXCIke3BhdGh9XCIsIGV4cGVjdGVkICddJyB0byBmb2xsb3cgYSAnXCInYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gbnVtYmVyIGJyYWNrZXQgZXhpdCBjb25kaXRpb25cbiAgICAgICAgaWYgKGluc2lkZU51bWJlckJyYWNrZXRzICYmIGNoYXIgPT09ICddJykge1xuICAgICAgICAgICAgaW5zaWRlTnVtYmVyQnJhY2tldHMgPSBmYWxzZTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnNpZGVTdHJpbmdCcmFja2V0cyAmJiAoY2hhciA9PT0gJy4nIHx8IGNoYXIgPT09ICddJyB8fCBjaGFyID09PSAnWycpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgT1BEVHJhdmVyc2FsRXJyb3IoYEludmFsaWQgY2hhcmFjdGVyICcke2NoYXJ9JyBhdCBwb3NpdGlvbiAke2l9IGluIFwiJHtwYXRofVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluc2lkZU51bWJlckJyYWNrZXRzICYmICFudW1iZXJzLmluY2x1ZGVzKGNoYXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgT1BEVHJhdmVyc2FsRXJyb3IoYEludmFsaWQgY2hhcmFjdGVyICcke2NoYXJ9JyBhdCBwb3NpdGlvbiAke2l9IGluIFwiJHtwYXRofVwiLCBudW1iZXIgZXhwZWN0ZWQgaW5zaWRlIG9mIGJyYWNrZXRzYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFpbnNpZGVOdW1iZXJCcmFja2V0cyAmJiAhaW5zaWRlU3RyaW5nQnJhY2tldHMpIHtcbiAgICAgICAgICAgIGlmIChjaGFyID09PSAnXScpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgT1BEVHJhdmVyc2FsRXJyb3IoYEludmFsaWQgY2hhcmFjdGVyICcke2NoYXJ9JyBhdCBwb3NpdGlvbiAke2l9IGluIFwiJHtwYXRofVwiLCBleHBlY3RlZCAnWycgdG8gcHJvY2VlZGApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy52YWxpZGF0ZVBhdGggPSB2YWxpZGF0ZVBhdGg7XG5jbGFzcyBPUERUcmF2ZXJzYWxFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIH1cbn1cbmV4cG9ydHMuT1BEVHJhdmVyc2FsRXJyb3IgPSBPUERUcmF2ZXJzYWxFcnJvcjtcbiIsICJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuc3RyaW5naWZ5RnJvbnRtYXR0ZXIgPSB2b2lkIDA7XG5jb25zdCBvYnNpZGlhbl8xID0gcmVxdWlyZShcIm9ic2lkaWFuXCIpO1xuZnVuY3Rpb24gc3RyaW5naWZ5RnJvbnRtYXR0ZXIoZnJvbnRtYXR0ZXIpIHtcbiAgICByZXR1cm4gYC0tLVxcbiR7KDAsIG9ic2lkaWFuXzEuc3RyaW5naWZ5WWFtbCkoZnJvbnRtYXR0ZXIpfS0tLWA7XG59XG5leHBvcnRzLnN0cmluZ2lmeUZyb250bWF0dGVyID0gc3RyaW5naWZ5RnJvbnRtYXR0ZXI7XG4iLCAiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuSW50ZXJuYWwgPSB2b2lkIDA7XG5jb25zdCBvYnNpZGlhbl8xID0gcmVxdWlyZShcIm9ic2lkaWFuXCIpO1xuY29uc3QgVXRpbHNfMSA9IHJlcXVpcmUoXCIuL1V0aWxzXCIpO1xuY29uc3QgT2JzVXRpbHNfMSA9IHJlcXVpcmUoXCIuL09ic1V0aWxzXCIpO1xuLyoqXG4gKiBgSW50ZXJuYWxgIGhvbGRzIG1ldGhvZHMgdGhhdCB0aGUgQVBJIHVzZXMgaW50ZXJuYWxseS4gVGhlIG1ldGhvZHMgdGhhdCB3ZSBleHBlY3QgYSBwbHVnaW4gdG8gdXNlIGFyZSB3aXRoaW4gYEFQSS50c2AuXG4gKi9cbnZhciBJbnRlcm5hbDtcbihmdW5jdGlvbiAoSW50ZXJuYWwpIHtcbiAgICAvKipcbiAgICAgKiBSZWdleCBFeHByZXNzaW9uIHRvIG1hdGNoIHRoZSBtYXJrZG93biBmcm9udG1hdHRlciBibG9jay5cbiAgICAgKi9cbiAgICBJbnRlcm5hbC5mcm9udE1hdHRlclJleEV4cFBhdHRlcm4gPSAnXigtLS0pXFxcXG5bXFxcXHNcXFxcU10qP1xcXFxuLS0tJztcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBtZXRhZGF0YSBvYmplY3QgZnJvbSB0aGUgZmlsZSBjb250ZW50cyB1c2luZyByZWdFeC5cbiAgICAgKiBJZiBwb3NzaWJsZSB1c2Uge0BsaW5rIGdldE1ldGFkYXRhRnJvbUZpbGVDYWNoZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmlsZUNvbnRlbnQgdGhlIGZpbGUgY29udGVudCB0byByZWFkIHRoZSBtZXRhZGF0YSBmcm9tXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB0aGUgZnJvbnRtYXR0ZXIgYXMgYSBwcm9wZXJ0eSBhcnJheVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldE1ldGFEYXRhRnJvbUZpbGVDb250ZW50KGZpbGVDb250ZW50KSB7XG4gICAgICAgIGNvbnN0IHJlZ0V4cCA9IG5ldyBSZWdFeHAoSW50ZXJuYWwuZnJvbnRNYXR0ZXJSZXhFeHBQYXR0ZXJuKTtcbiAgICAgICAgY29uc3QgZnJvbnRNYXR0ZXJSZWdFeHBSZXN1bHQgPSByZWdFeHAuZXhlYyhmaWxlQ29udGVudCk7XG4gICAgICAgIGlmICghZnJvbnRNYXR0ZXJSZWdFeHBSZXN1bHQpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZnJvbnRNYXR0ZXIgPSBmcm9udE1hdHRlclJlZ0V4cFJlc3VsdFswXTtcbiAgICAgICAgaWYgKCFmcm9udE1hdHRlcikge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIGZyb250TWF0dGVyID0gZnJvbnRNYXR0ZXIuc3Vic3RyaW5nKDQpO1xuICAgICAgICBmcm9udE1hdHRlciA9IGZyb250TWF0dGVyLnN1YnN0cmluZygwLCBmcm9udE1hdHRlci5sZW5ndGggLSAzKTtcbiAgICAgICAgcmV0dXJuIGdldE1ldGFEYXRhRnJvbVlBTUwoZnJvbnRNYXR0ZXIpO1xuICAgIH1cbiAgICBJbnRlcm5hbC5nZXRNZXRhRGF0YUZyb21GaWxlQ29udGVudCA9IGdldE1ldGFEYXRhRnJvbUZpbGVDb250ZW50O1xuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIHlhbWwgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHlhbWxcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHRoZSBwYXJzZWQgeWFtbCBhcyBhbiBvYmplY3RcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRNZXRhRGF0YUZyb21ZQU1MKHlhbWwpIHtcbiAgICAgICAgaWYgKCF5YW1sKSB7XG4gICAgICAgICAgICByZXR1cm4ge307XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb2JqID0gKDAsIG9ic2lkaWFuXzEucGFyc2VZYW1sKSh5YW1sKTtcbiAgICAgICAgaWYgKCFvYmopIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cbiAgICBJbnRlcm5hbC5nZXRNZXRhRGF0YUZyb21ZQU1MID0gZ2V0TWV0YURhdGFGcm9tWUFNTDtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBtZWRhdGEgb2JqZWN0IGZvcm0gb2JzaWRpYW4gZmlsZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWxlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGx1Z2luXG4gICAgICogQHJldHVybnMgdGhlIG1ldGFkYXRhIGFzIGFuIG9iamVjdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldE1ldGFkYXRhRnJvbUZpbGVDYWNoZShmaWxlLCBwbHVnaW4pIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBsZXQgbWV0YWRhdGEgPSAoX2EgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZnJvbnRtYXR0ZXI7XG4gICAgICAgIGlmIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgbWV0YWRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBtZXRhZGF0YSk7IC8vIGNvcHlcbiAgICAgICAgICAgIGRlbGV0ZSBtZXRhZGF0YS5wb3NpdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWV0YWRhdGE7XG4gICAgfVxuICAgIEludGVybmFsLmdldE1ldGFkYXRhRnJvbUZpbGVDYWNoZSA9IGdldE1ldGFkYXRhRnJvbUZpbGVDYWNoZTtcbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBmcm9udG1hdHRlciBibG9jayBmcm9tIGEgZmlsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWxlQ29udGVudFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbW92ZUZyb250bWF0dGVyKGZpbGVDb250ZW50KSB7XG4gICAgICAgIHJldHVybiBmaWxlQ29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoSW50ZXJuYWwuZnJvbnRNYXR0ZXJSZXhFeHBQYXR0ZXJuKSwgJycpO1xuICAgIH1cbiAgICBJbnRlcm5hbC5yZW1vdmVGcm9udG1hdHRlciA9IHJlbW92ZUZyb250bWF0dGVyO1xuICAgIC8qKlxuICAgICAqIFJlcGxhY2VzIHRoZSBGcm9udG1hdHRlciBvZiBhIGZpbGUgd2l0aCB0aGUgbWV0YWRhdGEuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbWV0YWRhdGFcbiAgICAgKiBAcGFyYW0gZmlsZSB0aGUgZmlsZSB0byBtb2RpZnkgdGhlIGZyb250bWF0dGVyIGluXG4gICAgICogQHBhcmFtIHBsdWdpblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVwZGF0ZUZyb250bWF0dGVyKG1ldGFkYXRhLCBmaWxlLCBwbHVnaW4pIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgICAgIGxldCBmaWxlQ29udGVudCA9IHlpZWxkIHBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKTtcbiAgICAgICAgICAgIGZpbGVDb250ZW50ID0gcmVtb3ZlRnJvbnRtYXR0ZXIoZmlsZUNvbnRlbnQpO1xuICAgICAgICAgICAgZmlsZUNvbnRlbnQgPSBgJHsoMCwgT2JzVXRpbHNfMS5zdHJpbmdpZnlGcm9udG1hdHRlcikobWV0YWRhdGEpfSR7ZmlsZUNvbnRlbnR9YDtcbiAgICAgICAgICAgIHlpZWxkIHBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGZpbGVDb250ZW50KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIEludGVybmFsLnVwZGF0ZUZyb250bWF0dGVyID0gdXBkYXRlRnJvbnRtYXR0ZXI7XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBvYmplY3QgaGFzIHRoZSBmaWVsZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoXG4gICAgICogQHBhcmFtIG1ldGFkYXRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGFzRmllbGQocGF0aCwgbWV0YWRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGdldEZpZWxkKHBhdGgsIG1ldGFkYXRhKSAhPT0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBJbnRlcm5hbC5oYXNGaWVsZCA9IGhhc0ZpZWxkO1xuICAgIC8qKlxuICAgICAqIEdldHMgb25lIGZpZWxkIGZvcm0gYW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGhcbiAgICAgKiBAcGFyYW0gbWV0YWRhdGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRGaWVsZChwYXRoLCBtZXRhZGF0YSkge1xuICAgICAgICByZXR1cm4gKDAsIFV0aWxzXzEudHJhdmVyc2VPYmplY3QpKHBhdGgsIG1ldGFkYXRhKTtcbiAgICB9XG4gICAgSW50ZXJuYWwuZ2V0RmllbGQgPSBnZXRGaWVsZDtcbiAgICAvKipcbiAgICAgKiBEZWxldGVzIG9uZSBmaWVsZCBmcm9tIGFtIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoXG4gICAgICogQHBhcmFtIG1ldGFkYXRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gZGVsZXRlRmllbGQocGF0aCwgbWV0YWRhdGEpIHtcbiAgICAgICAgbGV0IHsgcGFyZW50LCBjaGlsZCB9ID0gKDAsIFV0aWxzXzEudHJhdmVyc2VPYmplY3RUb1BhcmVudCkocGF0aCwgbWV0YWRhdGEpO1xuICAgICAgICBpZiAocGFyZW50LnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKGBUaGUgcGFyZW50IG9mIFwiJHtwYXRofVwiIGRvZXMgbm90IGV4aXN0IGluIE9iamVjdCwgY2FuIG5vdCBkZWxldGUgY2hpbGQgZnJvbSBub24gZXhpc3RpbmcgcGFyZW50YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFyZW50LnZhbHVlKSkge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBOdW1iZXIucGFyc2VJbnQoY2hpbGQua2V5KTtcbiAgICAgICAgICAgIGlmIChOdW1iZXIuaXNOYU4oaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyZW50LnZhbHVlLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgcGFyZW50LnZhbHVlW2NoaWxkLmtleV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xuICAgIH1cbiAgICBJbnRlcm5hbC5kZWxldGVGaWVsZCA9IGRlbGV0ZUZpZWxkO1xuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgb25lIGZpZWxkIGluIGFuIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoXG4gICAgICogQHBhcmFtIHZhbHVlXG4gICAgICogQHBhcmFtIG1ldGFkYXRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gdXBkYXRlRmllbGQocGF0aCwgdmFsdWUsIG1ldGFkYXRhKSB7XG4gICAgICAgIGxldCB7IHBhcmVudCwgY2hpbGQgfSA9ICgwLCBVdGlsc18xLnRyYXZlcnNlT2JqZWN0VG9QYXJlbnQpKHBhdGgsIG1ldGFkYXRhKTtcbiAgICAgICAgaWYgKHBhcmVudC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgVGhlIHBhcmVudCBvZiBcIiR7cGF0aH1cIiBkb2VzIG5vdCBleGlzdCBpbiBPYmplY3QsIHBsZWFzZSBjcmVhdGUgdGhlIHBhcmVudCBmaXJzdGApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGlsZC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgRmllbGQgd2l0aCBrZXkgXCIke3BhdGh9XCIgZG9lcyBub3QgZXhpc3QgaW4gT2JqZWN0YCk7XG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50LnZhbHVlW2NoaWxkLmtleV0gPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xuICAgIH1cbiAgICBJbnRlcm5hbC51cGRhdGVGaWVsZCA9IHVwZGF0ZUZpZWxkO1xuICAgIC8qKlxuICAgICAqIEluc2VydHMgb25lIGZpZWxkIGluIGFuIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXRoXG4gICAgICogQHBhcmFtIHZhbHVlXG4gICAgICogQHBhcmFtIG1ldGFkYXRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5zZXJ0RmllbGQocGF0aCwgdmFsdWUsIG1ldGFkYXRhKSB7XG4gICAgICAgIGxldCB7IHBhcmVudCwgY2hpbGQgfSA9ICgwLCBVdGlsc18xLnRyYXZlcnNlT2JqZWN0VG9QYXJlbnQpKHBhdGgsIG1ldGFkYXRhKTtcbiAgICAgICAgaWYgKHBhcmVudC52YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgVGhlIHBhcmVudCBvZiBcIiR7cGF0aH1cIiBkb2VzIG5vdCBleGlzdCBpbiBPYmplY3QsIHBsZWFzZSBjcmVhdGUgdGhlIHBhcmVudCBmaXJzdGApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGlsZC52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihgRmllbGQgd2l0aCBrZXkgXCIke3BhdGh9XCIgZG9lcyBhbHJlYWR5IGV4aXN0IGluIE9iamVjdGApO1xuICAgICAgICB9XG4gICAgICAgIHBhcmVudC52YWx1ZVtjaGlsZC5rZXldID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBtZXRhZGF0YTtcbiAgICB9XG4gICAgSW50ZXJuYWwuaW5zZXJ0RmllbGQgPSBpbnNlcnRGaWVsZDtcbiAgICAvKipcbiAgICAgKiBVcGRhdGUgb3IgaW5zZXJ0cyBvbmUgZmllbGQgaW4gYW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGhcbiAgICAgKiBAcGFyYW0gdmFsdWVcbiAgICAgKiBAcGFyYW0gbWV0YWRhdGFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1cGRhdGVPckluc2VydEZpZWxkKHBhdGgsIHZhbHVlLCBtZXRhZGF0YSkge1xuICAgICAgICBsZXQgeyBwYXJlbnQsIGNoaWxkIH0gPSAoMCwgVXRpbHNfMS50cmF2ZXJzZU9iamVjdFRvUGFyZW50KShwYXRoLCBtZXRhZGF0YSk7XG4gICAgICAgIGlmIChwYXJlbnQudmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYFRoZSBwYXJlbnQgb2YgXCIke3BhdGh9XCIgZG9lcyBub3QgZXhpc3QgaW4gT2JqZWN0LCBwbGVhc2UgY3JlYXRlIHRoZSBwYXJlbnQgZmlyc3RgKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJlbnQudmFsdWVbY2hpbGQua2V5XSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gbWV0YWRhdGE7XG4gICAgfVxuICAgIEludGVybmFsLnVwZGF0ZU9ySW5zZXJ0RmllbGQgPSB1cGRhdGVPckluc2VydEZpZWxkO1xufSkoSW50ZXJuYWwgPSBleHBvcnRzLkludGVybmFsIHx8IChleHBvcnRzLkludGVybmFsID0ge30pKTtcbiIsICJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5zZXRGcm9udG1hdHRlck9mVEZpbGUgPSBleHBvcnRzLmdldEZyb250bWF0dGVyT2ZURmlsZSA9IGV4cG9ydHMuZGVsZXRlRmllbGRJblRGaWxlID0gZXhwb3J0cy51cGRhdGVPckluc2VydEZpZWxkSW5URmlsZSA9IGV4cG9ydHMudXBkYXRlRmllbGRJblRGaWxlID0gZXhwb3J0cy5pbnNlcnRGaWVsZEluVEZpbGUgPSBleHBvcnRzLmdldEZpZWxkRnJvbVRGaWxlID0gZXhwb3J0cy5kb2VzRmllbGRFeGlzdEluVEZpbGUgPSB2b2lkIDA7XG5jb25zdCBJbnRlcm5hbF8xID0gcmVxdWlyZShcIi4vSW50ZXJuYWxcIik7XG4vKipcbiAqIENoZWNrcyB3aGV0aGVyIGEgZmllbGQgZXhpc3RzIGluc2lkZSBhIGZpbGVzJyBtZXRhZGF0YS5cbiAqIE5vdGUsIHdoZW4gdGhlIGZpZWxkIGV4aXN0cyBidXQgdGhlIHZhbHVlIGlzIGB1bmRlZmluZWRgLCB0aGUgbWV0aG9kIHdpbGwgcmV0dXJuIGZhbHNlLlxuICpcbiAqIEB0aHJvd3MgT1BEVHJhdmVyc2FsRXJyb3IgaWYgZmllbGQgaXMgYW4gaW52YWxpZCBwYXRoIHRvIGEgbWV0YWRhdGEgZmllbGQuXG4gKlxuICogQHBhcmFtIGZpZWxkIFRoZSBmaWVsZCB0byBmaW5kLCB0aGlzIGNhbiBhbHNvIGJlIGEgcGF0aCB0byBhIG5lc3RlZCBvYmplY3QgZS5nLiBgZm9vLmJhcmAsXG4gKiBcdFx0XHRcdGEgcGF0aCB0byBhIHNwZWNpZmljIGluZGV4IGluIGFuIGFycmF5IGUuZy4gYGZvb1swXWBcbiAqIFx0XHRcdFx0b3IgYW55IGNvbWJpbmF0aW9uIG9mIHRob3NlIGUuZy4gYGZvb1snYmFyJ10uYmF6WzBdYCxcbiAqIFx0XHRcdFx0bGlrZSB5b3UgYXJlIHVzZWQgdG8gZnJvbSBqYXZhc2NyaXB0LCBleGNlcHQgdGhhdCB0aGUgYD9gIG9wZXJhdG9yIGlzICoqbm90Kiogc3VwcG9ydGVkLlxuICogQHBhcmFtIGZpbGVcbiAqIEBwYXJhbSBwbHVnaW5cbiAqIEBwYXJhbSBpc0lubGluZSB1bnVzZWQgZm9yIG5vd1xuICpcbiAqIEByZXR1cm5zIGB0cnVlYCBpZiB0aGUgZmllbGQgZXhpc3RzLCBgZmFsc2VgIG90aGVyd2lzZVxuICovXG5mdW5jdGlvbiBkb2VzRmllbGRFeGlzdEluVEZpbGUoZmllbGQsIGZpbGUsIHBsdWdpbiwgaXNJbmxpbmUgPSBmYWxzZSkge1xuICAgIGNvbnN0IG1ldGFkYXRhID0gSW50ZXJuYWxfMS5JbnRlcm5hbC5nZXRNZXRhZGF0YUZyb21GaWxlQ2FjaGUoZmlsZSwgcGx1Z2luKTtcbiAgICByZXR1cm4gSW50ZXJuYWxfMS5JbnRlcm5hbC5oYXNGaWVsZChmaWVsZCwgbWV0YWRhdGEpO1xufVxuZXhwb3J0cy5kb2VzRmllbGRFeGlzdEluVEZpbGUgPSBkb2VzRmllbGRFeGlzdEluVEZpbGU7XG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIGEgZmllbGQgaW4gYSBmaWxlcycgbWV0YWRhdGEuXG4gKiBJZiB0aGUgZmllbGQgZG9lcyBub3QgZXhpc3QsIHRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIGB1bmRlZmluZWRgLlxuICpcbiAqIEB0aHJvd3MgT1BEVHJhdmVyc2FsRXJyb3IgaWYgZmllbGQgaXMgYW4gaW52YWxpZCBwYXRoIHRvIGEgbWV0YWRhdGEgZmllbGQuXG4gKlxuICogQHBhcmFtIGZpZWxkIFRoZSBmaWVsZCB0byBnZXQsIHRoaXMgY2FuIGFsc28gYmUgYSBwYXRoIHRvIGEgbmVzdGVkIG9iamVjdCBlLmcuIGBmb28uYmFyYCxcbiAqIFx0XHRcdFx0YSBwYXRoIHRvIGEgc3BlY2lmaWMgaW5kZXggaW4gYW4gYXJyYXkgZS5nLiBgZm9vWzBdYFxuICogXHRcdFx0XHRvciBhbnkgY29tYmluYXRpb24gb2YgdGhvc2UgZS5nLiBgZm9vWydiYXInXS5iYXpbMF1gLFxuICogXHRcdFx0XHRsaWtlIHlvdSBhcmUgdXNlZCB0byBmcm9tIGphdmFzY3JpcHQsIGV4Y2VwdCB0aGF0IHRoZSBgP2Agb3BlcmF0b3IgaXMgKipub3QqKiBzdXBwb3J0ZWQuXG4gKiBAcGFyYW0gZmlsZVxuICogQHBhcmFtIHBsdWdpblxuICogQHBhcmFtIGlzSW5saW5lIHVudXNlZCBmb3Igbm93XG4gKlxuICogQHJldHVybnMgVGhlIHZhbHVlIG9mIHRoZSBmaWVsZCBvciBgdW5kZWZpbmVkYCBpZiB0aGUgZmllbGQgZG9lcyBub3QgZXhpc3QuXG4gKi9cbmZ1bmN0aW9uIGdldEZpZWxkRnJvbVRGaWxlKGZpZWxkLCBmaWxlLCBwbHVnaW4sIGlzSW5saW5lID0gZmFsc2UpIHtcbiAgICBjb25zdCBtZXRhZGF0YSA9IEludGVybmFsXzEuSW50ZXJuYWwuZ2V0TWV0YWRhdGFGcm9tRmlsZUNhY2hlKGZpbGUsIHBsdWdpbik7XG4gICAgcmV0dXJuIEludGVybmFsXzEuSW50ZXJuYWwuZ2V0RmllbGQoZmllbGQsIG1ldGFkYXRhKTtcbn1cbmV4cG9ydHMuZ2V0RmllbGRGcm9tVEZpbGUgPSBnZXRGaWVsZEZyb21URmlsZTtcbi8qKlxuICogSW5zZXJ0cyBhIGZpZWxkIGluIGEgZmlsZXMnIG1ldGFkYXRhLiBJZiB0aGUgZmllbGQgYWxyZWFkeSBleGlzdHMsIHRoaXMgbWV0aG9kIHdpbGwgdGhyb3cuXG4gKlxuICogQHRocm93cyBFcnJvciBJZiB0aGUgZmllbGQgYWxyZWFkeSBleGlzdHMuXG4gKiBAdGhyb3dzIEVycm9yIElmIHRoZSBwYXJlbnQgb2YgdGhlIGZpZWxkIHRvIHVwZGF0ZS9pbnNlcnQgZG9lcyBub3QgZXhpc3QsXG4gKiBcdFx0ICAgZS5nLiBpZiB0aGUgbWV0aG9kIGlzIGNhbGxlZCB3aXRoIHRoZSBmaWVsZCBgZm9vLmJhcmAsIGJ1dCBgZm9vYCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgbWV0YWRhdGEgdGhpcyBtZXRob2Qgd2lsbCB0aHJvdy5cbiAqIEB0aHJvd3MgT1BEVHJhdmVyc2FsRXJyb3IgSWYgZmllbGQgaXMgYW4gaW52YWxpZCBwYXRoIHRvIGEgbWV0YWRhdGEgZmllbGQuXG4gKlxuICogQHBhcmFtIGZpZWxkIFRoZSBmaWVsZCB0byBpbnNlcnQsIHRoaXMgY2FuIGFsc28gYmUgYSBwYXRoIHRvIGEgbmVzdGVkIG9iamVjdCBlLmcuIGBmb28uYmFyYCxcbiAqIFx0XHRcdFx0YSBwYXRoIHRvIGEgc3BlY2lmaWMgaW5kZXggaW4gYW4gYXJyYXkgZS5nLiBgZm9vWzBdYFxuICogXHRcdFx0XHRvciBhbnkgY29tYmluYXRpb24gb2YgdGhvc2UgZS5nLiBgZm9vWydiYXInXS5iYXpbMF1gLFxuICogXHRcdFx0XHRsaWtlIHlvdSBhcmUgdXNlZCB0byBmcm9tIGphdmFzY3JpcHQsIGV4Y2VwdCB0aGF0IHRoZSBgP2Agb3BlcmF0b3IgaXMgKipub3QqKiBzdXBwb3J0ZWQuXG4gKiBAcGFyYW0gdmFsdWUgVGhlIG5ldyB2YWx1ZSBvZiB0aGUgZmllbGQuXG4gKiBAcGFyYW0gZmlsZVxuICogQHBhcmFtIHBsdWdpblxuICogQHBhcmFtIGlzSW5saW5lIHVudXNlZCBmb3Igbm93XG4gKi9cbmZ1bmN0aW9uIGluc2VydEZpZWxkSW5URmlsZShmaWVsZCwgdmFsdWUsIGZpbGUsIHBsdWdpbiwgaXNJbmxpbmUgPSBmYWxzZSkge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gSW50ZXJuYWxfMS5JbnRlcm5hbC5nZXRNZXRhZGF0YUZyb21GaWxlQ2FjaGUoZmlsZSwgcGx1Z2luKTtcbiAgICAgICAgSW50ZXJuYWxfMS5JbnRlcm5hbC5pbnNlcnRGaWVsZChmaWVsZCwgdmFsdWUsIG1ldGFkYXRhKTtcbiAgICAgICAgeWllbGQgSW50ZXJuYWxfMS5JbnRlcm5hbC51cGRhdGVGcm9udG1hdHRlcihtZXRhZGF0YSwgZmlsZSwgcGx1Z2luKTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuaW5zZXJ0RmllbGRJblRGaWxlID0gaW5zZXJ0RmllbGRJblRGaWxlO1xuLyoqXG4gKiBVcGRhdGVzIGEgZmllbGQgaW4gYSBmaWxlcycgbWV0YWRhdGEuIElmIHRoZSBmaWVsZCBkb2VzIG5vdCBleGlzdCwgdGhpcyBtZXRob2Qgd2lsbCB0aHJvdy5cbiAqXG4gKiBAdGhyb3dzIEVycm9yIElmIHRoZSBmaWVsZCBkb2VzIG5vdCBleGlzdC5cbiAqIEB0aHJvd3MgRXJyb3IgSWYgdGhlIHBhcmVudCBvZiB0aGUgZmllbGQgdG8gdXBkYXRlL2luc2VydCBkb2VzIG5vdCBleGlzdCxcbiAqIFx0XHQgICBlLmcuIGlmIHRoZSBtZXRob2QgaXMgY2FsbGVkIHdpdGggdGhlIGZpZWxkIGBmb28uYmFyYCwgYnV0IGBmb29gIGRvZXMgbm90IGV4aXN0IGluIHRoZSBtZXRhZGF0YSB0aGlzIG1ldGhvZCB3aWxsIHRocm93LlxuICogQHRocm93cyBPUERUcmF2ZXJzYWxFcnJvciBJZiBmaWVsZCBpcyBhbiBpbnZhbGlkIHBhdGggdG8gYSBtZXRhZGF0YSBmaWVsZC5cbiAqXG4gKiBAcGFyYW0gZmllbGQgVGhlIGZpZWxkIHRvIHVwZGF0ZSwgdGhpcyBjYW4gYWxzbyBiZSBhIHBhdGggdG8gYSBuZXN0ZWQgb2JqZWN0IGUuZy4gYGZvby5iYXJgLFxuICogXHRcdFx0XHRhIHBhdGggdG8gYSBzcGVjaWZpYyBpbmRleCBpbiBhbiBhcnJheSBlLmcuIGBmb29bMF1gXG4gKiBcdFx0XHRcdG9yIGFueSBjb21iaW5hdGlvbiBvZiB0aG9zZSBlLmcuIGBmb29bJ2JhciddLmJhelswXWAsXG4gKiBcdFx0XHRcdGxpa2UgeW91IGFyZSB1c2VkIHRvIGZyb20gamF2YXNjcmlwdCwgZXhjZXB0IHRoYXQgdGhlIGA/YCBvcGVyYXRvciBpcyAqKm5vdCoqIHN1cHBvcnRlZC5cbiAqIEBwYXJhbSB2YWx1ZSBUaGUgbmV3IHZhbHVlIG9mIHRoZSBmaWVsZC5cbiAqIEBwYXJhbSBmaWxlXG4gKiBAcGFyYW0gcGx1Z2luXG4gKiBAcGFyYW0gaXNJbmxpbmUgdW51c2VkIGZvciBub3dcbiAqL1xuZnVuY3Rpb24gdXBkYXRlRmllbGRJblRGaWxlKGZpZWxkLCB2YWx1ZSwgZmlsZSwgcGx1Z2luLCBpc0lubGluZSA9IGZhbHNlKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgY29uc3QgbWV0YWRhdGEgPSBJbnRlcm5hbF8xLkludGVybmFsLmdldE1ldGFkYXRhRnJvbUZpbGVDYWNoZShmaWxlLCBwbHVnaW4pO1xuICAgICAgICBJbnRlcm5hbF8xLkludGVybmFsLnVwZGF0ZUZpZWxkKGZpZWxkLCB2YWx1ZSwgbWV0YWRhdGEpO1xuICAgICAgICB5aWVsZCBJbnRlcm5hbF8xLkludGVybmFsLnVwZGF0ZUZyb250bWF0dGVyKG1ldGFkYXRhLCBmaWxlLCBwbHVnaW4pO1xuICAgIH0pO1xufVxuZXhwb3J0cy51cGRhdGVGaWVsZEluVEZpbGUgPSB1cGRhdGVGaWVsZEluVEZpbGU7XG4vKipcbiAqIEluc2VydHMgb3IgdXBkYXRlcyBhIGZpZWxkIGluIGEgZmlsZXMnIG1ldGFkYXRhLlxuICogVGhpcyBpcyBtb3JlIGVmZmljaWVudCB0aGFuIGNoZWNraW5nIHlvdXJzZWxmIHdpdGgge0BsaW5rIGRvZXNGaWVsZEV4aXN0SW5URmlsZX0gYW5kIHRoZW4gaW5zZXJ0aW5nIHdpdGgge0BsaW5rIGluc2VydEZpZWxkSW5URmlsZX0gb3IgdXBkYXRpbmcgd2l0aCB7QGxpbmsgdXBkYXRlRmllbGRJblRGaWxlfS5cbiAqXG4gKiBAdGhyb3dzIEVycm9yIElmIHRoZSBwYXJlbnQgb2YgdGhlIGZpZWxkIHRvIHVwZGF0ZS9pbnNlcnQgZG9lcyBub3QgZXhpc3QsXG4gKiBcdFx0ICAgZS5nLiBpZiB0aGUgbWV0aG9kIGlzIGNhbGxlZCB3aXRoIHRoZSBmaWVsZCBgZm9vLmJhcmAsIGJ1dCBgZm9vYCBkb2VzIG5vdCBleGlzdCBpbiB0aGUgbWV0YWRhdGEgdGhpcyBtZXRob2Qgd2lsbCB0aHJvdy5cbiAqIEB0aHJvd3MgT1BEVHJhdmVyc2FsRXJyb3IgSWYgZmllbGQgaXMgYW4gaW52YWxpZCBwYXRoIHRvIGEgbWV0YWRhdGEgZmllbGQuXG4gKlxuICogQHBhcmFtIGZpZWxkIFRoZSBmaWVsZCB0byB1cGRhdGUvaW5zZXJ0LCB0aGlzIGNhbiBhbHNvIGJlIGEgcGF0aCB0byBhIG5lc3RlZCBvYmplY3QgZS5nLiBgZm9vLmJhcmAsXG4gKiBcdFx0XHRcdGEgcGF0aCB0byBhIHNwZWNpZmljIGluZGV4IGluIGFuIGFycmF5IGUuZy4gYGZvb1swXWBcbiAqIFx0XHRcdFx0b3IgYW55IGNvbWJpbmF0aW9uIG9mIHRob3NlIGUuZy4gYGZvb1snYmFyJ10uYmF6WzBdYCxcbiAqIFx0XHRcdFx0bGlrZSB5b3UgYXJlIHVzZWQgdG8gZnJvbSBqYXZhc2NyaXB0LCBleGNlcHQgdGhhdCB0aGUgYD9gIG9wZXJhdG9yIGlzICoqbm90Kiogc3VwcG9ydGVkLlxuICogQHBhcmFtIHZhbHVlIFRoZSBuZXcgdmFsdWUgb2YgdGhlIGZpZWxkLlxuICogQHBhcmFtIGZpbGVcbiAqIEBwYXJhbSBwbHVnaW5cbiAqIEBwYXJhbSBpc0lubGluZSB1bnVzZWQgZm9yIG5vd1xuICovXG5mdW5jdGlvbiB1cGRhdGVPckluc2VydEZpZWxkSW5URmlsZShmaWVsZCwgdmFsdWUsIGZpbGUsIHBsdWdpbiwgaXNJbmxpbmUgPSBmYWxzZSkge1xuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIGxldCBtZXRhZGF0YSA9IEludGVybmFsXzEuSW50ZXJuYWwuZ2V0TWV0YWRhdGFGcm9tRmlsZUNhY2hlKGZpbGUsIHBsdWdpbik7XG4gICAgICAgIEludGVybmFsXzEuSW50ZXJuYWwudXBkYXRlT3JJbnNlcnRGaWVsZChmaWVsZCwgdmFsdWUsIG1ldGFkYXRhKTtcbiAgICAgICAgeWllbGQgSW50ZXJuYWxfMS5JbnRlcm5hbC51cGRhdGVGcm9udG1hdHRlcihtZXRhZGF0YSwgZmlsZSwgcGx1Z2luKTtcbiAgICB9KTtcbn1cbmV4cG9ydHMudXBkYXRlT3JJbnNlcnRGaWVsZEluVEZpbGUgPSB1cGRhdGVPckluc2VydEZpZWxkSW5URmlsZTtcbi8qKlxuICogRGVsZXRlcyBhIGZpZWxkIGluIGEgZmlsZXMnIG1ldGFkYXRhLlxuICpcbiAqIEB0aHJvd3MgRXJyb3IgSWYgdGhlIHBhcmVudCBvZiB0aGUgZmllbGQgdG8gdXBkYXRlL2luc2VydCBkb2VzIG5vdCBleGlzdCxcbiAqIFx0XHQgICBlLmcuIGlmIHRoZSBtZXRob2QgaXMgY2FsbGVkIHdpdGggdGhlIGZpZWxkIGBmb28uYmFyYCwgYnV0IGBmb29gIGRvZXMgbm90IGV4aXN0IGluIHRoZSBtZXRhZGF0YSB0aGlzIG1ldGhvZCB3aWxsIHRocm93LlxuICogQHRocm93cyBPUERUcmF2ZXJzYWxFcnJvciBJZiBmaWVsZCBpcyBhbiBpbnZhbGlkIHBhdGggdG8gYSBtZXRhZGF0YSBmaWVsZC5cbiAqXG4gKiBAcGFyYW0gZmllbGQgVGhlIGZpZWxkIHRvIGRlbGV0ZSwgdGhpcyBjYW4gYWxzbyBiZSBhIHBhdGggdG8gYSBuZXN0ZWQgb2JqZWN0IGUuZy4gYGZvby5iYXJgLFxuICogXHRcdFx0XHRhIHBhdGggdG8gYSBzcGVjaWZpYyBpbmRleCBpbiBhbiBhcnJheSBlLmcuIGBmb29bMF1gXG4gKiBcdFx0XHRcdG9yIGFueSBjb21iaW5hdGlvbiBvZiB0aG9zZSBlLmcuIGBmb29bJ2JhciddLmJhelswXWAsXG4gKiBcdFx0XHRcdGxpa2UgeW91IGFyZSB1c2VkIHRvIGZyb20gamF2YXNjcmlwdCwgZXhjZXB0IHRoYXQgdGhlIGA/YCBvcGVyYXRvciBpcyAqKm5vdCoqIHN1cHBvcnRlZC5cbiAqIEBwYXJhbSBmaWxlXG4gKiBAcGFyYW0gcGx1Z2luXG4gKiBAcGFyYW0gaXNJbmxpbmUgdW51c2VkIGZvciBub3dcbiAqL1xuZnVuY3Rpb24gZGVsZXRlRmllbGRJblRGaWxlKGZpZWxkLCBmaWxlLCBwbHVnaW4sIGlzSW5saW5lID0gZmFsc2UpIHtcbiAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IEludGVybmFsXzEuSW50ZXJuYWwuZ2V0TWV0YWRhdGFGcm9tRmlsZUNhY2hlKGZpbGUsIHBsdWdpbik7XG4gICAgICAgIEludGVybmFsXzEuSW50ZXJuYWwuZGVsZXRlRmllbGQoZmllbGQsIG1ldGFkYXRhKTtcbiAgICAgICAgeWllbGQgSW50ZXJuYWxfMS5JbnRlcm5hbC51cGRhdGVGcm9udG1hdHRlcihtZXRhZGF0YSwgZmlsZSwgcGx1Z2luKTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuZGVsZXRlRmllbGRJblRGaWxlID0gZGVsZXRlRmllbGRJblRGaWxlO1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBmcm9udG1hdHRlciBmcm9tIGEgZmlsZS5cbiAqXG4gKiBAcGFyYW0gZmlsZVxuICogQHBhcmFtIHBsdWdpblxuICovXG5mdW5jdGlvbiBnZXRGcm9udG1hdHRlck9mVEZpbGUoZmlsZSwgcGx1Z2luKSB7XG4gICAgcmV0dXJuIEludGVybmFsXzEuSW50ZXJuYWwuZ2V0TWV0YWRhdGFGcm9tRmlsZUNhY2hlKGZpbGUsIHBsdWdpbik7XG59XG5leHBvcnRzLmdldEZyb250bWF0dGVyT2ZURmlsZSA9IGdldEZyb250bWF0dGVyT2ZURmlsZTtcbi8qKlxuICogVXBkYXRlcyB0aGUgZW50aXJlIGZyb250bWF0dGVyIG9mIGEgZmlsZS5cbiAqXG4gKiBAcGFyYW0gbWV0YWRhdGFcbiAqIEBwYXJhbSBmaWxlXG4gKiBAcGFyYW0gcGx1Z2luXG4gKi9cbmZ1bmN0aW9uIHNldEZyb250bWF0dGVyT2ZURmlsZShtZXRhZGF0YSwgZmlsZSwgcGx1Z2luKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgeWllbGQgSW50ZXJuYWxfMS5JbnRlcm5hbC51cGRhdGVGcm9udG1hdHRlcihtZXRhZGF0YSwgZmlsZSwgcGx1Z2luKTtcbiAgICB9KTtcbn1cbmV4cG9ydHMuc2V0RnJvbnRtYXR0ZXJPZlRGaWxlID0gc2V0RnJvbnRtYXR0ZXJPZlRGaWxlO1xuLyoqXG4gKiBVTlVTRURcbiAqIEBkZXByZWNhdGVkXG4gKlxuICogQHBhcmFtIHBsdWdpblxuICogQHBhcmFtIGZpbGVcbiAqIEBwYXJhbSBmcm9udG1hdHRlckFzWWFtbFxuICovXG5mdW5jdGlvbiBnZW5lcmF0ZUZpbGVDb250ZW50cyhwbHVnaW4sIGZpbGUsIGZyb250bWF0dGVyQXNZYW1sKSB7XG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICAgICAgY29uc3QgZmlsZUNvbnRlbnRzID0geWllbGQgcGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuICAgICAgICByZXR1cm4gZmlsZUNvbnRlbnRzLnJlcGxhY2UoL14tLS1cXG4oLipcXG4pKi0tLS8sIGZyb250bWF0dGVyQXNZYW1sKTtcbiAgICB9KTtcbn1cbiIsICJpbXBvcnQgeyBQbHVnaW4sIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgRlJPTlRNQVRURVJfTElOS1NfRURJVE9SX1BMVUdJTiB9IGZyb20gJy4vZWRpdG9yX3BsdWdpbic7XG5pbXBvcnQgeyBvbk1ldGFkYXRhQ2FjaGVSZXNvbHZlIH0gZnJvbSAnLi9tZXRhZGF0YV9jYWNoZSc7XG5pbXBvcnQgeyBvblZhdWx0RmlsZVJlbmFtZSB9IGZyb20gJy4vcmVuYW1lX2xpbmtzJztcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIEZyb250bWF0dGVyTGlua3NTZXR0aW5ncywgRnJvbnRtYXR0ZXJMaW5rc1NldHRpbmdUYWIgfSBmcm9tICcuL3NldHRpbmdzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRnJvbnRtYXR0ZXJMaW5rc1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBGcm9udG1hdHRlckxpbmtzU2V0dGluZ3M7XG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IEZyb250bWF0dGVyTGlua3NTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdFx0dGhpcy5yZWdpc3RlckVkaXRvckV4dGVuc2lvbihGUk9OVE1BVFRFUl9MSU5LU19FRElUT1JfUExVR0lOKTtcblxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmFkZFRvR3JhcGgpIHtcblx0XHRcdGFwcC5tZXRhZGF0YUNhY2hlLmluaXRpYWxpemUoKTtcblx0XHR9XG5cblx0XHRjb25zdCBwbHVnaW4gPSB0aGlzO1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChhcHAubWV0YWRhdGFDYWNoZS5vbihcInJlc29sdmVcIiwgKGZpbGU6IFRGaWxlKSA9PiB7XG5cdFx0XHRpZiAoIXBsdWdpbi5zZXR0aW5ncy5hZGRUb0dyYXBoKSB7IHJldHVybjsgfVxuXG5cdFx0XHRvbk1ldGFkYXRhQ2FjaGVSZXNvbHZlKGZpbGUpO1xuXHRcdH0pKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChhcHAudmF1bHQub24oXCJyZW5hbWVcIiwgKGZpbGU6IFRGaWxlLCBvbGRQYXRoOiBzdHJpbmcpID0+IHtcblx0XHRcdGlmIChwbHVnaW4uc2V0dGluZ3MudXBkYXRlTGlua3MgJiYgYXBwLnZhdWx0LmdldENvbmZpZyhcImFsd2F5c1VwZGF0ZUxpbmtzXCIpKSB7XG5cdFx0XHRcdG9uVmF1bHRGaWxlUmVuYW1lKGZpbGUsIG9sZFBhdGgsIHBsdWdpbik7XG5cdFx0XHR9XG5cdFx0fSkpO1xuXHR9XG5cblx0b251bmxvYWQoKSB7IH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oXG5cdFx0XHR7fSxcblx0XHRcdERFRkFVTFRfU0VUVElOR1MsXG5cdFx0XHRhd2FpdCB0aGlzLmxvYWREYXRhKClcblx0XHQpO1xuXG5cdFx0dGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG59XG4iLCAiaW1wb3J0IHsgc3ludGF4VHJlZSB9IGZyb20gXCJAY29kZW1pcnJvci9sYW5ndWFnZVwiO1xuaW1wb3J0IHsgUmFuZ2VTZXRCdWlsZGVyIH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XG5pbXBvcnQgeyBTeW50YXhOb2RlUmVmIH0gZnJvbSBcIkBsZXplci9jb21tb25cIlxuaW1wb3J0IHsgRGVjb3JhdGlvbiwgRGVjb3JhdGlvblNldCwgRWRpdG9yVmlldywgUGx1Z2luVmFsdWUsIFZpZXdQbHVnaW4sIFZpZXdVcGRhdGUgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgRnJvbnRtYXR0ZXJMaW5rV2lkZ2V0IH0gZnJvbSBcIi4vbGlua193aWRnZXRcIjtcbmltcG9ydCB7IGlzVXJpIH0gZnJvbSBcInZhbGlkLXVybFwiO1xuaW1wb3J0IHsgTGlua1NsaWNlIH0gZnJvbSBcIi4vbGlua19zbGljZVwiO1xuaW1wb3J0IHsgRnJvbnRtYXR0ZXJMaW5rc1NldHRpbmdzIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcbmltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBGcm9udG1hdHRlckxpbmtzRWRpdG9yUGx1Z2luIGltcGxlbWVudHMgUGx1Z2luVmFsdWUge1xuICAgIGRlY29yYXRpb25zOiBEZWNvcmF0aW9uU2V0O1xuICAgIGxpbmtTbGljZXM6IEFycmF5PExpbmtTbGljZT4gPSBuZXcgQXJyYXkoKTtcblxuICAgIGNvbnN0cnVjdG9yKHZpZXc6IEVkaXRvclZpZXcpIHtcbiAgICAgICAgdGhpcy5saW5rU2xpY2VzID0gbmV3IEFycmF5PExpbmtTbGljZT4oKTtcbiAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuYnVpbGREZWNvcmF0aW9ucyh2aWV3KTtcbiAgICB9XG5cbiAgICB1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKTogdm9pZCB7XG4gICAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkIHx8IHVwZGF0ZS5zZWxlY3Rpb25TZXQpIHtcbiAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModXBkYXRlLnZpZXcpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGVzdHJveSgpIHsgfVxuXG4gICAgYnVpbGREZWNvcmF0aW9ucyh2aWV3OiBFZGl0b3JWaWV3KTogRGVjb3JhdGlvblNldCB7XG4gICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XG4gICAgICAgIHRoaXMubGlua1NsaWNlcyA9IG5ldyBBcnJheTxMaW5rU2xpY2U+KCk7XG5cbiAgICAgICAgdGhpcy5maW5kTGlua3ModmlldywgdGhpcy5saW5rU2xpY2VzKTtcblxuICAgICAgICB0aGlzLnByb2Nlc3NMaW5rcyh2aWV3LCBidWlsZGVyKTtcblxuICAgICAgICByZXR1cm4gYnVpbGRlci5maW5pc2goKTtcbiAgICB9XG5cbiAgICBmaW5kTGlua3ModmlldzogRWRpdG9yVmlldywgbGlua1NsaWNlczogQXJyYXk8TGlua1NsaWNlPikge1xuICAgICAgICAvLyBUT0RPOiBGaW5kIGEgd2F5IHRvIGFjY2VzcyB0aGUgcGx1Z2lucyB0aHJvdWdoIHRoZSBlZGl0b3IgcGx1Z2luJ3MgY29uc3RydWN0b3IgaW5zdGVhZC5cbiAgICAgICAgY29uc3Qgc2V0dGluZ3M6IEZyb250bWF0dGVyTGlua3NTZXR0aW5ncyA9IGFwcC5wbHVnaW5zLnBsdWdpbnNbXCJmcm9udG1hdHRlci1saW5rc1wiXS5zZXR0aW5ncztcblxuICAgICAgICBsZXQgZXh0ZXJuYWxMaW5rRnJvbTogbnVtYmVyIHwgbnVsbDtcbiAgICAgICAgbGV0IGV4dGVybmFsTGlua1RvOiBudW1iZXI7XG5cbiAgICAgICAgZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xuICAgICAgICAgICAgc3ludGF4VHJlZSh2aWV3LnN0YXRlKS5pdGVyYXRlKHtcbiAgICAgICAgICAgICAgICBmcm9tLFxuICAgICAgICAgICAgICAgIHRvLFxuICAgICAgICAgICAgICAgIGVudGVyKG5vZGU6IFN5bnRheE5vZGVSZWYpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBsaW5rcyBvdXRzaWRlIG9mIHF1b3Rlcy5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dGVybmFsTGlua0Zyb20gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5hbWUgPT09IFwiaG1kLWZyb250bWF0dGVyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbExpbmtGcm9tID0gbm9kZS5mcm9tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsTGlua1RvID0gbm9kZS50bztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlLm5hbWUgPT09IFwiYXRvbV9obWQtZnJvbnRtYXR0ZXJcIiB8fCBub2RlLm5hbWUgPT09IFwiZGVmX2htZC1mcm9udG1hdHRlclwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRleHQgPSB2aWV3LnN0YXRlLnNsaWNlRG9jKGV4dGVybmFsTGlua0Zyb20sIGV4dGVybmFsTGlua1RvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNVcmkodGV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua1NsaWNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsVGV4dDogdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWY6IHRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tOiBleHRlcm5hbExpbmtGcm9tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG86IGV4dGVybmFsTGlua1RvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbExpbmtGcm9tID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxMaW5rVG8gPSBub2RlLnRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBsaW5rcyBpbnNpZGUgb2YgcXVvdGVzLlxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5uYW1lID09PSBcImhtZC1mcm9udG1hdHRlcl9zdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IHZpZXcuc3RhdGUuc2xpY2VEb2Mobm9kZS5mcm9tICsgMSwgbm9kZS50byAtIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2g6IFJlZ0V4cE1hdGNoQXJyYXkgfCBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGhyZWY6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhbGlhczogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1hcmtkb3duTGluazogYm9vbGVhbiB8IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCA9IHRleHQubWF0Y2goL1xcW1xcWyguKylcXHwoLispXFxdXFxdL20pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZiA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWFzID0gbWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoID0gdGV4dC5tYXRjaCgvXFxbXFxbKC4rKVxcXVxcXS9tKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWYgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2ggPSB0ZXh0Lm1hdGNoKC9cXFsoLispXFxdXFwoKC4rKVxcKS9tKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhyZWYgPSBtYXRjaFsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGlhcyA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtkb3duTGluayA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlzVXJpKHRleHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZiA9IHRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaHJlZikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtTbGljZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsVGV4dDogdGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHJlZixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpYXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb206IG5vZGUuZnJvbSArIChzZXR0aW5ncy5oaWRlUXVvdGVzID8gMCA6IDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0bzogbm9kZS50byAtIChzZXR0aW5ncy5oaWRlUXVvdGVzID8gMCA6IDEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZG93bkxpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvY2Vzc0xpbmtzKHZpZXc6IEVkaXRvclZpZXcsIGJ1aWxkZXI6IFJhbmdlU2V0QnVpbGRlcjxEZWNvcmF0aW9uPikge1xuICAgICAgICBmb3IgKGxldCBsaW5rU2xpY2Ugb2YgdGhpcy5saW5rU2xpY2VzKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJzb3JIZWFkID0gdmlldy5zdGF0ZS5zZWxlY3Rpb24ubWFpbi5oZWFkO1xuXG4gICAgICAgICAgICBpZiAobGlua1NsaWNlLmZyb20gLSAxIDw9IGN1cnNvckhlYWQgJiYgY3Vyc29ySGVhZCA8PSBsaW5rU2xpY2UudG8gKyAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdHlsZUxpbmsodmlldywgYnVpbGRlciwgbGlua1NsaWNlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYnVpbGRlci5hZGQoXG4gICAgICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tLFxuICAgICAgICAgICAgICAgICAgICBsaW5rU2xpY2UudG8sXG4gICAgICAgICAgICAgICAgICAgIERlY29yYXRpb24ucmVwbGFjZSh7IHdpZGdldDogbmV3IEZyb250bWF0dGVyTGlua1dpZGdldChsaW5rU2xpY2UpIH0pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHN0eWxlTGluayh2aWV3OiBFZGl0b3JWaWV3LCBidWlsZGVyOiBSYW5nZVNldEJ1aWxkZXI8RGVjb3JhdGlvbj4sIGxpbmtTbGljZTogTGlua1NsaWNlKSB7XG4gICAgICAgIC8vIFRPRE86IENsZWFuIHVwIHRoaXMgY29kZS4gSSdtIG5vdCBzdXJlIHRoYXQncyBwb3NzaWJsZSB0aG91Z2guXG4gICAgICAgIGNvbnN0IHNldHRpbmdzOiBGcm9udG1hdHRlckxpbmtzU2V0dGluZ3MgPSBhcHAucGx1Z2lucy5wbHVnaW5zW1wiZnJvbnRtYXR0ZXItbGlua3NcIl0uc2V0dGluZ3M7XG4gICAgICAgIGNvbnN0IHVucmVzb2x2ZWQgPSAhKGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGxpbmtTbGljZS5ocmVmLCBcIlwiKSBpbnN0YW5jZW9mIFRGaWxlKTtcbiAgICAgICAgY29uc3QgdGV4dCA9IHZpZXcuc3RhdGUuc2xpY2VEb2MobGlua1NsaWNlLmZyb20sIGxpbmtTbGljZS50byk7XG5cbiAgICAgICAgbGV0IG1hdGNoOiBSZWdFeHBNYXRjaEFycmF5IHwgbnVsbDtcbiAgICAgICAgaWYgKG1hdGNoID0gdGV4dC5tYXRjaCgvXFxbXFxbKC4rKVxcfCguKylcXF1cXF0vbSkpIHtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkKFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgKHNldHRpbmdzLmhpZGVRdW90ZXMgPyAxIDogMCksXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20gKyAyICsgKHNldHRpbmdzLmhpZGVRdW90ZXMgPyAxIDogMCksXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiY20tZm9ybWF0dGluZy1saW5rIGNtLWZvcm1hdHRpbmctbGluay1zdGFydFwiIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYnVpbGRlci5hZGQoXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20gKyB0ZXh0LmluZGV4T2YobWF0Y2hbMV0pLFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgdGV4dC5pbmRleE9mKG1hdGNoWzFdKSArIG1hdGNoWzFdLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogXCJjbS1saW5rXCIgKyAodW5yZXNvbHZlZCA/IFwiIGlzLXVucmVzb2x2ZWRcIiA6IFwiXCIpIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYnVpbGRlci5hZGQoXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20gKyB0ZXh0LmluZGV4T2YobWF0Y2hbMV0pICsgbWF0Y2hbMV0ubGVuZ3RoLFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgdGV4dC5pbmRleE9mKG1hdGNoWzFdKSArIG1hdGNoWzFdLmxlbmd0aCArIDEsXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiY20taG1kLWludGVybmFsLWxpbmtcIiB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkKFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgdGV4dC5pbmRleE9mKG1hdGNoWzJdKSxcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UuZnJvbSArIHRleHQuaW5kZXhPZihtYXRjaFsyXSkgKyBtYXRjaFsyXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiY20tbGlua1wiICsgKHVucmVzb2x2ZWQgPyBcIiBpcy11bnJlc29sdmVkXCIgOiBcIlwiKSB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkKFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS50byAtIDIgLSAoc2V0dGluZ3MuaGlkZVF1b3RlcyA/IDEgOiAwKSxcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UudG8gLSAoc2V0dGluZ3MuaGlkZVF1b3RlcyA/IDEgOiAwKSxcbiAgICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogXCJjbS1mb3JtYXR0aW5nLWxpbmsgY20tZm9ybWF0dGluZy1saW5rLWVuZFwiIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoID0gdGV4dC5tYXRjaCgvXFxbXFxbKC4rKVxcXVxcXS9tKSkge1xuICAgICAgICAgICAgYnVpbGRlci5hZGQoXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20gKyAoc2V0dGluZ3MuaGlkZVF1b3RlcyA/IDEgOiAwKSxcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UuZnJvbSArIDIgKyAoc2V0dGluZ3MuaGlkZVF1b3RlcyA/IDEgOiAwKSxcbiAgICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogXCJjbS1mb3JtYXR0aW5nLWxpbmsgY20tZm9ybWF0dGluZy1saW5rLXN0YXJ0XCIgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBidWlsZGVyLmFkZChcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UuZnJvbSArIHRleHQuaW5kZXhPZihtYXRjaFsxXSksXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20gKyB0ZXh0LmluZGV4T2YobWF0Y2hbMV0pICsgbWF0Y2hbMV0ubGVuZ3RoLFxuICAgICAgICAgICAgICAgIERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImNtLWxpbmtcIiArICh1bnJlc29sdmVkID8gXCIgaXMtdW5yZXNvbHZlZFwiIDogXCJcIikgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBidWlsZGVyLmFkZChcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UudG8gLSAyIC0gKHNldHRpbmdzLmhpZGVRdW90ZXMgPyAxIDogMCksXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLnRvIC0gKHNldHRpbmdzLmhpZGVRdW90ZXMgPyAxIDogMCksXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiY20tZm9ybWF0dGluZy1saW5rIGNtLWZvcm1hdHRpbmctbGluay1lbmRcIiB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaCA9IHRleHQubWF0Y2goL1xcWyguKylcXF0oXFwoLitcXCkpL20pKSB7XG4gICAgICAgICAgICBidWlsZGVyLmFkZChcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UuZnJvbSArIChzZXR0aW5ncy5oaWRlUXVvdGVzID8gMSA6IDApLFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgMSArIChzZXR0aW5ncy5oaWRlUXVvdGVzID8gMSA6IDApLFxuICAgICAgICAgICAgICAgIERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImNtLWZvcm1hdHRpbmctbGluayBjbS1mb3JtYXR0aW5nLWxpbmstc3RhcnRcIiB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkKFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgdGV4dC5pbmRleE9mKG1hdGNoWzFdKSxcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UuZnJvbSArIHRleHQuaW5kZXhPZihtYXRjaFsxXSkgKyBtYXRjaFsxXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiY20tbGlua1wiIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYnVpbGRlci5hZGQoXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20gKyB0ZXh0LmluZGV4T2YoXCJdXCIpLFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgdGV4dC5pbmRleE9mKFwiXVwiKSArIDEsXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiY20tZm9ybWF0dGluZy1saW5rIGNtLWZvcm1hdHRpbmctbGluay1lbmRcIiB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGJ1aWxkZXIuYWRkKFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgdGV4dC5pbmRleE9mKG1hdGNoWzJdKSxcbiAgICAgICAgICAgICAgICBsaW5rU2xpY2UuZnJvbSArIHRleHQuaW5kZXhPZihtYXRjaFsyXSkgKyBtYXRjaFsyXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IGlzVXJpKGxpbmtTbGljZS5ocmVmKSA/IFwiZXh0ZXJuYWwtbGlua1wiIDogXCJjbS11cmxcIiB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaCA9IHRleHQubWF0Y2goL1xcXCIoLispXFxcIi9tKSkge1xuICAgICAgICAgICAgYnVpbGRlci5hZGQoXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20gKyB0ZXh0LmluZGV4T2YobWF0Y2hbMV0pLFxuICAgICAgICAgICAgICAgIGxpbmtTbGljZS5mcm9tICsgdGV4dC5pbmRleE9mKG1hdGNoWzFdKSArIG1hdGNoWzFdLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogXCJjbS11cmxcIiB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmIChpc1VyaSh0ZXh0KSkge1xuICAgICAgICAgICAgYnVpbGRlci5hZGQoXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLmZyb20sXG4gICAgICAgICAgICAgICAgbGlua1NsaWNlLnRvLFxuICAgICAgICAgICAgICAgIERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImNtLXVybFwiIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgRlJPTlRNQVRURVJfTElOS1NfRURJVE9SX1BMVUdJTiA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKEZyb250bWF0dGVyTGlua3NFZGl0b3JQbHVnaW4sIHtcbiAgICBkZWNvcmF0aW9uczogKHZhbHVlOiBGcm9udG1hdHRlckxpbmtzRWRpdG9yUGx1Z2luKSA9PiB2YWx1ZS5kZWNvcmF0aW9uc1xufSk7XG4iLCAiaW1wb3J0IHsgRWRpdG9yVmlldywgV2lkZ2V0VHlwZSB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaXNVcmkgfSBmcm9tIFwidmFsaWQtdXJsXCI7XG5pbXBvcnQgeyBMaW5rU2xpY2UgfSBmcm9tIFwiLi9saW5rX3NsaWNlXCI7XG5cbmV4cG9ydCBjbGFzcyBGcm9udG1hdHRlckxpbmtXaWRnZXQgZXh0ZW5kcyBXaWRnZXRUeXBlIHtcbiAgICBwcml2YXRlIGxpbmtTbGljZTogTGlua1NsaWNlO1xuXG4gICAgY29uc3RydWN0b3IobGlua1NsaWNlOiBMaW5rU2xpY2UpIHtcbiAgICAgICAgc3VwZXIoKVxuICAgICAgICB0aGlzLmxpbmtTbGljZSA9IGxpbmtTbGljZTtcbiAgICB9XG5cbiAgICB0b0RPTSh2aWV3OiBFZGl0b3JWaWV3KTogSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdCBhRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xuICAgICAgICBhRWxlbWVudC5ocmVmID0gdGhpcy5saW5rU2xpY2UuaHJlZjtcbiAgICAgICAgYUVsZW1lbnQuaW5uZXJUZXh0ID0gdGhpcy5saW5rU2xpY2UuYWxpYXMgfHwgdGhpcy5saW5rU2xpY2UuaHJlZjtcblxuICAgICAgICBpZiAoaXNVcmkodGhpcy5saW5rU2xpY2UuaHJlZikpIHtcbiAgICAgICAgICAgIGFFbGVtZW50LmFkZENsYXNzKHRoaXMubGlua1NsaWNlLm1hcmtkb3duTGluayA/IFwiZXh0ZXJuYWwtbGlua1wiIDogXCJjbS11cmxcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhRWxlbWVudC5hZGRDbGFzcyhcImludGVybmFsLWxpbmtcIik7XG5cbiAgICAgICAgICAgIGlmICghKGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHRoaXMubGlua1NsaWNlLmhyZWYsIFwiXCIpIGluc3RhbmNlb2YgVEZpbGUpICYmICF0aGlzLmxpbmtTbGljZS5tYXJrZG93bkxpbmspIHtcbiAgICAgICAgICAgICAgICBhRWxlbWVudC5hZGRDbGFzcyhcImlzLXVucmVzb2x2ZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYUVsZW1lbnQ7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpc1VyaSB9IGZyb20gXCJ2YWxpZC11cmxcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIG9uTWV0YWRhdGFDYWNoZVJlc29sdmUoZmlsZTogVEZpbGUpIHtcbiAgICBjb25zdCBjYWNoZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBpZiAoIWNhY2hlKSB7IHJldHVybjsgfVxuXG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBjYWNoZS5mcm9udG1hdHRlcjtcbiAgICBpZiAoIWZyb250bWF0dGVyKSB7IHJldHVybjsgfVxuXG4gICAgYWRkRnJvbnRtYXR0ZXJMaW5rc1RvQ2FjaGUoZmlsZSwgZnJvbnRtYXR0ZXIpO1xufVxuXG5mdW5jdGlvbiBhZGRGcm9udG1hdHRlckxpbmtzVG9DYWNoZShmaWxlOiBURmlsZSwgZnJvbnRtYXR0ZXI6IGFueSkge1xuICAgIGlmICghZnJvbnRtYXR0ZXIpIHsgcmV0dXJuOyB9XG4gICAgZm9yIChsZXQga2V5IG9mIE9iamVjdC5rZXlzKGZyb250bWF0dGVyKSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGZyb250bWF0dGVyW2tleV07XG4gICAgICAgIGlmICh0eXBlb2YodmFsdWUpID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRjaDogUmVnRXhwTWF0Y2hBcnJheSB8IG51bGwgPSB2YWx1ZS5tYXRjaCgvXFxbXFxbKC4rKVxcfC4rXFxdXFxdL20pIHx8IHZhbHVlLm1hdGNoKC9cXFtcXFsoLispXFxdXFxdL20pIHx8IHZhbHVlLm1hdGNoKC9cXFsuK1xcXVxcKCguKylcXCkvbSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghbWF0Y2gpIHsgY29udGludWU7IH1cbiAgICAgICAgICAgIGxldCBocmVmID0gbWF0Y2hbMV07XG5cbiAgICAgICAgICAgIGlmIChpc1VyaShocmVmKSkgeyBjb250aW51ZTsgfVxuXG4gICAgICAgICAgICBsZXQgZiA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGhyZWYsIFwiXCIpO1xuICAgICAgICAgICAgbGV0IGxpbmtzOiBSZWNvcmQ8c3RyaW5nLCBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+PjtcbiAgICAgICAgICAgIGlmIChmIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICBocmVmID0gZi5wYXRoO1xuICAgICAgICAgICAgICAgIGxpbmtzID0gYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rcztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGlua3MgPSBhcHAubWV0YWRhdGFDYWNoZS51bnJlc29sdmVkTGlua3M7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChsaW5rc1tmaWxlLnBhdGhdW2hyZWZdKSB7XG4gICAgICAgICAgICAgICAgbGlua3NbZmlsZS5wYXRoXVtocmVmXSArPSAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsaW5rc1tmaWxlLnBhdGhdW2hyZWZdID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YodmFsdWUpID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBhZGRGcm9udG1hdHRlckxpbmtzVG9DYWNoZShmaWxlLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgZ2V0RnJvbnRtYXR0ZXJPZlRGaWxlLCBzZXRGcm9udG1hdHRlck9mVEZpbGUgfSBmcm9tIFwiQG9wZC1saWJzL29wZC1tZXRhZGF0YS1saWIvbGliL0FQSVwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGcm9udG1hdHRlckxpbmtzUGx1Z2luIGZyb20gXCIuL21haW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIG9uVmF1bHRGaWxlUmVuYW1lKGZpbGU6IFRGaWxlLCBvbGRQYXRoOiBzdHJpbmcsIHBsdWdpbjogRnJvbnRtYXR0ZXJMaW5rc1BsdWdpbikge1xuICAgIGZvciAobGV0IGZpbGVOYW1lIG9mIE9iamVjdC5rZXlzKGFwcC5tZXRhZGF0YUNhY2hlLnJlc29sdmVkTGlua3MpKSB7XG4gICAgICAgIGNvbnN0IGxpbmtzID0gYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rc1tmaWxlTmFtZV07XG5cblx0XHRsZXQgb2xkTmFtZSA9IG9sZFBhdGg7XG5cdFx0bGV0IG1hdGNoOiBSZWdFeHBNYXRjaEFycmF5IHwgbnVsbCA9IG9sZFBhdGgubWF0Y2goLy4rXFwvKC4rXFwubWQpL20pO1xuXHRcdGlmIChtYXRjaCkge1xuXHRcdFx0b2xkTmFtZSA9IG1hdGNoWzFdO1xuXHRcdH1cblxuICAgICAgICBpZiAobGlua3Nbb2xkUGF0aF0pIHtcbiAgICAgICAgICAgIGNvbnN0IGYgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChmaWxlTmFtZSwgXCJcIik7XG4gICAgICAgICAgICBpZiAoZiBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBnZXRGcm9udG1hdHRlck9mVEZpbGUoZiwgcGx1Z2luKTtcbiAgICAgICAgICAgICAgICByZW5hbWVGcm9udG1hdHRlckxpbmtzKFxuICAgICAgICAgICAgICAgICAgICBmcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgb2xkTmFtZS5zdWJzdHJpbmcoMCwgb2xkTmFtZS5sZW5ndGggLSAzKSxcbiAgICAgICAgICAgICAgICAgICAgZmlsZS5uYW1lLnN1YnN0cmluZygwLCBmaWxlLm5hbWUubGVuZ3RoIC0gMylcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHNldEZyb250bWF0dGVyT2ZURmlsZShmcm9udG1hdHRlciwgZiwgcGx1Z2luKTtcbiAgICAgICAgICAgICAgICBhcHAubWV0YWRhdGFDYWNoZS5pbml0aWFsaXplKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlbmFtZUZyb250bWF0dGVyTGlua3MoZnJvbnRtYXR0ZXI6IGFueSwgb2xkTmFtZTogc3RyaW5nLCBuZXdOYW1lOiBzdHJpbmcpIHtcblx0Zm9yIChsZXQga2V5IG9mIE9iamVjdC5rZXlzKGZyb250bWF0dGVyKSkge1xuXHRcdGNvbnN0IHZhbHVlID0gZnJvbnRtYXR0ZXJba2V5XTtcblx0XHRpZiAodHlwZW9mKHZhbHVlKSA9PT0gXCJzdHJpbmdcIikge1xuXHRcdFx0bGV0IG1hdGNoOiBSZWdFeHBNYXRjaEFycmF5IHwgbnVsbDtcblx0XHRcdGlmIChtYXRjaCA9IHZhbHVlLm1hdGNoKC9cXFtcXFsoLispXFx8KC4rKVxcXVxcXS9tKSkge1xuXHRcdFx0XHRpZiAobWF0Y2hbMV0gPT09IG9sZE5hbWUpIHtcblx0XHRcdFx0XHRmcm9udG1hdHRlcltrZXldID0gXCJbW1wiICsgbmV3TmFtZSArIFwifFwiICsgbWF0Y2hbMl0gKyBcIl1dXCI7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobWF0Y2ggPSB2YWx1ZS5tYXRjaCgvXFxbXFxbKC4rKVxcXVxcXS9tKSkge1xuXHRcdFx0XHRpZiAobWF0Y2hbMV0gPT09IG9sZE5hbWUpIHtcblx0XHRcdFx0XHRmcm9udG1hdHRlcltrZXldID0gXCJbW1wiICsgbmV3TmFtZSArIFwiXV1cIjtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChtYXRjaCA9IHZhbHVlLm1hdGNoKC9cXFsoLispXFxdXFwoKC4rKVxcKS9tKSkge1xuXHRcdFx0XHRpZiAobWF0Y2hbMl0gPT09IG9sZE5hbWUpIHtcblx0XHRcdFx0XHRmcm9udG1hdHRlcltrZXldID0gXCJbXCIgKyBtYXRjaFsxXSArIFwiXShcIiArIG5ld05hbWUgKyBcIilcIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAodHlwZW9mKHZhbHVlKSA9PT0gXCJvYmplY3RcIikge1xuXHRcdFx0cmVuYW1lRnJvbnRtYXR0ZXJMaW5rcyh2YWx1ZSwgb2xkTmFtZSwgbmV3TmFtZSk7XG5cdFx0fVxuXHR9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBUb2dnbGVDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGcm9udG1hdHRlckxpbmtzUGx1Z2luIGZyb20gXCIuL21haW5cIjtcblxuZXhwb3J0IGludGVyZmFjZSBGcm9udG1hdHRlckxpbmtzU2V0dGluZ3Mge1xuICAgIGhpZGVRdW90ZXM6IGJvb2xlYW4sXG4gICAgYWRkVG9HcmFwaDogYm9vbGVhbixcbiAgICB1cGRhdGVMaW5rczogYm9vbGVhbixcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBhcnRpYWw8RnJvbnRtYXR0ZXJMaW5rc1NldHRpbmdzPiA9IHtcbiAgICBoaWRlUXVvdGVzOiBmYWxzZSxcbiAgICBhZGRUb0dyYXBoOiB0cnVlLFxuICAgIHVwZGF0ZUxpbmtzOiB0cnVlLFxufTtcblxuZXhwb3J0IGNsYXNzIEZyb250bWF0dGVyTGlua3NTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEZyb250bWF0dGVyTGlua3NQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBGcm9udG1hdHRlckxpbmtzUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpIHtcbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiSGlkZSBxdW90YXRpb24gbWFya3NcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiRG9uJ3QgcmVuZGVyIHF1b3RhdGlvbiBtYXJrcyBzdXJyb3VuZGluZyBmcm9udG1hdHRlciBsaW5rcy5cIilcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKGNvbXBvbmVudDogVG9nZ2xlQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZGVRdW90ZXMpO1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5vbkNoYW5nZSgodmFsdWU6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlkZVF1b3RlcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQWRkIHRvIGdyYXBoXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIkFkZCBmcm9udG1hdHRlciBsaW5rIGNvbm5lY3Rpb25zIHRvIHRoZSBncmFwaCB2aWV3LlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgoY29tcG9uZW50OiBUb2dnbGVDb21wb25lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWRkVG9HcmFwaCk7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50Lm9uQ2hhbmdlKCh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBhcHAubWV0YWRhdGFDYWNoZS5pbml0aWFsaXplKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFkZFRvR3JhcGggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkF1dG9tYXRpY2FsbHkgdXBkYXRlIGludGVybmFsIGZyb250bWF0dGVyIGxpbmtzXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlR1cm4gb24gdG8gdXBkYXRlIGZyb250bWF0dGVyIGxpbmtzIHdoZW4gYSBub3RlIGlzIHJlbmFtZWQuPGJyPidBdXRvbWF0aWNhbGx5IHVwZGF0ZSBpbnRlcm5hbCBsaW5rcycgaW4gJ0ZpbGVzICYgTGlua3MnIG11c3QgYWxzbyBiZSBlbmFibGVkLlwiKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgY3JlYXRlRnJhZ21lbnQoZWwgPT4ge1xuICAgICAgICAgICAgICAgICAgICBlbC5hcHBlbmRUZXh0KFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJUdXJuIG9uIHRvIHVwZGF0ZSBmcm9udG1hdHRlciBsaW5rcyB3aGVuIGEgbm90ZSBpcyByZW5hbWVkLlwiIFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBlbC5jcmVhdGVFbChcImJyXCIpO1xuICAgICAgICAgICAgICAgICAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbHM6IFwibW9kLXdhcm5pbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiJ0F1dG9tYXRpY2FsbHkgdXBkYXRlIGludGVybmFsIGxpbmtzJyBpbiAnRmlsZXMgJiBMaW5rcycgbXVzdCBhbHNvIGJlIGVuYWJsZWQuXCJcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKGNvbXBvbmVudDogVG9nZ2xlQ29tcG9uZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVwZGF0ZUxpbmtzKTtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQub25DaGFuZ2UoKHZhbHVlOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVwZGF0ZUxpbmtzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgaGlkZSgpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5lbXB0eSgpO1xuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQSxJQUFDLFVBQVMsU0FBUTtBQUNkO0FBRUEsY0FBTyxRQUFRLFNBQVM7QUFDeEIsY0FBTyxRQUFRLGNBQWM7QUFDN0IsY0FBTyxRQUFRLGVBQWU7QUFDOUIsY0FBTyxRQUFRLGFBQWE7QUFFNUIsY0FBTyxRQUFRLFFBQVE7QUFDdkIsY0FBTyxRQUFRLFlBQVk7QUFDM0IsY0FBTyxRQUFRLGFBQWE7QUFDNUIsY0FBTyxRQUFRLFdBQVc7QUFLMUIsVUFBSSxXQUFXLFNBQVMsS0FBSztBQUN6QixZQUFJLFdBQVcsSUFBSSxNQUFNLHNFQUFzRTtBQUMvRixlQUFPO0FBQUEsTUFDWDtBQUVBLHNCQUFnQixPQUFPO0FBQ25CLFlBQUksQ0FBQyxPQUFPO0FBQ1I7QUFBQSxRQUNKO0FBR0EsWUFBSSwyREFBMkQsS0FBSyxLQUFLO0FBQUc7QUFHNUUsWUFBSSxj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
