/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __reflectGet = Reflect.get;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __superGet = (cls, obj, key) => __reflectGet(__getProtoOf(cls), key, obj);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetadataMenu
});
module.exports = __toCommonJS(main_exports);
var import_obsidian61 = require("obsidian");

// src/commands/paletteCommands.ts
var import_obsidian45 = require("obsidian");

// src/components/NoteFields.ts
var import_obsidian37 = require("obsidian");

// src/fileClass/FileClassAttributeModal.ts
var import_obsidian34 = require("obsidian");

// src/fields/fieldManagers/InputField.ts
var import_obsidian10 = require("obsidian");

// src/modals/fields/InputModal.ts
var import_obsidian4 = require("obsidian");

// src/commands/insertValues.ts
var import_obsidian2 = require("obsidian");

// src/commands/insertFrontmatterWithFields.ts
var import_obsidian = require("obsidian");
function insertFrontmatterWithFields(plugin, fileOrFilePath, fields) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrFilePath instanceof import_obsidian.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = yield plugin.app.vault.read(file);
    const frontmatter = "---\n" + Object.entries(fields).map(([fieldName, value]) => `${fieldName}: ${value}`).join("\n") + "\n---\n";
    yield plugin.app.vault.modify(file, frontmatter + content);
    const editor = (_a = plugin.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView)) == null ? void 0 : _a.editor;
    if (editor) {
      const lineNumber = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber).length });
    }
  });
}

// src/commands/insertValues.ts
function insertValues(plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after = true, asList = false, asComment = false) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian2.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian2.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    if (inFrontmatter && lineNumber == -2 && !frontmatter) {
      const fields = {};
      fields[fieldName] = value;
      yield insertFrontmatterWithFields(plugin, file, fields);
    } else {
      const result = yield plugin.app.vault.read(file);
      let newContent = [];
      const targetLineNumber = inFrontmatter && lineNumber == -2 && frontmatter ? frontmatter.position.end.line : lineNumber;
      result.split("\n").forEach((line, _lineNumber) => {
        if (_lineNumber == targetLineNumber) {
          if (after)
            newContent.push(line);
          const newLine = `${!inFrontmatter && asComment ? ">" : ""}${!inFrontmatter && asList ? "- " : ""}${fieldName}${inFrontmatter ? ":" : "::"} ${value}`;
          newContent.push(newLine);
          if (!after)
            newContent.push(line);
        } else {
          newContent.push(line);
        }
      });
      yield plugin.app.vault.modify(file, newContent.join("\n"));
      const editor = (_b = plugin.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView)) == null ? void 0 : _b.editor;
      if (editor) {
        const lineNumber2 = editor.getCursor().line;
        editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber2).length });
      }
    }
  });
}

// src/commands/replaceValues.ts
var import_obsidian3 = require("obsidian");

// src/types/lookupTypes.ts
var BuiltinSummarizing = /* @__PURE__ */ ((BuiltinSummarizing2) => {
  BuiltinSummarizing2["Sum"] = "Sum";
  BuiltinSummarizing2["Count"] = "Count";
  BuiltinSummarizing2["CountAll"] = "CountAll";
  BuiltinSummarizing2["Average"] = "Average";
  BuiltinSummarizing2["Max"] = "Max";
  BuiltinSummarizing2["Min"] = "Min";
  return BuiltinSummarizing2;
})(BuiltinSummarizing || {});
var BuiltinSummarizingFunctionDescription = {
  "Sum": "Returns the sum of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Count": "Counts all pages matching the query where <{{summarizedFieldName}}> is non empty",
  "CountAll": "Counts all pages matching the query (including empty fields)",
  "Average": "Returns the average value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Max": "Returns the maximum value of <{{summarizedFieldName}}> fields in the pages matching the query",
  "Min": "Returns the minimum value of <{{summarizedFieldName}}> fields in the pages matching the query"
};
var BuiltinSummarizingFunction = {
  "Sum": 'const i=0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum',
  "CountAll": "return pages.length",
  "Count": 'return pages.filter(p => !!p["{{summarizedFieldName}}"]).length',
  "Average": 'const i=0.0;const sum = pages.reduce((p, c) => p + c["{{summarizedFieldName}}"], i); return sum / pages.length',
  "Max": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"] >= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]',
  "Min": 'return pages.reduce((p,c) => p["{{summarizedFieldName}}"]!==null && p["{{summarizedFieldName}}"] <= c["{{summarizedFieldName}}"] ? p : c)["{{summarizedFieldName}}"]'
};
var Type = /* @__PURE__ */ ((Type3) => {
  Type3["LinksList"] = "LinksList";
  Type3["LinksBulletList"] = "LinksBulletList";
  Type3["BuiltinSummarizing"] = "BuiltinSummarizing";
  Type3["CustomList"] = "CustomList";
  Type3["CustomBulletList"] = "CustomBulletList";
  Type3["CustomSummarizing"] = "CustomSummarizing";
  return Type3;
})(Type || {});
var ShortDescription = {
  "LinksList": "Inline list of links",
  "LinksBulletList": "Bullet list of links",
  "BuiltinSummarizing": "",
  "CustomList": "Inline list of customized links",
  "CustomBulletList": "Bullet list of customized links",
  "CustomSummarizing": "Custom summarizing function"
};
var Description = {
  "LinksList": "List of related links displayed inline",
  "LinksBulletList": "List of related links displayed below the field",
  "BuiltinSummarizing": "Built-in summarizing function",
  "CustomList": "Custom list rendering function displayed inline",
  "CustomBulletList": "Custom list rendering function displayed below the field",
  "CustomSummarizing": "Custom summarizing function"
};
var OptionLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Built-in summarize function:",
  "CustomList": "Query's results' list's rendering function:",
  "CustomBulletList": "Query's results' list's rendering function:",
  "CustomSummarizing": "Query's results' list's summarizing function:"
};
var OptionSubLabel = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": `function(page) { return <function using "page">; }`,
  "CustomBulletList": `function(page) { return <function using "page">; }`,
  "CustomSummarizing": `function(page) { return <function using "page">; }`
};
var Helper = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "",
  "CustomList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomBulletList": 'Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`',
  "CustomSummarizing": 'Javascript string, the "pages" (dataview pages type) variable is available\nexample: \nconst initialValue = 0;\nconst sumWithInitial = pages.reduce(\n    (previousValue, currentValue) => previousValue + currentValue,\n    initialValue\n);\nreturn `${sumWithInitial}`\n'
};
var Default = {
  "LinksList": "",
  "LinksBulletList": "",
  "BuiltinSummarizing": "Count" /* Count */,
  "CustomList": "page.file.name",
  "CustomBulletList": "page.file.name",
  "CustomSummarizing": "return pages.length"
};
var bulletListLookupTypes = [
  "LinksBulletList" /* LinksBulletList */,
  "CustomBulletList" /* CustomBulletList */
];

// src/utils/list.ts
function getListBounds(plugin, file, parent) {
  var _a;
  const listItems = ((_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.listItems) || [];
  return getListBoundsFromListItemCacheList(listItems, parent);
}
function getListBoundsFromListItemCacheList(listItems, parent) {
  const subParentsLines = [-parent - 1];
  let start2 = parent;
  let end2 = -1;
  let outOfList = false;
  listItems.sort((a, b) => a.position.start.line - b.position.start.line).forEach((listItem) => {
    if (subParentsLines.includes(listItem.parent) && !outOfList) {
      subParentsLines.push(listItem.position.start.line);
      if (start2 > listItem.position.start.line)
        start2 = listItem.position.start.line;
      if (end2 <= listItem.position.end.line) {
        if (listItem.position.end.line == listItem.position.start.line) {
          end2 = listItem.position.end.line;
        } else {
          end2 = listItem.position.start.line;
          outOfList = true;
        }
      }
    }
  });
  if (end2 >= 0) {
    return { start: start2, end: end2 };
  }
  return;
}

// src/utils/parser.ts
var fieldComponents = ["inQuote", "inList", "startStyle", "attribute", "endStyle", "beforeSeparatorSpacer", "afterSeparatorSpacer", "values"];
var genericFieldRegex = "(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<startStyle>[_\\*~`]*)(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*)(?<endStyle>[_\\*~`]*)(?<beforeSeparatorSpacer>\\s*)";
var inlineFieldRegex = (attribute) => `(?<inQuote>>(\\s+)?)?(?<inList>- )?(?<startStyle>[_\\*~\`]*)(?<attribute>${attribute})(?<endStyle>[_\\*~\`]*)(?<beforeSeparatorSpacer>\\s*)::(?<afterSeparatorSpacer>\\s*)`;
var fullLineRegex = new RegExp(`^${genericFieldRegex}::\\s*(?<values>.*)?`, "u");
var inSentenceRegexBrackets = new RegExp(`\\[${genericFieldRegex}::\\s*(?<values>[^\\]]+)?\\]`, "gu");
var inSentenceRegexPar = new RegExp(`\\(${genericFieldRegex}::\\s*(?<values>[^\\)]+)?\\)`, "gu");
var encodeLink = (value) => {
  return value ? value.replace(/\[\[/g, "\u{1F527}\u{1F400}").replace(/\]\]/g, "\u{1F413}\u{1F54C}") : value;
};
var decodeLink = (value) => {
  return value ? value.replace(/🔧🐀/gu, "[[").replace(/🐓🕌/gu, "]]") : value;
};
var frontMatterLineField = (line) => {
  const frontMatterRegex = new RegExp(new RegExp("(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*[^\\s])(?<beforeSeparatorSpacer>\\s*):(?<afterSeparatorSpacer>\\s*)(?<values>.*)", "u"));
  const fR = line.match(frontMatterRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    return attribute;
  }
};
var getLineFields = (line) => {
  const fields = [];
  const fR = line.match(fullLineRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    fields.push({ attribute, values, index: 0, length: line.length });
  } else {
    const sRBk = encodeLink(line).matchAll(inSentenceRegexBrackets);
    let next = sRBk.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBk.next();
    }
    const sRBc = encodeLink(line).matchAll(inSentenceRegexPar);
    next = sRBc.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBc.next();
    }
  }
  fields.sort((a, b) => {
    if (a.index < b.index)
      return -1;
    if (a.index > b.index)
      return 1;
    return 0;
  });
  return fields;
};

// src/commands/replaceValues.ts
var LocationWrapper = {
  "fullLine": { start: "", end: "" },
  "brackets": { start: "[", end: "]" },
  "parenthesis": { start: "(", end: ")" }
};
var matchInlineFields = (regex, line, attribute, input, location = "fullLine") => {
  const sR = line.matchAll(regex);
  let next = sR.next();
  const newFields = [];
  while (!next.done) {
    const match = next.value;
    if (match.groups && Object.keys(match.groups).every((j) => fieldComponents.includes(j))) {
      const { inList, inQuote, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = match.groups;
      const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
      const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
      const start2 = LocationWrapper[location].start;
      const end2 = LocationWrapper[location].end;
      newFields.push({
        oldField: match[0],
        newField: `${inQuote || ""}${start2}${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}${end2}`
      });
    }
    next = sR.next();
  }
  return newFields;
};
function replaceValues(plugin, fileOrFilePath, attribute, input, previousItemsCount = 0) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian3.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian3.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const skippedLines = [];
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const newContent = content.map((line, i) => {
      var _a2;
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`^${attribute}:`, "u");
        const r = line.match(regex);
        if (r && r.length > 0) {
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `[${inputArray.join(", ")}]`;
          return `${attribute}: ${newValue}`;
        } else {
          return line;
        }
      } else {
        const encodedInput = encodeLink(input);
        let encodedLine = encodeLink(line);
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodedLine.match(fullLineRegex2);
        if ((fR == null ? void 0 : fR.groups) && Object.keys(fR.groups).every((j) => fieldComponents.includes(j))) {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((f) => f.name === attribute);
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */) {
            const bounds = getListBounds(plugin, file, i);
            if (bounds) {
              const { start: start3, end: end3 } = bounds;
              for (let j = start3 + 1; j < start3 + previousItemsCount + 1 && j < end3 + 1; j++) {
                skippedLines.push(j);
              }
            }
          }
          const { inList, inQuote, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = fR.groups;
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",").sort() : [];
          let newValue;
          let hiddenValue = "";
          if ((field == null ? void 0 : field.type) === "Lookup" /* Lookup */ && bulletListLookupTypes.includes(field == null ? void 0 : field.options.outputType)) {
            newValue = inputArray.length == 1 ? "\n- " + inputArray[0] : `${inputArray.length > 0 ? "\n" : ""}${inputArray.map((item) => "- " + item).join("\n")}`;
            hiddenValue = `<div hidden id="${field.name}_values">${input}</div>`;
          } else {
            newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          }
          return `${inQuote || ""}${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${hiddenValue + newValue}`;
        } else {
          const newFields = [];
          const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
          const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
          newFields.push(...matchInlineFields(inSentenceRegexBrackets2, encodedLine, attribute, encodedInput, "brackets" /* brackets */));
          newFields.push(...matchInlineFields(inSentenceRegexPar2, encodedLine, attribute, encodedInput, "parenthesis" /* parenthesis */));
          newFields.forEach((field) => {
            const fieldRegex = new RegExp(field.oldField.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "u");
            encodedLine = encodedLine.replace(fieldRegex, field.newField);
          });
          return decodeLink(encodedLine);
        }
      }
    });
    yield plugin.app.vault.modify(file, newContent.filter((line, i) => !skippedLines.includes(i)).join("\n"));
    const editor = (_b = plugin.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView)) == null ? void 0 : _b.editor;
    if (editor) {
      const lineNumber = editor.getCursor().line;
      editor.setCursor({ line: editor.getCursor().line, ch: editor.getLine(lineNumber).length });
    }
  });
}

// src/modals/fields/InputModal.ts
var InputModal = class extends import_obsidian4.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.templateValues = {};
  }
  onOpen() {
    if (this.field.options.template) {
      const templateFieldRegex = new RegExp(`\\{\\{(?<field>[^\\}]+?)\\}\\}`, "gu");
      const tF = this.field.options.template.matchAll(templateFieldRegex);
      let next = tF.next();
      while (!next.done) {
        if (next.value.groups) {
          const value = next.value.groups.field;
          const [name, optionsString] = value.split(new RegExp(":(.*)", "s")).map((v) => v.trim());
          this.templateValues[name] = "";
          if (optionsString) {
            const options = JSON.parse(optionsString);
            this.buildTemplateSelectItem(this.contentEl.createDiv({ cls: "field-container" }), name, options);
          } else {
            this.buildTemplateInputItem(this.contentEl.createDiv({ cls: "field-container" }), name);
          }
        }
        next = tF.next();
      }
      this.contentEl.createDiv({ text: "Result preview" });
      this.buildResultPreview(this.contentEl.createDiv({ cls: "field-container" }));
      this.buildSaveBtn(this.contentEl.createDiv({ cls: "footer-actions" }));
    } else {
      this.buildInputEl(this.contentEl.createDiv({ cls: "field-container" }));
    }
    this.containerEl.addClass("metadata-menu");
  }
  renderValue() {
    let renderedString = this.field.options.template.slice();
    Object.keys(this.templateValues).forEach((k) => {
      const fieldRegex = new RegExp(`\\{\\{${k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")}(:[^\\}]*)?\\}\\}`, "u");
      renderedString = renderedString.replace(fieldRegex, this.templateValues[k]);
    });
    this.renderedValue.setValue(renderedString);
  }
  buildTemplateInputItem(fieldContainer, name) {
    fieldContainer.createDiv({ cls: "label", text: name });
    const input = new import_obsidian4.TextComponent(fieldContainer);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    input.setPlaceholder(`Enter a value for ${name}`);
    input.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildTemplateSelectItem(fieldContainer, name, options) {
    fieldContainer.createDiv({ text: name, cls: "label" });
    fieldContainer.createDiv({ cls: "spacer" });
    const selectEl = new import_obsidian4.DropdownComponent(fieldContainer);
    selectEl.addOption("", "--select--");
    options.forEach((o) => selectEl.addOption(o, o));
    selectEl.onChange((value) => {
      this.templateValues[name] = value;
      this.renderValue();
    });
  }
  buildResultPreview(fieldContainer) {
    this.renderedValue = new import_obsidian4.TextAreaComponent(fieldContainer);
    this.renderedValue.inputEl.addClass("full-width");
    this.renderedValue.inputEl.rows = 3;
    this.renderedValue.setValue(this.value);
  }
  buildSaveBtn(fieldContainer) {
    fieldContainer.createDiv({ cls: "spacer" });
    const saveBtn = new import_obsidian4.ButtonComponent(fieldContainer);
    saveBtn.setIcon("checkmark");
    saveBtn.onClick(() => __async(this, null, function* () {
      let inputValue = this.renderedValue.getValue();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    }));
  }
  buildInputEl(container) {
    const inputEl = new import_obsidian4.TextComponent(container);
    inputEl.inputEl.focus();
    inputEl.inputEl.addClass("full-width");
    inputEl.setValue(`${this.value}`);
    const saveBtn = new import_obsidian4.ButtonComponent(container);
    saveBtn.setIcon("checkmark");
    saveBtn.onClick(() => __async(this, null, function* () {
      let inputValue = inputEl.getValue();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    }));
  }
};

// src/fields/FieldManager.ts
var import_obsidian9 = require("obsidian");

// src/modals/insertFieldSuggestModal.ts
var import_obsidian6 = require("obsidian");

// src/modals/addNewFieldModal.ts
var import_obsidian5 = require("obsidian");
var addNewFieldModal = class extends import_obsidian5.Modal {
  constructor(plugin, lineNumber, file, inFrontmatter, after) {
    super(plugin.app);
    this.plugin = plugin;
    this.lineNumber = lineNumber;
    this.file = file;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    this.titleEl.setText("Insert new field");
    const nameContainer = this.contentEl.createDiv({ cls: "field-container" });
    nameContainer.createDiv({ text: "Field name: ", cls: "label" });
    const nameInput = new import_obsidian5.TextComponent(nameContainer);
    nameInput.inputEl.addClass("with-label");
    nameInput.inputEl.addClass("full-width");
    const valueContainer = this.contentEl.createDiv({ cls: "field-container" });
    valueContainer.createDiv({ text: "Field value: ", cls: "label" });
    const valueInput = new import_obsidian5.TextComponent(valueContainer);
    valueInput.inputEl.addClass("with-label");
    valueInput.inputEl.addClass("full-width");
    const footerButtons = this.contentEl.createDiv({
      cls: "footer-actions"
    });
    footerButtons.createDiv({ cls: "spacer" });
    const saveButton = new import_obsidian5.ButtonComponent(footerButtons);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      yield this.plugin.fileTaskManager.pushTask(() => {
        insertValues(this.plugin, this.file, nameInput.getValue(), valueInput.getValue(), this.lineNumber, this.inFrontmatter, this.after);
      });
      this.close();
    }));
    const cancelButton = new import_obsidian5.ButtonComponent(footerButtons);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
  }
};

// src/modals/insertFieldSuggestModal.ts
var InsertFieldSuggestModal = class extends import_obsidian6.FuzzySuggestModal {
  constructor(plugin, file, lineNumber, inFrontmatter, after) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.containerEl.addClass("metadata-menu");
  }
  getItems() {
    var _a;
    return [{ actionLabel: "++New++" }].concat(((_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.map((field) => {
      return { actionLabel: field.name, type: field.type };
    })) || []);
  }
  getItemText(item) {
    return item.actionLabel;
  }
  renderSuggestion(item, el) {
    el.addClass("value-container");
    const iconContainer = el.createDiv({ cls: "icon-container" });
    item.item.type ? (0, import_obsidian6.setIcon)(iconContainer, FieldIcon[item.item.type]) : (0, import_obsidian6.setIcon)(iconContainer, "plus-with-circle");
    el.createDiv({ text: item.item.actionLabel });
    el.createDiv({ cls: "spacer" });
    if (item.item.type)
      el.createDiv({ cls: `chip ${FieldTypeTagClass[item.item.type]}`, text: item.item.type });
  }
  onChooseItem(item, evt) {
    var _a;
    if (item.actionLabel === "++New++") {
      const newFieldModal = new addNewFieldModal(this.plugin, this.lineNumber, this.file, this.inFrontmatter, this.after);
      newFieldModal.open();
      this.close();
    } else {
      const field = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field2) => field2.name === item.actionLabel);
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.createAndOpenFieldModal(this.file, item.actionLabel, "", this.lineNumber, this.inFrontmatter, this.after, false, false);
      }
    }
  }
};

// src/settings/FieldSettingsModal.ts
var import_obsidian8 = require("obsidian");

// src/fields/Field.ts
var Field = class {
  constructor(name = "", options = {}, id = "", type = "Input" /* Input */, fileClassName, command) {
    this.name = name;
    this.options = options;
    this.id = id;
    this.type = type;
    this.fileClassName = fileClassName;
    this.command = command;
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.type = source.type;
    Object.keys(source.options).forEach((k) => {
      target.options[k] = source.options[k];
    });
    Object.keys(target.options).forEach((k) => {
      if (!Object.keys(source.options).includes(k)) {
        delete target.options[k];
      }
      ;
    });
    target.command = source.command;
  }
  static createDefault(name) {
    const field = new Field();
    field.type = "Input" /* Input */;
    field.name = name;
    return field;
  }
};
var Field_default = Field;

// src/settings/FieldSetting.ts
var import_obsidian7 = require("obsidian");
var FieldSetting = class extends import_obsidian7.Setting {
  constructor(containerEl, field, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.field = field;
    this.plugin = plugin;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
    this.settingEl.addClass("no-border");
  }
  setTextContentWithname() {
    const manager = new FieldManager[this.field.type](this.plugin, this.field);
    this.infoEl.textContent = "";
    this.infoEl.addClass("setting-item");
    this.fieldNameContainer = this.infoEl.createEl("div", "name");
    this.fieldNameContainer.setText(this.field.name);
    this.typeContainer = this.infoEl.createEl("div");
    this.typeContainer.setAttr("class", `chip ${FieldTypeTagClass[this.field.type]}`);
    this.typeContainer.setText(this.field.type);
    this.fieldOptionsContainer = this.infoEl.createEl("div");
    this.fieldOptionsContainer.setText(`${manager.getOptionsStr()}`);
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FieldSettingsModal(this.plugin, this.containerEl, this, this.field);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
        if (currentExistingProperty) {
          this.plugin.initialProperties.remove(currentExistingProperty);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  static getValuesListFromNote(plugin, notePath) {
    return __async(this, null, function* () {
      let values = [];
      const file = plugin.app.vault.getAbstractFileByPath(notePath);
      if (file instanceof import_obsidian7.TFile && file.extension == "md") {
        const result = yield plugin.app.vault.read(file);
        result.split("\n").forEach((line) => {
          if (/^(.*)$/.test(line)) {
            values.push(line.trim());
          }
          ;
        });
        return values;
      } else {
        return [];
      }
      ;
    });
  }
};

// src/settings/FieldSettingsModal.ts
var FieldSettingsModal = class extends import_obsidian8.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, field) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialField = new Field_default();
    if (field) {
      this.new = false;
      this.field = field;
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      let newId = 1;
      this.plugin.initialProperties.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.field = new Field_default();
      this.field.id = newId.toString();
      this.initialField.id = newId.toString();
    }
    ;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.addCommand = this.field.command !== void 0;
    this.command = this.field.command || {
      id: this.field ? `insert__${this.field.fileClassName || "presetField"}__${this.field.name}` : "",
      icon: "list-plus",
      label: this.field ? `Insert ${this.field.name} field` : "",
      hotkey: void 0
    };
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      if (this.field.name == "") {
        this.titleEl.setText(`Add a field and define options`);
      } else {
        this.titleEl.setText(`Manage settings options for ${this.field.name}`);
      }
      ;
      this.createnameInputContainer();
      this.contentEl.createEl("hr");
      this.createCommandContainer();
      const typeSelectContainer = this.contentEl.createDiv({ cls: "field-container" });
      this.contentEl.createEl("hr");
      this.fieldOptionsContainer = this.contentEl.createDiv();
      const footer = this.contentEl.createDiv({ cls: "footer-actions" });
      footer.createDiv({ cls: "spacer" });
      this.createSaveButton(footer);
      this.createCancelButton(footer);
      this.createTypeSelectorContainer(typeSelectContainer);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  onClose() {
    Object.assign(this.field, this.initialField);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FieldSetting(this.parentSettingContainer, this.field, this.plugin);
    }
    ;
  }
  createnameInputContainer() {
    const container = this.contentEl.createDiv({ cls: "field-container" });
    container.createDiv({ cls: "label", text: "Field Name: " });
    const input = new import_obsidian8.TextComponent(container);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    const name = this.field.name;
    input.setValue(name);
    input.setPlaceholder("Name of the field");
    input.onChange((value) => {
      this.field.name = value;
      this.command.id = `insert__${this.field.fileClassName || "presetField"}__${value}`;
      this.command.label = `Insert ${value} field`;
      this.titleEl.setText(`Manage predefined options for ${this.field.name}`);
      FieldSettingsModal.removeValidationError(input);
    });
    this.namePromptComponent = input;
  }
  createTypeSelectorContainer(parentNode) {
    const typeSelectorContainerLabel = parentNode.createDiv({ cls: "label" });
    typeSelectorContainerLabel.setText(`Field type:`);
    parentNode.createDiv({ cls: "spacer" });
    const select = new import_obsidian8.DropdownComponent(parentNode);
    Object.keys(FieldTypeLabelMapping).forEach((f) => select.addOption(f, FieldTypeTooltip[f]));
    if (this.field.type) {
      select.setValue(this.field.type);
    }
    select.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.namePromptComponent.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  createCommandContainer() {
    const commandContainer = this.contentEl.createDiv({ cls: "field-container" });
    commandContainer.createDiv({ text: "set a command for this field?", cls: "label" });
    commandContainer.createDiv({ cls: "spacer" });
    const addCommandToggler = new import_obsidian8.ToggleComponent(commandContainer);
    addCommandToggler.setValue(this.addCommand);
    const iconContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.addCommand ? iconContainer.show() : iconContainer.hide();
    iconContainer.createDiv({ text: "Icon name", cls: "label" });
    this.iconName = new import_obsidian8.TextComponent(iconContainer);
    this.iconName.inputEl.addClass("full-width");
    this.iconName.inputEl.addClass("with-label");
    const iconPreview = iconContainer.createDiv({ cls: "icon-preview" });
    this.iconName.setValue(this.command.icon);
    (0, import_obsidian8.setIcon)(iconPreview, this.command.icon);
    this.iconName.onChange((value) => {
      this.command.icon = value;
      (0, import_obsidian8.setIcon)(iconPreview, value);
    });
    addCommandToggler.onChange((value) => {
      this.addCommand = value;
      this.addCommand ? iconContainer.show() : iconContainer.hide();
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.namePromptComponent, this.contentEl) && this.fieldManager.validateOptions();
  }
  createSaveButton(container) {
    const b = new import_obsidian8.ButtonComponent(container);
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      let error = !this.validateFields();
      if (error) {
        new import_obsidian8.Notice("Fix errors before saving.");
        return;
      }
      ;
      if (this.addCommand) {
        this.field.command = this.command;
      } else {
        delete this.field.command;
      }
      this.saved = true;
      const currentExistingField = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
      if (currentExistingField) {
        Field_default.copyProperty(currentExistingField, this.field);
      } else {
        this.plugin.initialProperties.push(this.field);
      }
      ;
      Field_default.copyProperty(this.initialField, this.field);
      if (this.parentSetting)
        Field_default.copyProperty(this.parentSetting.field, this.field);
      (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
      this.plugin.saveSettings();
      this.close();
    }));
  }
  createCancelButton(container) {
    const b = new import_obsidian8.ButtonComponent(container);
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialField.name != "") {
        Object.assign(this.field, this.initialField);
      }
      ;
      this.close();
    });
  }
  static setValidationError(textInput, message) {
    textInput.inputEl.addClass("is-invalid");
    const fieldContainer = textInput.inputEl.parentElement;
    const fieldsContainer = fieldContainer == null ? void 0 : fieldContainer.parentElement;
    if (message && fieldsContainer) {
      let mDiv = fieldsContainer.querySelector(".field-error");
      if (!mDiv)
        mDiv = createDiv({ cls: "field-error" });
      mDiv.innerText = message;
      fieldsContainer.insertBefore(mDiv, fieldContainer);
    }
  }
  static removeValidationError(textInput) {
    if (textInput.inputEl.hasClass("is-invalid"))
      textInput.inputEl.removeClass("is-invalid");
    const fieldContainer = textInput.inputEl.parentElement;
    const fieldsContainer = fieldContainer == null ? void 0 : fieldContainer.parentElement;
    const fieldError = fieldsContainer == null ? void 0 : fieldsContainer.querySelector(".field-error");
    if (fieldError)
      fieldsContainer.removeChild(fieldError);
  }
};

// src/fields/FieldManager.ts
var FieldManager2 = class {
  constructor(plugin, field, type) {
    this.plugin = plugin;
    this.field = field;
    this.type = type;
    this.showModalOption = true;
    if (field.type !== type)
      throw Error(`This field is not of type ${type}`);
  }
  static buildMarkDownLink(plugin, file, path, alias) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, void 0, alias);
    }
    return "";
  }
  validateName(textInput, contentEl) {
    let error = false;
    if (/^[#>-]/.test(this.field.name)) {
      FieldSettingsModal.setValidationError(textInput, "Field name cannot start with #, >, -");
      error = true;
    }
    ;
    if (this.field.name == "") {
      FieldSettingsModal.setValidationError(textInput, "Field name can not be Empty");
      error = true;
    }
    ;
    return !error;
  }
  validateValue(value) {
    return true;
  }
  static replaceValues(plugin, path, fieldName, value) {
    return __async(this, null, function* () {
      const file = plugin.app.vault.getAbstractFileByPath(path);
      if (file instanceof import_obsidian9.TFile && file.extension == "md") {
        yield plugin.fileTaskManager.pushTask(() => {
          replaceValues(plugin, file, fieldName, value);
        });
      }
    });
  }
  static isMenu(location) {
    return location.addItem !== void 0;
  }
  static isSuggest(location) {
    return location.getItems !== void 0;
  }
  static isInsertFieldCommand(location) {
    return location === "InsertFieldCommand";
  }
  static isFieldOptions(location) {
    return location.addOption !== void 0;
  }
  static createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, inFrontmatter, after, asList, asComment) {
    if (field) {
      const fieldManager = new FieldManager[field.type](plugin, field);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment);
    } else {
      const fieldManager = FieldManager2.createDefault(plugin, fieldName);
      fieldManager.createAndOpenFieldModal(file, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment);
    }
  }
  static openFieldModal(plugin, file, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    var _a;
    if (!fieldName) {
      const modal = new InsertFieldSuggestModal(plugin, file, lineNumber, inFrontmatter, after);
      modal.open();
    } else {
      const field = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
      if (field)
        this.createAndOpenModal(plugin, file, fieldName, field, value, lineNumber, inFrontmatter, after, asList, asComment);
    }
  }
  static createDefault(plugin, name) {
    const field = Field_default.createDefault(name);
    return new FieldManager[field.type](plugin, field);
  }
  static stringToBoolean(value) {
    let toBooleanValue = false;
    if (isBoolean(value)) {
      toBooleanValue = value;
    } else if (/true/i.test(value) || /1/.test(value)) {
      toBooleanValue = true;
    } else if (/false/i.test(value) || /0/.test(value)) {
      toBooleanValue = false;
    }
    ;
    return toBooleanValue;
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let valueText;
    if (dvApi) {
      switch (dvApi.page(file.path)[fieldName]) {
        case void 0:
          valueText = "";
          break;
        case null:
          valueText = "";
          break;
        case false:
          valueText = "false";
          break;
        case 0:
          valueText = "0";
          break;
        default:
          valueText = dvApi.page(file.path)[fieldName];
      }
    } else {
      valueText = "";
    }
    container.createDiv({ text: valueText });
  }
};

// src/fields/fieldManagers/InputField.ts
var InputField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Input" /* Input */);
  }
  getOptionsStr() {
    return this.field.options.template;
  }
  addFieldOption(name, value, file, location) {
    const modal = new InputModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    const iconName = FieldIcon["Input" /* Input */];
    const action = () => modal.open();
    if (InputField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (InputField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: iconName
      });
    } else if (InputField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Input" /* Input */], action, `Update ${name}'s value`);
    }
  }
  createSettingContainer(container, plugin) {
    container.createEl("span", { text: "Template", cls: "label" });
    const templateContainer = container.createDiv({ cls: "field-container" });
    const templateValue = new import_obsidian10.TextAreaComponent(templateContainer);
    templateValue.inputEl.cols = 50;
    templateValue.inputEl.rows = 4;
    templateValue.inputEl.addClass("full-width");
    templateValue.setValue(this.field.options.template || "");
    templateValue.onChange((value) => {
      this.field.options.template = value;
    });
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new InputModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a, _b;
    attrs.cls = "value-container";
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
    const inputContainer = fieldContainer.createDiv({});
    inputContainer.hide();
    const input = inputContainer.createEl("input");
    input.value = p[this.field.name];
    const spacer = fieldContainer.createDiv({ cls: "spacer-1" });
    if ((_a = attrs.options) == null ? void 0 : _a.alwaysOn)
      spacer.hide();
    const editBtn = fieldContainer.createEl("button");
    (0, import_obsidian10.setIcon)(editBtn, FieldIcon["Input" /* Input */]);
    if (!((_b = attrs == null ? void 0 : attrs.options) == null ? void 0 : _b.alwaysOn)) {
      editBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        if (!inputContainer.isShown()) {
          editBtn.show();
          spacer.hide();
        }
      };
      fieldContainer.onmouseout = () => {
        var _a2;
        editBtn.hide();
        if (!((_a2 = attrs.options) == null ? void 0 : _a2.alwaysOn))
          spacer.show();
      };
    }
    const validateIcon = inputContainer.createEl("button");
    (0, import_obsidian10.setIcon)(validateIcon, "checkmark");
    validateIcon.onclick = (e) => {
      InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
      inputContainer.hide();
    };
    const cancelIcon = inputContainer.createEl("button");
    (0, import_obsidian10.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      var _a2;
      inputContainer.hide();
      fieldValue.show();
      editBtn.show();
      if (!((_a2 = attrs.options) == null ? void 0 : _a2.alwaysOn))
        spacer.show();
    };
    input.focus();
    input.onkeydown = (e) => {
      var _a2;
      if (e.key === "Enter") {
        InputField.replaceValues(this.plugin, p.file.path, this.field.name, input.value);
        inputContainer.hide();
      }
      if (e.key === "Escape") {
        inputContainer.hide();
        fieldValue.show();
        editBtn.show();
        if (!((_a2 = attrs.options) == null ? void 0 : _a2.alwaysOn))
          spacer.show();
      }
    };
    editBtn.onclick = () => {
      if (this.field.options.template) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian10.TFile && file.extension === "md") {
          const inputModal = new InputModal(this.plugin, file, this.field, p[this.field.name]);
          inputModal.open();
        }
      } else {
        inputContainer.show();
        input.focus();
      }
      fieldValue.hide();
      editBtn.hide();
      spacer.hide();
    };
  }
};

// src/modals/fields/BooleanModal.ts
var import_obsidian11 = require("obsidian");
var BooleanModal = class extends import_obsidian11.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.field = field;
  }
  onOpen() {
    this.containerEl.addClass("metadata-menu");
    this.containerEl.addClass("narrow");
    this.buildToggleEl();
  }
  buildToggleEl() {
    const choicesContainer = this.contentEl.createDiv({ cls: "value-container" });
    choicesContainer.createDiv({ cls: "spacer" });
    const trueButton = new import_obsidian11.ButtonComponent(choicesContainer);
    trueButton.setButtonText("True");
    choicesContainer.createDiv({ cls: "spacer" });
    const falseButton = new import_obsidian11.ButtonComponent(choicesContainer);
    falseButton.setButtonText("False");
    choicesContainer.createDiv({ cls: "spacer" });
    if (this.value) {
      trueButton.setCta();
      falseButton.removeCta();
    } else {
      falseButton.setCta();
      trueButton.removeCta();
    }
    falseButton.onClick(() => {
      this.value = false;
      falseButton.setCta();
      trueButton.removeCta();
    });
    trueButton.onClick(() => {
      this.value = true;
      trueButton.setCta();
      falseButton.removeCta();
    });
    const saveButton = new import_obsidian11.ButtonComponent(choicesContainer);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const value = this.value.toString();
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, value);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, value, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    }));
  }
};

// src/fields/fieldManagers/BooleanField.ts
var BooleanField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Boolean" /* Boolean */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    const bValue = BooleanField.stringToBoolean(value);
    const iconName = FieldIcon["Boolean" /* Boolean */];
    const action = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, (!bValue).toString());
      });
    });
    if (BooleanField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`<${name}> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (BooleanField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span><b>${name}</b> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}</span>`,
        action,
        icon: iconName
      });
    } else if (BooleanField.isFieldOptions(location)) {
      location.addOption(bValue ? "x-square" : "check-square", action, bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705");
    }
    ;
  }
  getOptionsStr() {
    return "";
  }
  createSettingContainer(parentContainer, plugin) {
  }
  validateValue(value) {
    try {
      const bValue = BooleanField.stringToBoolean(value);
      return isBoolean(bValue);
    } catch (error) {
      return false;
    }
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const bValue = BooleanField.stringToBoolean(value || "false");
    const fieldModal = new BooleanModal(this.plugin, file, this.field, bValue, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Set value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs) {
    const checkbox = dv.el("input", "", __spreadProps(__spreadValues({}, attrs), { "type": "checkbox" }));
    checkbox.checked = p[this.field.name];
    fieldContainer.appendChild(checkbox);
    checkbox.onchange = (value) => {
      BooleanField.replaceValues(this.plugin, p.file.path, this.field.name, checkbox.checked.toString());
    };
  }
};

// src/fields/fieldManagers/NumberField.ts
var import_obsidian13 = require("obsidian");

// src/modals/fields/NumberModal.ts
var import_obsidian12 = require("obsidian");
var NumberModal = class extends import_obsidian12.Modal {
  constructor(plugin, file, field, value, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    this.buildInputEl();
  }
  decrement(numberInput) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      numberInput.setValue((parseFloat(numberInput.getValue()) - fStep).toString());
    } else {
      numberInput.setValue((parseFloat(numberInput.getValue()) - 1).toString());
    }
  }
  increment(numberInput) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      numberInput.setValue((parseFloat(numberInput.getValue()) + fStep).toString());
    } else {
      numberInput.setValue((parseFloat(numberInput.getValue()) + 1).toString());
    }
  }
  toggleButtonsState(minusBtn, plusBtn, numberInput) {
    minusBtn.setDisabled(!this.fieldManager.canDecrement(numberInput.getValue()));
    plusBtn.setDisabled(!this.fieldManager.canIncrement(numberInput.getValue()));
    if (this.fieldManager.canDecrement(numberInput.getValue())) {
      minusBtn.setCta();
    } else {
      minusBtn.removeCta();
    }
    if (this.fieldManager.canIncrement(numberInput.getValue())) {
      plusBtn.setCta();
    } else {
      plusBtn.removeCta();
    }
  }
  buildInputEl() {
    const { step } = this.field.options;
    const fieldContainer = this.contentEl.createEl("div", { cls: "field-container" });
    const numberInput = new import_obsidian12.TextComponent(fieldContainer);
    numberInput.inputEl.focus();
    numberInput.setValue(`${this.value}`);
    const minusBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    minusBtn.setButtonText(`- ${!!step ? step : 1}`);
    minusBtn.setDisabled(!this.fieldManager.canDecrement(numberInput.getValue()));
    const plusBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    plusBtn.setButtonText(`+ ${!!step ? step : 1}`);
    plusBtn.setDisabled(!this.fieldManager.canIncrement(numberInput.getValue()));
    fieldContainer.createDiv({ cls: "spacer" });
    const validateBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    validateBtn.setIcon("checkmark");
    const cancelBtn = new import_obsidian12.ButtonComponent(fieldContainer);
    cancelBtn.setIcon("cross");
    const errorField = this.contentEl.createEl("div", { cls: "field-error" });
    errorField.hide();
    this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    numberInput.onChange(() => {
      numberInput.inputEl.removeClass("is-invalid");
      errorField.hide();
      errorField.setText("");
      this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    });
    plusBtn.onClick((e) => {
      e.preventDefault();
      this.increment(numberInput);
      this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    });
    minusBtn.onClick((e) => {
      e.preventDefault();
      this.decrement(numberInput);
      this.toggleButtonsState(minusBtn, plusBtn, numberInput);
    });
    cancelBtn.onClick((e) => {
      e.preventDefault();
      this.close();
    });
    validateBtn.onClick(() => __async(this, null, function* () {
      let inputValue = numberInput.getValue();
      if (!this.fieldManager.validateValue(inputValue)) {
        const { min: min2, max: max2 } = this.field.options;
        errorField.show();
        errorField.setText(`value must be numeric${min2 ? " and >= " + min2 : ""} ${max2 ? " and <= " + max2 : ""}`);
        numberInput.inputEl.setAttr("class", "is-invalid");
        return;
      }
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, inputValue);
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    }));
  }
};

// src/fields/fieldManagers/NumberField.ts
var NumberField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Number" /* Number */);
  }
  getOptionsStr() {
    const options = [];
    Object.keys(this.field.options).forEach((k) => {
      if (this.field.options[k])
        options.push(`${k}: ${this.field.options[k]}`);
    });
    return options.join(" | ");
  }
  canDecrement(value) {
    const { step, min: min2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMin = parseFloat(min2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMin) && (!isNaN(fStep) && (parseFloat(value) - fStep < fMin || parseFloat(value) - 1 < fMin)));
  }
  canIncrement(value) {
    const { step, max: max2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMax = parseFloat(max2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMax) && (!isNaN(fStep) && (parseFloat(value) + fStep > fMax || parseFloat(value) + 1 > fMax)));
  }
  validateValue(value) {
    const { min: min2, max: max2 } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fValue = parseFloat(value);
    return !isNaN(fValue) && (isNaN(fMin) || fValue >= fMin) && (isNaN(fMax) || fValue <= fMax);
  }
  addFieldOption(name, value, file, location) {
    const modal = new NumberModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    const { min: min2, max: max2, step } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fStep = parseFloat(step);
    const fValue = parseFloat(value);
    const canDecrease = !isNaN(fMin) && fValue - fStep >= fMin;
    const canIncrease = !isNaN(fMax) && fValue + fStep <= fMax;
    const action = () => modal.open();
    const decrease = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, (fValue - fStep).toString());
      });
    });
    const increase = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, (fValue + fStep).toString());
      });
    });
    if (NumberField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Number" /* Number */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
      if (fStep) {
        if (canDecrease)
          location.addItem((item) => {
            item.setIcon("minus-square");
            item.setTitle(`<${name}> \u2198\uFE0F ${fValue - fStep}`);
            item.onClick(decrease);
            item.setSection("metadata-menu.fields");
          });
        if (canIncrease)
          location.addItem((item) => {
            item.setIcon("plus-square");
            item.setTitle(`<${name}> \u2197\uFE0F ${fValue + fStep}`);
            item.onClick(increase);
            item.setSection("metadata-menu.fields");
          });
      }
    } else if (NumberField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Number" /* Number */]
      });
    } else if (NumberField.isFieldOptions(location)) {
      if (step) {
        if (canDecrease) {
          location.addOption("minus-square", decrease, `Decrease ${name} by ${step}`);
        }
        if (canIncrease) {
          location.addOption("plus-square", increase, `Increase ${name} by ${step}`);
        }
      }
      location.addOption(FieldIcon["Number" /* Number */], action, `Update ${name}'s value`);
    }
    ;
  }
  createNumberContainer(container) {
    const numberStepValueContainer = container.createDiv({ cls: "field-container" });
    numberStepValueContainer.createEl("span", { text: "Step (optional)", cls: "label" });
    numberStepValueContainer.createDiv({ cls: "spacer" });
    this.numberStepValue = new import_obsidian13.TextComponent(numberStepValueContainer);
    this.numberStepValue.inputEl.addClass("with-label");
    this.numberStepValue.setValue(this.field.options.step || "");
    const numberMinValueContainer = container.createDiv({ cls: "field-container" });
    numberMinValueContainer.createEl("span", { text: "Min value (optional)", cls: "label" });
    this.numberMinValue = new import_obsidian13.TextComponent(numberMinValueContainer);
    this.numberMinValue.inputEl.addClass("full-width");
    this.numberMinValue.inputEl.addClass("with-label");
    this.numberMinValue.setValue(this.field.options.min || "");
    const numberMaxValueContainer = container.createDiv({ cls: "field-container" });
    numberMaxValueContainer.createEl("span", { text: "Max value (optional)", cls: "label" });
    this.numberMaxValue = new import_obsidian13.TextComponent(numberMaxValueContainer);
    this.numberMaxValue.inputEl.addClass("full-width");
    this.numberMaxValue.inputEl.addClass("with-label");
    this.numberMaxValue.setValue(this.field.options.max || "");
    this.numberStepValue.onChange((value) => {
      this.field.options.step = value;
      FieldSettingsModal.removeValidationError(this.numberStepValue);
    });
    this.numberMinValue.onChange((value) => {
      this.field.options.min = value;
      FieldSettingsModal.removeValidationError(this.numberMinValue);
    });
    this.numberMaxValue.onChange((value) => {
      this.field.options.max = value;
      FieldSettingsModal.removeValidationError(this.numberMaxValue);
    });
  }
  createSettingContainer(container, plugin) {
    this.createNumberContainer(container);
  }
  validateOptions() {
    let error = false;
    if (this.field.options.step && isNaN(parseFloat(this.field.options.step))) {
      FieldSettingsModal.setValidationError(this.numberStepValue, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.min && isNaN(parseFloat(this.field.options.min))) {
      FieldSettingsModal.setValidationError(this.numberMinValue, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.max && isNaN(parseFloat(this.field.options.max))) {
      FieldSettingsModal.setValidationError(this.numberMaxValue, "Values must be numeric.");
      error = true;
    }
    return !error;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new NumberModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  toggleDvButtons(decrementBtn, incrementBtn, value) {
    if (this.canDecrement(value)) {
      decrementBtn.removeClass("disabled");
    } else {
      decrementBtn.addClass("disabled");
    }
    if (this.canIncrement(value)) {
      incrementBtn.removeClass("disabled");
    } else {
      incrementBtn.addClass("disabled");
      ;
    }
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    fieldContainer.appendChild(fieldValue);
    const inputContainer = fieldContainer.createDiv({});
    const input = inputContainer.createEl("input");
    input.value = p[this.field.name];
    const tripleSpacer = fieldContainer.createDiv({ cls: "spacer-3" });
    const editButton = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(editButton, FieldIcon["Number" /* Number */]);
    const decrementButton = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(decrementButton, "left-arrow");
    const incrementButton = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(incrementButton, "right-arrow");
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      editButton.hide();
      decrementButton.hide();
      incrementButton.hide();
      tripleSpacer.show();
      fieldContainer.onmouseover = () => {
        editButton.show();
        decrementButton.show();
        incrementButton.show();
        tripleSpacer.hide();
      };
      fieldContainer.onmouseout = () => {
        editButton.hide();
        decrementButton.hide();
        incrementButton.hide();
        tripleSpacer.show();
      };
    }
    const validateIcon = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(validateIcon, "checkmark");
    validateIcon.onclick = () => __async(this, null, function* () {
      if (this.validateValue(input.value)) {
        const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, input.value);
          });
          this.toggleDvButtons(decrementButton, incrementButton, input.value);
        }
        fieldContainer.removeChild(inputContainer);
      }
    });
    inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
    const cancelIcon = fieldContainer.createEl("button");
    (0, import_obsidian13.setIcon)(cancelIcon, "cross");
    cancelIcon.onclick = (e) => {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(decrementButton);
      fieldContainer.appendChild(editButton);
      fieldContainer.appendChild(incrementButton);
      fieldContainer.appendChild(tripleSpacer);
    };
    inputContainer.appendChild(cancelIcon);
    input.focus();
    input.onkeyup = (e) => {
      if (!this.validateValue(input.value)) {
        input.addClass("is-invalid");
        validateIcon.addClass("disabled");
      } else {
        input.removeClass("is-invalid");
        validateIcon.removeClass("disabled");
      }
    };
    input.onkeydown = (e) => __async(this, null, function* () {
      if (e.key === "Enter") {
        if (this.validateValue(input.value)) {
          const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
          if (file instanceof import_obsidian13.TFile && file.extension == "md") {
            yield this.plugin.fileTaskManager.pushTask(() => {
              replaceValues(this.plugin, file, this.field.name, input.value);
            });
            this.toggleDvButtons(decrementButton, incrementButton, input.value);
          }
          fieldContainer.removeChild(inputContainer);
        }
      }
      if (e.key === "Escape") {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(decrementButton);
        fieldContainer.appendChild(editButton);
        fieldContainer.appendChild(incrementButton);
        fieldContainer.appendChild(tripleSpacer);
      }
    });
    editButton.onclick = () => {
      fieldContainer.removeChild(fieldValue);
      fieldContainer.removeChild(editButton);
      fieldContainer.removeChild(decrementButton);
      fieldContainer.removeChild(incrementButton);
      fieldContainer.removeChild(tripleSpacer);
      fieldContainer.appendChild(inputContainer);
      input.focus();
    };
    decrementButton.onclick = () => __async(this, null, function* () {
      if (this.canDecrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] - fStep : p[this.field.name] - 1).toString();
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, newValue);
          });
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    incrementButton.onclick = () => __async(this, null, function* () {
      if (this.canIncrement(p[this.field.name])) {
        const { step } = this.field.options;
        const fStep = parseFloat(step);
        const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
        if (file instanceof import_obsidian13.TFile && file.extension == "md") {
          const newValue = (!!fStep ? p[this.field.name] + fStep : p[this.field.name] + 1).toString();
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, file, this.field.name, newValue);
          });
          this.toggleDvButtons(decrementButton, incrementButton, newValue);
        }
      }
    });
    fieldContainer.removeChild(inputContainer);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(decrementButton);
    fieldContainer.appendChild(editButton);
    fieldContainer.appendChild(incrementButton);
    fieldContainer.appendChild(tripleSpacer);
    this.toggleDvButtons(decrementButton, incrementButton, p[this.field.name]);
  }
};

// src/fields/fieldManagers/SelectField.ts
var import_obsidian19 = require("obsidian");

// src/modals/fields/SelectModal.ts
var import_obsidian14 = require("obsidian");

// src/types/selectValuesSourceTypes.ts
var Type2 = /* @__PURE__ */ ((Type3) => {
  Type3["ValuesList"] = "ValuesList";
  Type3["ValuesListNotePath"] = "ValuesListNotePath";
  Type3["ValuesFromDVQuery"] = "ValuesFromDVQuery";
  return Type3;
})(Type2 || {});
var Key = {
  "ValuesList": "valuesList",
  "ValuesListNotePath": "valuesListNotePath",
  "ValuesFromDVQuery": "valuesFromDVQuery"
};
var typeDisplay = {
  "ValuesList": "Values defined in these settings",
  "ValuesListNotePath": "Values from a note",
  "ValuesFromDVQuery": "Values returned from a dataview query"
};

// src/modals/fields/SelectModal.ts
var ValueSuggestModal = class extends import_obsidian14.SuggestModal {
  constructor(plugin, file, value, field, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.value = value;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(ValueSuggestModal.prototype, this, "onOpen").call(this);
      const inputContainer = this.containerEl.createDiv({ cls: "suggester-input" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "footer-actions" });
      buttonContainer.createDiv({ cls: "spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "info" });
      infoContainer.setText("Shift+Enter to save");
      this.addButton = new import_obsidian14.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => this.addNewValueToSettings());
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      const cancelButton = new import_obsidian14.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => this.close());
      cancelButton.setTooltip("Cancel");
      const clearButton = new import_obsidian14.ButtonComponent(buttonContainer);
      clearButton.setIcon("eraser");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("danger");
      clearButton.setTooltip("Clear the field value");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      var _a, _b;
      const newValue = this.inputEl.value;
      const fileClassName = (_b = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field) => field.name === this.field.name)) == null ? void 0 : _b.fileClassName;
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length + 1}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian14.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian14.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.saveItem(newValue);
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("value-container");
    if (value === this.value)
      el.addClass("value-checked");
  }
  saveItem(item) {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, item.toString());
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, item.toString(), this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  onChooseSuggestion(item, evt) {
    return __async(this, null, function* () {
      this.saveItem(item);
    });
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var import_obsidian18 = require("obsidian");

// src/suggester/FileSuggester.ts
var import_obsidian17 = require("obsidian");

// src/suggester/suggest.ts
var import_obsidian15 = require("obsidian");

// node_modules/@popperjs/core/lib/enums.js
var top = "top";
var bottom = "bottom";
var right = "right";
var left = "left";
var auto = "auto";
var basePlacements = [top, bottom, right, left];
var start = "start";
var end = "end";
var clippingParents = "clippingParents";
var viewport = "viewport";
var popper = "popper";
var reference = "reference";
var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []);
var beforeRead = "beforeRead";
var read = "read";
var afterRead = "afterRead";
var beforeMain = "beforeMain";
var main = "main";
var afterMain = "afterMain";
var beforeWrite = "beforeWrite";
var write = "write";
var afterWrite = "afterWrite";
var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];

// node_modules/@popperjs/core/lib/dom-utils/getNodeName.js
function getNodeName(element) {
  return element ? (element.nodeName || "").toLowerCase() : null;
}

// node_modules/@popperjs/core/lib/dom-utils/getWindow.js
function getWindow(node) {
  if (node == null) {
    return window;
  }
  if (node.toString() !== "[object Window]") {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }
  return node;
}

// node_modules/@popperjs/core/lib/dom-utils/instanceOf.js
function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}
function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}
function isShadowRoot(node) {
  if (typeof ShadowRoot === "undefined") {
    return false;
  }
  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

// node_modules/@popperjs/core/lib/modifiers/applyStyles.js
function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function(name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name];
    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    }
    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function(name2) {
      var value = attributes[name2];
      if (value === false) {
        element.removeAttribute(name2);
      } else {
        element.setAttribute(name2, value === true ? "" : value);
      }
    });
  });
}
function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: "0",
      top: "0",
      margin: "0"
    },
    arrow: {
      position: "absolute"
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;
  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }
  return function() {
    Object.keys(state.elements).forEach(function(name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
      var style = styleProperties.reduce(function(style2, property) {
        style2[property] = "";
        return style2;
      }, {});
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
}
var applyStyles_default = {
  name: "applyStyles",
  enabled: true,
  phase: "write",
  fn: applyStyles,
  effect,
  requires: ["computeStyles"]
};

// node_modules/@popperjs/core/lib/utils/getBasePlacement.js
function getBasePlacement(placement) {
  return placement.split("-")[0];
}

// node_modules/@popperjs/core/lib/utils/math.js
var max = Math.max;
var min = Math.min;
var round = Math.round;

// node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js
function getBoundingClientRect(element, includeScale) {
  if (includeScale === void 0) {
    includeScale = false;
  }
  var rect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;
  if (isHTMLElement(element) && includeScale) {
    var offsetHeight = element.offsetHeight;
    var offsetWidth = element.offsetWidth;
    if (offsetWidth > 0) {
      scaleX = round(rect.width) / offsetWidth || 1;
    }
    if (offsetHeight > 0) {
      scaleY = round(rect.height) / offsetHeight || 1;
    }
  }
  return {
    width: rect.width / scaleX,
    height: rect.height / scaleY,
    top: rect.top / scaleY,
    right: rect.right / scaleX,
    bottom: rect.bottom / scaleY,
    left: rect.left / scaleX,
    x: rect.left / scaleX,
    y: rect.top / scaleY
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js
function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element);
  var width = element.offsetWidth;
  var height = element.offsetHeight;
  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }
  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }
  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width,
    height
  };
}

// node_modules/@popperjs/core/lib/dom-utils/contains.js
function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode();
  if (parent.contains(child)) {
    return true;
  } else if (rootNode && isShadowRoot(rootNode)) {
    var next = child;
    do {
      if (next && parent.isSameNode(next)) {
        return true;
      }
      next = next.parentNode || next.host;
    } while (next);
  }
  return false;
}

// node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js
function getComputedStyle(element) {
  return getWindow(element).getComputedStyle(element);
}

// node_modules/@popperjs/core/lib/dom-utils/isTableElement.js
function isTableElement(element) {
  return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js
function getDocumentElement(element) {
  return ((isElement(element) ? element.ownerDocument : element.document) || window.document).documentElement;
}

// node_modules/@popperjs/core/lib/dom-utils/getParentNode.js
function getParentNode(element) {
  if (getNodeName(element) === "html") {
    return element;
  }
  return element.assignedSlot || element.parentNode || (isShadowRoot(element) ? element.host : null) || getDocumentElement(element);
}

// node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js
function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || getComputedStyle(element).position === "fixed") {
    return null;
  }
  return element.offsetParent;
}
function getContainingBlock(element) {
  var isFirefox = navigator.userAgent.toLowerCase().indexOf("firefox") !== -1;
  var isIE = navigator.userAgent.indexOf("Trident") !== -1;
  if (isIE && isHTMLElement(element)) {
    var elementCss = getComputedStyle(element);
    if (elementCss.position === "fixed") {
      return null;
    }
  }
  var currentNode = getParentNode(element);
  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }
  while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle(currentNode);
    if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }
  return null;
}
function getOffsetParent(element) {
  var window2 = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);
  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === "static") {
    offsetParent = getTrueOffsetParent(offsetParent);
  }
  if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle(offsetParent).position === "static")) {
    return window2;
  }
  return offsetParent || getContainingBlock(element) || window2;
}

// node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js
function getMainAxisFromPlacement(placement) {
  return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
}

// node_modules/@popperjs/core/lib/utils/within.js
function within(min2, value, max2) {
  return max(min2, min(value, max2));
}
function withinMaxClamp(min2, value, max2) {
  var v = within(min2, value, max2);
  return v > max2 ? max2 : v;
}

// node_modules/@popperjs/core/lib/utils/getFreshSideObject.js
function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}

// node_modules/@popperjs/core/lib/utils/mergePaddingObject.js
function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}

// node_modules/@popperjs/core/lib/utils/expandToHashMap.js
function expandToHashMap(value, keys) {
  return keys.reduce(function(hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}

// node_modules/@popperjs/core/lib/modifiers/arrow.js
var toPaddingObject = function toPaddingObject2(padding, state) {
  padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
};
function arrow(_ref) {
  var _state$modifiersData$;
  var state = _ref.state, name = _ref.name, options = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? "height" : "width";
  if (!arrowElement || !popperOffsets2) {
    return;
  }
  var paddingObject = toPaddingObject(options.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === "y" ? top : left;
  var maxProp = axis === "y" ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
  var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2;
  var min2 = paddingObject[minProp];
  var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset2 = within(min2, center, max2);
  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
}
function effect2(_ref2) {
  var state = _ref2.state, options = _ref2.options;
  var _options$element = options.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
  if (arrowElement == null) {
    return;
  }
  if (typeof arrowElement === "string") {
    arrowElement = state.elements.popper.querySelector(arrowElement);
    if (!arrowElement) {
      return;
    }
  }
  if (true) {
    if (!isHTMLElement(arrowElement)) {
      console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).', "To use an SVG arrow, wrap it in an HTMLElement that will be used as", "the arrow."].join(" "));
    }
  }
  if (!contains(state.elements.popper, arrowElement)) {
    if (true) {
      console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper', "element."].join(" "));
    }
    return;
  }
  state.elements.arrow = arrowElement;
}
var arrow_default = {
  name: "arrow",
  enabled: true,
  phase: "main",
  fn: arrow,
  effect: effect2,
  requires: ["popperOffsets"],
  requiresIfExists: ["preventOverflow"]
};

// node_modules/@popperjs/core/lib/utils/getVariation.js
function getVariation(placement) {
  return placement.split("-")[1];
}

// node_modules/@popperjs/core/lib/modifiers/computeStyles.js
var unsetSides = {
  top: "auto",
  right: "auto",
  bottom: "auto",
  left: "auto"
};
function roundOffsetsByDPR(_ref) {
  var x = _ref.x, y = _ref.y;
  var win = window;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}
function mapToStyles(_ref2) {
  var _Object$assign2;
  var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, variation = _ref2.variation, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets, isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x, x = _offsets$x === void 0 ? 0 : _offsets$x, _offsets$y = offsets.y, y = _offsets$y === void 0 ? 0 : _offsets$y;
  var _ref3 = typeof roundOffsets === "function" ? roundOffsets({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty("x");
  var hasY = offsets.hasOwnProperty("y");
  var sideX = left;
  var sideY = top;
  var win = window;
  if (adaptive) {
    var offsetParent = getOffsetParent(popper2);
    var heightProp = "clientHeight";
    var widthProp = "clientWidth";
    if (offsetParent === getWindow(popper2)) {
      offsetParent = getDocumentElement(popper2);
      if (getComputedStyle(offsetParent).position !== "static" && position === "absolute") {
        heightProp = "scrollHeight";
        widthProp = "scrollWidth";
      }
    }
    offsetParent = offsetParent;
    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : offsetParent[heightProp];
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }
    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : offsetParent[widthProp];
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }
  var commonStyles = Object.assign({
    position
  }, adaptive && unsetSides);
  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref4.x;
  y = _ref4.y;
  if (gpuAcceleration) {
    var _Object$assign;
    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }
  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
}
function computeStyles(_ref5) {
  var state = _ref5.state, options = _ref5.options;
  var _options$gpuAccelerat = options.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
  if (true) {
    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || "";
    if (adaptive && ["transform", "top", "right", "bottom", "left"].some(function(property) {
      return transitionProperty.indexOf(property) >= 0;
    })) {
      console.warn(["Popper: Detected CSS transitions on at least one of the following", 'CSS properties: "transform", "top", "right", "bottom", "left".', "\n\n", 'Disable the "computeStyles" modifier\'s `adaptive` option to allow', "for smooth transitions, or remove these properties from the CSS", "transition declaration on the popper element if only transitioning", "opacity or background-color for example.", "\n\n", "We recommend using the popper element as a wrapper around an inner", "element that can have any CSS property transitioned for animations."].join(" "));
    }
  }
  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration,
    isFixed: state.options.strategy === "fixed"
  };
  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive,
      roundOffsets
    })));
  }
  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: "absolute",
      adaptive: false,
      roundOffsets
    })));
  }
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-placement": state.placement
  });
}
var computeStyles_default = {
  name: "computeStyles",
  enabled: true,
  phase: "beforeWrite",
  fn: computeStyles,
  data: {}
};

// node_modules/@popperjs/core/lib/modifiers/eventListeners.js
var passive = {
  passive: true
};
function effect3(_ref) {
  var state = _ref.state, instance = _ref.instance, options = _ref.options;
  var _options$scroll = options.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options.resize, resize = _options$resize === void 0 ? true : _options$resize;
  var window2 = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
  if (scroll) {
    scrollParents.forEach(function(scrollParent) {
      scrollParent.addEventListener("scroll", instance.update, passive);
    });
  }
  if (resize) {
    window2.addEventListener("resize", instance.update, passive);
  }
  return function() {
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.removeEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.removeEventListener("resize", instance.update, passive);
    }
  };
}
var eventListeners_default = {
  name: "eventListeners",
  enabled: true,
  phase: "write",
  fn: function fn() {
  },
  effect: effect3,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getOppositePlacement.js
var hash = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function(matched) {
    return hash[matched];
  });
}

// node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js
var hash2 = {
  start: "end",
  end: "start"
};
function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function(matched) {
    return hash2[matched];
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js
function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft,
    scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js
function getWindowScrollBarX(element) {
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}

// node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js
function getViewportRect(element) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;
  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    if (!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }
  return {
    width,
    height,
    x: x + getWindowScrollBarX(element),
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js
function getDocumentRect(element) {
  var _element$ownerDocumen;
  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;
  if (getComputedStyle(body || html).direction === "rtl") {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }
  return {
    width,
    height,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js
function isScrollParent(element) {
  var _getComputedStyle = getComputedStyle(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}

// node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js
function getScrollParent(node) {
  if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
    return node.ownerDocument.body;
  }
  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }
  return getScrollParent(getParentNode(node));
}

// node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js
function listScrollParents(element, list) {
  var _element$ownerDocumen;
  if (list === void 0) {
    list = [];
  }
  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : updatedList.concat(listScrollParents(getParentNode(target)));
}

// node_modules/@popperjs/core/lib/utils/rectToClientRect.js
function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js
function getInnerBoundingClientRect(element) {
  var rect = getBoundingClientRect(element);
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}
function getClientRectFromMixedType(element, clippingParent) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
}
function getClippingParents(element) {
  var clippingParents2 = listScrollParents(getParentNode(element));
  var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
  if (!isElement(clipperElement)) {
    return [];
  }
  return clippingParents2.filter(function(clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
  });
}
function getClippingRect(element, boundary, rootBoundary) {
  var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
  var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents2[0];
  var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}

// node_modules/@popperjs/core/lib/utils/computeOffsets.js
function computeOffsets(_ref) {
  var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference2.x + reference2.width / 2 - element.width / 2;
  var commonY = reference2.y + reference2.height / 2 - element.height / 2;
  var offsets;
  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference2.y - element.height
      };
      break;
    case bottom:
      offsets = {
        x: commonX,
        y: reference2.y + reference2.height
      };
      break;
    case right:
      offsets = {
        x: reference2.x + reference2.width,
        y: commonY
      };
      break;
    case left:
      offsets = {
        x: reference2.x - element.width,
        y: commonY
      };
      break;
    default:
      offsets = {
        x: reference2.x,
        y: reference2.y
      };
  }
  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
  if (mainAxis != null) {
    var len = mainAxis === "y" ? "height" : "width";
    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
        break;
      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
        break;
      default:
    }
  }
  return offsets;
}

// node_modules/@popperjs/core/lib/utils/detectOverflow.js
function detectOverflow(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets2 = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: "absolute",
    placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset;
  if (elementContext === popper && offsetData) {
    var offset2 = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function(key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
      overflowOffsets[key] += offset2[axis] * multiply;
    });
  }
  return overflowOffsets;
}

// node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js
function computeAutoPlacement(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements2 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
    return getVariation(placement2) === variation;
  }) : basePlacements;
  var allowedPlacements = placements2.filter(function(placement2) {
    return allowedAutoPlacements.indexOf(placement2) >= 0;
  });
  if (allowedPlacements.length === 0) {
    allowedPlacements = placements2;
    if (true) {
      console.error(["Popper: The `allowedAutoPlacements` option did not allow any", "placements. Ensure the `placement` option matches the variation", "of the allowed placements.", 'For example, "auto" cannot be used to allow "bottom-start".', 'Use "auto-start" instead.'].join(" "));
    }
  }
  var overflows = allowedPlacements.reduce(function(acc, placement2) {
    acc[placement2] = detectOverflow(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding
    })[getBasePlacement(placement2)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function(a, b) {
    return overflows[a] - overflows[b];
  });
}

// node_modules/@popperjs/core/lib/modifiers/flip.js
function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }
  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}
function flip(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  if (state.modifiersData[name]._skip) {
    return;
  }
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options.fallbackPlacements, padding = options.padding, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, _options$flipVariatio = options.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
    return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding,
      flipVariations,
      allowedAutoPlacements
    }) : placement2);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = /* @__PURE__ */ new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements2[0];
  for (var i = 0; i < placements2.length; i++) {
    var placement = placements2[i];
    var _basePlacement = getBasePlacement(placement);
    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? "width" : "height";
    var overflow = detectOverflow(state, {
      placement,
      boundary,
      rootBoundary,
      altBoundary,
      padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }
    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];
    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }
    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }
    if (checks.every(function(check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }
    checksMap.set(placement, checks);
  }
  if (makeFallbackChecks) {
    var numberOfChecks = flipVariations ? 3 : 1;
    var _loop = function _loop2(_i2) {
      var fittingPlacement = placements2.find(function(placement2) {
        var checks2 = checksMap.get(placement2);
        if (checks2) {
          return checks2.slice(0, _i2).every(function(check) {
            return check;
          });
        }
      });
      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };
    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);
      if (_ret === "break")
        break;
    }
  }
  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
}
var flip_default = {
  name: "flip",
  enabled: true,
  phase: "main",
  fn: flip,
  requiresIfExists: ["offset"],
  data: {
    _skip: false
  }
};

// node_modules/@popperjs/core/lib/modifiers/hide.js
function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }
  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}
function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function(side) {
    return overflow[side] >= 0;
  });
}
function hide(_ref) {
  var state = _ref.state, name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: "reference"
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets,
    popperEscapeOffsets,
    isReferenceHidden,
    hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-reference-hidden": isReferenceHidden,
    "data-popper-escaped": hasPopperEscaped
  });
}
var hide_default = {
  name: "hide",
  enabled: true,
  phase: "main",
  requiresIfExists: ["preventOverflow"],
  fn: hide
};

// node_modules/@popperjs/core/lib/modifiers/offset.js
function distanceAndSkiddingToXY(placement, rects, offset2) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
  var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
    placement
  })) : offset2, skidding = _ref[0], distance = _ref[1];
  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}
function offset(_ref2) {
  var state = _ref2.state, options = _ref2.options, name = _ref2.name;
  var _options$offset = options.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function(acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }
  state.modifiersData[name] = data;
}
var offset_default = {
  name: "offset",
  enabled: true,
  phase: "main",
  requires: ["popperOffsets"],
  fn: offset
};

// node_modules/@popperjs/core/lib/modifiers/popperOffsets.js
function popperOffsets(_ref) {
  var state = _ref.state, name = _ref.name;
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: "absolute",
    placement: state.placement
  });
}
var popperOffsets_default = {
  name: "popperOffsets",
  enabled: true,
  phase: "read",
  fn: popperOffsets,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getAltAxis.js
function getAltAxis(axis) {
  return axis === "x" ? "y" : "x";
}

// node_modules/@popperjs/core/lib/modifiers/preventOverflow.js
function preventOverflow(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, padding = options.padding, _options$tether = options.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary,
    rootBoundary,
    padding,
    altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === "number" ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };
  if (!popperOffsets2) {
    return;
  }
  if (checkMainAxis) {
    var _offsetModifierState$;
    var mainSide = mainAxis === "y" ? top : left;
    var altSide = mainAxis === "y" ? bottom : right;
    var len = mainAxis === "y" ? "height" : "width";
    var offset2 = popperOffsets2[mainAxis];
    var min2 = offset2 + overflow[mainSide];
    var max2 = offset2 - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide];
    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset2 + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset2 + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? min(min2, tetherMin) : min2, offset2, tether ? max(max2, tetherMax) : max2);
    popperOffsets2[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset2;
  }
  if (checkAltAxis) {
    var _offsetModifierState$2;
    var _mainSide = mainAxis === "x" ? top : left;
    var _altSide = mainAxis === "x" ? bottom : right;
    var _offset = popperOffsets2[altAxis];
    var _len = altAxis === "y" ? "height" : "width";
    var _min = _offset + overflow[_mainSide];
    var _max = _offset - overflow[_altSide];
    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;
    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;
    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;
    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;
    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);
    popperOffsets2[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }
  state.modifiersData[name] = data;
}
var preventOverflow_default = {
  name: "preventOverflow",
  enabled: true,
  phase: "main",
  fn: preventOverflow,
  requiresIfExists: ["offset"]
};

// node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js
function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js
function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}

// node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js
function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
}
function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }
  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };
  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== "body" || isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }
    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }
  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}

// node_modules/@popperjs/core/lib/utils/orderModifiers.js
function order(modifiers) {
  var map = /* @__PURE__ */ new Map();
  var visited = /* @__PURE__ */ new Set();
  var result = [];
  modifiers.forEach(function(modifier) {
    map.set(modifier.name, modifier);
  });
  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function(dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);
        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }
  modifiers.forEach(function(modifier) {
    if (!visited.has(modifier.name)) {
      sort(modifier);
    }
  });
  return result;
}
function orderModifiers(modifiers) {
  var orderedModifiers = order(modifiers);
  return modifierPhases.reduce(function(acc, phase) {
    return acc.concat(orderedModifiers.filter(function(modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}

// node_modules/@popperjs/core/lib/utils/debounce.js
function debounce(fn2) {
  var pending;
  return function() {
    if (!pending) {
      pending = new Promise(function(resolve) {
        Promise.resolve().then(function() {
          pending = void 0;
          resolve(fn2());
        });
      });
    }
    return pending;
  };
}

// node_modules/@popperjs/core/lib/utils/format.js
function format(str) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }
  return [].concat(args).reduce(function(p, c) {
    return p.replace(/%s/, c);
  }, str);
}

// node_modules/@popperjs/core/lib/utils/validateModifiers.js
var INVALID_MODIFIER_ERROR = 'Popper: modifier "%s" provided an invalid %s property, expected %s but got %s';
var MISSING_DEPENDENCY_ERROR = 'Popper: modifier "%s" requires "%s", but "%s" modifier is not available';
var VALID_PROPERTIES = ["name", "enabled", "phase", "fn", "effect", "requires", "options"];
function validateModifiers(modifiers) {
  modifiers.forEach(function(modifier) {
    [].concat(Object.keys(modifier), VALID_PROPERTIES).filter(function(value, index, self) {
      return self.indexOf(value) === index;
    }).forEach(function(key) {
      switch (key) {
        case "name":
          if (typeof modifier.name !== "string") {
            console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '"name"', '"string"', '"' + String(modifier.name) + '"'));
          }
          break;
        case "enabled":
          if (typeof modifier.enabled !== "boolean") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"enabled"', '"boolean"', '"' + String(modifier.enabled) + '"'));
          }
          break;
        case "phase":
          if (modifierPhases.indexOf(modifier.phase) < 0) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"phase"', "either " + modifierPhases.join(", "), '"' + String(modifier.phase) + '"'));
          }
          break;
        case "fn":
          if (typeof modifier.fn !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"fn"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "effect":
          if (modifier.effect != null && typeof modifier.effect !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"effect"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "requires":
          if (modifier.requires != null && !Array.isArray(modifier.requires)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requires"', '"array"', '"' + String(modifier.requires) + '"'));
          }
          break;
        case "requiresIfExists":
          if (!Array.isArray(modifier.requiresIfExists)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requiresIfExists"', '"array"', '"' + String(modifier.requiresIfExists) + '"'));
          }
          break;
        case "options":
        case "data":
          break;
        default:
          console.error('PopperJS: an invalid property has been provided to the "' + modifier.name + '" modifier, valid properties are ' + VALID_PROPERTIES.map(function(s) {
            return '"' + s + '"';
          }).join(", ") + '; but "' + key + '" was provided.');
      }
      modifier.requires && modifier.requires.forEach(function(requirement) {
        if (modifiers.find(function(mod) {
          return mod.name === requirement;
        }) == null) {
          console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));
        }
      });
    });
  });
}

// node_modules/@popperjs/core/lib/utils/uniqueBy.js
function uniqueBy(arr, fn2) {
  var identifiers = /* @__PURE__ */ new Set();
  return arr.filter(function(item) {
    var identifier = fn2(item);
    if (!identifiers.has(identifier)) {
      identifiers.add(identifier);
      return true;
    }
  });
}

// node_modules/@popperjs/core/lib/utils/mergeByName.js
function mergeByName(modifiers) {
  var merged = modifiers.reduce(function(merged2, current) {
    var existing = merged2[current.name];
    merged2[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged2;
  }, {});
  return Object.keys(merged).map(function(key) {
    return merged[key];
  });
}

// node_modules/@popperjs/core/lib/createPopper.js
var INVALID_ELEMENT_ERROR = "Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.";
var INFINITE_LOOP_ERROR = "Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.";
var DEFAULT_OPTIONS = {
  placement: "bottom",
  modifiers: [],
  strategy: "absolute"
};
function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  return !args.some(function(element) {
    return !(element && typeof element.getBoundingClientRect === "function");
  });
}
function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }
  var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper2(reference2, popper2, options) {
    if (options === void 0) {
      options = defaultOptions;
    }
    var state = {
      placement: "bottom",
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference2,
        popper: popper2
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state,
      setOptions: function setOptions(setOptionsAction) {
        var options2 = typeof setOptionsAction === "function" ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options2);
        state.scrollParents = {
          reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
          popper: listScrollParents(popper2)
        };
        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
        state.orderedModifiers = orderedModifiers.filter(function(m) {
          return m.enabled;
        });
        if (true) {
          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function(_ref) {
            var name = _ref.name;
            return name;
          });
          validateModifiers(modifiers);
          if (getBasePlacement(state.options.placement) === auto) {
            var flipModifier = state.orderedModifiers.find(function(_ref2) {
              var name = _ref2.name;
              return name === "flip";
            });
            if (!flipModifier) {
              console.error(['Popper: "auto" placements require the "flip" modifier be', "present and enabled to work."].join(" "));
            }
          }
          var _getComputedStyle = getComputedStyle(popper2), marginTop = _getComputedStyle.marginTop, marginRight = _getComputedStyle.marginRight, marginBottom = _getComputedStyle.marginBottom, marginLeft = _getComputedStyle.marginLeft;
          if ([marginTop, marginRight, marginBottom, marginLeft].some(function(margin) {
            return parseFloat(margin);
          })) {
            console.warn(['Popper: CSS "margin" styles cannot be used to apply padding', "between the popper and its reference element or boundary.", "To replicate margin, use the `offset` modifier, as well as", "the `padding` option in the `preventOverflow` and `flip`", "modifiers."].join(" "));
          }
        }
        runModifierEffects();
        return instance.update();
      },
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }
        var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
        if (!areValidElements(reference3, popper3)) {
          if (true) {
            console.error(INVALID_ELEMENT_ERROR);
          }
          return;
        }
        state.rects = {
          reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
          popper: getLayoutRect(popper3)
        };
        state.reset = false;
        state.placement = state.options.placement;
        state.orderedModifiers.forEach(function(modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        var __debug_loops__ = 0;
        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (true) {
            __debug_loops__ += 1;
            if (__debug_loops__ > 100) {
              console.error(INFINITE_LOOP_ERROR);
              break;
            }
          }
          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }
          var _state$orderedModifie = state.orderedModifiers[index], fn2 = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
          if (typeof fn2 === "function") {
            state = fn2({
              state,
              options: _options,
              name,
              instance
            }) || state;
          }
        }
      },
      update: debounce(function() {
        return new Promise(function(resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };
    if (!areValidElements(reference2, popper2)) {
      if (true) {
        console.error(INVALID_ELEMENT_ERROR);
      }
      return instance;
    }
    instance.setOptions(options).then(function(state2) {
      if (!isDestroyed && options.onFirstUpdate) {
        options.onFirstUpdate(state2);
      }
    });
    function runModifierEffects() {
      state.orderedModifiers.forEach(function(_ref3) {
        var name = _ref3.name, _ref3$options = _ref3.options, options2 = _ref3$options === void 0 ? {} : _ref3$options, effect4 = _ref3.effect;
        if (typeof effect4 === "function") {
          var cleanupFn = effect4({
            state,
            name,
            instance,
            options: options2
          });
          var noopFn = function noopFn2() {
          };
          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }
    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function(fn2) {
        return fn2();
      });
      effectCleanupFns = [];
    }
    return instance;
  };
}

// node_modules/@popperjs/core/lib/popper.js
var defaultModifiers = [eventListeners_default, popperOffsets_default, computeStyles_default, applyStyles_default, offset_default, flip_default, preventOverflow_default, arrow_default, hide_default];
var createPopper = /* @__PURE__ */ popperGenerator({
  defaultModifiers
});

// src/suggester/suggest.ts
var wrapAround = (value, size) => {
  return (value % size + size) % size;
};
var Suggest = class {
  constructor(owner, containerEl, scope) {
    this.owner = owner;
    this.containerEl = containerEl;
    containerEl.on("click", ".suggestion-item", this.onSuggestionClick.bind(this));
    containerEl.on("mousemove", ".suggestion-item", this.onSuggestionMouseover.bind(this));
    scope.register([], "ArrowUp", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem - 1, true);
        return false;
      }
    });
    scope.register([], "ArrowDown", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem + 1, true);
        return false;
      }
    });
    scope.register([], "Enter", (event) => {
      if (!event.isComposing) {
        this.useSelectedItem(event);
        return false;
      }
    });
  }
  onSuggestionClick(event, el) {
    event.preventDefault();
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
    this.useSelectedItem(event);
  }
  onSuggestionMouseover(_event, el) {
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
  }
  setSuggestions(values) {
    this.containerEl.empty();
    const suggestionEls = [];
    values.forEach((value) => {
      const suggestionEl = this.containerEl.createDiv("suggestion-item");
      this.owner.renderSuggestion(value, suggestionEl);
      suggestionEls.push(suggestionEl);
    });
    this.values = values;
    this.suggestions = suggestionEls;
    this.setSelectedItem(0, false);
  }
  useSelectedItem(event) {
    const currentValue = this.values[this.selectedItem];
    if (currentValue) {
      this.owner.selectSuggestion(currentValue, event);
    }
  }
  setSelectedItem(selectedIndex, scrollIntoView) {
    const normalizedIndex = wrapAround(selectedIndex, this.suggestions.length);
    const prevSelectedSuggestion = this.suggestions[this.selectedItem];
    const selectedSuggestion = this.suggestions[normalizedIndex];
    prevSelectedSuggestion == null ? void 0 : prevSelectedSuggestion.removeClass("is-selected");
    selectedSuggestion == null ? void 0 : selectedSuggestion.addClass("is-selected");
    this.selectedItem = normalizedIndex;
    if (scrollIntoView) {
      selectedSuggestion.scrollIntoView(false);
    }
  }
};
var TextInputSuggest = class {
  constructor(inputEl) {
    this.inputEl = inputEl;
    this.scope = new import_obsidian15.Scope();
    this.suggestEl = createDiv("suggestion-container");
    const suggestion = this.suggestEl.createDiv("suggestion");
    this.suggest = new Suggest(this, suggestion, this.scope);
    this.scope.register([], "Escape", this.close.bind(this));
    this.inputEl.addEventListener("input", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("focus", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("blur", this.close.bind(this));
    this.suggestEl.on("mousedown", ".suggestion-container", (event) => {
      event.preventDefault();
    });
  }
  onInputChanged() {
    const inputStr = this.inputEl.value;
    const suggestions = this.getSuggestions(inputStr);
    if (!suggestions) {
      this.close();
      return;
    }
    if (suggestions.length > 0) {
      this.suggest.setSuggestions(suggestions);
      this.open(app.dom.appContainerEl, this.inputEl);
    } else {
      this.close();
    }
  }
  open(container, inputEl) {
    app.keymap.pushScope(this.scope);
    container.appendChild(this.suggestEl);
    this.popper = createPopper(inputEl, this.suggestEl, {
      placement: "bottom-start",
      modifiers: [
        {
          name: "sameWidth",
          enabled: true,
          fn: ({ state, instance }) => {
            const targetWidth = `${state.rects.reference.width}px`;
            if (state.styles.popper.width === targetWidth) {
              return;
            }
            state.styles.popper.width = targetWidth;
            instance.update();
          },
          phase: "beforeWrite",
          requires: ["computeStyles"]
        }
      ]
    });
  }
  close() {
    app.keymap.popScope(this.scope);
    this.suggest.setSuggestions([]);
    if (this.popper)
      this.popper.destroy();
    this.suggestEl.detach();
  }
};

// src/utils/fileUtils.ts
var import_obsidian16 = require("obsidian");
function resolve_tfolder(plugin, folder_str) {
  folder_str = (0, import_obsidian16.normalizePath)(folder_str);
  const folder = plugin.app.vault.getAbstractFileByPath(folder_str);
  if (!folder) {
    throw new Error(`Folder "${folder_str}" doesn't exist`);
  }
  if (!(folder instanceof import_obsidian16.TFolder)) {
    throw new Error(`${folder_str} is a file, not a folder`);
  }
  return folder;
}
function get_tfiles_from_folder(plugin, folder_str) {
  const folder = resolve_tfolder(plugin, folder_str);
  const files = [];
  import_obsidian16.Vault.recurseChildren(folder, (file) => {
    if (file instanceof import_obsidian16.TFile) {
      files.push(file);
    }
  });
  files.sort((a, b) => {
    return a.basename.localeCompare(b.basename);
  });
  return files;
}

// src/suggester/FileSuggester.ts
var FileSuggest = class extends TextInputSuggest {
  constructor(inputEl, plugin, folder) {
    super(inputEl);
    this.inputEl = inputEl;
    this.plugin = plugin;
    this.folder = folder;
    this.plugin = plugin;
  }
  getSuggestions(input_str) {
    const all_files = [];
    try {
      all_files.push(...get_tfiles_from_folder(this.plugin, this.folder));
    } catch (error) {
    }
    const files = [];
    const lower_input_str = input_str.toLowerCase();
    all_files.forEach((file) => {
      if (file instanceof import_obsidian17.TFile && file.extension === "md" && file.path.toLowerCase().contains(lower_input_str)) {
        files.push(file);
      }
    });
    return files;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var AbstractListBasedField = class extends FieldManager2 {
  constructor(plugin, field, type) {
    super(plugin, field, type);
  }
  setValueListText(header) {
    header.setText(`Preset options: ${Object.values(this.field.options.valuesList).join(", ")}`);
  }
  createListNotePathContainer(container, plugin) {
    const valuesListNotePathContainer = container.createDiv({ cls: "field-container" });
    valuesListNotePathContainer.createDiv({ text: `Path of the note`, cls: "label" });
    const input = new import_obsidian18.TextComponent(valuesListNotePathContainer);
    input.inputEl.addClass("full-width");
    input.inputEl.addClass("with-label");
    new FileSuggest(input.inputEl, plugin, "/");
    const listNotePath = this.field.options.valuesListNotePath;
    input.setValue(listNotePath || "");
    input.setPlaceholder("Path/of/the/note.md");
    input.onChange((value) => this.field.options.valuesListNotePath = value);
    return valuesListNotePathContainer;
  }
  removePresetValue(key) {
    let newValues = {};
    for (let _key in this.field.options.valuesList) {
      if (key !== _key) {
        newValues[_key] = this.field.options.valuesList[_key];
      }
      ;
    }
    ;
    this.field.options.valuesList = newValues;
  }
  createValuesListContainer(parentContainer) {
    const presetValuesFields = parentContainer.createDiv();
    const valuesList = presetValuesFields.createDiv();
    const valuesListHeader = valuesList.createDiv({});
    valuesListHeader.createEl("span", { text: `Preset options: ${Object.values(this.field.options.valuesList).join(", ")}` });
    const valuesListBody = valuesList.createDiv();
    Object.keys(this.field.options.valuesList).forEach((key) => {
      this.valuesPromptComponents.push(this.createValueContainer(valuesListBody, valuesListHeader, key));
    });
    this.createAddButton(valuesList, valuesListBody, valuesListHeader);
    return presetValuesFields;
  }
  createValueContainer(parentNode, header, key) {
    const values = this.field.options.valuesList || {};
    const presetValue = values[key];
    const valueContainer = parentNode.createDiv({ cls: "field-container" });
    const input = new import_obsidian18.TextComponent(valueContainer);
    input.inputEl.addClass("full-width");
    this.valuesPromptComponents.push(input);
    input.setValue(presetValue);
    input.onChange((value) => {
      this.field.options.valuesList[key] = value;
      this.setValueListText(header);
      FieldSettingsModal.removeValidationError(input);
    });
    const valueRemoveButton = new import_obsidian18.ButtonComponent(valueContainer);
    valueRemoveButton.setIcon("trash").onClick((evt) => {
      evt.preventDefault;
      this.removePresetValue(key);
      this.setValueListText(header);
      parentNode.removeChild(valueContainer);
      this.valuesPromptComponents.remove(input);
    });
    if (key != Object.keys(this.field.options)[0]) {
      const valueUpgradeButton = new import_obsidian18.ButtonComponent(valueContainer);
      (0, import_obsidian18.setIcon)(valueUpgradeButton.buttonEl, "up-chevron-glyph");
      valueUpgradeButton.onClick((evt) => {
        const thisValue = values[key];
        const inputIndex = this.valuesPromptComponents.indexOf(input);
        const upperComponent = inputIndex !== -1 ? this.valuesPromptComponents[inputIndex - 1] : this.valuesPromptComponents.last();
        if (upperComponent) {
          const upperValue = upperComponent.inputEl.value;
          const upperKey = Object.keys(values).filter((k) => values[k] == upperValue)[0];
          if (upperKey) {
            upperComponent.setValue(thisValue);
            values[upperKey] = thisValue;
            input.setValue(upperValue);
            values[key] = upperValue;
          }
          ;
        }
        ;
      });
    }
    ;
    return input;
  }
  validateValue(value) {
    return true;
  }
  getOptionsStr() {
    switch (this.field.options.sourceType) {
      case "ValuesList" /* ValuesList */:
        return Object.values(this.field.options.valuesList).join(", ");
      case "ValuesListNotePath" /* ValuesListNotePath */:
        return this.field.options.valuesListNotePath;
      case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
        return this.field.options.valuesFromDVQuery;
      default:
        return "";
    }
  }
  getOptionsList(dvFile = void 0) {
    var _a;
    let values = [];
    if (Array.isArray(this.field.options)) {
      values = this.field.options;
    } else if (!this.field.options.sourceType) {
      values = Object.values(this.field.options);
    } else {
      switch (this.field.options.sourceType) {
        case "ValuesList" /* ValuesList */:
          values = Object.values(this.field.options.valuesList);
          break;
        case "ValuesListNotePath" /* ValuesListNotePath */:
          values = this.plugin.fieldIndex.valuesListNotePathValues.get(this.field.options.valuesListNotePath) || [];
          break;
        case "ValuesFromDVQuery" /* ValuesFromDVQuery */:
          {
            const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
            if (dvApi) {
              values = new Function("dv", "current", `return ${this.field.options.valuesFromDVQuery}`)(dvApi, dvFile);
            } else {
              values = [];
            }
          }
          break;
        default:
          values = [];
          break;
      }
    }
    return values;
  }
  validateOptions() {
    let error = false;
    this.valuesPromptComponents.forEach((input) => {
      var _a, _b;
      if (/[,]/gu.test(input.inputEl.value) && ((_a = input.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, "Values cannot contain a comma");
        error = true;
      }
      ;
      if (input.inputEl.value == "" && ((_b = input.inputEl.parentElement) == null ? void 0 : _b.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, "Values can't be null.");
        error = true;
      }
      ;
    });
    return !error;
  }
  createAddButton(valuesList, valuesListBody, valuesListHeader) {
    const valuesListFooter = valuesList.createDiv();
    const addValue = valuesListFooter.createEl("button");
    addValue.type = "button";
    addValue.textContent = "Add a value";
    addValue.onClickEvent((evt) => __async(this, null, function* () {
      evt.preventDefault;
      let newKeyNumber = 1;
      Object.keys(this.field.options.valuesList).forEach((key) => {
        if (parseInt(key) && parseInt(key) >= newKeyNumber) {
          newKeyNumber = parseInt(key) + 1;
        }
        ;
      });
      const newKey = newKeyNumber.toString();
      this.field.options.valuesList[newKey] = "";
      this.createValueContainer(valuesListBody, valuesListHeader, newKey);
    }));
    valuesList.createEl("hr");
  }
  createValuesFromDVQueryContainer(parentContainer) {
    const valuesFromDVQueryTopContainer = parentContainer.createDiv({ cls: "vstacked" });
    valuesFromDVQueryTopContainer.createEl("span", { text: "Dataview function" });
    valuesFromDVQueryTopContainer.createEl("span", { text: "Dataview query returning a list of string (<dv> object is available)", cls: "sub-text" });
    const valuesFromDVQueryContainer = valuesFromDVQueryTopContainer.createDiv({ cls: "field-container" });
    const valuesFromDVQuery = new import_obsidian18.TextAreaComponent(valuesFromDVQueryContainer);
    valuesFromDVQuery.inputEl.addClass("full-width");
    valuesFromDVQuery.inputEl.cols = 65;
    valuesFromDVQuery.inputEl.rows = 8;
    valuesFromDVQuery.setPlaceholder("ex: dv.pages('#student').map(p => p.name)");
    valuesFromDVQuery.setValue(this.field.options.valuesFromDVQuery || "");
    valuesFromDVQuery.onChange((value) => {
      this.field.options.valuesFromDVQuery = value;
    });
    return valuesFromDVQueryTopContainer;
  }
  displaySelectedTypeContainer(optionContainers, value) {
    Object.keys(optionContainers).forEach((key) => {
      if (key === value) {
        optionContainers[key].show();
      } else {
        optionContainers[key].hide();
      }
    });
  }
  createSettingContainer(container, plugin, location) {
    const sourceTypeContainer = container.createDiv({ cls: "field-container" });
    sourceTypeContainer.createDiv({ text: "Values source type", cls: "label" });
    sourceTypeContainer.createDiv({ cls: "spacer" });
    const sourceType = new import_obsidian18.DropdownComponent(sourceTypeContainer);
    if (!this.field.options.sourceType) {
      if (typeof this.field.options === "object" && Object.keys(this.field.options).every((key) => !isNaN(parseInt(key)))) {
        const valuesList = {};
        Object.keys(this.field.options).forEach((key) => valuesList[key] = this.field.options[key]);
        this.field.options = {};
        this.field.options.valuesList = valuesList;
      } else {
        this.field.options = {};
      }
      this.field.options.sourceType = "ValuesList" /* ValuesList */;
      this.field.options.valuesListNotePath = "";
      this.field.options.valuesFromDVQuery = "";
    }
    Object.keys(Type2).forEach((option) => sourceType.addOption(option, typeDisplay[option]));
    sourceType.setValue(this.field.options.sourceType || "ValuesList" /* ValuesList */);
    const valuesListNotePathContainer = this.createListNotePathContainer(container, plugin);
    const presetValuesFieldsContainer = this.createValuesListContainer(container);
    const valuesFromDVQueryContainer = this.createValuesFromDVQueryContainer(container);
    const valuesContainers = {
      "ValuesList": presetValuesFieldsContainer,
      "ValuesListNotePath": valuesListNotePathContainer,
      "ValuesFromDVQuery": valuesFromDVQueryContainer
    };
    sourceType.onChange((value) => {
      this.field.options.sourceType = value;
      this.displaySelectedTypeContainer(valuesContainers, value);
    });
    this.displaySelectedTypeContainer(valuesContainers, this.field.options.sourceType);
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
  }
};

// src/fields/fieldManagers/SelectField.ts
var SelectField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Select" /* Select */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new ValueSuggestModal(this.plugin, file, value, this.field);
    modal.titleEl.setText("Select value");
    const action = () => modal.open();
    if (SelectField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["Select" /* Select */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (SelectField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Select" /* Select */]
      });
    } else if (SelectField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Multi" /* Multi */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name] || "", attrs));
    const spacer = fieldContainer.createEl("div", { cls: "spacer-1" });
    const dropDownButton = fieldContainer.createEl("button");
    (0, import_obsidian19.setIcon)(dropDownButton, "down-chevron-glyph");
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian19.TFile && file.extension == "md") {
      fieldModal = new ValueSuggestModal(this.plugin, file, p[this.field.name], this.field);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    dropDownButton.onclick = () => fieldModal.open();
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      dropDownButton.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        dropDownButton.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        dropDownButton.hide();
        spacer.show();
      };
    }
  }
};

// src/fields/fieldManagers/CycleField.ts
var import_obsidian20 = require("obsidian");
var CycleField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Cycle" /* Cycle */);
    this.valuesPromptComponents = [];
    this.showModalOption = false;
  }
  nextOption(value) {
    let nextOption;
    const values = this.getOptionsList();
    if (values.indexOf(value) === -1) {
      nextOption = values[0] || "";
    } else {
      nextOption = values[(values.indexOf(value) + 1) % values.length];
    }
    return nextOption;
  }
  getRawOptionFromDuration(duration2) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let matchedValue = void 0;
    if (dvApi && dvApi.value.isDuration(duration2)) {
      this.getOptionsList().forEach((option) => {
        const dvOption = dvApi.duration(option);
        if (Object.keys(duration2.values).every((j) => !duration2.values[j] && !dvOption.values[j] || duration2.values[j] === dvOption.values[j])) {
          matchedValue = option;
        }
      });
    }
    return matchedValue;
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let valueText;
    if (dvApi) {
      switch (dvApi.page(file.path)[fieldName]) {
        case void 0:
          valueText = "";
          break;
        case null:
          valueText = "";
          break;
        case false:
          valueText = "false";
          break;
        case 0:
          valueText = "0";
          break;
        default:
          valueText = dvApi.page(file.path)[fieldName];
      }
    } else {
      valueText = "";
    }
    container.createDiv({ text: this.getRawOptionFromDuration(valueText) || valueText });
  }
  addFieldOption(name, value, file, location) {
    let matchedValue = this.getRawOptionFromDuration(value) || value;
    const iconName = FieldIcon["Cycle" /* Cycle */];
    const action = () => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file, name, this.nextOption(matchedValue).toString());
      });
    });
    if (CycleField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`${name} : ${matchedValue} \u25B7 ${this.nextOption(matchedValue)}`);
        item.setIcon(iconName);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (CycleField.isSuggest(location)) {
      location.options.push({
        id: `${name}_${matchedValue}_${this.nextOption(matchedValue)}`,
        actionLabel: `<span><b>${name}</b> : ${matchedValue} \u25B7 ${this.nextOption(matchedValue)}</span>`,
        action,
        icon: iconName
      });
    } else if (CycleField.isFieldOptions(location)) {
      location.addOption(iconName, action, `${matchedValue} \u25B7 ${this.nextOption(matchedValue)}`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new ValueSuggestModal(this.plugin, file, value || "", this.field, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
    const nextOption = this.nextOption(p[this.field.name]);
    const spacer = fieldContainer.createEl("div", { cls: "spacer" });
    const cycleBtn = fieldContainer.createEl("button");
    (0, import_obsidian20.setIcon)(cycleBtn, FieldIcon["Cycle" /* Cycle */]);
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      cycleBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        cycleBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        cycleBtn.hide();
        spacer.show();
      };
    }
    cycleBtn.onclick = (e) => {
      var _a2;
      CycleField.replaceValues(this.plugin, p.file.path, this.field.name, nextOption);
      if (!((_a2 = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a2.alwaysOn)) {
        cycleBtn.hide();
        spacer.show();
      }
    };
  }
};

// src/fields/fieldManagers/MultiField.ts
var import_obsidian24 = require("obsidian");

// src/modals/fields/MultiSelectModal.ts
var import_obsidian23 = require("obsidian");

// src/fields/fieldManagers/FileField.ts
var import_obsidian22 = require("obsidian");

// src/modals/fields/SingleFileModal.ts
var import_obsidian21 = require("obsidian");
var FileFuzzySuggester = class extends import_obsidian21.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      if (dvApi.value.isLink(initialValueObject)) {
        const file2 = this.plugin.app.vault.getAbstractFileByPath(initialValueObject.path);
        if (file2 instanceof import_obsidian21.TFile)
          this.selectedFile = file2;
      }
    }
    this.containerEl.addClass("metadata-menu");
  }
  getItems() {
    const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
      return a.basename < b.basename ? -1 : 1;
    };
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file).sort(sortingMethod);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  renderSuggestion(value, el) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "item-with-add-on" });
      suggestionContainer.createDiv({
        text: new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path))
      });
      const filePath = suggestionContainer.createDiv({ cls: "add-on" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("value-container");
    const spacer = this.containerEl.createDiv({ cls: "spacer" });
    el.appendChild(spacer);
    if (((_b = this.selectedFile) == null ? void 0 : _b.path) === value.item.path) {
      el.addClass("value-checked");
      const iconContainer = el.createDiv({ cls: "icon-container" });
      (0, import_obsidian21.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
      var _a;
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      let alias = void 0;
      if (dvApi && this.field.options.customRendering) {
        alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(item.path));
      }
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, FileField.buildMarkDownLink(this.plugin, this.file, item.basename, alias));
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, FileField.buildMarkDownLink(this.plugin, this.file, item.basename, alias), this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
};

// src/fields/fieldManagers/FileField.ts
var FileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "File" /* File */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian22.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  addFieldOption(name, value, file, location) {
    const modal = new FileFuzzySuggester(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select value");
    const action = () => modal.open();
    if (FileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (FileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["File" /* File */]
      });
    } else if (FileField.isFieldOptions(location)) {
      location.addOption(FieldIcon["File" /* File */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const value = dvApi.page(file.path)[fieldName];
      if (dvApi.value.isLink(value)) {
        const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
        link.onclick = () => {
          this.plugin.app.workspace.openLinkText(value.path, file.path, true);
          onClicked();
        };
      } else {
        container.createDiv({ text: value });
      }
    }
    container.createDiv();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
    const searchBtn = fieldContainer.createEl("button");
    (0, import_obsidian22.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    const spacer = fieldContainer.createEl("div", { cls: "spacer" });
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian22.TFile && file.extension == "md") {
      fieldModal = new FileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn) || true) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
  }
  createFileContainer(container) {
    const dvQueryStringTopContainer = container.createDiv({ cls: "vstacked" });
    dvQueryStringTopContainer.createEl("span", { text: "Dataview Query (optional)" });
    const dvQueryStringContainer = dvQueryStringTopContainer.createDiv({ cls: "field-container" });
    this.dvQueryString = new import_obsidian22.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.inputEl.addClass("full-width");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingTopContainer = container.createDiv({ cls: "vstacked" });
    customeRenderingTopContainer.createEl("span", { text: "Alias" });
    customeRenderingTopContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "sub-text" });
    customeRenderingTopContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customeRenderingContainer = customeRenderingTopContainer.createDiv({ cls: "field-container" });
    const customRendering = new import_obsidian22.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.inputEl.addClass("full-width");
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
    const customSortingTopContainer = container.createDiv({ cls: "vstacked" });
    customSortingTopContainer.createEl("span", { text: "Sorting order" });
    customSortingTopContainer.createEl("span", { text: "Personalise the sorting order of your links with a instruction taking 2 files (a, b) and returning -1, 0 or 1", cls: "sub-text" });
    customSortingTopContainer.createEl("code", {
      text: `(a: TFile, b: TFile): number`
    });
    const customSortingContainer = customSortingTopContainer.createDiv({ cls: "field-container" });
    const customSorting = new import_obsidian22.TextAreaComponent(customSortingContainer);
    customSorting.inputEl.cols = 50;
    customSorting.inputEl.rows = 4;
    customSorting.inputEl.addClass("full-width");
    customSorting.setValue(this.field.options.customSorting || "");
    customSorting.setPlaceholder("Javascript instruction, (a: TFile, b: TFile): number\nexample 1 (alphabetical order): a.basename < b.basename ? 1 : -1 \nexample 2 (creation time newer to older): b.stat.ctime - b.stat.ctime");
    customSorting.onChange((value) => {
      this.field.options.customSorting = value;
      FieldSettingsModal.removeValidationError(customSorting);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.createFileContainer(parentContainer);
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    return true;
  }
};

// src/modals/fields/MultiSelectModal.ts
var MultiSuggestModal = class extends import_obsidian23.SuggestModal {
  constructor(plugin, file, field, initialOptions, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    if (initialOptions) {
      if (Array.isArray(initialOptions)) {
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        if (dvApi && initialOptions.some((o) => dvApi.value.isLink(o))) {
          this.selectedOptions = initialOptions.map((item) => {
            if (dvApi.value.isLink(item)) {
              return FileField.buildMarkDownLink(this.plugin, this.file, item.path);
            } else {
              return item.toString();
            }
          });
        }
        this.selectedOptions = initialOptions.map((item) => item.toString());
      } else if (initialOptions.toString().startsWith("[[")) {
        this.selectedOptions = initialOptions.split(",").map((item) => item.trim());
      } else {
        this.selectedOptions = initialOptions.toString().replace(/^\[(.*)\]$/, "$1").split(",").map((item) => item.trim());
      }
    } else {
      this.selectedOptions = [];
    }
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    return __async(this, null, function* () {
      __superGet(MultiSuggestModal.prototype, this, "onOpen").call(this);
      this.containerEl.onkeydown = (e) => __async(this, null, function* () {
        if (e.key == "Enter" && e.altKey) {
          yield this.replaceValues();
          this.close();
        }
      });
      const updateSettingsInfoContainer = this.containerEl.createDiv({ cls: "value-add-notice" });
      const notice = updateSettingsInfoContainer.createDiv({ cls: "label" });
      updateSettingsInfoContainer.createDiv({ cls: "spacer" });
      updateSettingsInfoContainer.hide();
      this.containerEl.find(".prompt").prepend(updateSettingsInfoContainer);
      const inputContainer = this.containerEl.createDiv({ cls: "suggester-input" });
      inputContainer.appendChild(this.inputEl);
      this.containerEl.find(".prompt").prepend(inputContainer);
      const buttonContainer = this.containerEl.createDiv({ cls: "footer-actions" });
      buttonContainer.createDiv({ cls: "spacer" });
      const infoContainer = buttonContainer.createDiv({ cls: "info" });
      infoContainer.setText("Alt+Enter to save");
      this.addButton = new import_obsidian23.ButtonComponent(inputContainer);
      this.addButton.setIcon("plus");
      this.addButton.onClick(() => __async(this, null, function* () {
        yield this.addNewValueToSettings();
        notice.setText(`${this.inputEl.value} added to the field settings
click on reload`);
        this.addButton.buttonEl.hide();
        updateSettingsInfoContainer.show();
      }));
      this.addButton.setCta();
      this.addButton.setTooltip("Add this value to this field settings");
      this.addButton.buttonEl.hide();
      this.reloadButton = new import_obsidian23.ButtonComponent(updateSettingsInfoContainer);
      this.reloadButton.setIcon("refresh-cw");
      this.reloadButton.setCta();
      this.reloadButton.onClick(() => __async(this, null, function* () {
        this.inputEl.value = "";
        this.updateSuggestions();
        updateSettingsInfoContainer.hide();
        this.addButton.buttonEl.hide();
      }));
      const confirmButton = new import_obsidian23.ButtonComponent(buttonContainer);
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => __async(this, null, function* () {
        yield this.replaceValues();
        this.close();
      }));
      const cancelButton = new import_obsidian23.ButtonComponent(buttonContainer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => {
        this.close();
      });
      const clearButton = new import_obsidian23.ButtonComponent(buttonContainer);
      clearButton.setIcon("trash");
      clearButton.onClick(() => __async(this, null, function* () {
        yield this.clearValues();
        this.close();
      }));
      clearButton.buttonEl.addClass("danger");
      this.modalEl.appendChild(buttonContainer);
    });
  }
  addNewValueToSettings() {
    return __async(this, null, function* () {
      var _a, _b;
      const newValue = this.inputEl.value;
      const fileClassName = (_b = (_a = this.plugin.fieldIndex.filesFields.get(this.file.path)) == null ? void 0 : _a.find((field) => field.name === this.field.name)) == null ? void 0 : _b.fileClassName;
      if (fileClassName) {
        const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        const fileClassAttribute = fileClass == null ? void 0 : fileClass.attributes.find((attr) => attr.name === this.field.name);
        if (fileClass && fileClassAttribute) {
          let newOptions;
          if (Array.isArray(fileClassAttribute.options)) {
            newOptions = [...fileClassAttribute.options, newValue];
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesList" /* ValuesList */) {
            newOptions = fileClassAttribute.options.valuesList;
            newOptions[`${Object.keys(fileClassAttribute.options.valuesList).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          } else if (fileClassAttribute.options.sourceType === "ValuesListNotePath" /* ValuesListNotePath */) {
            const valuesFile = this.plugin.app.vault.getAbstractFileByPath(fileClassAttribute.options.valuesListNotePath);
            if (valuesFile instanceof import_obsidian23.TFile && valuesFile.extension == "md") {
              const result = yield this.plugin.app.vault.read(valuesFile);
              this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
            }
          } else {
            newOptions = fileClassAttribute.options;
            newOptions[`${Object.keys(fileClassAttribute.options).length}`] = newValue;
            yield fileClass.updateAttribute(fileClassAttribute.type, fileClassAttribute.name, newOptions, fileClassAttribute);
          }
        }
      } else {
        const presetField = this.plugin.settings.presetFields.find((field) => field.name === this.field.name);
        if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesListNotePath" /* ValuesListNotePath */) {
          const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.options.valuesListNotePath);
          if (valuesFile instanceof import_obsidian23.TFile && valuesFile.extension == "md") {
            const result = yield this.plugin.app.vault.read(valuesFile);
            this.plugin.app.vault.modify(valuesFile, `${result}
${newValue}`);
          }
        } else if ((presetField == null ? void 0 : presetField.options.sourceType) === "ValuesList" /* ValuesList */) {
          const currentExistingField = this.plugin.initialProperties.find((p) => p.id == this.field.id);
          if (currentExistingField) {
            const valuesList = currentExistingField.options.valuesList;
            valuesList[`${Object.keys(valuesList).length + 1}`] = newValue;
          }
          this.plugin.saveSettings();
        }
      }
      yield this.plugin.fieldIndex.fullIndex("valueAdd");
      this.selectedOptions.push(newValue);
    });
  }
  replaceValues() {
    return __async(this, null, function* () {
      const options = this.selectedOptions;
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, options.join(", "));
        });
      } else {
        const renderedValues = !this.inFrontmatter ? options.join(", ") : options.length > 1 ? `[${options.join(", ")}]` : `${options[0]}`;
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, renderedValues, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
      this.close();
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedOptions.includes(values[i].toString())) {
        s.addClass("value-checked");
        if (s.querySelectorAll(".icon-container").length == 0) {
          const iconContainer = s.createDiv({ cls: "icon-container" });
          (0, import_obsidian23.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("value-checked");
        s.querySelectorAll(".icon-container").forEach((icon) => icon.remove());
      }
    });
  }
  getSuggestions(query) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let dvFile;
    if (dvApi)
      dvFile = dvApi.page(this.file.path);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const values = fieldManager.getOptionsList(dvFile).filter((o) => o.toLowerCase().includes(query.toLowerCase()));
    if (this.addButton) {
      values.some((p) => p === query) || this.field.options.sourceType == "ValuesFromDVQuery" /* ValuesFromDVQuery */ || !query ? this.addButton.buttonEl.hide() : this.addButton.buttonEl.show();
    }
    ;
    return values;
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("value-container");
    const spacer = this.containerEl.createDiv({ cls: "spacer" });
    el.appendChild(spacer);
    if (this.selectedOptions.includes(value.toString())) {
      el.addClass("value-checked");
      const iconContainer = el.createDiv({ cls: "icon-container" });
      (0, import_obsidian23.setIcon)(iconContainer, "check-circle");
    }
    this.inputEl.focus();
  }
  selectSuggestion(value, evt) {
    if (this.selectedOptions.includes(value.toString())) {
      this.selectedOptions.remove(value.toString());
    } else {
      this.selectedOptions.push(value.toString());
    }
    this.renderSelected();
  }
  onChooseSuggestion(item, evt) {
  }
};

// src/fields/fieldManagers/MultiField.ts
var MultiField = class extends AbstractListBasedField {
  constructor(plugin, field) {
    super(plugin, field, "Multi" /* Multi */);
    this.valuesPromptComponents = [];
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiSuggestModal(this.plugin, file, this.field, value);
    modal.titleEl.setText("Select values");
    const action = () => modal.open();
    if (MultiField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon["Multi" /* Multi */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["Multi" /* Multi */]
      });
    } else if (MultiField.isFieldOptions(location)) {
      location.addOption(FieldIcon["Multi" /* Multi */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new MultiSuggestModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Select options for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a, _b;
    let valueHovered = false;
    let currentValues = [];
    if (p[this.field.name]) {
      if (Object.keys(p[this.field.name]).includes("path")) {
        currentValues = [`[[${p[this.field.name].path.replace(".md", "")}]]`];
      } else if (Array.isArray(p[this.field.name])) {
        currentValues.push(...p[this.field.name].map((v) => v.trim()));
      } else {
        currentValues = p[this.field.name].split(",").map((v) => v.trim());
      }
    }
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian24.TFile && file.extension == "md") {
      fieldModal = new MultiSuggestModal(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    const valuesContainer = fieldContainer.createDiv({ cls: "values-container" });
    currentValues.forEach((v) => {
      const valueContainer = valuesContainer.createDiv({ cls: "item-container" });
      const valueRemoveBtn = valueContainer.createEl("button");
      const valueLabel = valueContainer.createDiv({ cls: "label", text: v });
      (0, import_obsidian24.setIcon)(valueRemoveBtn, "cross");
      valueRemoveBtn.hide();
      valueRemoveBtn.onclick = () => __async(this, null, function* () {
        const remainingValues = currentValues.filter((cV) => cV !== v).join(", ");
        MultiField.replaceValues(this.plugin, p.file.path, this.field.name, remainingValues);
      });
      valueContainer.onmouseover = () => {
        valueHovered = true;
        doubleSpacer.hide();
        singleSpacer.hide();
        valueRemoveBtn.show();
        valueLabel.addClass("hovered");
      };
      valueContainer.onmouseout = () => {
        valueHovered = false;
        valueRemoveBtn.hide();
        singleSpacer.show();
        doubleSpacer.hide();
        valueLabel.removeClass("hovered");
      };
    });
    const addBtn = valuesContainer.createEl("button");
    (0, import_obsidian24.setIcon)(addBtn, "list-plus");
    addBtn.onclick = () => fieldModal.open();
    const singleSpacer = valuesContainer.createDiv({ cls: "spacer-1" });
    const doubleSpacer = valuesContainer.createDiv({ cls: "spacer-2" });
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      addBtn.hide();
      fieldContainer.onmouseover = () => {
        addBtn.show();
        doubleSpacer.hide();
        if (!valueHovered)
          singleSpacer.show();
      };
      fieldContainer.onmouseout = () => {
        addBtn.hide();
        singleSpacer.hide();
        doubleSpacer.show();
      };
    }
    if (!((_b = attrs == null ? void 0 : attrs.options) == null ? void 0 : _b.alwaysOn)) {
      singleSpacer.hide();
      doubleSpacer.show();
      addBtn.hide();
    } else {
      singleSpacer.show();
      doubleSpacer.hide();
      addBtn.show();
    }
  }
};

// src/fields/fieldManagers/DateField.ts
var import_obsidian27 = require("obsidian");

// src/modals/fields/DateModal.ts
var import_obsidian25 = require("obsidian");
var import_obsidian26 = require("obsidian");

// node_modules/flatpickr/dist/esm/types/options.js
var HOOKS = [
  "onChange",
  "onClose",
  "onDayCreate",
  "onDestroy",
  "onKeyDown",
  "onMonthChange",
  "onOpen",
  "onParseConfig",
  "onReady",
  "onValueUpdate",
  "onYearChange",
  "onPreCalendarPosition"
];
var defaults = {
  _disable: [],
  allowInput: false,
  allowInvalidPreload: false,
  altFormat: "F j, Y",
  altInput: false,
  altInputClass: "form-control input",
  animate: typeof window === "object" && window.navigator.userAgent.indexOf("MSIE") === -1,
  ariaDateFormat: "F j, Y",
  autoFillDefaultTime: true,
  clickOpens: true,
  closeOnSelect: true,
  conjunction: ", ",
  dateFormat: "Y-m-d",
  defaultHour: 12,
  defaultMinute: 0,
  defaultSeconds: 0,
  disable: [],
  disableMobile: false,
  enableSeconds: false,
  enableTime: false,
  errorHandler: function(err) {
    return typeof console !== "undefined" && console.warn(err);
  },
  getWeek: function(givenDate) {
    var date = new Date(givenDate.getTime());
    date.setHours(0, 0, 0, 0);
    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
    var week1 = new Date(date.getFullYear(), 0, 4);
    return 1 + Math.round(((date.getTime() - week1.getTime()) / 864e5 - 3 + (week1.getDay() + 6) % 7) / 7);
  },
  hourIncrement: 1,
  ignoredFocusElements: [],
  inline: false,
  locale: "default",
  minuteIncrement: 5,
  mode: "single",
  monthSelectorType: "dropdown",
  nextArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",
  noCalendar: false,
  now: new Date(),
  onChange: [],
  onClose: [],
  onDayCreate: [],
  onDestroy: [],
  onKeyDown: [],
  onMonthChange: [],
  onOpen: [],
  onParseConfig: [],
  onReady: [],
  onValueUpdate: [],
  onYearChange: [],
  onPreCalendarPosition: [],
  plugins: [],
  position: "auto",
  positionElement: void 0,
  prevArrow: "<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",
  shorthandCurrentMonth: false,
  showMonths: 1,
  static: false,
  time_24hr: false,
  weekNumbers: false,
  wrap: false
};

// node_modules/flatpickr/dist/esm/l10n/default.js
var english = {
  weekdays: {
    shorthand: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
    longhand: [
      "Sunday",
      "Monday",
      "Tuesday",
      "Wednesday",
      "Thursday",
      "Friday",
      "Saturday"
    ]
  },
  months: {
    shorthand: [
      "Jan",
      "Feb",
      "Mar",
      "Apr",
      "May",
      "Jun",
      "Jul",
      "Aug",
      "Sep",
      "Oct",
      "Nov",
      "Dec"
    ],
    longhand: [
      "January",
      "February",
      "March",
      "April",
      "May",
      "June",
      "July",
      "August",
      "September",
      "October",
      "November",
      "December"
    ]
  },
  daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
  firstDayOfWeek: 0,
  ordinal: function(nth) {
    var s = nth % 100;
    if (s > 3 && s < 21)
      return "th";
    switch (s % 10) {
      case 1:
        return "st";
      case 2:
        return "nd";
      case 3:
        return "rd";
      default:
        return "th";
    }
  },
  rangeSeparator: " to ",
  weekAbbreviation: "Wk",
  scrollTitle: "Scroll to increment",
  toggleTitle: "Click to toggle",
  amPM: ["AM", "PM"],
  yearAriaLabel: "Year",
  monthAriaLabel: "Month",
  hourAriaLabel: "Hour",
  minuteAriaLabel: "Minute",
  time_24hr: false
};
var default_default = english;

// node_modules/flatpickr/dist/esm/utils/index.js
var pad = function(number, length) {
  if (length === void 0) {
    length = 2;
  }
  return ("000" + number).slice(length * -1);
};
var int = function(bool) {
  return bool === true ? 1 : 0;
};
function debounce2(fn2, wait) {
  var t;
  return function() {
    var _this = this;
    var args = arguments;
    clearTimeout(t);
    t = setTimeout(function() {
      return fn2.apply(_this, args);
    }, wait);
  };
}
var arrayify = function(obj) {
  return obj instanceof Array ? obj : [obj];
};

// node_modules/flatpickr/dist/esm/utils/dom.js
function toggleClass(elem, className, bool) {
  if (bool === true)
    return elem.classList.add(className);
  elem.classList.remove(className);
}
function createElement(tag, className, content) {
  var e = window.document.createElement(tag);
  className = className || "";
  content = content || "";
  e.className = className;
  if (content !== void 0)
    e.textContent = content;
  return e;
}
function clearNode(node) {
  while (node.firstChild)
    node.removeChild(node.firstChild);
}
function findParent(node, condition) {
  if (condition(node))
    return node;
  else if (node.parentNode)
    return findParent(node.parentNode, condition);
  return void 0;
}
function createNumberInput(inputClassName, opts) {
  var wrapper = createElement("div", "numInputWrapper"), numInput = createElement("input", "numInput " + inputClassName), arrowUp = createElement("span", "arrowUp"), arrowDown = createElement("span", "arrowDown");
  if (navigator.userAgent.indexOf("MSIE 9.0") === -1) {
    numInput.type = "number";
  } else {
    numInput.type = "text";
    numInput.pattern = "\\d*";
  }
  if (opts !== void 0)
    for (var key in opts)
      numInput.setAttribute(key, opts[key]);
  wrapper.appendChild(numInput);
  wrapper.appendChild(arrowUp);
  wrapper.appendChild(arrowDown);
  return wrapper;
}
function getEventTarget(event) {
  try {
    if (typeof event.composedPath === "function") {
      var path = event.composedPath();
      return path[0];
    }
    return event.target;
  } catch (error) {
    return event.target;
  }
}

// node_modules/flatpickr/dist/esm/utils/formatting.js
var doNothing = function() {
  return void 0;
};
var monthToStr = function(monthNumber, shorthand, locale) {
  return locale.months[shorthand ? "shorthand" : "longhand"][monthNumber];
};
var revFormat = {
  D: doNothing,
  F: function(dateObj, monthName, locale) {
    dateObj.setMonth(locale.months.longhand.indexOf(monthName));
  },
  G: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  H: function(dateObj, hour) {
    dateObj.setHours(parseFloat(hour));
  },
  J: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  K: function(dateObj, amPM, locale) {
    dateObj.setHours(dateObj.getHours() % 12 + 12 * int(new RegExp(locale.amPM[1], "i").test(amPM)));
  },
  M: function(dateObj, shortMonth, locale) {
    dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));
  },
  S: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  U: function(_, unixSeconds) {
    return new Date(parseFloat(unixSeconds) * 1e3);
  },
  W: function(dateObj, weekNum, locale) {
    var weekNumber = parseInt(weekNum);
    var date = new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);
    date.setDate(date.getDate() - date.getDay() + locale.firstDayOfWeek);
    return date;
  },
  Y: function(dateObj, year) {
    dateObj.setFullYear(parseFloat(year));
  },
  Z: function(_, ISODate) {
    return new Date(ISODate);
  },
  d: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  h: function(dateObj, hour) {
    dateObj.setHours((dateObj.getHours() >= 12 ? 12 : 0) + parseFloat(hour));
  },
  i: function(dateObj, minutes) {
    dateObj.setMinutes(parseFloat(minutes));
  },
  j: function(dateObj, day) {
    dateObj.setDate(parseFloat(day));
  },
  l: doNothing,
  m: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  n: function(dateObj, month) {
    dateObj.setMonth(parseFloat(month) - 1);
  },
  s: function(dateObj, seconds) {
    dateObj.setSeconds(parseFloat(seconds));
  },
  u: function(_, unixMillSeconds) {
    return new Date(parseFloat(unixMillSeconds));
  },
  w: doNothing,
  y: function(dateObj, year) {
    dateObj.setFullYear(2e3 + parseFloat(year));
  }
};
var tokenRegex = {
  D: "",
  F: "",
  G: "(\\d\\d|\\d)",
  H: "(\\d\\d|\\d)",
  J: "(\\d\\d|\\d)\\w+",
  K: "",
  M: "",
  S: "(\\d\\d|\\d)",
  U: "(.+)",
  W: "(\\d\\d|\\d)",
  Y: "(\\d{4})",
  Z: "(.+)",
  d: "(\\d\\d|\\d)",
  h: "(\\d\\d|\\d)",
  i: "(\\d\\d|\\d)",
  j: "(\\d\\d|\\d)",
  l: "",
  m: "(\\d\\d|\\d)",
  n: "(\\d\\d|\\d)",
  s: "(\\d\\d|\\d)",
  u: "(.+)",
  w: "(\\d\\d|\\d)",
  y: "(\\d{2})"
};
var formats = {
  Z: function(date) {
    return date.toISOString();
  },
  D: function(date, locale, options) {
    return locale.weekdays.shorthand[formats.w(date, locale, options)];
  },
  F: function(date, locale, options) {
    return monthToStr(formats.n(date, locale, options) - 1, false, locale);
  },
  G: function(date, locale, options) {
    return pad(formats.h(date, locale, options));
  },
  H: function(date) {
    return pad(date.getHours());
  },
  J: function(date, locale) {
    return locale.ordinal !== void 0 ? date.getDate() + locale.ordinal(date.getDate()) : date.getDate();
  },
  K: function(date, locale) {
    return locale.amPM[int(date.getHours() > 11)];
  },
  M: function(date, locale) {
    return monthToStr(date.getMonth(), true, locale);
  },
  S: function(date) {
    return pad(date.getSeconds());
  },
  U: function(date) {
    return date.getTime() / 1e3;
  },
  W: function(date, _, options) {
    return options.getWeek(date);
  },
  Y: function(date) {
    return pad(date.getFullYear(), 4);
  },
  d: function(date) {
    return pad(date.getDate());
  },
  h: function(date) {
    return date.getHours() % 12 ? date.getHours() % 12 : 12;
  },
  i: function(date) {
    return pad(date.getMinutes());
  },
  j: function(date) {
    return date.getDate();
  },
  l: function(date, locale) {
    return locale.weekdays.longhand[date.getDay()];
  },
  m: function(date) {
    return pad(date.getMonth() + 1);
  },
  n: function(date) {
    return date.getMonth() + 1;
  },
  s: function(date) {
    return date.getSeconds();
  },
  u: function(date) {
    return date.getTime();
  },
  w: function(date) {
    return date.getDay();
  },
  y: function(date) {
    return String(date.getFullYear()).substring(2);
  }
};

// node_modules/flatpickr/dist/esm/utils/dates.js
var createDateFormatter = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c, _d = _a.isMobile, isMobile = _d === void 0 ? false : _d;
  return function(dateObj, frmt, overrideLocale) {
    var locale = overrideLocale || l10n;
    if (config.formatDate !== void 0 && !isMobile) {
      return config.formatDate(dateObj, frmt, locale);
    }
    return frmt.split("").map(function(c, i, arr) {
      return formats[c] && arr[i - 1] !== "\\" ? formats[c](dateObj, locale, config) : c !== "\\" ? c : "";
    }).join("");
  };
};
var createDateParser = function(_a) {
  var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;
  return function(date, givenFormat, timeless, customLocale) {
    if (date !== 0 && !date)
      return void 0;
    var locale = customLocale || l10n;
    var parsedDate;
    var dateOrig = date;
    if (date instanceof Date)
      parsedDate = new Date(date.getTime());
    else if (typeof date !== "string" && date.toFixed !== void 0)
      parsedDate = new Date(date);
    else if (typeof date === "string") {
      var format2 = givenFormat || (config || defaults).dateFormat;
      var datestr = String(date).trim();
      if (datestr === "today") {
        parsedDate = new Date();
        timeless = true;
      } else if (config && config.parseDate) {
        parsedDate = config.parseDate(date, format2);
      } else if (/Z$/.test(datestr) || /GMT$/.test(datestr)) {
        parsedDate = new Date(date);
      } else {
        var matched = void 0, ops = [];
        for (var i = 0, matchIndex = 0, regexStr = ""; i < format2.length; i++) {
          var token = format2[i];
          var isBackSlash = token === "\\";
          var escaped = format2[i - 1] === "\\" || isBackSlash;
          if (tokenRegex[token] && !escaped) {
            regexStr += tokenRegex[token];
            var match = new RegExp(regexStr).exec(date);
            if (match && (matched = true)) {
              ops[token !== "Y" ? "push" : "unshift"]({
                fn: revFormat[token],
                val: match[++matchIndex]
              });
            }
          } else if (!isBackSlash)
            regexStr += ".";
        }
        parsedDate = !config || !config.noCalendar ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0) : new Date(new Date().setHours(0, 0, 0, 0));
        ops.forEach(function(_a2) {
          var fn2 = _a2.fn, val = _a2.val;
          return parsedDate = fn2(parsedDate, val, locale) || parsedDate;
        });
        parsedDate = matched ? parsedDate : void 0;
      }
    }
    if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {
      config.errorHandler(new Error("Invalid date provided: " + dateOrig));
      return void 0;
    }
    if (timeless === true)
      parsedDate.setHours(0, 0, 0, 0);
    return parsedDate;
  };
};
function compareDates(date1, date2, timeless) {
  if (timeless === void 0) {
    timeless = true;
  }
  if (timeless !== false) {
    return new Date(date1.getTime()).setHours(0, 0, 0, 0) - new Date(date2.getTime()).setHours(0, 0, 0, 0);
  }
  return date1.getTime() - date2.getTime();
}
var isBetween = function(ts, ts1, ts2) {
  return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);
};
var calculateSecondsSinceMidnight = function(hours, minutes, seconds) {
  return hours * 3600 + minutes * 60 + seconds;
};
var parseSeconds = function(secondsSinceMidnight) {
  var hours = Math.floor(secondsSinceMidnight / 3600), minutes = (secondsSinceMidnight - hours * 3600) / 60;
  return [hours, minutes, secondsSinceMidnight - hours * 3600 - minutes * 60];
};
var duration = {
  DAY: 864e5
};
function getDefaultHours(config) {
  var hours = config.defaultHour;
  var minutes = config.defaultMinute;
  var seconds = config.defaultSeconds;
  if (config.minDate !== void 0) {
    var minHour = config.minDate.getHours();
    var minMinutes = config.minDate.getMinutes();
    var minSeconds = config.minDate.getSeconds();
    if (hours < minHour) {
      hours = minHour;
    }
    if (hours === minHour && minutes < minMinutes) {
      minutes = minMinutes;
    }
    if (hours === minHour && minutes === minMinutes && seconds < minSeconds)
      seconds = config.minDate.getSeconds();
  }
  if (config.maxDate !== void 0) {
    var maxHr = config.maxDate.getHours();
    var maxMinutes = config.maxDate.getMinutes();
    hours = Math.min(hours, maxHr);
    if (hours === maxHr)
      minutes = Math.min(maxMinutes, minutes);
    if (hours === maxHr && minutes === maxMinutes)
      seconds = config.maxDate.getSeconds();
  }
  return { hours, minutes, seconds };
}

// node_modules/flatpickr/dist/esm/utils/polyfills.js
if (typeof Object.assign !== "function") {
  Object.assign = function(target) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
      args[_i - 1] = arguments[_i];
    }
    if (!target) {
      throw TypeError("Cannot convert undefined or null to object");
    }
    var _loop_1 = function(source2) {
      if (source2) {
        Object.keys(source2).forEach(function(key) {
          return target[key] = source2[key];
        });
      }
    };
    for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {
      var source = args_1[_a];
      _loop_1(source);
    }
    return target;
  };
}

// node_modules/flatpickr/dist/esm/index.js
var __assign = function() {
  __assign = Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s)
        if (Object.prototype.hasOwnProperty.call(s, p))
          t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};
var __spreadArrays = function() {
  for (var s = 0, i = 0, il = arguments.length; i < il; i++)
    s += arguments[i].length;
  for (var r = Array(s), k = 0, i = 0; i < il; i++)
    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
      r[k] = a[j];
  return r;
};
var DEBOUNCED_CHANGE_MS = 300;
function FlatpickrInstance(element, instanceConfig) {
  var self = {
    config: __assign(__assign({}, defaults), flatpickr.defaultConfig),
    l10n: default_default
  };
  self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  self._handlers = [];
  self.pluginElements = [];
  self.loadedPlugins = [];
  self._bind = bind;
  self._setHoursFromDate = setHoursFromDate;
  self._positionCalendar = positionCalendar;
  self.changeMonth = changeMonth;
  self.changeYear = changeYear;
  self.clear = clear;
  self.close = close;
  self.onMouseOver = onMouseOver;
  self._createElement = createElement;
  self.createDay = createDay;
  self.destroy = destroy;
  self.isEnabled = isEnabled;
  self.jumpToDate = jumpToDate;
  self.updateValue = updateValue;
  self.open = open;
  self.redraw = redraw;
  self.set = set;
  self.setDate = setDate;
  self.toggle = toggle;
  function setupHelperFunctions() {
    self.utils = {
      getDaysInMonth: function(month, yr) {
        if (month === void 0) {
          month = self.currentMonth;
        }
        if (yr === void 0) {
          yr = self.currentYear;
        }
        if (month === 1 && (yr % 4 === 0 && yr % 100 !== 0 || yr % 400 === 0))
          return 29;
        return self.l10n.daysInMonth[month];
      }
    };
  }
  function init() {
    self.element = self.input = element;
    self.isOpen = false;
    parseConfig();
    setupLocale();
    setupInputs();
    setupDates();
    setupHelperFunctions();
    if (!self.isMobile)
      build();
    bindEvents();
    if (self.selectedDates.length || self.config.noCalendar) {
      if (self.config.enableTime) {
        setHoursFromDate(self.config.noCalendar ? self.latestSelectedDateObj : void 0);
      }
      updateValue(false);
    }
    setCalendarWidth();
    var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
    if (!self.isMobile && isSafari) {
      positionCalendar();
    }
    triggerEvent("onReady");
  }
  function getClosestActiveElement() {
    var _a;
    return ((_a = self.calendarContainer) === null || _a === void 0 ? void 0 : _a.getRootNode()).activeElement || document.activeElement;
  }
  function bindToInstance(fn2) {
    return fn2.bind(self);
  }
  function setCalendarWidth() {
    var config = self.config;
    if (config.weekNumbers === false && config.showMonths === 1) {
      return;
    } else if (config.noCalendar !== true) {
      window.requestAnimationFrame(function() {
        if (self.calendarContainer !== void 0) {
          self.calendarContainer.style.visibility = "hidden";
          self.calendarContainer.style.display = "block";
        }
        if (self.daysContainer !== void 0) {
          var daysWidth = (self.days.offsetWidth + 1) * config.showMonths;
          self.daysContainer.style.width = daysWidth + "px";
          self.calendarContainer.style.width = daysWidth + (self.weekWrapper !== void 0 ? self.weekWrapper.offsetWidth : 0) + "px";
          self.calendarContainer.style.removeProperty("visibility");
          self.calendarContainer.style.removeProperty("display");
        }
      });
    }
  }
  function updateTime(e) {
    if (self.selectedDates.length === 0) {
      var defaultDate = self.config.minDate === void 0 || compareDates(new Date(), self.config.minDate) >= 0 ? new Date() : new Date(self.config.minDate.getTime());
      var defaults2 = getDefaultHours(self.config);
      defaultDate.setHours(defaults2.hours, defaults2.minutes, defaults2.seconds, defaultDate.getMilliseconds());
      self.selectedDates = [defaultDate];
      self.latestSelectedDateObj = defaultDate;
    }
    if (e !== void 0 && e.type !== "blur") {
      timeWrapper(e);
    }
    var prevValue = self._input.value;
    setHoursFromInputs();
    updateValue();
    if (self._input.value !== prevValue) {
      self._debouncedChange();
    }
  }
  function ampm2military(hour, amPM) {
    return hour % 12 + 12 * int(amPM === self.l10n.amPM[1]);
  }
  function military2ampm(hour) {
    switch (hour % 24) {
      case 0:
      case 12:
        return 12;
      default:
        return hour % 12;
    }
  }
  function setHoursFromInputs() {
    if (self.hourElement === void 0 || self.minuteElement === void 0)
      return;
    var hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== void 0 ? (parseInt(self.secondElement.value, 10) || 0) % 60 : 0;
    if (self.amPM !== void 0) {
      hours = ampm2military(hours, self.amPM.textContent);
    }
    var limitMinHours = self.config.minTime !== void 0 || self.config.minDate && self.minDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.minDate, true) === 0;
    var limitMaxHours = self.config.maxTime !== void 0 || self.config.maxDate && self.maxDateHasTime && self.latestSelectedDateObj && compareDates(self.latestSelectedDateObj, self.config.maxDate, true) === 0;
    if (self.config.maxTime !== void 0 && self.config.minTime !== void 0 && self.config.minTime > self.config.maxTime) {
      var minBound = calculateSecondsSinceMidnight(self.config.minTime.getHours(), self.config.minTime.getMinutes(), self.config.minTime.getSeconds());
      var maxBound = calculateSecondsSinceMidnight(self.config.maxTime.getHours(), self.config.maxTime.getMinutes(), self.config.maxTime.getSeconds());
      var currentTime = calculateSecondsSinceMidnight(hours, minutes, seconds);
      if (currentTime > maxBound && currentTime < minBound) {
        var result = parseSeconds(minBound);
        hours = result[0];
        minutes = result[1];
        seconds = result[2];
      }
    } else {
      if (limitMaxHours) {
        var maxTime = self.config.maxTime !== void 0 ? self.config.maxTime : self.config.maxDate;
        hours = Math.min(hours, maxTime.getHours());
        if (hours === maxTime.getHours())
          minutes = Math.min(minutes, maxTime.getMinutes());
        if (minutes === maxTime.getMinutes())
          seconds = Math.min(seconds, maxTime.getSeconds());
      }
      if (limitMinHours) {
        var minTime = self.config.minTime !== void 0 ? self.config.minTime : self.config.minDate;
        hours = Math.max(hours, minTime.getHours());
        if (hours === minTime.getHours() && minutes < minTime.getMinutes())
          minutes = minTime.getMinutes();
        if (minutes === minTime.getMinutes())
          seconds = Math.max(seconds, minTime.getSeconds());
      }
    }
    setHours(hours, minutes, seconds);
  }
  function setHoursFromDate(dateObj) {
    var date = dateObj || self.latestSelectedDateObj;
    if (date && date instanceof Date) {
      setHours(date.getHours(), date.getMinutes(), date.getSeconds());
    }
  }
  function setHours(hours, minutes, seconds) {
    if (self.latestSelectedDateObj !== void 0) {
      self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);
    }
    if (!self.hourElement || !self.minuteElement || self.isMobile)
      return;
    self.hourElement.value = pad(!self.config.time_24hr ? (12 + hours) % 12 + 12 * int(hours % 12 === 0) : hours);
    self.minuteElement.value = pad(minutes);
    if (self.amPM !== void 0)
      self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];
    if (self.secondElement !== void 0)
      self.secondElement.value = pad(seconds);
  }
  function onYearInput(event) {
    var eventTarget = getEventTarget(event);
    var year = parseInt(eventTarget.value) + (event.delta || 0);
    if (year / 1e3 > 1 || event.key === "Enter" && !/[^\d]/.test(year.toString())) {
      changeYear(year);
    }
  }
  function bind(element2, event, handler, options) {
    if (event instanceof Array)
      return event.forEach(function(ev) {
        return bind(element2, ev, handler, options);
      });
    if (element2 instanceof Array)
      return element2.forEach(function(el) {
        return bind(el, event, handler, options);
      });
    element2.addEventListener(event, handler, options);
    self._handlers.push({
      remove: function() {
        return element2.removeEventListener(event, handler, options);
      }
    });
  }
  function triggerChange() {
    triggerEvent("onChange");
  }
  function bindEvents() {
    if (self.config.wrap) {
      ["open", "close", "toggle", "clear"].forEach(function(evt) {
        Array.prototype.forEach.call(self.element.querySelectorAll("[data-" + evt + "]"), function(el) {
          return bind(el, "click", self[evt]);
        });
      });
    }
    if (self.isMobile) {
      setupMobile();
      return;
    }
    var debouncedResize = debounce2(onResize, 50);
    self._debouncedChange = debounce2(triggerChange, DEBOUNCED_CHANGE_MS);
    if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))
      bind(self.daysContainer, "mouseover", function(e) {
        if (self.config.mode === "range")
          onMouseOver(getEventTarget(e));
      });
    bind(self._input, "keydown", onKeyDown);
    if (self.calendarContainer !== void 0) {
      bind(self.calendarContainer, "keydown", onKeyDown);
    }
    if (!self.config.inline && !self.config.static)
      bind(window, "resize", debouncedResize);
    if (window.ontouchstart !== void 0)
      bind(window.document, "touchstart", documentClick);
    else
      bind(window.document, "mousedown", documentClick);
    bind(window.document, "focus", documentClick, { capture: true });
    if (self.config.clickOpens === true) {
      bind(self._input, "focus", self.open);
      bind(self._input, "click", self.open);
    }
    if (self.daysContainer !== void 0) {
      bind(self.monthNav, "click", onMonthNavClick);
      bind(self.monthNav, ["keyup", "increment"], onYearInput);
      bind(self.daysContainer, "click", selectDate);
    }
    if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0) {
      var selText = function(e) {
        return getEventTarget(e).select();
      };
      bind(self.timeContainer, ["increment"], updateTime);
      bind(self.timeContainer, "blur", updateTime, { capture: true });
      bind(self.timeContainer, "click", timeIncrement);
      bind([self.hourElement, self.minuteElement], ["focus", "click"], selText);
      if (self.secondElement !== void 0)
        bind(self.secondElement, "focus", function() {
          return self.secondElement && self.secondElement.select();
        });
      if (self.amPM !== void 0) {
        bind(self.amPM, "click", function(e) {
          updateTime(e);
        });
      }
    }
    if (self.config.allowInput) {
      bind(self._input, "blur", onBlur);
    }
  }
  function jumpToDate(jumpDate, triggerChange2) {
    var jumpTo = jumpDate !== void 0 ? self.parseDate(jumpDate) : self.latestSelectedDateObj || (self.config.minDate && self.config.minDate > self.now ? self.config.minDate : self.config.maxDate && self.config.maxDate < self.now ? self.config.maxDate : self.now);
    var oldYear = self.currentYear;
    var oldMonth = self.currentMonth;
    try {
      if (jumpTo !== void 0) {
        self.currentYear = jumpTo.getFullYear();
        self.currentMonth = jumpTo.getMonth();
      }
    } catch (e) {
      e.message = "Invalid date supplied: " + jumpTo;
      self.config.errorHandler(e);
    }
    if (triggerChange2 && self.currentYear !== oldYear) {
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    if (triggerChange2 && (self.currentYear !== oldYear || self.currentMonth !== oldMonth)) {
      triggerEvent("onMonthChange");
    }
    self.redraw();
  }
  function timeIncrement(e) {
    var eventTarget = getEventTarget(e);
    if (~eventTarget.className.indexOf("arrow"))
      incrementNumInput(e, eventTarget.classList.contains("arrowUp") ? 1 : -1);
  }
  function incrementNumInput(e, delta, inputElem) {
    var target = e && getEventTarget(e);
    var input = inputElem || target && target.parentNode && target.parentNode.firstChild;
    var event = createEvent("increment");
    event.delta = delta;
    input && input.dispatchEvent(event);
  }
  function build() {
    var fragment = window.document.createDocumentFragment();
    self.calendarContainer = createElement("div", "flatpickr-calendar");
    self.calendarContainer.tabIndex = -1;
    if (!self.config.noCalendar) {
      fragment.appendChild(buildMonthNav());
      self.innerContainer = createElement("div", "flatpickr-innerContainer");
      if (self.config.weekNumbers) {
        var _a = buildWeeks(), weekWrapper = _a.weekWrapper, weekNumbers = _a.weekNumbers;
        self.innerContainer.appendChild(weekWrapper);
        self.weekNumbers = weekNumbers;
        self.weekWrapper = weekWrapper;
      }
      self.rContainer = createElement("div", "flatpickr-rContainer");
      self.rContainer.appendChild(buildWeekdays());
      if (!self.daysContainer) {
        self.daysContainer = createElement("div", "flatpickr-days");
        self.daysContainer.tabIndex = -1;
      }
      buildDays();
      self.rContainer.appendChild(self.daysContainer);
      self.innerContainer.appendChild(self.rContainer);
      fragment.appendChild(self.innerContainer);
    }
    if (self.config.enableTime) {
      fragment.appendChild(buildTime());
    }
    toggleClass(self.calendarContainer, "rangeMode", self.config.mode === "range");
    toggleClass(self.calendarContainer, "animate", self.config.animate === true);
    toggleClass(self.calendarContainer, "multiMonth", self.config.showMonths > 1);
    self.calendarContainer.appendChild(fragment);
    var customAppend = self.config.appendTo !== void 0 && self.config.appendTo.nodeType !== void 0;
    if (self.config.inline || self.config.static) {
      self.calendarContainer.classList.add(self.config.inline ? "inline" : "static");
      if (self.config.inline) {
        if (!customAppend && self.element.parentNode)
          self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);
        else if (self.config.appendTo !== void 0)
          self.config.appendTo.appendChild(self.calendarContainer);
      }
      if (self.config.static) {
        var wrapper = createElement("div", "flatpickr-wrapper");
        if (self.element.parentNode)
          self.element.parentNode.insertBefore(wrapper, self.element);
        wrapper.appendChild(self.element);
        if (self.altInput)
          wrapper.appendChild(self.altInput);
        wrapper.appendChild(self.calendarContainer);
      }
    }
    if (!self.config.static && !self.config.inline)
      (self.config.appendTo !== void 0 ? self.config.appendTo : window.document.body).appendChild(self.calendarContainer);
  }
  function createDay(className, date, _dayNumber, i) {
    var dateIsEnabled = isEnabled(date, true), dayElement = createElement("span", className, date.getDate().toString());
    dayElement.dateObj = date;
    dayElement.$i = i;
    dayElement.setAttribute("aria-label", self.formatDate(date, self.config.ariaDateFormat));
    if (className.indexOf("hidden") === -1 && compareDates(date, self.now) === 0) {
      self.todayDateElem = dayElement;
      dayElement.classList.add("today");
      dayElement.setAttribute("aria-current", "date");
    }
    if (dateIsEnabled) {
      dayElement.tabIndex = -1;
      if (isDateSelected(date)) {
        dayElement.classList.add("selected");
        self.selectedDateElem = dayElement;
        if (self.config.mode === "range") {
          toggleClass(dayElement, "startRange", self.selectedDates[0] && compareDates(date, self.selectedDates[0], true) === 0);
          toggleClass(dayElement, "endRange", self.selectedDates[1] && compareDates(date, self.selectedDates[1], true) === 0);
          if (className === "nextMonthDay")
            dayElement.classList.add("inRange");
        }
      }
    } else {
      dayElement.classList.add("flatpickr-disabled");
    }
    if (self.config.mode === "range") {
      if (isDateInRange(date) && !isDateSelected(date))
        dayElement.classList.add("inRange");
    }
    if (self.weekNumbers && self.config.showMonths === 1 && className !== "prevMonthDay" && i % 7 === 6) {
      self.weekNumbers.insertAdjacentHTML("beforeend", "<span class='flatpickr-day'>" + self.config.getWeek(date) + "</span>");
    }
    triggerEvent("onDayCreate", dayElement);
    return dayElement;
  }
  function focusOnDayElem(targetNode) {
    targetNode.focus();
    if (self.config.mode === "range")
      onMouseOver(targetNode);
  }
  function getFirstAvailableDay(delta) {
    var startMonth = delta > 0 ? 0 : self.config.showMonths - 1;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    for (var m = startMonth; m != endMonth; m += delta) {
      var month = self.daysContainer.children[m];
      var startIndex = delta > 0 ? 0 : month.children.length - 1;
      var endIndex = delta > 0 ? month.children.length : -1;
      for (var i = startIndex; i != endIndex; i += delta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj))
          return c;
      }
    }
    return void 0;
  }
  function getNextAvailableDay(current, delta) {
    var givenMonth = current.className.indexOf("Month") === -1 ? current.dateObj.getMonth() : self.currentMonth;
    var endMonth = delta > 0 ? self.config.showMonths : -1;
    var loopDelta = delta > 0 ? 1 : -1;
    for (var m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {
      var month = self.daysContainer.children[m];
      var startIndex = givenMonth - self.currentMonth === m ? current.$i + delta : delta < 0 ? month.children.length - 1 : 0;
      var numMonthDays = month.children.length;
      for (var i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {
        var c = month.children[i];
        if (c.className.indexOf("hidden") === -1 && isEnabled(c.dateObj) && Math.abs(current.$i - i) >= Math.abs(delta))
          return focusOnDayElem(c);
      }
    }
    self.changeMonth(loopDelta);
    focusOnDay(getFirstAvailableDay(loopDelta), 0);
    return void 0;
  }
  function focusOnDay(current, offset2) {
    var activeElement = getClosestActiveElement();
    var dayFocused = isInView(activeElement || document.body);
    var startElem = current !== void 0 ? current : dayFocused ? activeElement : self.selectedDateElem !== void 0 && isInView(self.selectedDateElem) ? self.selectedDateElem : self.todayDateElem !== void 0 && isInView(self.todayDateElem) ? self.todayDateElem : getFirstAvailableDay(offset2 > 0 ? 1 : -1);
    if (startElem === void 0) {
      self._input.focus();
    } else if (!dayFocused) {
      focusOnDayElem(startElem);
    } else {
      getNextAvailableDay(startElem, offset2);
    }
  }
  function buildMonthDays(year, month) {
    var firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;
    var prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12, year);
    var daysInMonth = self.utils.getDaysInMonth(month, year), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? "prevMonthDay hidden" : "prevMonthDay", nextMonthDayClass = isMultiMonth ? "nextMonthDay hidden" : "nextMonthDay";
    var dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;
    for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));
    }
    for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day", new Date(year, month, dayNumber), dayNumber, dayIndex));
    }
    for (var dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth && (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {
      days.appendChild(createDay("flatpickr-day " + nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));
    }
    var dayContainer = createElement("div", "dayContainer");
    dayContainer.appendChild(days);
    return dayContainer;
  }
  function buildDays() {
    if (self.daysContainer === void 0) {
      return;
    }
    clearNode(self.daysContainer);
    if (self.weekNumbers)
      clearNode(self.weekNumbers);
    var frag = document.createDocumentFragment();
    for (var i = 0; i < self.config.showMonths; i++) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));
    }
    self.daysContainer.appendChild(frag);
    self.days = self.daysContainer.firstChild;
    if (self.config.mode === "range" && self.selectedDates.length === 1) {
      onMouseOver();
    }
  }
  function buildMonthSwitch() {
    if (self.config.showMonths > 1 || self.config.monthSelectorType !== "dropdown")
      return;
    var shouldBuildMonth = function(month2) {
      if (self.config.minDate !== void 0 && self.currentYear === self.config.minDate.getFullYear() && month2 < self.config.minDate.getMonth()) {
        return false;
      }
      return !(self.config.maxDate !== void 0 && self.currentYear === self.config.maxDate.getFullYear() && month2 > self.config.maxDate.getMonth());
    };
    self.monthsDropdownContainer.tabIndex = -1;
    self.monthsDropdownContainer.innerHTML = "";
    for (var i = 0; i < 12; i++) {
      if (!shouldBuildMonth(i))
        continue;
      var month = createElement("option", "flatpickr-monthDropdown-month");
      month.value = new Date(self.currentYear, i).getMonth().toString();
      month.textContent = monthToStr(i, self.config.shorthandCurrentMonth, self.l10n);
      month.tabIndex = -1;
      if (self.currentMonth === i) {
        month.selected = true;
      }
      self.monthsDropdownContainer.appendChild(month);
    }
  }
  function buildMonth() {
    var container = createElement("div", "flatpickr-month");
    var monthNavFragment = window.document.createDocumentFragment();
    var monthElement;
    if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
      monthElement = createElement("span", "cur-month");
    } else {
      self.monthsDropdownContainer = createElement("select", "flatpickr-monthDropdown-months");
      self.monthsDropdownContainer.setAttribute("aria-label", self.l10n.monthAriaLabel);
      bind(self.monthsDropdownContainer, "change", function(e) {
        var target = getEventTarget(e);
        var selectedMonth = parseInt(target.value, 10);
        self.changeMonth(selectedMonth - self.currentMonth);
        triggerEvent("onMonthChange");
      });
      buildMonthSwitch();
      monthElement = self.monthsDropdownContainer;
    }
    var yearInput = createNumberInput("cur-year", { tabindex: "-1" });
    var yearElement = yearInput.getElementsByTagName("input")[0];
    yearElement.setAttribute("aria-label", self.l10n.yearAriaLabel);
    if (self.config.minDate) {
      yearElement.setAttribute("min", self.config.minDate.getFullYear().toString());
    }
    if (self.config.maxDate) {
      yearElement.setAttribute("max", self.config.maxDate.getFullYear().toString());
      yearElement.disabled = !!self.config.minDate && self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();
    }
    var currentMonth = createElement("div", "flatpickr-current-month");
    currentMonth.appendChild(monthElement);
    currentMonth.appendChild(yearInput);
    monthNavFragment.appendChild(currentMonth);
    container.appendChild(monthNavFragment);
    return {
      container,
      yearElement,
      monthElement
    };
  }
  function buildMonths() {
    clearNode(self.monthNav);
    self.monthNav.appendChild(self.prevMonthNav);
    if (self.config.showMonths) {
      self.yearElements = [];
      self.monthElements = [];
    }
    for (var m = self.config.showMonths; m--; ) {
      var month = buildMonth();
      self.yearElements.push(month.yearElement);
      self.monthElements.push(month.monthElement);
      self.monthNav.appendChild(month.container);
    }
    self.monthNav.appendChild(self.nextMonthNav);
  }
  function buildMonthNav() {
    self.monthNav = createElement("div", "flatpickr-months");
    self.yearElements = [];
    self.monthElements = [];
    self.prevMonthNav = createElement("span", "flatpickr-prev-month");
    self.prevMonthNav.innerHTML = self.config.prevArrow;
    self.nextMonthNav = createElement("span", "flatpickr-next-month");
    self.nextMonthNav.innerHTML = self.config.nextArrow;
    buildMonths();
    Object.defineProperty(self, "_hidePrevMonthArrow", {
      get: function() {
        return self.__hidePrevMonthArrow;
      },
      set: function(bool) {
        if (self.__hidePrevMonthArrow !== bool) {
          toggleClass(self.prevMonthNav, "flatpickr-disabled", bool);
          self.__hidePrevMonthArrow = bool;
        }
      }
    });
    Object.defineProperty(self, "_hideNextMonthArrow", {
      get: function() {
        return self.__hideNextMonthArrow;
      },
      set: function(bool) {
        if (self.__hideNextMonthArrow !== bool) {
          toggleClass(self.nextMonthNav, "flatpickr-disabled", bool);
          self.__hideNextMonthArrow = bool;
        }
      }
    });
    self.currentYearElement = self.yearElements[0];
    updateNavigationCurrentMonth();
    return self.monthNav;
  }
  function buildTime() {
    self.calendarContainer.classList.add("hasTime");
    if (self.config.noCalendar)
      self.calendarContainer.classList.add("noCalendar");
    var defaults2 = getDefaultHours(self.config);
    self.timeContainer = createElement("div", "flatpickr-time");
    self.timeContainer.tabIndex = -1;
    var separator = createElement("span", "flatpickr-time-separator", ":");
    var hourInput = createNumberInput("flatpickr-hour", {
      "aria-label": self.l10n.hourAriaLabel
    });
    self.hourElement = hourInput.getElementsByTagName("input")[0];
    var minuteInput = createNumberInput("flatpickr-minute", {
      "aria-label": self.l10n.minuteAriaLabel
    });
    self.minuteElement = minuteInput.getElementsByTagName("input")[0];
    self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;
    self.hourElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getHours() : self.config.time_24hr ? defaults2.hours : military2ampm(defaults2.hours));
    self.minuteElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getMinutes() : defaults2.minutes);
    self.hourElement.setAttribute("step", self.config.hourIncrement.toString());
    self.minuteElement.setAttribute("step", self.config.minuteIncrement.toString());
    self.hourElement.setAttribute("min", self.config.time_24hr ? "0" : "1");
    self.hourElement.setAttribute("max", self.config.time_24hr ? "23" : "12");
    self.hourElement.setAttribute("maxlength", "2");
    self.minuteElement.setAttribute("min", "0");
    self.minuteElement.setAttribute("max", "59");
    self.minuteElement.setAttribute("maxlength", "2");
    self.timeContainer.appendChild(hourInput);
    self.timeContainer.appendChild(separator);
    self.timeContainer.appendChild(minuteInput);
    if (self.config.time_24hr)
      self.timeContainer.classList.add("time24hr");
    if (self.config.enableSeconds) {
      self.timeContainer.classList.add("hasSeconds");
      var secondInput = createNumberInput("flatpickr-second");
      self.secondElement = secondInput.getElementsByTagName("input")[0];
      self.secondElement.value = pad(self.latestSelectedDateObj ? self.latestSelectedDateObj.getSeconds() : defaults2.seconds);
      self.secondElement.setAttribute("step", self.minuteElement.getAttribute("step"));
      self.secondElement.setAttribute("min", "0");
      self.secondElement.setAttribute("max", "59");
      self.secondElement.setAttribute("maxlength", "2");
      self.timeContainer.appendChild(createElement("span", "flatpickr-time-separator", ":"));
      self.timeContainer.appendChild(secondInput);
    }
    if (!self.config.time_24hr) {
      self.amPM = createElement("span", "flatpickr-am-pm", self.l10n.amPM[int((self.latestSelectedDateObj ? self.hourElement.value : self.config.defaultHour) > 11)]);
      self.amPM.title = self.l10n.toggleTitle;
      self.amPM.tabIndex = -1;
      self.timeContainer.appendChild(self.amPM);
    }
    return self.timeContainer;
  }
  function buildWeekdays() {
    if (!self.weekdayContainer)
      self.weekdayContainer = createElement("div", "flatpickr-weekdays");
    else
      clearNode(self.weekdayContainer);
    for (var i = self.config.showMonths; i--; ) {
      var container = createElement("div", "flatpickr-weekdaycontainer");
      self.weekdayContainer.appendChild(container);
    }
    updateWeekdays();
    return self.weekdayContainer;
  }
  function updateWeekdays() {
    if (!self.weekdayContainer) {
      return;
    }
    var firstDayOfWeek = self.l10n.firstDayOfWeek;
    var weekdays = __spreadArrays(self.l10n.weekdays.shorthand);
    if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {
      weekdays = __spreadArrays(weekdays.splice(firstDayOfWeek, weekdays.length), weekdays.splice(0, firstDayOfWeek));
    }
    for (var i = self.config.showMonths; i--; ) {
      self.weekdayContainer.children[i].innerHTML = "\n      <span class='flatpickr-weekday'>\n        " + weekdays.join("</span><span class='flatpickr-weekday'>") + "\n      </span>\n      ";
    }
  }
  function buildWeeks() {
    self.calendarContainer.classList.add("hasWeeks");
    var weekWrapper = createElement("div", "flatpickr-weekwrapper");
    weekWrapper.appendChild(createElement("span", "flatpickr-weekday", self.l10n.weekAbbreviation));
    var weekNumbers = createElement("div", "flatpickr-weeks");
    weekWrapper.appendChild(weekNumbers);
    return {
      weekWrapper,
      weekNumbers
    };
  }
  function changeMonth(value, isOffset) {
    if (isOffset === void 0) {
      isOffset = true;
    }
    var delta = isOffset ? value : value - self.currentMonth;
    if (delta < 0 && self._hidePrevMonthArrow === true || delta > 0 && self._hideNextMonthArrow === true)
      return;
    self.currentMonth += delta;
    if (self.currentMonth < 0 || self.currentMonth > 11) {
      self.currentYear += self.currentMonth > 11 ? 1 : -1;
      self.currentMonth = (self.currentMonth + 12) % 12;
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
    buildDays();
    triggerEvent("onMonthChange");
    updateNavigationCurrentMonth();
  }
  function clear(triggerChangeEvent, toInitial) {
    if (triggerChangeEvent === void 0) {
      triggerChangeEvent = true;
    }
    if (toInitial === void 0) {
      toInitial = true;
    }
    self.input.value = "";
    if (self.altInput !== void 0)
      self.altInput.value = "";
    if (self.mobileInput !== void 0)
      self.mobileInput.value = "";
    self.selectedDates = [];
    self.latestSelectedDateObj = void 0;
    if (toInitial === true) {
      self.currentYear = self._initialDate.getFullYear();
      self.currentMonth = self._initialDate.getMonth();
    }
    if (self.config.enableTime === true) {
      var _a = getDefaultHours(self.config), hours = _a.hours, minutes = _a.minutes, seconds = _a.seconds;
      setHours(hours, minutes, seconds);
    }
    self.redraw();
    if (triggerChangeEvent)
      triggerEvent("onChange");
  }
  function close() {
    self.isOpen = false;
    if (!self.isMobile) {
      if (self.calendarContainer !== void 0) {
        self.calendarContainer.classList.remove("open");
      }
      if (self._input !== void 0) {
        self._input.classList.remove("active");
      }
    }
    triggerEvent("onClose");
  }
  function destroy() {
    if (self.config !== void 0)
      triggerEvent("onDestroy");
    for (var i = self._handlers.length; i--; ) {
      self._handlers[i].remove();
    }
    self._handlers = [];
    if (self.mobileInput) {
      if (self.mobileInput.parentNode)
        self.mobileInput.parentNode.removeChild(self.mobileInput);
      self.mobileInput = void 0;
    } else if (self.calendarContainer && self.calendarContainer.parentNode) {
      if (self.config.static && self.calendarContainer.parentNode) {
        var wrapper = self.calendarContainer.parentNode;
        wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);
        if (wrapper.parentNode) {
          while (wrapper.firstChild)
            wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);
          wrapper.parentNode.removeChild(wrapper);
        }
      } else
        self.calendarContainer.parentNode.removeChild(self.calendarContainer);
    }
    if (self.altInput) {
      self.input.type = "text";
      if (self.altInput.parentNode)
        self.altInput.parentNode.removeChild(self.altInput);
      delete self.altInput;
    }
    if (self.input) {
      self.input.type = self.input._type;
      self.input.classList.remove("flatpickr-input");
      self.input.removeAttribute("readonly");
    }
    [
      "_showTimeInput",
      "latestSelectedDateObj",
      "_hideNextMonthArrow",
      "_hidePrevMonthArrow",
      "__hideNextMonthArrow",
      "__hidePrevMonthArrow",
      "isMobile",
      "isOpen",
      "selectedDateElem",
      "minDateHasTime",
      "maxDateHasTime",
      "days",
      "daysContainer",
      "_input",
      "_positionElement",
      "innerContainer",
      "rContainer",
      "monthNav",
      "todayDateElem",
      "calendarContainer",
      "weekdayContainer",
      "prevMonthNav",
      "nextMonthNav",
      "monthsDropdownContainer",
      "currentMonthElement",
      "currentYearElement",
      "navigationCurrentMonth",
      "selectedDateElem",
      "config"
    ].forEach(function(k) {
      try {
        delete self[k];
      } catch (_) {
      }
    });
  }
  function isCalendarElem(elem) {
    return self.calendarContainer.contains(elem);
  }
  function documentClick(e) {
    if (self.isOpen && !self.config.inline) {
      var eventTarget_1 = getEventTarget(e);
      var isCalendarElement = isCalendarElem(eventTarget_1);
      var isInput = eventTarget_1 === self.input || eventTarget_1 === self.altInput || self.element.contains(eventTarget_1) || e.path && e.path.indexOf && (~e.path.indexOf(self.input) || ~e.path.indexOf(self.altInput));
      var lostFocus = !isInput && !isCalendarElement && !isCalendarElem(e.relatedTarget);
      var isIgnored = !self.config.ignoredFocusElements.some(function(elem) {
        return elem.contains(eventTarget_1);
      });
      if (lostFocus && isIgnored) {
        if (self.config.allowInput) {
          self.setDate(self._input.value, false, self.config.altInput ? self.config.altFormat : self.config.dateFormat);
        }
        if (self.timeContainer !== void 0 && self.minuteElement !== void 0 && self.hourElement !== void 0 && self.input.value !== "" && self.input.value !== void 0) {
          updateTime();
        }
        self.close();
        if (self.config && self.config.mode === "range" && self.selectedDates.length === 1)
          self.clear(false);
      }
    }
  }
  function changeYear(newYear) {
    if (!newYear || self.config.minDate && newYear < self.config.minDate.getFullYear() || self.config.maxDate && newYear > self.config.maxDate.getFullYear())
      return;
    var newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;
    self.currentYear = newYearNum || self.currentYear;
    if (self.config.maxDate && self.currentYear === self.config.maxDate.getFullYear()) {
      self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);
    } else if (self.config.minDate && self.currentYear === self.config.minDate.getFullYear()) {
      self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);
    }
    if (isNewYear) {
      self.redraw();
      triggerEvent("onYearChange");
      buildMonthSwitch();
    }
  }
  function isEnabled(date, timeless) {
    var _a;
    if (timeless === void 0) {
      timeless = true;
    }
    var dateToCheck = self.parseDate(date, void 0, timeless);
    if (self.config.minDate && dateToCheck && compareDates(dateToCheck, self.config.minDate, timeless !== void 0 ? timeless : !self.minDateHasTime) < 0 || self.config.maxDate && dateToCheck && compareDates(dateToCheck, self.config.maxDate, timeless !== void 0 ? timeless : !self.maxDateHasTime) > 0)
      return false;
    if (!self.config.enable && self.config.disable.length === 0)
      return true;
    if (dateToCheck === void 0)
      return false;
    var bool = !!self.config.enable, array = (_a = self.config.enable) !== null && _a !== void 0 ? _a : self.config.disable;
    for (var i = 0, d = void 0; i < array.length; i++) {
      d = array[i];
      if (typeof d === "function" && d(dateToCheck))
        return bool;
      else if (d instanceof Date && dateToCheck !== void 0 && d.getTime() === dateToCheck.getTime())
        return bool;
      else if (typeof d === "string") {
        var parsed = self.parseDate(d, void 0, true);
        return parsed && parsed.getTime() === dateToCheck.getTime() ? bool : !bool;
      } else if (typeof d === "object" && dateToCheck !== void 0 && d.from && d.to && dateToCheck.getTime() >= d.from.getTime() && dateToCheck.getTime() <= d.to.getTime())
        return bool;
    }
    return !bool;
  }
  function isInView(elem) {
    if (self.daysContainer !== void 0)
      return elem.className.indexOf("hidden") === -1 && elem.className.indexOf("flatpickr-disabled") === -1 && self.daysContainer.contains(elem);
    return false;
  }
  function onBlur(e) {
    var isInput = e.target === self._input;
    var valueChanged = self._input.value.trimEnd() !== getDateStr();
    if (isInput && valueChanged && !(e.relatedTarget && isCalendarElem(e.relatedTarget))) {
      self.setDate(self._input.value, true, e.target === self.altInput ? self.config.altFormat : self.config.dateFormat);
    }
  }
  function onKeyDown(e) {
    var eventTarget = getEventTarget(e);
    var isInput = self.config.wrap ? element.contains(eventTarget) : eventTarget === self._input;
    var allowInput = self.config.allowInput;
    var allowKeydown = self.isOpen && (!allowInput || !isInput);
    var allowInlineKeydown = self.config.inline && isInput && !allowInput;
    if (e.keyCode === 13 && isInput) {
      if (allowInput) {
        self.setDate(self._input.value, true, eventTarget === self.altInput ? self.config.altFormat : self.config.dateFormat);
        self.close();
        return eventTarget.blur();
      } else {
        self.open();
      }
    } else if (isCalendarElem(eventTarget) || allowKeydown || allowInlineKeydown) {
      var isTimeObj = !!self.timeContainer && self.timeContainer.contains(eventTarget);
      switch (e.keyCode) {
        case 13:
          if (isTimeObj) {
            e.preventDefault();
            updateTime();
            focusAndClose();
          } else
            selectDate(e);
          break;
        case 27:
          e.preventDefault();
          focusAndClose();
          break;
        case 8:
        case 46:
          if (isInput && !self.config.allowInput) {
            e.preventDefault();
            self.clear();
          }
          break;
        case 37:
        case 39:
          if (!isTimeObj && !isInput) {
            e.preventDefault();
            var activeElement = getClosestActiveElement();
            if (self.daysContainer !== void 0 && (allowInput === false || activeElement && isInView(activeElement))) {
              var delta_1 = e.keyCode === 39 ? 1 : -1;
              if (!e.ctrlKey)
                focusOnDay(void 0, delta_1);
              else {
                e.stopPropagation();
                changeMonth(delta_1);
                focusOnDay(getFirstAvailableDay(1), 0);
              }
            }
          } else if (self.hourElement)
            self.hourElement.focus();
          break;
        case 38:
        case 40:
          e.preventDefault();
          var delta = e.keyCode === 40 ? 1 : -1;
          if (self.daysContainer && eventTarget.$i !== void 0 || eventTarget === self.input || eventTarget === self.altInput) {
            if (e.ctrlKey) {
              e.stopPropagation();
              changeYear(self.currentYear - delta);
              focusOnDay(getFirstAvailableDay(1), 0);
            } else if (!isTimeObj)
              focusOnDay(void 0, delta * 7);
          } else if (eventTarget === self.currentYearElement) {
            changeYear(self.currentYear - delta);
          } else if (self.config.enableTime) {
            if (!isTimeObj && self.hourElement)
              self.hourElement.focus();
            updateTime(e);
            self._debouncedChange();
          }
          break;
        case 9:
          if (isTimeObj) {
            var elems = [
              self.hourElement,
              self.minuteElement,
              self.secondElement,
              self.amPM
            ].concat(self.pluginElements).filter(function(x) {
              return x;
            });
            var i = elems.indexOf(eventTarget);
            if (i !== -1) {
              var target = elems[i + (e.shiftKey ? -1 : 1)];
              e.preventDefault();
              (target || self._input).focus();
            }
          } else if (!self.config.noCalendar && self.daysContainer && self.daysContainer.contains(eventTarget) && e.shiftKey) {
            e.preventDefault();
            self._input.focus();
          }
          break;
        default:
          break;
      }
    }
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      switch (e.key) {
        case self.l10n.amPM[0].charAt(0):
        case self.l10n.amPM[0].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[0];
          setHoursFromInputs();
          updateValue();
          break;
        case self.l10n.amPM[1].charAt(0):
        case self.l10n.amPM[1].charAt(0).toLowerCase():
          self.amPM.textContent = self.l10n.amPM[1];
          setHoursFromInputs();
          updateValue();
          break;
      }
    }
    if (isInput || isCalendarElem(eventTarget)) {
      triggerEvent("onKeyDown", e);
    }
  }
  function onMouseOver(elem, cellClass) {
    if (cellClass === void 0) {
      cellClass = "flatpickr-day";
    }
    if (self.selectedDates.length !== 1 || elem && (!elem.classList.contains(cellClass) || elem.classList.contains("flatpickr-disabled")))
      return;
    var hoverDate = elem ? elem.dateObj.getTime() : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], void 0, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime());
    var containsDisabled = false;
    var minRange = 0, maxRange = 0;
    for (var t = rangeStartDate; t < rangeEndDate; t += duration.DAY) {
      if (!isEnabled(new Date(t), true)) {
        containsDisabled = containsDisabled || t > rangeStartDate && t < rangeEndDate;
        if (t < initialDate && (!minRange || t > minRange))
          minRange = t;
        else if (t > initialDate && (!maxRange || t < maxRange))
          maxRange = t;
      }
    }
    var hoverableCells = Array.from(self.rContainer.querySelectorAll("*:nth-child(-n+" + self.config.showMonths + ") > ." + cellClass));
    hoverableCells.forEach(function(dayElem) {
      var date = dayElem.dateObj;
      var timestamp = date.getTime();
      var outOfRange = minRange > 0 && timestamp < minRange || maxRange > 0 && timestamp > maxRange;
      if (outOfRange) {
        dayElem.classList.add("notAllowed");
        ["inRange", "startRange", "endRange"].forEach(function(c) {
          dayElem.classList.remove(c);
        });
        return;
      } else if (containsDisabled && !outOfRange)
        return;
      ["startRange", "inRange", "endRange", "notAllowed"].forEach(function(c) {
        dayElem.classList.remove(c);
      });
      if (elem !== void 0) {
        elem.classList.add(hoverDate <= self.selectedDates[0].getTime() ? "startRange" : "endRange");
        if (initialDate < hoverDate && timestamp === initialDate)
          dayElem.classList.add("startRange");
        else if (initialDate > hoverDate && timestamp === initialDate)
          dayElem.classList.add("endRange");
        if (timestamp >= minRange && (maxRange === 0 || timestamp <= maxRange) && isBetween(timestamp, initialDate, hoverDate))
          dayElem.classList.add("inRange");
      }
    });
  }
  function onResize() {
    if (self.isOpen && !self.config.static && !self.config.inline)
      positionCalendar();
  }
  function open(e, positionElement) {
    if (positionElement === void 0) {
      positionElement = self._positionElement;
    }
    if (self.isMobile === true) {
      if (e) {
        e.preventDefault();
        var eventTarget = getEventTarget(e);
        if (eventTarget) {
          eventTarget.blur();
        }
      }
      if (self.mobileInput !== void 0) {
        self.mobileInput.focus();
        self.mobileInput.click();
      }
      triggerEvent("onOpen");
      return;
    } else if (self._input.disabled || self.config.inline) {
      return;
    }
    var wasOpen = self.isOpen;
    self.isOpen = true;
    if (!wasOpen) {
      self.calendarContainer.classList.add("open");
      self._input.classList.add("active");
      triggerEvent("onOpen");
      positionCalendar(positionElement);
    }
    if (self.config.enableTime === true && self.config.noCalendar === true) {
      if (self.config.allowInput === false && (e === void 0 || !self.timeContainer.contains(e.relatedTarget))) {
        setTimeout(function() {
          return self.hourElement.select();
        }, 50);
      }
    }
  }
  function minMaxDateSetter(type) {
    return function(date) {
      var dateObj = self.config["_" + type + "Date"] = self.parseDate(date, self.config.dateFormat);
      var inverseDateObj = self.config["_" + (type === "min" ? "max" : "min") + "Date"];
      if (dateObj !== void 0) {
        self[type === "min" ? "minDateHasTime" : "maxDateHasTime"] = dateObj.getHours() > 0 || dateObj.getMinutes() > 0 || dateObj.getSeconds() > 0;
      }
      if (self.selectedDates) {
        self.selectedDates = self.selectedDates.filter(function(d) {
          return isEnabled(d);
        });
        if (!self.selectedDates.length && type === "min")
          setHoursFromDate(dateObj);
        updateValue();
      }
      if (self.daysContainer) {
        redraw();
        if (dateObj !== void 0)
          self.currentYearElement[type] = dateObj.getFullYear().toString();
        else
          self.currentYearElement.removeAttribute(type);
        self.currentYearElement.disabled = !!inverseDateObj && dateObj !== void 0 && inverseDateObj.getFullYear() === dateObj.getFullYear();
      }
    };
  }
  function parseConfig() {
    var boolOpts = [
      "wrap",
      "weekNumbers",
      "allowInput",
      "allowInvalidPreload",
      "clickOpens",
      "time_24hr",
      "enableTime",
      "noCalendar",
      "altInput",
      "shorthandCurrentMonth",
      "inline",
      "static",
      "enableSeconds",
      "disableMobile"
    ];
    var userConfig = __assign(__assign({}, JSON.parse(JSON.stringify(element.dataset || {}))), instanceConfig);
    var formats2 = {};
    self.config.parseDate = userConfig.parseDate;
    self.config.formatDate = userConfig.formatDate;
    Object.defineProperty(self.config, "enable", {
      get: function() {
        return self.config._enable;
      },
      set: function(dates) {
        self.config._enable = parseDateRules(dates);
      }
    });
    Object.defineProperty(self.config, "disable", {
      get: function() {
        return self.config._disable;
      },
      set: function(dates) {
        self.config._disable = parseDateRules(dates);
      }
    });
    var timeMode = userConfig.mode === "time";
    if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {
      var defaultDateFormat = flatpickr.defaultConfig.dateFormat || defaults.dateFormat;
      formats2.dateFormat = userConfig.noCalendar || timeMode ? "H:i" + (userConfig.enableSeconds ? ":S" : "") : defaultDateFormat + " H:i" + (userConfig.enableSeconds ? ":S" : "");
    }
    if (userConfig.altInput && (userConfig.enableTime || timeMode) && !userConfig.altFormat) {
      var defaultAltFormat = flatpickr.defaultConfig.altFormat || defaults.altFormat;
      formats2.altFormat = userConfig.noCalendar || timeMode ? "h:i" + (userConfig.enableSeconds ? ":S K" : " K") : defaultAltFormat + (" h:i" + (userConfig.enableSeconds ? ":S" : "") + " K");
    }
    Object.defineProperty(self.config, "minDate", {
      get: function() {
        return self.config._minDate;
      },
      set: minMaxDateSetter("min")
    });
    Object.defineProperty(self.config, "maxDate", {
      get: function() {
        return self.config._maxDate;
      },
      set: minMaxDateSetter("max")
    });
    var minMaxTimeSetter = function(type) {
      return function(val) {
        self.config[type === "min" ? "_minTime" : "_maxTime"] = self.parseDate(val, "H:i:S");
      };
    };
    Object.defineProperty(self.config, "minTime", {
      get: function() {
        return self.config._minTime;
      },
      set: minMaxTimeSetter("min")
    });
    Object.defineProperty(self.config, "maxTime", {
      get: function() {
        return self.config._maxTime;
      },
      set: minMaxTimeSetter("max")
    });
    if (userConfig.mode === "time") {
      self.config.noCalendar = true;
      self.config.enableTime = true;
    }
    Object.assign(self.config, formats2, userConfig);
    for (var i = 0; i < boolOpts.length; i++)
      self.config[boolOpts[i]] = self.config[boolOpts[i]] === true || self.config[boolOpts[i]] === "true";
    HOOKS.filter(function(hook) {
      return self.config[hook] !== void 0;
    }).forEach(function(hook) {
      self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);
    });
    self.isMobile = !self.config.disableMobile && !self.config.inline && self.config.mode === "single" && !self.config.disable.length && !self.config.enable && !self.config.weekNumbers && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    for (var i = 0; i < self.config.plugins.length; i++) {
      var pluginConf = self.config.plugins[i](self) || {};
      for (var key in pluginConf) {
        if (HOOKS.indexOf(key) > -1) {
          self.config[key] = arrayify(pluginConf[key]).map(bindToInstance).concat(self.config[key]);
        } else if (typeof userConfig[key] === "undefined")
          self.config[key] = pluginConf[key];
      }
    }
    if (!userConfig.altInputClass) {
      self.config.altInputClass = getInputElem().className + " " + self.config.altInputClass;
    }
    triggerEvent("onParseConfig");
  }
  function getInputElem() {
    return self.config.wrap ? element.querySelector("[data-input]") : element;
  }
  function setupLocale() {
    if (typeof self.config.locale !== "object" && typeof flatpickr.l10ns[self.config.locale] === "undefined")
      self.config.errorHandler(new Error("flatpickr: invalid locale " + self.config.locale));
    self.l10n = __assign(__assign({}, flatpickr.l10ns.default), typeof self.config.locale === "object" ? self.config.locale : self.config.locale !== "default" ? flatpickr.l10ns[self.config.locale] : void 0);
    tokenRegex.D = "(" + self.l10n.weekdays.shorthand.join("|") + ")";
    tokenRegex.l = "(" + self.l10n.weekdays.longhand.join("|") + ")";
    tokenRegex.M = "(" + self.l10n.months.shorthand.join("|") + ")";
    tokenRegex.F = "(" + self.l10n.months.longhand.join("|") + ")";
    tokenRegex.K = "(" + self.l10n.amPM[0] + "|" + self.l10n.amPM[1] + "|" + self.l10n.amPM[0].toLowerCase() + "|" + self.l10n.amPM[1].toLowerCase() + ")";
    var userConfig = __assign(__assign({}, instanceConfig), JSON.parse(JSON.stringify(element.dataset || {})));
    if (userConfig.time_24hr === void 0 && flatpickr.defaultConfig.time_24hr === void 0) {
      self.config.time_24hr = self.l10n.time_24hr;
    }
    self.formatDate = createDateFormatter(self);
    self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });
  }
  function positionCalendar(customPositionElement) {
    if (typeof self.config.position === "function") {
      return void self.config.position(self, customPositionElement);
    }
    if (self.calendarContainer === void 0)
      return;
    triggerEvent("onPreCalendarPosition");
    var positionElement = customPositionElement || self._positionElement;
    var calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, function(acc, child) {
      return acc + child.offsetHeight;
    }, 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(" "), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === "above" || configPosVertical !== "below" && distanceFromBottom < calendarHeight && inputBounds.top > calendarHeight;
    var top2 = window.pageYOffset + inputBounds.top + (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);
    toggleClass(self.calendarContainer, "arrowTop", !showOnTop);
    toggleClass(self.calendarContainer, "arrowBottom", showOnTop);
    if (self.config.inline)
      return;
    var left2 = window.pageXOffset + inputBounds.left;
    var isCenter = false;
    var isRight = false;
    if (configPosHorizontal === "center") {
      left2 -= (calendarWidth - inputBounds.width) / 2;
      isCenter = true;
    } else if (configPosHorizontal === "right") {
      left2 -= calendarWidth - inputBounds.width;
      isRight = true;
    }
    toggleClass(self.calendarContainer, "arrowLeft", !isCenter && !isRight);
    toggleClass(self.calendarContainer, "arrowCenter", isCenter);
    toggleClass(self.calendarContainer, "arrowRight", isRight);
    var right2 = window.document.body.offsetWidth - (window.pageXOffset + inputBounds.right);
    var rightMost = left2 + calendarWidth > window.document.body.offsetWidth;
    var centerMost = right2 + calendarWidth > window.document.body.offsetWidth;
    toggleClass(self.calendarContainer, "rightMost", rightMost);
    if (self.config.static)
      return;
    self.calendarContainer.style.top = top2 + "px";
    if (!rightMost) {
      self.calendarContainer.style.left = left2 + "px";
      self.calendarContainer.style.right = "auto";
    } else if (!centerMost) {
      self.calendarContainer.style.left = "auto";
      self.calendarContainer.style.right = right2 + "px";
    } else {
      var doc = getDocumentStyleSheet();
      if (doc === void 0)
        return;
      var bodyWidth = window.document.body.offsetWidth;
      var centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);
      var centerBefore = ".flatpickr-calendar.centerMost:before";
      var centerAfter = ".flatpickr-calendar.centerMost:after";
      var centerIndex = doc.cssRules.length;
      var centerStyle = "{left:" + inputBounds.left + "px;right:auto;}";
      toggleClass(self.calendarContainer, "rightMost", false);
      toggleClass(self.calendarContainer, "centerMost", true);
      doc.insertRule(centerBefore + "," + centerAfter + centerStyle, centerIndex);
      self.calendarContainer.style.left = centerLeft + "px";
      self.calendarContainer.style.right = "auto";
    }
  }
  function getDocumentStyleSheet() {
    var editableSheet = null;
    for (var i = 0; i < document.styleSheets.length; i++) {
      var sheet = document.styleSheets[i];
      if (!sheet.cssRules)
        continue;
      try {
        sheet.cssRules;
      } catch (err) {
        continue;
      }
      editableSheet = sheet;
      break;
    }
    return editableSheet != null ? editableSheet : createStyleSheet();
  }
  function createStyleSheet() {
    var style = document.createElement("style");
    document.head.appendChild(style);
    return style.sheet;
  }
  function redraw() {
    if (self.config.noCalendar || self.isMobile)
      return;
    buildMonthSwitch();
    updateNavigationCurrentMonth();
    buildDays();
  }
  function focusAndClose() {
    self._input.focus();
    if (window.navigator.userAgent.indexOf("MSIE") !== -1 || navigator.msMaxTouchPoints !== void 0) {
      setTimeout(self.close, 0);
    } else {
      self.close();
    }
  }
  function selectDate(e) {
    e.preventDefault();
    e.stopPropagation();
    var isSelectable = function(day) {
      return day.classList && day.classList.contains("flatpickr-day") && !day.classList.contains("flatpickr-disabled") && !day.classList.contains("notAllowed");
    };
    var t = findParent(getEventTarget(e), isSelectable);
    if (t === void 0)
      return;
    var target = t;
    var selectedDate = self.latestSelectedDateObj = new Date(target.dateObj.getTime());
    var shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth || selectedDate.getMonth() > self.currentMonth + self.config.showMonths - 1) && self.config.mode !== "range";
    self.selectedDateElem = target;
    if (self.config.mode === "single")
      self.selectedDates = [selectedDate];
    else if (self.config.mode === "multiple") {
      var selectedIndex = isDateSelected(selectedDate);
      if (selectedIndex)
        self.selectedDates.splice(parseInt(selectedIndex), 1);
      else
        self.selectedDates.push(selectedDate);
    } else if (self.config.mode === "range") {
      if (self.selectedDates.length === 2) {
        self.clear(false, false);
      }
      self.latestSelectedDateObj = selectedDate;
      self.selectedDates.push(selectedDate);
      if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)
        self.selectedDates.sort(function(a, b) {
          return a.getTime() - b.getTime();
        });
    }
    setHoursFromInputs();
    if (shouldChangeMonth) {
      var isNewYear = self.currentYear !== selectedDate.getFullYear();
      self.currentYear = selectedDate.getFullYear();
      self.currentMonth = selectedDate.getMonth();
      if (isNewYear) {
        triggerEvent("onYearChange");
        buildMonthSwitch();
      }
      triggerEvent("onMonthChange");
    }
    updateNavigationCurrentMonth();
    buildDays();
    updateValue();
    if (!shouldChangeMonth && self.config.mode !== "range" && self.config.showMonths === 1)
      focusOnDayElem(target);
    else if (self.selectedDateElem !== void 0 && self.hourElement === void 0) {
      self.selectedDateElem && self.selectedDateElem.focus();
    }
    if (self.hourElement !== void 0)
      self.hourElement !== void 0 && self.hourElement.focus();
    if (self.config.closeOnSelect) {
      var single = self.config.mode === "single" && !self.config.enableTime;
      var range = self.config.mode === "range" && self.selectedDates.length === 2 && !self.config.enableTime;
      if (single || range) {
        focusAndClose();
      }
    }
    triggerChange();
  }
  var CALLBACKS = {
    locale: [setupLocale, updateWeekdays],
    showMonths: [buildMonths, setCalendarWidth, buildWeekdays],
    minDate: [jumpToDate],
    maxDate: [jumpToDate],
    positionElement: [updatePositionElement],
    clickOpens: [
      function() {
        if (self.config.clickOpens === true) {
          bind(self._input, "focus", self.open);
          bind(self._input, "click", self.open);
        } else {
          self._input.removeEventListener("focus", self.open);
          self._input.removeEventListener("click", self.open);
        }
      }
    ]
  };
  function set(option, value) {
    if (option !== null && typeof option === "object") {
      Object.assign(self.config, option);
      for (var key in option) {
        if (CALLBACKS[key] !== void 0)
          CALLBACKS[key].forEach(function(x) {
            return x();
          });
      }
    } else {
      self.config[option] = value;
      if (CALLBACKS[option] !== void 0)
        CALLBACKS[option].forEach(function(x) {
          return x();
        });
      else if (HOOKS.indexOf(option) > -1)
        self.config[option] = arrayify(value);
    }
    self.redraw();
    updateValue(true);
  }
  function setSelectedDate(inputDate, format2) {
    var dates = [];
    if (inputDate instanceof Array)
      dates = inputDate.map(function(d) {
        return self.parseDate(d, format2);
      });
    else if (inputDate instanceof Date || typeof inputDate === "number")
      dates = [self.parseDate(inputDate, format2)];
    else if (typeof inputDate === "string") {
      switch (self.config.mode) {
        case "single":
        case "time":
          dates = [self.parseDate(inputDate, format2)];
          break;
        case "multiple":
          dates = inputDate.split(self.config.conjunction).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        case "range":
          dates = inputDate.split(self.l10n.rangeSeparator).map(function(date) {
            return self.parseDate(date, format2);
          });
          break;
        default:
          break;
      }
    } else
      self.config.errorHandler(new Error("Invalid date supplied: " + JSON.stringify(inputDate)));
    self.selectedDates = self.config.allowInvalidPreload ? dates : dates.filter(function(d) {
      return d instanceof Date && isEnabled(d, false);
    });
    if (self.config.mode === "range")
      self.selectedDates.sort(function(a, b) {
        return a.getTime() - b.getTime();
      });
  }
  function setDate(date, triggerChange2, format2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = false;
    }
    if (format2 === void 0) {
      format2 = self.config.dateFormat;
    }
    if (date !== 0 && !date || date instanceof Array && date.length === 0)
      return self.clear(triggerChange2);
    setSelectedDate(date, format2);
    self.latestSelectedDateObj = self.selectedDates[self.selectedDates.length - 1];
    self.redraw();
    jumpToDate(void 0, triggerChange2);
    setHoursFromDate();
    if (self.selectedDates.length === 0) {
      self.clear(false);
    }
    updateValue(triggerChange2);
    if (triggerChange2)
      triggerEvent("onChange");
  }
  function parseDateRules(arr) {
    return arr.slice().map(function(rule) {
      if (typeof rule === "string" || typeof rule === "number" || rule instanceof Date) {
        return self.parseDate(rule, void 0, true);
      } else if (rule && typeof rule === "object" && rule.from && rule.to)
        return {
          from: self.parseDate(rule.from, void 0),
          to: self.parseDate(rule.to, void 0)
        };
      return rule;
    }).filter(function(x) {
      return x;
    });
  }
  function setupDates() {
    self.selectedDates = [];
    self.now = self.parseDate(self.config.now) || new Date();
    var preloadedDate = self.config.defaultDate || ((self.input.nodeName === "INPUT" || self.input.nodeName === "TEXTAREA") && self.input.placeholder && self.input.value === self.input.placeholder ? null : self.input.value);
    if (preloadedDate)
      setSelectedDate(preloadedDate, self.config.dateFormat);
    self._initialDate = self.selectedDates.length > 0 ? self.selectedDates[0] : self.config.minDate && self.config.minDate.getTime() > self.now.getTime() ? self.config.minDate : self.config.maxDate && self.config.maxDate.getTime() < self.now.getTime() ? self.config.maxDate : self.now;
    self.currentYear = self._initialDate.getFullYear();
    self.currentMonth = self._initialDate.getMonth();
    if (self.selectedDates.length > 0)
      self.latestSelectedDateObj = self.selectedDates[0];
    if (self.config.minTime !== void 0)
      self.config.minTime = self.parseDate(self.config.minTime, "H:i");
    if (self.config.maxTime !== void 0)
      self.config.maxTime = self.parseDate(self.config.maxTime, "H:i");
    self.minDateHasTime = !!self.config.minDate && (self.config.minDate.getHours() > 0 || self.config.minDate.getMinutes() > 0 || self.config.minDate.getSeconds() > 0);
    self.maxDateHasTime = !!self.config.maxDate && (self.config.maxDate.getHours() > 0 || self.config.maxDate.getMinutes() > 0 || self.config.maxDate.getSeconds() > 0);
  }
  function setupInputs() {
    self.input = getInputElem();
    if (!self.input) {
      self.config.errorHandler(new Error("Invalid input element specified"));
      return;
    }
    self.input._type = self.input.type;
    self.input.type = "text";
    self.input.classList.add("flatpickr-input");
    self._input = self.input;
    if (self.config.altInput) {
      self.altInput = createElement(self.input.nodeName, self.config.altInputClass);
      self._input = self.altInput;
      self.altInput.placeholder = self.input.placeholder;
      self.altInput.disabled = self.input.disabled;
      self.altInput.required = self.input.required;
      self.altInput.tabIndex = self.input.tabIndex;
      self.altInput.type = "text";
      self.input.setAttribute("type", "hidden");
      if (!self.config.static && self.input.parentNode)
        self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);
    }
    if (!self.config.allowInput)
      self._input.setAttribute("readonly", "readonly");
    updatePositionElement();
  }
  function updatePositionElement() {
    self._positionElement = self.config.positionElement || self._input;
  }
  function setupMobile() {
    var inputType = self.config.enableTime ? self.config.noCalendar ? "time" : "datetime-local" : "date";
    self.mobileInput = createElement("input", self.input.className + " flatpickr-mobile");
    self.mobileInput.tabIndex = 1;
    self.mobileInput.type = inputType;
    self.mobileInput.disabled = self.input.disabled;
    self.mobileInput.required = self.input.required;
    self.mobileInput.placeholder = self.input.placeholder;
    self.mobileFormatStr = inputType === "datetime-local" ? "Y-m-d\\TH:i:S" : inputType === "date" ? "Y-m-d" : "H:i:S";
    if (self.selectedDates.length > 0) {
      self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);
    }
    if (self.config.minDate)
      self.mobileInput.min = self.formatDate(self.config.minDate, "Y-m-d");
    if (self.config.maxDate)
      self.mobileInput.max = self.formatDate(self.config.maxDate, "Y-m-d");
    if (self.input.getAttribute("step"))
      self.mobileInput.step = String(self.input.getAttribute("step"));
    self.input.type = "hidden";
    if (self.altInput !== void 0)
      self.altInput.type = "hidden";
    try {
      if (self.input.parentNode)
        self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);
    } catch (_a) {
    }
    bind(self.mobileInput, "change", function(e) {
      self.setDate(getEventTarget(e).value, false, self.mobileFormatStr);
      triggerEvent("onChange");
      triggerEvent("onClose");
    });
  }
  function toggle(e) {
    if (self.isOpen === true)
      return self.close();
    self.open(e);
  }
  function triggerEvent(event, data) {
    if (self.config === void 0)
      return;
    var hooks = self.config[event];
    if (hooks !== void 0 && hooks.length > 0) {
      for (var i = 0; hooks[i] && i < hooks.length; i++)
        hooks[i](self.selectedDates, self.input.value, self, data);
    }
    if (event === "onChange") {
      self.input.dispatchEvent(createEvent("change"));
      self.input.dispatchEvent(createEvent("input"));
    }
  }
  function createEvent(name) {
    var e = document.createEvent("Event");
    e.initEvent(name, true, true);
    return e;
  }
  function isDateSelected(date) {
    for (var i = 0; i < self.selectedDates.length; i++) {
      var selectedDate = self.selectedDates[i];
      if (selectedDate instanceof Date && compareDates(selectedDate, date) === 0)
        return "" + i;
    }
    return false;
  }
  function isDateInRange(date) {
    if (self.config.mode !== "range" || self.selectedDates.length < 2)
      return false;
    return compareDates(date, self.selectedDates[0]) >= 0 && compareDates(date, self.selectedDates[1]) <= 0;
  }
  function updateNavigationCurrentMonth() {
    if (self.config.noCalendar || self.isMobile || !self.monthNav)
      return;
    self.yearElements.forEach(function(yearElement, i) {
      var d = new Date(self.currentYear, self.currentMonth, 1);
      d.setMonth(self.currentMonth + i);
      if (self.config.showMonths > 1 || self.config.monthSelectorType === "static") {
        self.monthElements[i].textContent = monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) + " ";
      } else {
        self.monthsDropdownContainer.value = d.getMonth().toString();
      }
      yearElement.value = d.getFullYear().toString();
    });
    self._hidePrevMonthArrow = self.config.minDate !== void 0 && (self.currentYear === self.config.minDate.getFullYear() ? self.currentMonth <= self.config.minDate.getMonth() : self.currentYear < self.config.minDate.getFullYear());
    self._hideNextMonthArrow = self.config.maxDate !== void 0 && (self.currentYear === self.config.maxDate.getFullYear() ? self.currentMonth + 1 > self.config.maxDate.getMonth() : self.currentYear > self.config.maxDate.getFullYear());
  }
  function getDateStr(specificFormat) {
    var format2 = specificFormat || (self.config.altInput ? self.config.altFormat : self.config.dateFormat);
    return self.selectedDates.map(function(dObj) {
      return self.formatDate(dObj, format2);
    }).filter(function(d, i, arr) {
      return self.config.mode !== "range" || self.config.enableTime || arr.indexOf(d) === i;
    }).join(self.config.mode !== "range" ? self.config.conjunction : self.l10n.rangeSeparator);
  }
  function updateValue(triggerChange2) {
    if (triggerChange2 === void 0) {
      triggerChange2 = true;
    }
    if (self.mobileInput !== void 0 && self.mobileFormatStr) {
      self.mobileInput.value = self.latestSelectedDateObj !== void 0 ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr) : "";
    }
    self.input.value = getDateStr(self.config.dateFormat);
    if (self.altInput !== void 0) {
      self.altInput.value = getDateStr(self.config.altFormat);
    }
    if (triggerChange2 !== false)
      triggerEvent("onValueUpdate");
  }
  function onMonthNavClick(e) {
    var eventTarget = getEventTarget(e);
    var isPrevMonth = self.prevMonthNav.contains(eventTarget);
    var isNextMonth = self.nextMonthNav.contains(eventTarget);
    if (isPrevMonth || isNextMonth) {
      changeMonth(isPrevMonth ? -1 : 1);
    } else if (self.yearElements.indexOf(eventTarget) >= 0) {
      eventTarget.select();
    } else if (eventTarget.classList.contains("arrowUp")) {
      self.changeYear(self.currentYear + 1);
    } else if (eventTarget.classList.contains("arrowDown")) {
      self.changeYear(self.currentYear - 1);
    }
  }
  function timeWrapper(e) {
    e.preventDefault();
    var isKeyDown = e.type === "keydown", eventTarget = getEventTarget(e), input = eventTarget;
    if (self.amPM !== void 0 && eventTarget === self.amPM) {
      self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
    }
    var min2 = parseFloat(input.getAttribute("min")), max2 = parseFloat(input.getAttribute("max")), step = parseFloat(input.getAttribute("step")), curValue = parseInt(input.value, 10), delta = e.delta || (isKeyDown ? e.which === 38 ? 1 : -1 : 0);
    var newValue = curValue + step * delta;
    if (typeof input.value !== "undefined" && input.value.length === 2) {
      var isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;
      if (newValue < min2) {
        newValue = max2 + newValue + int(!isHourElem) + (int(isHourElem) && int(!self.amPM));
        if (isMinuteElem)
          incrementNumInput(void 0, -1, self.hourElement);
      } else if (newValue > max2) {
        newValue = input === self.hourElement ? newValue - max2 - int(!self.amPM) : min2;
        if (isMinuteElem)
          incrementNumInput(void 0, 1, self.hourElement);
      }
      if (self.amPM && isHourElem && (step === 1 ? newValue + curValue === 23 : Math.abs(newValue - curValue) > step)) {
        self.amPM.textContent = self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];
      }
      input.value = pad(newValue);
    }
  }
  init();
  return self;
}
function _flatpickr(nodeList, config) {
  var nodes = Array.prototype.slice.call(nodeList).filter(function(x) {
    return x instanceof HTMLElement;
  });
  var instances = [];
  for (var i = 0; i < nodes.length; i++) {
    var node = nodes[i];
    try {
      if (node.getAttribute("data-fp-omit") !== null)
        continue;
      if (node._flatpickr !== void 0) {
        node._flatpickr.destroy();
        node._flatpickr = void 0;
      }
      node._flatpickr = FlatpickrInstance(node, config || {});
      instances.push(node._flatpickr);
    } catch (e) {
      console.error(e);
    }
  }
  return instances.length === 1 ? instances[0] : instances;
}
if (typeof HTMLElement !== "undefined" && typeof HTMLCollection !== "undefined" && typeof NodeList !== "undefined") {
  HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
  HTMLElement.prototype.flatpickr = function(config) {
    return _flatpickr([this], config);
  };
}
var flatpickr = function(selector, config) {
  if (typeof selector === "string") {
    return _flatpickr(window.document.querySelectorAll(selector), config);
  } else if (selector instanceof Node) {
    return _flatpickr([selector], config);
  } else {
    return _flatpickr(selector, config);
  }
};
flatpickr.defaultConfig = {};
flatpickr.l10ns = {
  en: __assign({}, default_default),
  default: __assign({}, default_default)
};
flatpickr.localize = function(l10n) {
  flatpickr.l10ns.default = __assign(__assign({}, flatpickr.l10ns.default), l10n);
};
flatpickr.setDefaults = function(config) {
  flatpickr.defaultConfig = __assign(__assign({}, flatpickr.defaultConfig), config);
};
flatpickr.parseDate = createDateParser({});
flatpickr.formatDate = createDateFormatter({});
flatpickr.compareDates = compareDates;
if (typeof jQuery !== "undefined" && typeof jQuery.fn !== "undefined") {
  jQuery.fn.flatpickr = function(config) {
    return _flatpickr(this, config);
  };
}
Date.prototype.fp_incr = function(days) {
  return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === "string" ? parseInt(days, 10) : days));
};
if (typeof window !== "undefined") {
  window.flatpickr = flatpickr;
}
var esm_default = flatpickr;

// src/modals/fields/DateModal.ts
var DateModal = class extends import_obsidian25.Modal {
  constructor(plugin, file, field, initialValue, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a, _b;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.initialValue = initialValue;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.pushNextInterval = false;
    this.initialValue = initialValue ? ((_a = initialValue.toString().replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last()) || "" : "";
    this.insertAsLink = FieldManager2.stringToBoolean(this.field.options.defaultInsertAsLink || "false") || false;
    this.format = this.field.options.dateFormat || this.field.options.defaultDateFormat;
    this.dvApi = (_b = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _b.api;
    if (this.dvApi)
      this.dateManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.value = this.initialValue;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    const fieldContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.buildFields(fieldContainer);
    this.errorField = this.contentEl.createEl("div", { cls: "field-error" });
    this.errorField.hide();
  }
  buildFields(dateFieldsContainer) {
    this.buildInputEl(dateFieldsContainer);
    this.buildInsertAsLinkButton(dateFieldsContainer);
    dateFieldsContainer.createDiv({ cls: "spacer" });
    const saveBtn = new import_obsidian25.ButtonComponent(dateFieldsContainer);
    saveBtn.setIcon("checkmark");
    saveBtn.onClick((e) => __async(this, null, function* () {
      e.preventDefault();
      let newValue;
      if (this.plugin.app.plugins.enabledPlugins.has("nldates-obsidian")) {
        try {
          const nldates = this.plugin.app.plugins.plugins["nldates-obsidian"];
          newValue = nldates.parseDate(this.value).moment;
        } catch (error) {
          newValue = (0, import_obsidian26.moment)(this.value, this.format);
        }
      } else {
        newValue = (0, import_obsidian26.moment)(this.value, this.format);
      }
      if (newValue.isValid()) {
        const linkPath = this.plugin.app.metadataCache.getFirstLinkpathDest(this.field.options.linkPath || "" + newValue.format(this.format), this.file.path);
        const formattedValue = this.insertAsLink ? `[[${this.field.options.linkPath || ""}${newValue.format(this.format)}${linkPath ? "|" + linkPath.basename : ""}]]` : newValue.format(this.format);
        if (this.lineNumber == -1) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file, this.field.name, formattedValue);
          });
        } else {
          yield this.plugin.fileTaskManager.pushTask(() => {
            insertValues(this.plugin, this.file, this.field.name, formattedValue, this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
          });
        }
        ;
        if (this.nextIntervalField && this.pushNextInterval && this.nextShift) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file.path, this.nextIntervalField.name, this.nextShift);
          });
        }
        this.close();
      } else if (!this.value) {
        if (this.lineNumber == -1) {
          yield this.plugin.fileTaskManager.pushTask(() => {
            replaceValues(this.plugin, this.file, this.field.name, "");
          });
        } else {
          yield this.plugin.fileTaskManager.pushTask(() => {
            insertValues(this.plugin, this.file, this.field.name, "", this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
          });
        }
        ;
        this.close();
      } else {
        this.errorField.show();
        this.errorField.setText(`value must be a valid date`);
        this.inputEl.inputEl.addClass("is-invalid");
        return;
      }
    }));
  }
  buildInsertAsLinkButton(container) {
    const insertAsLinkBtn = new import_obsidian25.ButtonComponent(container);
    const setLinkBtnIcon = () => {
      insertAsLinkBtn.setIcon(this.insertAsLink ? "link" : "unlink");
      insertAsLinkBtn.setTooltip(this.insertAsLink ? "Click to insert date as text" : "Click to insert date as link");
    };
    setLinkBtnIcon();
    insertAsLinkBtn.onClick(() => {
      this.insertAsLink = !this.insertAsLink;
      setLinkBtnIcon();
    });
  }
  toggleButton(button, value) {
    button.setDisabled(!!value);
    if (value) {
      button.buttonEl.addClass("disabled");
    } else {
      button.buttonEl.removeClass("disabled");
    }
  }
  buildInputEl(container) {
    if (this.dateManager)
      [this.currentShift, this.nextIntervalField, this.nextShift] = this.dateManager.shiftDuration(this.file);
    this.inputEl = new import_obsidian25.TextComponent(container);
    this.inputEl.inputEl.focus();
    this.inputEl.setPlaceholder(this.initialValue ? (0, import_obsidian26.moment)(this.initialValue, this.field.options.dateFormat).format(this.field.options.dateFormat) : "");
    this.inputEl.onChange((value) => {
      this.inputEl.inputEl.removeClass("is-invalid");
      this.errorField.hide();
      this.errorField.setText("");
      this.value = value;
      this.toggleButton(shiftFromTodayBtn, value);
    });
    const calendarDisplayBtn = new import_obsidian25.ButtonComponent(container);
    calendarDisplayBtn.setIcon(FieldIcon["Date" /* Date */]);
    calendarDisplayBtn.setTooltip("open date picker");
    const shiftFromTodayBtn = new import_obsidian25.ButtonComponent(container);
    shiftFromTodayBtn.setIcon("skip-forward");
    shiftFromTodayBtn.setTooltip(`Shift ${this.field.name} ${this.currentShift || "1 day"} ahead`);
    const datePickerContainer = container.createDiv();
    const datePicker = esm_default(datePickerContainer, {
      locale: {
        firstDayOfWeek: this.plugin.settings.firstDayOfWeek
      },
      defaultDate: (0, import_obsidian26.moment)(Date.now()).format("YYYY-MM-DD")
    });
    datePicker.config.onChange.push((value) => {
      const newDate = (0, import_obsidian26.moment)(value.toString()).format(this.format);
      this.inputEl.setValue(newDate);
      this.value = newDate;
      this.toggleButton(shiftFromTodayBtn, this.value);
    });
    calendarDisplayBtn.onClick((e) => {
      e.preventDefault();
      datePicker.setDate(datePicker.parseDate(this.inputEl.getValue()) || new Date());
      datePicker.open();
    });
    shiftFromTodayBtn.onClick((e) => __async(this, null, function* () {
      const currentDvDate = this.dvApi.date((0, import_obsidian26.moment)(this.initialValue, this.format).toISOString());
      const newDate = currentDvDate.plus(this.dvApi.duration(this.currentShift || "1 day"));
      const newValue = (0, import_obsidian26.moment)(newDate.toString()).format(this.format);
      this.inputEl.setValue(newValue);
      this.value = newValue;
      this.pushNextInterval = true;
      this.toggleButton(shiftFromTodayBtn, this.inputEl.getValue());
    }));
    if (!this.dvApi) {
      shiftFromTodayBtn.buttonEl.hide();
      shiftFromTodayBtn.setDisabled(true);
    }
  }
};

// src/utils/dataviewUtils.ts
function genuineKeys(dvFile) {
  const genuineKeys2 = [];
  Object.keys(dvFile).forEach((key) => {
    if (!genuineKeys2.map((k) => k.toLowerCase().replace(/\s/g, "-")).includes(key.toLowerCase().replace(/\s/g, "-"))) {
      genuineKeys2.push(key);
    } else {
      if (key !== key.toLowerCase().replace(/\s/g, "-")) {
        genuineKeys2[genuineKeys2.indexOf(key.toLowerCase().replace(/\s/g, "-"))] = key;
      }
    }
  });
  return genuineKeys2;
}
function compareDuration(dvDurA, dvDurB) {
  const normalizedA = dvDurA.shiftTo("years", "months", "weeks", "days", "hours", "minutes", "seconds", "milliseconds").normalize();
  const normalizedB = dvDurB.shiftTo("years", "months", "weeks", "days", "hours", "minutes", "seconds", "milliseconds").normalize();
  return normalizedA.equals(normalizedB);
}

// src/fields/fieldManagers/DateField.ts
var DateField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Date" /* Date */);
    this.defaultDateFormat = "YYYY-MM-DD";
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    var _a;
    const modal = new DateModal(this.plugin, file, this.field, value);
    modal.titleEl.setText(`Change date for <${name}>`);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    const dateIconName = FieldIcon["Date" /* Date */];
    const dateModalAction = () => modal.open();
    const p = dvApi.page(file.path);
    const shiftDateAction = () => this.shiftDate(dvApi, p, file);
    const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    const [currentShift] = fieldManager.shiftDuration(file);
    if (DateField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(dateIconName);
        item.onClick(dateModalAction);
        item.setSection("metadata-menu.fields");
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        location.addItem((item) => {
          item.setTitle(`Shift <${name}> ${currentShift} ahead`);
          item.setIcon("skip-forward");
          item.onClick(shiftDateAction);
          item.setSection("metadata-menu.fields");
        });
      }
    } else if (DateField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action: dateModalAction,
        icon: dateIconName
      });
      if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField && dvApi) {
        location.options.push({
          id: `update_${name}`,
          actionLabel: `<span>Shift <b>${name}</b> ${currentShift} ahead</span>`,
          action: shiftDateAction,
          icon: "skip-forward"
        });
      }
    } else if (DateField.isFieldOptions(location)) {
      location.addOption("skip-forward", shiftDateAction, `Shift ${name} ahead by ${currentShift}`);
      location.addOption(dateIconName, dateModalAction, `Set ${name}'s date`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new DateModal(this.plugin, file, this.field, value || "", lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter date for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDateContainer(container) {
    if (!this.field.options.dateFormat)
      this.field.options.dateFormat = this.defaultDateFormat;
    if (!this.field.options.defaultInsertAsLink)
      this.field.options.defaultInsertAsLink = "false";
    const dateFormatContainer = container.createDiv({ cls: "field-container" });
    dateFormatContainer.createEl("span", { text: "Date format", cls: "label" });
    const dateExample = dateFormatContainer.createEl("span", { cls: "more-info" });
    dateFormatContainer.createDiv({ cls: "spacer" });
    const dateFormatInput = new import_obsidian27.TextComponent(dateFormatContainer);
    dateFormatInput.setValue(this.field.options.dateFormat);
    dateExample.setText(`${(0, import_obsidian27.moment)().format(dateFormatInput.getValue())}`);
    dateFormatInput.onChange((value) => {
      this.field.options.dateFormat = value;
      dateExample.setText(`${(0, import_obsidian27.moment)().format(value)}`);
    });
    const defaultInsertAsLinkContainer = container.createDiv({ cls: "field-container" });
    defaultInsertAsLinkContainer.createEl("span", { text: "Insert as link by default", cls: "label" });
    defaultInsertAsLinkContainer.createDiv({ cls: "spacer" });
    const defaultInsertAsLink = new import_obsidian27.ToggleComponent(defaultInsertAsLinkContainer);
    defaultInsertAsLink.setValue(DateField.stringToBoolean(this.field.options.defaultInsertAsLink));
    defaultInsertAsLink.onChange((value) => {
      this.field.options.defaultInsertAsLink = value.toString();
    });
    const dateLinkPathContainer = container.createDiv({ cls: "field-container" });
    dateLinkPathContainer.createEl("span", { text: "Link path (optional)", cls: "label" });
    dateLinkPathContainer.createDiv({ cls: "spacer" });
    const dateLinkPathInput = new import_obsidian27.TextComponent(dateLinkPathContainer);
    dateLinkPathInput.setValue(this.field.options.linkPath);
    dateLinkPathInput.onChange((value) => {
      this.field.options.linkPath = value + (!value.endsWith("/") && !!value.length ? "/" : "");
    });
    const dateShiftIntervalContainer = container.createDiv({ cls: "field-container" });
    dateShiftIntervalContainer.createEl("span", { text: "Define a shift interval", cls: "label" });
    dateShiftIntervalContainer.createDiv({ cls: "spacer" });
    const dateShiftInterval = new import_obsidian27.TextComponent(dateShiftIntervalContainer);
    dateShiftInterval.setPlaceholder("ex: 1 month 2 days");
    dateShiftInterval.setValue(this.field.options.dateShiftInterval);
    dateShiftInterval.onChange((value) => {
      if (!value) {
        delete this.field.options.dateShiftInterval;
      } else {
        this.field.options.dateShiftInterval = value.toString();
      }
    });
    const nextShiftIntervalFieldContainer = container.createDiv({ cls: "field-container" });
    nextShiftIntervalFieldContainer.createEl("span", {
      text: "Field containing shift intervals",
      cls: "label"
    });
    nextShiftIntervalFieldContainer.createDiv({ cls: "spacer" });
    const nextShiftIntervalField = new import_obsidian27.TextComponent(nextShiftIntervalFieldContainer);
    nextShiftIntervalField.setValue(this.field.options.nextShiftIntervalField);
    nextShiftIntervalField.onChange((value) => {
      if (!value) {
        delete this.field.options.nextShiftIntervalField;
      } else {
        this.field.options.nextShiftIntervalField = value.toString();
      }
    });
  }
  createSettingContainer(container, plugin, location) {
    this.createDateContainer(container);
  }
  shiftDate(dv, p, file) {
    return __async(this, null, function* () {
      const { dateFormat, defaultInsertAsLink, linkPath } = this.field.options;
      const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      const [currentShift, nextIntervalField, nextShift] = fieldManager.shiftDuration(file);
      const dvDate = p[this.field.name];
      const currentDateValue = dv.value.isLink(dvDate) ? dvDate.path.split("/").last() : dv.value.isDate(dvDate) ? (0, import_obsidian27.moment)(dvDate.toJSDate()).format(dateFormat) : dvDate;
      const currentDvDate = dv.date((0, import_obsidian27.moment)(currentDateValue, dateFormat).toISOString());
      const newDate = currentDvDate.plus(dv.duration(currentShift || "1 day"));
      const newValue = (0, import_obsidian27.moment)(newDate.toString()).format(dateFormat);
      if (nextIntervalField && nextShift) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file.path, nextIntervalField.name, nextShift);
        });
      }
      const linkFile = this.plugin.app.metadataCache.getFirstLinkpathDest(linkPath || "" + newValue.format(dateFormat), file.path);
      const formattedValue = DateField.stringToBoolean(defaultInsertAsLink) ? `[[${linkPath || ""}${newValue}${linkFile ? "|" + linkFile.basename : ""}]]` : newValue;
      yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, file.path, this.field.name, formattedValue);
      });
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
    var _a;
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const dateBtn = fieldContainer.createEl("button");
    (0, import_obsidian27.setIcon)(dateBtn, FieldIcon["Date" /* Date */]);
    const spacer = fieldContainer.createDiv({ cls: "spacer-1" });
    if (this.field.options.dateShiftInterval || this.field.options.nextShiftIntervalField) {
      this.shiftBtn = fieldContainer.createEl("button");
      (0, import_obsidian27.setIcon)(this.shiftBtn, "skip-forward");
      spacer.setAttr("class", "spacer-2");
    } else {
      spacer.setAttr("class", "spacer-1");
    }
    const file = this.plugin.app.vault.getAbstractFileByPath(p.file.path);
    let fieldModal;
    if (file instanceof import_obsidian27.TFile && file.extension == "md") {
      if (p[this.field.name] && p[this.field.name].hasOwnProperty("path")) {
        const dateFile = this.plugin.app.vault.getAbstractFileByPath(p[this.field.name]);
        if (dateFile instanceof import_obsidian27.TFile && dateFile.extension == "md") {
          fieldModal = new DateModal(this.plugin, file, this.field, dateFile.name);
        } else {
          fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name].path.split("/").last().replace(".md", ""));
        }
      } else if (p[this.field.name]) {
        fieldModal = new DateModal(this.plugin, file, this.field, p[this.field.name]);
      } else {
        fieldModal = new DateModal(this.plugin, file, this.field, "");
      }
      if (this.shiftBtn)
        this.shiftBtn.onclick = () => {
          this.shiftDate(dv, p, file);
        };
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    fieldModal.onClose = () => {
      fieldModal.contentEl.innerHTML = "";
    };
    dateBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      dateBtn.hide();
      if (this.shiftBtn)
        this.shiftBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        dateBtn.show();
        if (this.shiftBtn)
          this.shiftBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        dateBtn.hide();
        if (this.shiftBtn)
          this.shiftBtn.hide();
        spacer.show();
      };
    }
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(dateBtn);
    if (this.shiftBtn)
      fieldContainer.appendChild(this.shiftBtn);
    fieldContainer.appendChild(spacer);
  }
  getOptionsStr() {
    return this.field.options.dateFormat;
  }
  validateOptions() {
    return true;
  }
  displayValue(container, file, fieldName, onClicked) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const value = dvApi.page(file.path)[fieldName];
      if (dvApi.value.isDate(value)) {
        container.createDiv({ text: value.display });
      } else if (dvApi.value.isLink(value)) {
        const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
        link.onclick = () => {
          this.plugin.app.workspace.openLinkText(value.path, file.path, true);
          onClicked();
        };
      } else {
        container.createDiv({ text: value });
      }
    }
    container.createDiv({});
  }
  validateValue(value) {
    var _a, _b;
    if (!value) {
      return true;
    } else {
      if (typeof value == "string") {
        return (0, import_obsidian27.moment)((_a = value.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _a.split("/").last(), this.field.options.dateFormat).isValid();
      } else {
        return (0, import_obsidian27.moment)((_b = value.path.replace(/^\[\[/g, "").replace(/\]\]$/g, "").split("|").first()) == null ? void 0 : _b.split("/").last(), this.field.options.dateFormat).isValid();
      }
    }
  }
  shiftDuration(file) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const interval = this.field.options.dateShiftInterval;
      const cycleIntervalField = this.field.options.nextShiftIntervalField;
      const cycle = (_b = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _b.find((field) => field.name === cycleIntervalField);
      if (cycle) {
        const cycleManager = new FieldManager[cycle.type](this.plugin, cycle);
        const options = cycleManager.getOptionsList(file);
        const currentValue = dvApi.page(file.path)[cycle.name];
        if (currentValue) {
          const currentValueString = options.filter((o) => dvApi.duration(o) !== null).find((o) => compareDuration(dvApi.duration(o), currentValue));
          if (currentValueString) {
            const nextValue = cycleManager.nextOption(currentValueString);
            return [currentValueString, cycle, nextValue];
          }
        }
        return [options[0], cycle, options[1] || options[0]];
      } else if (interval && dvApi.duration(interval)) {
        return [interval, void 0, void 0];
      }
    }
    return [void 0, void 0, void 0];
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var import_obsidian29 = require("obsidian");

// src/modals/fields/MultiFileModal.ts
var import_obsidian28 = require("obsidian");
var MultiFileFuzzySuggester = class extends import_obsidian28.FuzzySuggestModal {
  constructor(plugin, file, field, initialValueObject, lineNumber = -1, inFrontmatter = false, after = false, asList = false, asComment = false) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.after = after;
    this.asList = asList;
    this.asComment = asComment;
    this.selectedFiles = [];
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const selectedValues = Array.isArray(initialValueObject) ? initialValueObject : [initialValueObject];
      selectedValues.forEach((value) => {
        if (dvApi.value.isLink(value)) {
          const file2 = this.plugin.app.vault.getAbstractFileByPath(value.path);
          if (file2 instanceof import_obsidian28.TFile)
            this.selectedFiles.push(file2);
        }
      });
    }
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    super.onOpen();
    this.containerEl.onkeydown = (e) => __async(this, null, function* () {
      if (e.key == "Enter" && e.altKey) {
        yield this.replaceValues();
        this.close();
      }
    });
    const buttonContainer = this.containerEl.createDiv({ cls: "footer-actions" });
    buttonContainer.createDiv({ cls: "spacer" });
    const infoContainer = buttonContainer.createDiv({ cls: "info" });
    infoContainer.setText("Alt+Enter to save");
    const confirmButton = new import_obsidian28.ButtonComponent(buttonContainer);
    confirmButton.setIcon("checkmark");
    confirmButton.onClick(() => __async(this, null, function* () {
      yield this.replaceValues();
      this.close();
    }));
    const cancelButton = new import_obsidian28.ButtonComponent(buttonContainer);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
    const clearButton = new import_obsidian28.ButtonComponent(buttonContainer);
    clearButton.setIcon("trash");
    clearButton.onClick(() => __async(this, null, function* () {
      yield this.clearValues();
      this.close();
    }));
    clearButton.buttonEl.addClass("danger");
    this.modalEl.appendChild(buttonContainer);
  }
  getItems() {
    const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
      return a.basename < b.basename ? -1 : 1;
    };
    try {
      const fileManager = new FieldManager[this.field.type](this.plugin, this.field);
      return fileManager.getFiles(this.file).sort(sortingMethod);
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  replaceValues() {
    return __async(this, null, function* () {
      const result = this.selectedFiles.map((file) => {
        var _a;
        const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
        let alias = void 0;
        if (dvApi && this.field.options.customRendering) {
          alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(file.path));
        }
        return FieldManager2.buildMarkDownLink(this.plugin, this.file, file.basename, alias);
      });
      if (this.lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, this.file, this.field.name, result.join(", "));
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, this.file, this.field.name, result.join(", "), this.lineNumber, this.inFrontmatter, this.after, this.asList, this.asComment);
        });
      }
      ;
    });
  }
  clearValues() {
    return __async(this, null, function* () {
      yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, this.file, this.field.name, "");
      });
    });
  }
  renderSuggestion(value, el) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field.options.customRendering) {
      const suggestionContainer = el.createDiv({ cls: "item-with-add-on" });
      suggestionContainer.createDiv({
        text: new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(value.item.path))
      });
      const filePath = suggestionContainer.createDiv({ cls: "add-on" });
      filePath.setText(value.item.path);
    } else {
      el.setText(value.item.basename);
    }
    el.addClass("value-container");
    const spacer = this.containerEl.createDiv({ cls: "spacer" });
    el.appendChild(spacer);
    if (this.selectedFiles.some((file) => file.path === value.item.path)) {
      el.addClass("value-checked");
      const iconContainer = el.createDiv({ cls: "icon-container" });
      (0, import_obsidian28.setIcon)(iconContainer, "check-circle");
    }
  }
  renderSelected() {
    const chooser = this.chooser;
    const suggestions = chooser.suggestions;
    const values = chooser.values;
    suggestions.forEach((s, i) => {
      if (this.selectedFiles.some((file) => file.path === values[i].item.path)) {
        s.addClass("value-checked");
        if (s.querySelectorAll(".icon-container").length == 0) {
          const iconContainer = s.createDiv({ cls: "icon-container" });
          (0, import_obsidian28.setIcon)(iconContainer, "check-circle");
        }
      } else {
        s.removeClass("value-checked");
        s.querySelectorAll(".icon-container").forEach((icon) => icon.remove());
      }
    });
  }
  selectSuggestion(value, evt) {
    if (this.selectedFiles.includes(value.item)) {
      this.selectedFiles.remove(value.item);
    } else {
      this.selectedFiles.push(value.item);
    }
    this.renderSelected();
  }
  onChooseItem(item) {
    return __async(this, null, function* () {
    });
  }
};

// src/fields/fieldManagers/MultiFileField.ts
var MultiFileField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "MultiFile" /* MultiFile */);
    this.getFiles = (currentFile) => {
      const getResults = (api) => {
        try {
          return new Function("dv", "current", `return ${this.field.options.dvQueryString}`)(api, api.page(currentFile == null ? void 0 : currentFile.path));
        } catch (error) {
          new import_obsidian29.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = this.plugin.app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return this.plugin.app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return this.plugin.app.vault.getMarkdownFiles();
      }
    };
  }
  static buildMarkDownLink(plugin, file, path) {
    const destFile = plugin.app.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return plugin.app.fileManager.generateMarkdownLink(destFile, file.path, void 0, destFile.basename);
    }
    return "";
  }
  addFieldOption(name, value, file, location) {
    const modal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value);
    const action = () => modal.open();
    if (MultiFileField.isMenu(location)) {
      location.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon(FieldIcon["File" /* File */]);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (MultiFileField.isSuggest(location)) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon["File" /* File */]
      });
    } else if (MultiFileField.isFieldOptions(location)) {
      location.addOption(FieldIcon["File" /* File */], action, `Update ${name}'s value`);
    }
    ;
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    const fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, value, lineNumber, inFrontmatter, after, asList, asComment);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(dv, p, fieldContainer, attrs = {}) {
    var _a;
    attrs.cls = "value-container";
    fieldContainer.appendChild(dv.el("span", p[this.field.name], attrs));
    const searchBtn = fieldContainer.createEl("button");
    (0, import_obsidian29.setIcon)(searchBtn, FieldIcon["File" /* File */]);
    const spacer = fieldContainer.createEl("div", { cls: "spacer" });
    const file = this.plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian29.TFile && file.extension == "md") {
      fieldModal = new MultiFileFuzzySuggester(this.plugin, file, this.field, p[this.field.name]);
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.alwaysOn)) {
      searchBtn.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        searchBtn.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        searchBtn.hide();
        spacer.show();
      };
    }
  }
  createFileContainer(container) {
    const dvQueryStringTopContainer = container.createDiv({ cls: "vstacked" });
    dvQueryStringTopContainer.createEl("span", { text: "Dataview Query (optional)", cls: "field-option" });
    const dvQueryStringContainer = dvQueryStringTopContainer.createDiv({ cls: "field-container" });
    this.dvQueryString = new import_obsidian29.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 50;
    this.dvQueryString.inputEl.rows = 4;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.inputEl.addClass("full-width");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
    const customeRenderingTopContainer = container.createDiv({ cls: "vstacked" });
    customeRenderingTopContainer.createEl("span", { text: "Alias" });
    customeRenderingTopContainer.createEl("span", { text: "Personalise the rendering of your links' aliases with a function returning a string (<page> object is available)", cls: "sub-text" });
    customeRenderingTopContainer.createEl("code", {
      text: `function(page) { return <function using "page">; }`
    });
    const customeRenderingContainer = customeRenderingTopContainer.createDiv({ cls: "field-container" });
    const customRendering = new import_obsidian29.TextAreaComponent(customeRenderingContainer);
    customRendering.inputEl.cols = 50;
    customRendering.inputEl.rows = 4;
    customRendering.inputEl.addClass("full-width");
    customRendering.setValue(this.field.options.customRendering || "");
    customRendering.setPlaceholder('Javascript string, the "page" (dataview page type) variable is available\nexample 1: page.file.name\nexample 2: `${page.file.name} of gender ${page.gender}`');
    customRendering.onChange((value) => {
      this.field.options.customRendering = value;
      FieldSettingsModal.removeValidationError(customRendering);
    });
    const customSortingTopContainer = container.createDiv({ cls: "vstacked" });
    customSortingTopContainer.createEl("span", { text: "Sorting order" });
    customSortingTopContainer.createEl("span", { text: "Personalise the sorting order of your links with a instruction taking 2 files (a, b) and returning -1, 0 or 1", cls: "sub-text" });
    customSortingTopContainer.createEl("code", {
      text: `(a: TFile, b: TFile): number`
    });
    const customSortingContainer = customSortingTopContainer.createDiv({ cls: "field-container" });
    const customSorting = new import_obsidian29.TextAreaComponent(customSortingContainer);
    customSorting.inputEl.cols = 50;
    customSorting.inputEl.rows = 4;
    customSorting.inputEl.addClass("full-width");
    customSorting.setValue(this.field.options.customSorting || "");
    customSorting.setPlaceholder("Javascript instruction, (a: TFile, b: TFile): number\nexample 1 (alphabetical order): a.basename < b.basename ? 1 : -1 \nexample 2 (creation time newer to older): b.stat.ctime - b.stat.ctime");
    customSorting.onChange((value) => {
      this.field.options.customSorting = value;
      FieldSettingsModal.removeValidationError(customSorting);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.createFileContainer(parentContainer);
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    return true;
  }
  displayValue(container, file, fieldName, onClick) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvValue = dvApi.page(file.path)[fieldName];
      const values = Array.isArray(dvValue) ? dvValue : [dvValue];
      values.forEach((value, i) => {
        if (dvApi.value.isLink(value)) {
          const link = container.createEl("a", { text: value.path.split("/").last().replace(/(.*).md/, "$1") });
          link.onclick = () => {
            this.plugin.app.workspace.openLinkText(value.path, file.path, true);
            onClick();
          };
        } else {
          container.createDiv({ text: value });
        }
        if (i < values.length - 1) {
          container.createEl("span", { text: " | " });
        }
      });
    }
    container.createDiv();
  }
};

// src/fields/fieldManagers/LookupField.ts
var import_obsidian32 = require("obsidian");

// src/commands/updateLookups.ts
var import_obsidian31 = require("obsidian");

// src/commands/getValues.ts
var import_obsidian30 = require("obsidian");
function getValues(plugin, fileOrfilePath, attribute) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrfilePath instanceof import_obsidian30.TFile) {
      file = fileOrfilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
      if (_file instanceof import_obsidian30.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield plugin.app.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const result = [];
    content.map((line, i) => {
      if (start2 && end2 && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`${attribute}:(.*)`, "u");
        const r = line.match(regex);
        if (r && r.length > 0)
          result.push(r[1]);
      } else {
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}(?<values>[^\\]]*)`, "u");
        const fR = encodeLink(line).match(fullLineRegex2);
        if (fR == null ? void 0 : fR.groups) {
          result.push(decodeLink(fR.groups.values));
        }
        ;
        const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}(?<values>[^\\]]+)?\\]`, "gu");
        const sRB = encodeLink(line).matchAll(inSentenceRegexBrackets2);
        let next = sRB.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRB.next();
        }
        const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}(?<values>[^\\)]+)?\\)`, "gu");
        const sRP = encodeLink(line).matchAll(inSentenceRegexPar2);
        next = sRP.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRP.next();
        }
      }
    });
    return result;
  });
}

// src/commands/updateLookups.ts
function arraysAsStringAreEqual(a, b) {
  const aAsArray = a.split(",").map((v) => v.trim());
  const bAsArray = b.split(",").map((v) => v.trim());
  return aAsArray.every((item) => bAsArray.includes(item)) && bAsArray.every((item) => aAsArray.includes(item));
}
function parseFieldValues(plugin, file, fieldName) {
  return __async(this, null, function* () {
    var _a, _b;
    const rawValue = (_a = yield getValues(plugin, file, fieldName)) == null ? void 0 : _a[0];
    const regex = new RegExp(`<div hidden id="${fieldName}_values">(?<values>.*)</div>`);
    const fR = rawValue.match(regex);
    return ((_b = fR == null ? void 0 : fR.groups) == null ? void 0 : _b.values) || rawValue;
  });
}
function updateLookups(plugin, source = "", forceUpdateOne) {
  return __async(this, null, function* () {
    var _a, _b, _c;
    const start2 = Date.now();
    const f = plugin.fieldIndex;
    let renderingErrors = [];
    for (let id of f.fileLookupFiles.keys()) {
      const matchRegex = new RegExp("(?<filePath>.*)__related__(?<fileClassName>.*)___(?<fieldName>.*)");
      const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
      const tFile = plugin.app.vault.getAbstractFileByPath(filePath);
      const dvApi = (_b = plugin.app.plugins.plugins.dataview) == null ? void 0 : _b.api;
      const dvFile = dvApi && dvApi.page(tFile.path);
      if (tFile && dvFile) {
        let newValue = "";
        const pages = f.fileLookupFiles.get(id);
        const field = (_c = f.filesFields.get(filePath)) == null ? void 0 : _c.find((field2) => field2.name == fieldName);
        if (field) {
          const outputType = field.options.outputType;
          if (!f.fileLookupFieldLastOutputType.get(id))
            f.fileLookupFieldLastOutputType.set(id, outputType);
          switch (outputType) {
            case "LinksList" /* LinksList */:
            case "LinksBulletList" /* LinksBulletList */:
              {
                const newValuesArray = pages == null ? void 0 : pages.map((dvFile2) => {
                  return FieldManager2.buildMarkDownLink(plugin, tFile, dvFile2.file.path);
                });
                newValue = (newValuesArray || []).join(", ");
              }
              break;
            case "CustomList" /* CustomList */:
            case "CustomBulletList" /* CustomBulletList */:
              {
                const renderingFunction = new Function("page", `return ${field.options.customListFunction}`);
                const newValuesArray = pages == null ? void 0 : pages.map((dvFile2) => {
                  try {
                    return renderingFunction(dvFile2);
                  } catch (e) {
                    if (!renderingErrors.includes(field.name))
                      renderingErrors.push(field.name);
                    return "";
                  }
                });
                newValue = (newValuesArray || []).join(", ");
              }
              break;
            case "CustomSummarizing" /* CustomSummarizing */:
              {
                const customSummarizingFunction = field.options.customSummarizingFunction;
                const summarizingFunction = new Function("pages", customSummarizingFunction.replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
                try {
                  newValue = summarizingFunction(pages).toString();
                } catch (e) {
                  if (!renderingErrors.includes(field.name))
                    renderingErrors.push(field.name);
                  newValue = "";
                }
              }
              break;
            case "BuiltinSummarizing" /* BuiltinSummarizing */:
              {
                const builtinFunction = field.options.builtinSummarizingFunction;
                const summarizingFunction = new Function("pages", BuiltinSummarizingFunction[builtinFunction].replace(/\{\{summarizedFieldName\}\}/g, field.options.summarizedFieldName));
                try {
                  newValue = summarizingFunction(pages).toString();
                } catch (e) {
                  if (!renderingErrors.includes(field.name))
                    renderingErrors.push(field.name);
                  newValue = "";
                }
              }
              break;
            default:
              break;
          }
          const currentValue = f.fileLookupFieldLastValue.get(id) || (yield parseFieldValues(plugin, tFile, field.name)) || "";
          const shouldCheckForUpdate = field.options.autoUpdate || field.options.autoUpdate === void 0 || (forceUpdateOne == null ? void 0 : forceUpdateOne.file.path) === tFile.path && (forceUpdateOne == null ? void 0 : forceUpdateOne.fieldName) === field.name;
          const valueHasChanged = !currentValue && newValue !== "" || !arraysAsStringAreEqual(currentValue, newValue);
          const formatHasChanged = outputType !== f.fileLookupFieldLastOutputType.get(id);
          if (shouldCheckForUpdate) {
            f.fileLookupFieldLastValue.set(id, newValue);
            f.fileLookupFieldLastOutputType.set(id, outputType);
          }
          if (shouldCheckForUpdate && (valueHasChanged || formatHasChanged)) {
            const previousValuesCount = plugin.fieldIndex.previousFileLookupFilesValues.get(id) || 0;
            yield plugin.fileTaskManager.pushTask(() => replaceValues(plugin, tFile, fieldName, newValue, previousValuesCount));
            f.fileLookupFieldsStatus.set(`${filePath}__${fieldName}`, "upToDate" /* upToDate */);
          } else if (source !== "full Index") {
            plugin.fieldIndex.fileChanged = false;
          }
          if (!valueHasChanged && !formatHasChanged) {
            f.fileLookupFieldsStatus.set(`${filePath}__${fieldName}`, "upToDate" /* upToDate */);
          }
        }
      }
    }
    if (renderingErrors.length)
      new import_obsidian31.Notice(`Those fields have incorrect output rendering functions:
${renderingErrors.join(",\n")}`);
  });
}

// src/fields/fieldManagers/LookupField.ts
var LookupField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Lookup" /* Lookup */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    if (!this.field.options.autoUpdate && this.field.options.autoUpdate !== void 0) {
      const f = this.plugin.fieldIndex;
      const id = `${file.path}__${this.field.name}`;
      let status2;
      status2 = f.fileLookupFieldsStatus.get(id) || "changed" /* changed */;
      if (f.fileLookupFieldLastOutputType.get(`${file.path}__related__${this.field.fileClassName}___${this.field.name}`) !== this.field.options.outputType)
        status2 = "changed" /* changed */;
      const icon = status2 === "changed" /* changed */ ? "refresh-ccw" : "file-check";
      const action = () => {
        updateLookups(this.plugin, "single_command", { file, fieldName: this.field.name });
      };
      if (LookupField.isMenu(location) && status2 === "changed" /* changed */) {
        location.addItem((item) => {
          item.setTitle(`Update <${name}>`);
          item.setIcon(icon);
          item.onClick(action);
          item.setSection("metadata-menu.fields");
        });
      } else if (LookupField.isSuggest(location) && status2 === "changed" /* changed */) {
        location.options.push({
          id: `update_${name}`,
          actionLabel: `<span>Update <b>${name}</b></span>`,
          action,
          icon
        });
      } else if (LookupField.isFieldOptions(location) && status2 === "changed" /* changed */) {
        location.addOption(icon, action, `Update ${name}'s value`);
      } else if (LookupField.isFieldOptions(location) && status2 === "upToDate" /* upToDate */) {
        location.addOption(icon, () => {
        }, `${name} is up to date`);
      }
    } else if (LookupField.isFieldOptions(location)) {
      location.addOption("server-cog", () => {
      }, `${name} is auto-updated`, "disabled");
    }
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    return __async(this, null, function* () {
      if (lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, file, this.field.name, "", lineNumber, inFrontmatter, after, asList, asComment);
        });
      }
      ;
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
  }
  displaySelectedOutputOptionContainer(optionContainers, value) {
    optionContainers.forEach((options_set) => {
      var _a, _b;
      if (options_set[0].includes(value)) {
        (_a = options_set[1]) == null ? void 0 : _a.show();
      } else {
        (_b = options_set[1]) == null ? void 0 : _b.hide();
      }
    });
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a, _b;
    const fileClassName = ((_b = (_a = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName)) == null ? void 0 : _b.fileClassName) || "presetField";
    container.createDiv({ text: this.plugin.fieldIndex.fileLookupFieldLastValue.get(`${file.path}__related__${fileClassName}___${fieldName}`) });
  }
  displaySelectedOutputWarningContainer(optionWarningContainer, value) {
    ["LinksBulletList" /* LinksBulletList */.toString(), "CustomBulletList" /* CustomBulletList */.toString()].includes(value) ? optionWarningContainer.show() : optionWarningContainer.hide();
  }
  createLookupContainer(container) {
    const autoUpdateTopContainer = container.createDiv({ cls: "vstacked" });
    const autoUpdateContainer = autoUpdateTopContainer.createDiv({ cls: "field-container" });
    autoUpdateContainer.createEl("span", { text: "Auto update this field ", cls: "label" });
    autoUpdateContainer.createDiv({ cls: "spacer" });
    const autoUpdate = new import_obsidian32.ToggleComponent(autoUpdateContainer);
    autoUpdateTopContainer.createEl("span", { text: "This could lead to latencies depending on the queries", cls: "sub-text warning" });
    if (this.field.options.autoUpdate === void 0)
      this.field.options.autoUpdate = true;
    autoUpdate.setValue(this.field.options.autoUpdate);
    autoUpdate.onChange((value) => {
      this.field.options.autoUpdate = value;
    });
    const dvQueryStringTopContainer = container.createDiv({ cls: "vstacked" });
    dvQueryStringTopContainer.createEl("span", { text: "Pages to look for in your vault (DataviewJS Query)", cls: "label" });
    dvQueryStringTopContainer.createEl("span", { text: "DataviewJS query of the form `dv.pages(...)`", cls: "sub-text" });
    const dvQueryStringContainer = dvQueryStringTopContainer.createDiv({ cls: "field-container" });
    const dvQueryString = new import_obsidian32.TextAreaComponent(dvQueryStringContainer);
    dvQueryString.inputEl.addClass("full-width");
    dvQueryString.inputEl.cols = 50;
    dvQueryString.inputEl.rows = 4;
    dvQueryString.setValue(this.field.options.dvQueryString || "");
    dvQueryString.setPlaceholder("exampe: dv.pages('#student')");
    dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(dvQueryString);
    });
    const targetFieldTopContainer = container.createDiv({ cls: "vstacked" });
    const targetFieldContainer = targetFieldTopContainer.createDiv({ cls: "field-container" });
    targetFieldContainer.createEl("span", { text: "Name of the related field", cls: "label" });
    const targetFieldName = new import_obsidian32.TextComponent(targetFieldContainer);
    targetFieldName.inputEl.addClass("full-width");
    targetFieldName.inputEl.addClass("with-label");
    targetFieldTopContainer.createEl("span", { text: "field in the target pages that contains a link to the page where this lookup field is", cls: "sub-text" });
    targetFieldName.setValue(this.field.options.targetFieldName || "");
    targetFieldName.onChange((value) => {
      this.field.options.targetFieldName = value;
      FieldSettingsModal.removeValidationError(targetFieldName);
    });
    const outputTypeContainer = container.createDiv({ cls: "field-container" });
    this.field.options.outputType = this.field.options.outputType || "LinksList" /* LinksList */;
    outputTypeContainer.createEl("span", { text: "Type of output", cls: "label" });
    outputTypeContainer.createDiv({ cls: "spacer" });
    const outputTypeList = new import_obsidian32.DropdownComponent(outputTypeContainer);
    Object.keys(Type).forEach((outputType) => {
      outputTypeList.addOption(outputType, Description[outputType]);
    });
    outputTypeList.setValue(this.field.options.outputType);
    const outputWarningContainer = container.createDiv();
    outputWarningContainer.createEl("p", {
      text: "Warning: this may override some lines under your list. There shouldn't be an extra manual item in the list that is automatically rendered by this field: it would be overriden after each field indexing",
      cls: "field-warning"
    });
    const builtinOptionsContainer = container.createDiv();
    const builtinSummarizeFunctionTopContainer = builtinOptionsContainer.createDiv({ cls: "vstacked" });
    const builtinSummarizeFunctionContainer = builtinSummarizeFunctionTopContainer.createDiv({ cls: "field-container" });
    this.field.options.builtinSummarizingFunction = this.field.options.builtinSummarizingFunction || Default.BuiltinSummarizing;
    builtinSummarizeFunctionContainer.createEl("span", { text: OptionLabel.BuiltinSummarizing, cls: "label" });
    builtinSummarizeFunctionContainer.createDiv({ cls: "spacer" });
    const builtinSummarizeFunctionList = new import_obsidian32.DropdownComponent(builtinSummarizeFunctionContainer);
    Object.keys(BuiltinSummarizing).forEach((builtinFunction2) => {
      builtinSummarizeFunctionList.addOption(builtinFunction2, BuiltinSummarizing[builtinFunction2]);
    });
    const builtinOptionsDescriptionContainer = builtinSummarizeFunctionTopContainer.createDiv({ cls: "sub-text" });
    const builtinFunction = this.field.options.builtinSummarizingFunction;
    builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[builtinFunction].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    builtinSummarizeFunctionList.setValue(this.field.options.builtinSummarizingFunction);
    builtinSummarizeFunctionList.onChange((value) => {
      this.field.options.builtinSummarizingFunction = value;
      builtinOptionsDescriptionContainer.setText(BuiltinSummarizingFunctionDescription[value].replace("{{summarizedFieldName}}", this.field.options.summarizedFieldName));
    });
    const summarizedFieldNameTopContainer = builtinOptionsContainer.createDiv({ cls: "vstacked" });
    this.field.options.summarizedFieldName = this.field.options.summarizedFieldName;
    const summarizedFieldNameContainer = summarizedFieldNameTopContainer.createDiv({ cls: "field-container" });
    summarizedFieldNameContainer.createEl("span", { text: "Summarized field name", cls: "label" });
    const summarizedFieldName = new import_obsidian32.TextComponent(summarizedFieldNameContainer);
    summarizedFieldName.inputEl.addClass("full-width");
    summarizedFieldName.inputEl.addClass("with-label");
    summarizedFieldNameTopContainer.createEl("span", { text: "Name of the field containing summarized value used for the summarizing function", cls: "sub-text" });
    summarizedFieldName.setValue(this.field.options.summarizedFieldName);
    summarizedFieldName.onChange((value) => {
      this.field.options.summarizedFieldName = value;
    });
    const outputRenderingFunctionTopContainer = container.createDiv({ cls: "vstacked" });
    this.field.options.customListFunction = this.field.options.customListFunction || Default.CustomList;
    outputRenderingFunctionTopContainer.createEl("span", { text: OptionLabel.CustomList, cls: "label" });
    outputRenderingFunctionTopContainer.createEl("code", { text: OptionSubLabel.CustomList });
    const outputRenderingFunctionContainer = outputRenderingFunctionTopContainer.createDiv({ cls: "field-container" });
    const outputRenderingFunction = new import_obsidian32.TextAreaComponent(outputRenderingFunctionContainer);
    outputRenderingFunction.inputEl.addClass("full-width");
    outputRenderingFunction.setPlaceholder(Helper.CustomList);
    outputRenderingFunction.setValue(this.field.options.customListFunction);
    outputRenderingFunction.inputEl.cols = 65;
    outputRenderingFunction.inputEl.rows = 4;
    outputRenderingFunction.onChange((value) => {
      this.field.options.customListFunction = value;
    });
    const outputSummarizingFunctionTopContainer = container.createDiv({ cls: "vstacked" });
    this.field.options.customSummarizingFunction = this.field.options.customSummarizingFunction || Default.CustomSummarizing;
    outputSummarizingFunctionTopContainer.createEl("span", { text: OptionLabel.CustomSummarizing, cls: "label" });
    outputSummarizingFunctionTopContainer.createEl("code", { text: OptionSubLabel.CustomSummarizing });
    const outputSummarizingFunctionContainer = outputSummarizingFunctionTopContainer.createDiv({ cls: "field-container" });
    const outputSummarizingFunction = new import_obsidian32.TextAreaComponent(outputSummarizingFunctionContainer);
    outputSummarizingFunction.inputEl.addClass("full-width");
    outputSummarizingFunction.setPlaceholder(Helper.CustomSummarizing);
    outputSummarizingFunction.setValue(this.field.options.customSummarizingFunction);
    outputSummarizingFunction.inputEl.cols = 65;
    outputSummarizingFunction.inputEl.rows = 8;
    outputSummarizingFunction.onChange((value) => {
      this.field.options.customSummarizingFunction = value;
    });
    const optionContainers = [
      [["LinksList", "LinksBulletList"], void 0],
      [["BuiltinSummarizing"], builtinOptionsContainer],
      [["CustomList", "CustomBulletList"], outputRenderingFunctionTopContainer],
      [["CustomSummarizing"], outputSummarizingFunctionTopContainer]
    ];
    this.displaySelectedOutputOptionContainer(optionContainers, outputTypeList.getValue());
    this.displaySelectedOutputWarningContainer(outputWarningContainer, outputTypeList.getValue());
    outputTypeList.onChange((value) => {
      this.field.options.outputType = value;
      this.displaySelectedOutputOptionContainer(optionContainers, value);
      this.displaySelectedOutputWarningContainer(outputWarningContainer, value);
    });
  }
  createSettingContainer(container, plugin, location) {
    this.createLookupContainer(container);
  }
  getOptionsStr() {
    const shortDescription = ShortDescription[this.field.options.outputType];
    let complement = "";
    if (this.field.options.outputType === "BuiltinSummarizing" /* BuiltinSummarizing */) {
      complement = ` ${this.field.options.builtinSummarizingFunction}${this.field.options.builtinSummarizingFunction !== "CountAll" /* CountAll */ ? " " + this.field.options.summarizedFieldName : ""}`;
    }
    return shortDescription + complement;
  }
  validateOptions() {
    return true;
  }
};

// src/fields/fieldManagers/FormulaField.ts
var import_obsidian33 = require("obsidian");
var FormulaField = class extends FieldManager2 {
  constructor(plugin, field) {
    super(plugin, field, "Formula" /* Formula */);
    this.showModalOption = false;
  }
  addFieldOption(name, value, file, location) {
    const action = () => {
    };
    if (FormulaField.isMenu(location) && status === "changed" /* changed */) {
      location.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon(FieldIcon.Formula);
        item.onClick(action);
        item.setSection("metadata-menu.fields");
      });
    } else if (FormulaField.isSuggest(location) && status === "changed" /* changed */) {
      location.options.push({
        id: `update_${name}`,
        actionLabel: `<span>Update <b>${name}</b></span>`,
        action,
        icon: FieldIcon.Formula
      });
    } else if (FormulaField.isFieldOptions(location)) {
      location.addOption(FieldIcon.Formula, () => {
      }, `${name} is automatically calculated`, "disabled");
    }
  }
  createAndOpenFieldModal(file, selectedFieldName, value, lineNumber, inFrontmatter, after, asList, asComment) {
    return __async(this, null, function* () {
      if (lineNumber == -1) {
        yield this.plugin.fileTaskManager.pushTask(() => {
          replaceValues(this.plugin, file, this.field.name, "");
        });
      } else {
        yield this.plugin.fileTaskManager.pushTask(() => {
          insertValues(this.plugin, file, this.field.name, "", lineNumber, inFrontmatter, after, asList, asComment);
        });
      }
      ;
    });
  }
  createDvField(dv, p, fieldContainer, attrs) {
  }
  displayValue(container, file, fieldName, onClicked = () => {
  }) {
    var _a, _b;
    const fileClassName = ((_b = (_a = this.plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((f) => f.name === fieldName)) == null ? void 0 : _b.fileClassName) || "presetField";
    container.createDiv({ text: this.plugin.fieldIndex.fileFormulaFieldLastValue.get(`${file.path}__calculated__${fileClassName}___${fieldName}`) });
  }
  createFormulaContainer(parentContainer) {
    const formulaTopContainer = parentContainer.createDiv({ cls: "vstacked" });
    formulaTopContainer.createEl("span", { text: "javascript formula", cls: "label" });
    formulaTopContainer.createEl("span", { text: "current and pages variables are available`", cls: "sub-text" });
    const formulaContainer = formulaTopContainer.createDiv({ cls: "field-container" });
    const formula = new import_obsidian33.TextAreaComponent(formulaContainer);
    formula.inputEl.addClass("full-width");
    formula.inputEl.cols = 50;
    formula.inputEl.rows = 4;
    formula.setValue(this.field.options.formula || "");
    formula.setPlaceholder("exampe: current.apple + current.bananas - 3");
    formula.onChange((value) => {
      this.field.options.formula = value;
      FieldSettingsModal.removeValidationError(formula);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.createFormulaContainer(parentContainer);
  }
  getOptionsStr() {
    return this.field.options.formula;
  }
  validateOptions() {
    return true;
  }
};

// src/fields/fieldManagers/Managers.ts
var Managers = {
  Input: InputField,
  Boolean: BooleanField,
  Number: NumberField,
  Select: SelectField,
  Cycle: CycleField,
  Multi: MultiField,
  File: FileField,
  Date: DateField,
  MultiFile: MultiFileField,
  Lookup: LookupField,
  Formula: FormulaField
};
var Managers_default = Managers;

// src/types/fieldTypes.ts
var FieldTypeLabelMapping = {
  "Input": "Input" /* Input */,
  "Select": "Select" /* Select */,
  "Multi": "Multi" /* Multi */,
  "Cycle": "Cycle" /* Cycle */,
  "Boolean": "Boolean" /* Boolean */,
  "Number": "Number" /* Number */,
  "File": "File" /* File */,
  "MultiFile": "MultiFile" /* MultiFile */,
  "Date": "Date" /* Date */,
  "Lookup": "Lookup" /* Lookup */,
  "Formula": "Formula" /* Formula */
};
var FieldTypeTagClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file",
  "MultiFile": "file",
  "Date": "date",
  "Lookup": "lookup",
  "Formula": "formula"
};
var FieldTypeTooltip = {
  "Input": "Accept any value",
  "Select": "Accept a single value from a list",
  "Multi": "Accept multiple values from a list",
  "Cycle": "Cycle through values from a list",
  "Boolean": "Accept true of false",
  "Number": "Accept a number",
  "File": "Accept a link",
  "MultiFile": "Accept multiple links",
  "Date": "Accept a date",
  "Lookup": "Accept a lookup query",
  "Formula": "Accept a formula"
};
var FieldManager = {
  "Input": Managers_default.Input,
  "Select": Managers_default.Select,
  "Multi": Managers_default.Multi,
  "Cycle": Managers_default.Cycle,
  "Boolean": Managers_default.Boolean,
  "Number": Managers_default.Number,
  "File": Managers_default.File,
  "MultiFile": Managers_default.MultiFile,
  "Date": Managers_default.Date,
  "Lookup": Managers_default.Lookup,
  "Formula": Managers_default.Formula
};
var FieldIcon = {
  "Input": "pencil",
  "Select": "right-triangle",
  "Multi": "bullet-list",
  "Cycle": "switch",
  "Boolean": "checkmark",
  "Number": "plus-minus-glyph",
  "File": "link",
  "MultiFile": "link",
  "Date": "calendar-with-checkmark",
  "Lookup": "file-search",
  "Formula": "function-square"
};
var FieldBackgroundColorClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file",
  "MultiFile": "file",
  "Date": "date",
  "Lookup": "lookup",
  "Formula": "lookup"
};

// src/fileClass/FileClassAttributeModal.ts
var FileClassAttributeModal = class extends import_obsidian34.Modal {
  constructor(plugin, fileClass, attr) {
    super(plugin.app);
    this.plugin = plugin;
    this.fileClass = fileClass;
    this.attr = attr;
    this.initialField = new Field_default();
    if (this.attr) {
      this.field = attr.getField();
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      this.field = new Field_default();
    }
    this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
    this.addCommand = this.field.command !== void 0;
    this.command = this.field.command || {
      id: this.field ? `insert__${this.field.fileClassName || "presetField"}__${this.field.name}` : "",
      icon: "list-plus",
      label: this.field ? `Insert ${this.field.name} field` : "",
      hotkey: void 0
    };
  }
  onOpen() {
    this.containerEl.addClass("metadata-menu");
    this.titleEl.setText(this.attr ? `Manage ${this.attr.name}` : `Create a new attribute for ${this.fileClass.name}`);
    this.buildNameInputContainer();
    this.buildHeader();
    this.contentEl.createEl("hr");
    this.buildCommandContainer();
    const typeSelectContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.contentEl.createEl("hr");
    this.fieldOptionsContainer = this.contentEl.createDiv();
    const footer = this.contentEl.createDiv({ cls: "footer-actions" });
    footer.createDiv({ cls: "spacer" });
    this.createSaveBtn(footer);
    if (this.attr)
      this.createRemovelBtn(footer);
    this.createCancelBtn(footer);
    this.buildTypeSelectContainer(typeSelectContainer);
    this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
  }
  buildNameInputContainer() {
    const container = this.contentEl.createDiv({ cls: "field-container" });
    container.createDiv({ cls: "label", text: "Field Name: " });
    const input = new import_obsidian34.TextComponent(container);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    this.attr ? input.setValue(this.field.name) : input.setPlaceholder("Name of the field");
    input.inputEl.focus();
    input.onChange((value) => {
      this.field.name = value;
      this.command.id = `insert__${this.field.fileClassName || "presetField"}__${value}`;
      this.command.label = `Insert ${value} field`;
      this.attrName.setText(`<${value}>`);
      FieldSettingsModal.removeValidationError(input);
    });
    this.nameInput = input;
  }
  buildCommandContainer() {
    const commandContainer = this.contentEl.createDiv({ cls: "field-container" });
    commandContainer.createDiv({ text: "set a command for this field?", cls: "label" });
    commandContainer.createDiv({ cls: "spacer" });
    const addCommandToggler = new import_obsidian34.ToggleComponent(commandContainer);
    addCommandToggler.setValue(this.addCommand);
    const iconContainer = this.contentEl.createDiv({ cls: "field-container" });
    this.addCommand ? iconContainer.show() : iconContainer.hide();
    iconContainer.createDiv({ text: "Icon name", cls: "label" });
    this.iconName = new import_obsidian34.TextComponent(iconContainer);
    this.iconName.inputEl.addClass("full-width");
    this.iconName.inputEl.addClass("with-label");
    const iconPreview = iconContainer.createDiv({ cls: "icon-preview" });
    this.iconName.setValue(this.command.icon);
    (0, import_obsidian34.setIcon)(iconPreview, this.command.icon);
    this.iconName.onChange((value) => {
      this.command.icon = value;
      (0, import_obsidian34.setIcon)(iconPreview, value);
    });
    addCommandToggler.onChange((value) => {
      this.addCommand = value;
      this.addCommand ? iconContainer.show() : iconContainer.hide();
    });
  }
  buildHeader() {
    const container = this.contentEl.createDiv({ cls: "field-container" });
    const typeSelectHeader = container.createDiv();
    const attrLine = typeSelectHeader.createEl("div");
    this.attrName = attrLine.createEl("strong");
    this.attrName.setText(`<${this.field.name}>`);
    attrLine.append(` available in files with ${this.plugin.settings.fileClassAlias} = ${this.field.fileClassName}`);
  }
  buildTypeSelectContainer(container) {
    const typeSelectorContainerLabel = container.createDiv({ cls: "label" });
    typeSelectorContainerLabel.setText(`Field type:`);
    container.createDiv({ cls: "spacer" });
    const typeSelect = new import_obsidian34.DropdownComponent(container);
    Object.keys(FieldTypeTooltip).forEach((key) => typeSelect.addOption(key, FieldTypeTooltip[key]));
    if (this.field.type) {
      typeSelect.setValue(this.field.type);
    }
    typeSelect.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.nameInput.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.nameInput, this.contentEl) && this.fieldManager.validateOptions();
  }
  createSaveBtn(container) {
    const saveButton = new import_obsidian34.ButtonComponent(container);
    saveButton.setTooltip("Save");
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      let error = !this.validateFields();
      if (error) {
        new import_obsidian34.Notice("Fix errors before saving.");
        return;
      }
      ;
      if (this.addCommand) {
        this.field.command = this.command;
      } else {
        delete this.field.command;
      }
      yield this.fileClass.updateAttribute(this.field.type, this.field.name, this.field.options, this.attr, this.field.command);
      this.close();
    }));
  }
  createRemovelBtn(container) {
    const removeButton = new import_obsidian34.ButtonComponent(container);
    removeButton.setIcon("trash");
    removeButton.onClick(() => {
      var _a;
      const confirmModal = new import_obsidian34.Modal(this.plugin.app);
      confirmModal.containerEl.addClass("metadata-menu");
      confirmModal.titleEl.setText("Please confirm");
      confirmModal.contentEl.createDiv().setText(`Do you really want to remove ${(_a = this.attr) == null ? void 0 : _a.name} attribute from ${this.fileClass.name}?`);
      const confirmFooter = confirmModal.contentEl.createDiv({ cls: "footer-actions" });
      confirmFooter.createDiv({ cls: "spacer" });
      const confirmButton = new import_obsidian34.ButtonComponent(confirmFooter);
      confirmButton.setWarning();
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => {
        if (this.attr)
          this.fileClass.removeAttribute(this.attr);
        confirmModal.close();
        this.close();
      });
      const dismissButton = new import_obsidian34.ButtonComponent(confirmFooter);
      dismissButton.setIcon("cross");
      dismissButton.onClick(() => this.close());
      confirmModal.open();
    });
  }
  createCancelBtn(container) {
    const cancelButton = new import_obsidian34.ButtonComponent(container);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => this.close());
  }
};

// src/modals/chooseSectionModal.ts
var import_obsidian35 = require("obsidian");
var chooseSectionModal = class extends import_obsidian35.SuggestModal {
  constructor(plugin, file, onSelect) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.onSelect = onSelect;
    this.addAsListItem = false;
    this.addAsComment = false;
    this.addAtEndOfFrontMatter = false;
    this.onSelect = onSelect;
    this.containerEl.addClass("metadata-menu");
    this.resultContainerEl.addClass("sections");
  }
  onOpen() {
    super.onOpen();
    const inputContainer = this.containerEl.createDiv({ cls: "suggester-input" });
    inputContainer.appendChild(this.inputEl);
    this.containerEl.find(".prompt").prepend(inputContainer);
    const addAsListItemBtn = new import_obsidian35.ButtonComponent(inputContainer);
    addAsListItemBtn.setIcon("list");
    addAsListItemBtn.onClick(() => {
      if (this.addAsListItem) {
        addAsListItemBtn.removeCta();
        this.addAsListItem = false;
      } else {
        addAsListItemBtn.setCta();
        this.addAsListItem = true;
      }
    });
    addAsListItemBtn.setDisabled(this.addAtEndOfFrontMatter);
    addAsListItemBtn.setTooltip("Add this field as a list item");
    const addAsCommentItemBtn = new import_obsidian35.ButtonComponent(inputContainer);
    addAsCommentItemBtn.setIcon("message-square");
    addAsCommentItemBtn.onClick(() => {
      if (this.addAsComment) {
        addAsCommentItemBtn.removeCta();
        this.addAsComment = false;
      } else {
        addAsCommentItemBtn.setCta();
        this.addAsComment = true;
      }
    });
    addAsCommentItemBtn.setDisabled(this.addAtEndOfFrontMatter);
    addAsCommentItemBtn.setTooltip("Add this field as a comment item");
    const addAtEndOfFrontMatterBtn = new import_obsidian35.ButtonComponent(inputContainer);
    addAtEndOfFrontMatterBtn.setIcon("list-end");
    addAtEndOfFrontMatterBtn.onClick(() => {
      this.onSelect(-2, true, false, false, false);
      this.close();
    });
    addAtEndOfFrontMatterBtn.setTooltip("Add this field at the end of the frontmatter");
  }
  getSuggestions(query) {
    return __async(this, null, function* () {
      const content = yield this.plugin.app.vault.read(this.file);
      const suggestions = [{
        lineNumber: -1,
        lineText: "----------Add on top of the file--------"
      }];
      content.split("\n").forEach((lineContent, i) => {
        if (lineContent.toLowerCase().includes(query.toLowerCase())) {
          suggestions.push({
            lineNumber: i,
            lineText: lineContent.substring(0, 57) + (lineContent.length < 57 ? "" : "...")
          });
        }
      });
      return suggestions;
    });
  }
  renderSuggestion(value, el) {
    el.addClass("item");
    const container = el.createDiv({ cls: "line" });
    container.createDiv({ text: `${value.lineNumber + 1}`, cls: "lineNumber" });
    container.createDiv({ text: value.lineText, cls: "lineText" });
  }
  onChooseSuggestion(item, evt) {
    var _a;
    const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter;
    const inFrontmatter = frontmatter !== void 0 && item.lineNumber <= frontmatter.position.end.line;
    const after = item.lineNumber == -1 ? false : true;
    this.onSelect(item.lineNumber == -1 ? 0 : item.lineNumber, inFrontmatter, after, this.addAsListItem, this.addAsComment);
  }
};

// src/commands/insertMissingFields.ts
var import_obsidian36 = require("obsidian");
function insertMissingFields(plugin, fileOrFilePath, lineNumber, inFrontmatter = false, after = false, asList = false, asComment = false, fileClassName) {
  return __async(this, null, function* () {
    var _a, _b;
    let file;
    if (fileOrFilePath instanceof import_obsidian36.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = plugin.app.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian36.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const f = plugin.fieldIndex;
      const tm = plugin.fileTaskManager;
      const fields = f.filesFields.get(file.path);
      const currentFieldsNames = genuineKeys(dvApi.page(file.path));
      const filteredClassFields = fileClassName ? ((_b = plugin.fieldIndex.fileClassesFields.get(fileClassName)) == null ? void 0 : _b.filter((field) => field.fileClassName === fileClassName)) || void 0 : void 0;
      fields == null ? void 0 : fields.filter((field) => !currentFieldsNames.includes(field.name)).filter((field) => filteredClassFields ? filteredClassFields.map((f2) => f2.name).includes(field.name) : true).reverse().forEach((field) => __async(this, null, function* () {
        yield tm.pushTask(() => {
          insertValues(plugin, file.path, field.name, "", lineNumber, inFrontmatter, after, asList, asComment);
        });
      }));
    }
  });
}

// src/components/NoteFields.ts
var FieldOptions = class {
  constructor(container) {
    this.container = container;
  }
  addOption(icon, onclick, tooltip, className) {
    const fieldOptionContainer = this.container.createDiv({ cls: "field-item field-option" });
    const fieldOption = new import_obsidian37.ButtonComponent(fieldOptionContainer);
    fieldOption.setIcon(icon);
    if (className)
      fieldOption.buttonEl.addClass(className);
    fieldOption.onClick(() => onclick());
    if (tooltip)
      fieldOption.setTooltip(tooltip);
  }
};
var FieldsModal = class extends import_obsidian37.Modal {
  constructor(plugin, file) {
    var _a;
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
    this.fieldContainers = [];
    this.maxOptions = 0;
    this.missingFields = false;
    this.dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    this.getFields();
    this.containerEl.addClass("metadata-menu");
    this.containerEl.addClass("note-fields-modal");
  }
  onOpen() {
    this.titleEl.setText(`Fields of ${this.file.basename}.${this.file.extension}`);
    this.buildFieldsContainer();
  }
  getFields() {
    this.fields = this.plugin.fieldIndex.filesFields.get(this.file.path) || [];
  }
  buildFieldContainer(parentContainer, field, value) {
    const fieldManager = new FieldManager[field.type](this.plugin, field);
    const fieldContainer = parentContainer.createDiv({ cls: "field-container" });
    const fieldNameContainer = fieldContainer.createDiv({ text: `${field.name}`, cls: "field-item field-name" });
    const fileClass = field.fileClassName ? this.plugin.fieldIndex.fileClassesName.get(field.fileClassName) : void 0;
    if (fileClass) {
      fieldNameContainer.addClass(`fileClassField__${fileClass.name.replace("/", "___").replace(" ", "_")}`);
    }
    const fieldSettingContainer = fieldContainer.createDiv({ cls: "field-item field-setting" });
    const fieldSettingBtn = new import_obsidian37.ButtonComponent(fieldSettingContainer);
    fieldSettingBtn.setIcon("gear");
    fieldSettingBtn.setTooltip(`${field.fileClassName ? field.fileClassName + " > " : "Preset Field > "} ${field.name} settings`);
    fieldSettingBtn.onClick(() => {
      const _fileClass = field.fileClassName ? this.plugin.fieldIndex.fileClassesName.get(field.fileClassName) : void 0;
      const fileClassAttribute = _fileClass == null ? void 0 : _fileClass.attributes.find((attr) => attr.name === field.name);
      if (fileClassAttribute && _fileClass) {
        const fileClassAttributeModal = new FileClassAttributeModal(this.plugin, _fileClass, fileClassAttribute);
        fileClassAttributeModal.open();
      }
    });
    const fieldTypeContainer = fieldContainer.createDiv({ cls: `field-item` });
    fieldTypeContainer.createDiv({ text: field.type, cls: `chip field-type ${FieldBackgroundColorClass[field.type]}` });
    const fieldValueContainer = fieldContainer.createDiv({
      cls: value !== void 0 && value !== null ? "field-item field-value" : "field-item field-value emptyfield"
    });
    if (value === null) {
      fieldValueContainer.setText(field.type === "Lookup" /* Lookup */ ? "---auto---" : "<empty>");
    } else if (value === void 0) {
      this.missingFields = true;
      fieldValueContainer.setText("<missing>");
    } else {
      fieldManager.displayValue(fieldValueContainer, this.file, field.name, () => {
        this.close();
      });
    }
    const fieldOptions = new FieldOptions(fieldContainer);
    if (value !== void 0) {
      fieldManager.addFieldOption(field.name, value, this.file, fieldOptions);
    } else {
      const fieldBtnContainer = fieldContainer.createDiv({ cls: "field-item field-option" });
      const fieldBtn = new import_obsidian37.ButtonComponent(fieldBtnContainer);
      fieldBtn.setIcon("list-plus");
      fieldBtn.setTooltip("Add field at section");
      fieldBtn.onClick(() => {
        new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(this.plugin, this.file, field.name, "", lineNumber, inFrontmatter, after, asList, asComment)).open();
      });
    }
    ;
    const optionsCount = fieldContainer.querySelectorAll(".field-option").length;
    if (this.maxOptions < optionsCount)
      this.maxOptions = optionsCount;
    return fieldContainer;
  }
  openInsertMissingFieldsForFileClassModal(fileClass) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      if (dvFile) {
        const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment, fileClass.name));
        modal.open();
      }
    }
  }
  missingFieldsForFileClass(fileClass) {
    var _a, _b;
    const currentFieldsNames = [];
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      if (dvFile) {
        currentFieldsNames.push(...genuineKeys(dvFile));
      }
    }
    ;
    const missingFields = fileClass && this.file ? !((_b = this.plugin.fieldIndex.fileClassesFields.get(fileClass.name)) == null ? void 0 : _b.map((f) => f.name).every((fieldName) => currentFieldsNames.includes(fieldName))) : false;
    return missingFields;
  }
  buildFileClassManager(container) {
    const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
    fileClasses.forEach((fileClass) => {
      const fileClassManagerContainer = container.createDiv({ cls: "fields-inheritance-manager-container" });
      const _ancestors = this.plugin.fieldIndex.fileClassesAncestors.get(fileClass.name) || [];
      const ancestors = [..._ancestors].reverse();
      ancestors.push(fileClass.name);
      ancestors.forEach((fileClassName, i) => {
        const _fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
        if (_fileClass) {
          const fileClassOptionsContainer = fileClassManagerContainer.createDiv({ cls: "fileclass-manager-container" });
          const fileClassNameContainer = fileClassOptionsContainer.createDiv({ cls: "name", text: _fileClass.name });
          fileClassNameContainer.setAttr("id", `fileClass__${_fileClass.name.replace("/", "___").replace(" ", "_")}`);
          if (this.missingFieldsForFileClass(_fileClass)) {
            const fileClassInsertMissingFieldsBtn = new import_obsidian37.ButtonComponent(fileClassOptionsContainer);
            fileClassInsertMissingFieldsBtn.setIcon("battery-full");
            fileClassInsertMissingFieldsBtn.setTooltip(`Insert missing fields for ${_fileClass.name}`);
            fileClassInsertMissingFieldsBtn.onClick(() => {
              this.openInsertMissingFieldsForFileClassModal(_fileClass);
            });
          }
          const fileClassAddAttributeBtn = new import_obsidian37.ButtonComponent(fileClassOptionsContainer);
          fileClassAddAttributeBtn.setIcon("plus-circle");
          fileClassAddAttributeBtn.setTooltip(`Add field definition in ${_fileClass.name}`);
          fileClassAddAttributeBtn.onClick(() => {
            const fileClassAttributeModal = new FileClassAttributeModal(this.plugin, _fileClass);
            fileClassAttributeModal.open();
          });
          if (i < ancestors.length - 1) {
            fileClassManagerContainer.createDiv({ text: ">", cls: "separator" });
          }
          const fileClassFielsContainers = this.containerEl.querySelectorAll(`[class*="fileClassField__${fileClassName.replace("/", "___").replace(" ", "_")}"]`);
          fileClassFielsContainers.forEach((fieldNameContainer) => {
            fieldNameContainer.onmouseover = () => {
              fileClassNameContainer == null ? void 0 : fileClassNameContainer.addClass("active");
            };
            fieldNameContainer.onmouseout = () => {
              fileClassNameContainer == null ? void 0 : fileClassNameContainer.removeClass("active");
            };
          });
          fileClassNameContainer.onmouseover = () => {
            this.containerEl.querySelectorAll(`.field-item.field-name.fileClassField__${fileClassName.replace("/", "___").replace(" ", "_")}`).forEach((cont) => {
              cont.addClass("active");
            });
          };
          fileClassNameContainer.onmouseout = () => {
            this.containerEl.querySelectorAll(`.field-item.field-name.fileClassField__${fileClassName.replace("/", "___").replace(" ", "_")}`).forEach((cont) => {
              cont.removeClass("active");
            });
          };
        }
      });
    });
  }
  formatOptionsColumns(fieldsContainer) {
    const fieldContainers = fieldsContainer.querySelectorAll(".field-container");
    fieldContainers.forEach((field) => {
      var _a, _b;
      const options = field.querySelectorAll(".field-option");
      if (options.length < this.maxOptions) {
        const parent = (_a = options[0]) == null ? void 0 : _a.parentElement;
        if (parent) {
          for (let i = 0; i < this.maxOptions - options.length; i++) {
            const emptyCell = parent.createDiv({ cls: "field-item field-option" });
            (_b = options[0].parentElement) == null ? void 0 : _b.insertBefore(emptyCell, options[0]);
          }
        }
      }
    });
  }
  buildFieldsContainer() {
    this.missingFields = false;
    this.contentEl.replaceChildren();
    this.contentEl.createEl("hr");
    const fieldsContainer = this.contentEl.createDiv({ cls: "note-fields-container" });
    this.fields.forEach((field) => {
      const value = this.dvApi ? this.dvApi.page(this.file.path)[field.name] : void 0;
      this.fieldContainers.push(this.buildFieldContainer(fieldsContainer, field, value));
    });
    this.formatOptionsColumns(fieldsContainer);
    if (this.missingFields) {
      const insertMissingFieldsContainer = this.contentEl.createDiv({ cls: "insert-all-fields" });
      insertMissingFieldsContainer.createDiv({ text: "Insert missing fields" });
      const insertMissingFieldsBtn = new import_obsidian37.ButtonComponent(insertMissingFieldsContainer);
      insertMissingFieldsBtn.setIcon("battery-full");
      insertMissingFieldsBtn.onClick(() => {
        var _a;
        const dvFile = (_a = this.dvApi) == null ? void 0 : _a.page(this.file.path);
        if (dvFile) {
          new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment)).open();
        }
      });
    }
    this.contentEl.createEl("hr");
    const fileClassManagersContainer = this.contentEl.createDiv({ cls: "fields-container" });
    this.buildFileClassManager(fileClassManagersContainer);
  }
};
var NoteFieldsComponent = class extends import_obsidian37.Component {
  constructor(plugin, cacheVersion, onChange, file) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.file = file;
    this.fieldsModal = new FieldsModal(this.plugin, file);
    this.fieldsModal.onClose = () => {
      this.plugin.removeChild(this);
      this.unload();
    };
  }
  onload() {
    this.plugin.registerEvent(this.plugin.app.metadataCache.on("dataview:metadata-change", () => {
      this.fieldsModal.getFields();
      this.fieldsModal.buildFieldsContainer();
    }));
    this.fieldsModal.open();
  }
};

// src/fileClass/fileClassAttribute.ts
var FileClassAttribute = class {
  constructor(origin, name, type = "Input" /* Input */, options = [], fileClassName, command) {
    this.origin = origin;
    this.name = name;
    this.type = type;
    this.options = options;
    this.fileClassName = fileClassName;
    this.command = command;
  }
  getField() {
    var _a;
    let options = {};
    if (Array.isArray(this.options)) {
      (_a = this.options) == null ? void 0 : _a.forEach((option, index) => {
        options[index] = option;
      });
    } else {
      options = this.options;
    }
    return new Field_default(this.name, options, this.name, this.type, this.fileClassName, this.command);
  }
};

// src/fileClass/fileClass.ts
var import_obsidian38 = require("obsidian");

// src/utils/textUtils.ts
var capitalize = (s) => {
  return s && s[0].toUpperCase() + s.slice(1);
};

// src/fileClass/fileClass.ts
var AddFileClassToFileModal = class extends import_obsidian38.SuggestModal {
  constructor(plugin, file) {
    super(plugin.app);
    this.plugin = plugin;
    this.file = file;
  }
  getSuggestions(query) {
    return [...this.plugin.fieldIndex.fileClassesName.keys()].filter((fileClassName) => {
      var _a;
      return !((_a = this.plugin.fieldIndex.filesFileClasses.get(this.file.path)) == null ? void 0 : _a.map((fileClass) => fileClass.name).includes(fileClassName));
    }).filter((fileClassName) => fileClassName.toLocaleLowerCase().contains(query.toLowerCase())).sort();
  }
  renderSuggestion(value, el) {
    el.setText(value);
  }
  onChooseSuggestion(item, evt) {
    this.insertFileClassToFile(item);
  }
  insertFileClassToFile(value) {
    return __async(this, null, function* () {
      var _a, _b, _c;
      const fileClassAlias = this.plugin.settings.fileClassAlias;
      const currentFileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path);
      const frontmatterFileClasses = (_b = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b[fileClassAlias];
      if (currentFileClasses && frontmatterFileClasses) {
        replaceValues(this.plugin, this.file, fileClassAlias, [...currentFileClasses.map((fc) => fc.name), value].join(", "));
      } else {
        const frontmatter = (_c = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _c.frontmatter;
        if (frontmatter) {
          if (Object.keys(frontmatter).includes(fileClassAlias)) {
            yield replaceValues(this.plugin, this.file, fileClassAlias, value);
          } else {
            const lineNumber = frontmatter.position.end.line - 1;
            yield insertValues(this.plugin, this.file, fileClassAlias, value, lineNumber, true);
          }
        } else {
          const fields = {};
          fields[fileClassAlias] = value;
          yield insertFrontmatterWithFields(this.plugin, this.file, fields);
        }
      }
    });
  }
};
var FileClassManager = class {
  constructor(instance) {
    this.instance = instance;
  }
  all() {
    const filesWithFileClassName = this.instance.plugin.app.vault.getMarkdownFiles().filter((file) => {
      const cache = this.instance.plugin.app.metadataCache.getFileCache(file);
      const fileClassAlias = this.instance.plugin.settings.fileClassAlias;
      return (cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).includes(fileClassAlias) && cache.frontmatter[fileClassAlias] == this.instance.name;
    });
    return filesWithFileClassName;
  }
  get(name) {
    const filesWithName = this.all().filter((file) => file.path.replace(/md$/, "").endsWith(name));
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
  getPath(path) {
    const filesWithName = this.all().filter((file) => file.path == path);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
};
var FileClass = class {
  constructor(plugin, name) {
    this.plugin = plugin;
    this.name = name;
    this.objects = new FileClassManager(this);
    this.attributes = [];
  }
  isMappedWithTag() {
    var _a, _b;
    try {
      const fileClassFile = this.getClassFile();
      const mapWithTag = (_b = (_a = this.plugin.app.metadataCache.getFileCache(fileClassFile)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.mapWithTag;
      return !!mapWithTag;
    } catch (error) {
      return false;
    }
  }
  getClassFile() {
    const filesClassPath = this.plugin.settings.classFilesPath;
    const file = this.plugin.app.vault.getAbstractFileByPath(`${filesClassPath}${this.name}.md`);
    if (file instanceof import_obsidian38.TFile && file.extension == "md") {
      return file;
    } else {
      const error = new Error(`no file named <${this.name}.md> in <${filesClassPath}> folder to match <${this.plugin.settings.fileClassAlias}: ${this.name}> in one of these notes`);
      throw error;
    }
  }
  getIcon() {
    const parents = [this.name, ...this.plugin.fieldIndex.fileClassesAncestors.get(this.name) || []];
    let icon;
    parents.some((fileClassName, i) => {
      var _a, _b;
      const fileClass = this.plugin.fieldIndex.fileClassesName.get(fileClassName);
      if (fileClass) {
        const file = fileClass.getClassFile();
        const _icon = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.icon;
        if (_icon) {
          icon = _icon;
          return true;
        }
        ;
      }
    });
    return icon;
  }
  static getFileClassAttributes(plugin, fileClass, excludes) {
    var _a;
    const file = fileClass.getClassFile();
    let attributes = [];
    const dvApi = (_a = plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(file.path);
      try {
        genuineKeys(dvFile).forEach((key) => {
          if (key !== "file" && !Object.keys(dvFile.file.frontmatter || {}).includes(key)) {
            const item = typeof dvFile[key] !== "string" ? JSON.stringify(dvFile[key]) : dvFile[key];
            try {
              const { type, options, command } = JSON.parse(item);
              const fieldType = FieldTypeLabelMapping[capitalize(type)];
              const attr = new FileClassAttribute(this.name, key, fieldType, options, fileClass.name, command);
              attributes.push(attr);
            } catch (e) {
            }
          }
        });
      } catch (error) {
        throw error;
      }
    }
    if (excludes) {
      return attributes.filter((attr) => !excludes.includes(attr.name));
    } else {
      return attributes;
    }
  }
  static getExcludedFieldsFromFrontmatter(excludedFields) {
    if (Array.isArray(excludedFields)) {
      return excludedFields;
    } else if (excludedFields) {
      return excludedFields.split(",");
    } else {
      return [];
    }
  }
  getAttributes(excludeParents = false) {
    var _a, _b;
    try {
      const file = this.getClassFile();
      const ancestors = this.plugin.fieldIndex.fileClassesAncestors.get(this.name);
      const _excludedFields = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.excludes;
      let excludedFields = FileClass.getExcludedFieldsFromFrontmatter(_excludedFields);
      const ancestorsAttributes = /* @__PURE__ */ new Map();
      ancestorsAttributes.set(this.name, FileClass.getFileClassAttributes(this.plugin, this, excludedFields));
      if (!excludeParents) {
        ancestors == null ? void 0 : ancestors.forEach((ancestorName) => {
          var _a2, _b2;
          const ancestorFile = this.plugin.app.vault.getAbstractFileByPath(`${this.plugin.settings.classFilesPath}${ancestorName}.md`);
          const ancestor = new FileClass(this.plugin, ancestorName);
          ancestorsAttributes.set(ancestorName, FileClass.getFileClassAttributes(this.plugin, ancestor, excludedFields));
          if (ancestorFile instanceof import_obsidian38.TFile && ancestorFile.extension === "md") {
            const _excludedFields2 = (_b2 = (_a2 = this.plugin.app.metadataCache.getFileCache(ancestorFile)) == null ? void 0 : _a2.frontmatter) == null ? void 0 : _b2.excludes;
            excludedFields = FileClass.getExcludedFieldsFromFrontmatter(_excludedFields2);
          }
        });
      }
      for (const [fileClassName, fileClassAttributes] of ancestorsAttributes) {
        this.attributes.push(...fileClassAttributes.filter((attr) => !this.attributes.map((_attr) => _attr.name).includes(attr.name)));
      }
    } catch (error) {
      throw error;
    }
  }
  updateAttribute(newType, newName, newOptions, attr, newCommand) {
    return __async(this, null, function* () {
      const fileClass = attr ? this.plugin.fieldIndex.fileClassesName.get(attr.fileClassName) : this;
      const file = fileClass.getClassFile();
      let result = yield this.plugin.app.vault.read(file);
      if (attr) {
        let newContent = [];
        result.split("\n").forEach((line) => {
          if (line.startsWith(attr.name)) {
            let settings = {};
            settings["type"] = newType;
            if (newOptions)
              settings["options"] = newOptions;
            if (newCommand)
              settings["command"] = newCommand;
            newContent.push(`${newName}:: ${JSON.stringify(settings)}`);
          } else {
            newContent.push(line);
          }
        });
        this.plugin.app.vault.modify(file, newContent.join("\n"));
      } else {
        let settings = {};
        settings["type"] = newType;
        if (newOptions)
          settings["options"] = newOptions;
        if (newCommand)
          settings["command"] = newCommand;
        result += `
${newName}:: ${JSON.stringify(settings)}`;
        yield this.plugin.app.vault.modify(file, result);
      }
    });
  }
  removeAttribute(attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      const result = yield this.plugin.app.vault.read(file);
      let newContent = [];
      result.split("\n").forEach((line) => {
        if (!line.startsWith(attr.name)) {
          newContent.push(line);
        }
      });
      yield this.plugin.app.vault.modify(file, newContent.join("\n"));
    });
  }
  static createFileClass(plugin, name, excludeParent = false) {
    const fileClass = new FileClass(plugin, name);
    fileClass.getAttributes();
    return fileClass;
  }
  static getFileClassNameFromPath(plugin, path) {
    var _a, _b;
    const fileClassNameRegex = new RegExp(`${plugin.settings.classFilesPath}(?<fileClassName>.*).md`);
    return (_b = (_a = path.match(fileClassNameRegex)) == null ? void 0 : _a.groups) == null ? void 0 : _b.fileClassName;
  }
};

// src/options/FieldCommandSuggestModal.ts
var import_obsidian39 = require("obsidian");
var FieldCommandSuggestModal = class extends import_obsidian39.FuzzySuggestModal {
  constructor(app2) {
    super(app2);
    this.options = [];
    this.containerEl.addClass("metadata-menu");
  }
  getItems() {
    return this.options;
  }
  getItemText(item) {
    return item.actionLabel;
  }
  onChooseItem(item, evt) {
    item.action();
  }
  renderSuggestion(item, el) {
    el.addClass("value-container");
    const iconContainer = el.createDiv({ cls: "icon-container" });
    item.item.icon ? (0, import_obsidian39.setIcon)(iconContainer, item.item.icon) : (0, import_obsidian39.setIcon)(iconContainer, "pencil");
    const actionLabel = el.createDiv();
    actionLabel.innerHTML = item.item.actionLabel;
  }
};

// src/options/FileClassOptionsList.ts
var import_obsidian42 = require("obsidian");

// src/components/fileClassTable.ts
var import_obsidian41 = require("obsidian");

// src/fileClass/fileClassChoiceModal.ts
var import_obsidian40 = require("obsidian");
var FileClassChoiceModal = class extends import_obsidian40.SuggestModal {
  constructor(plugin, table, tagsAndFileClasses) {
    super(plugin.app);
    this.plugin = plugin;
    this.table = table;
    this.tagsAndFileClasses = tagsAndFileClasses;
    this.containerEl.addClass("metadata-menu");
  }
  getSuggestions(query) {
    const index = this.plugin.fieldIndex;
    const values = [.../* @__PURE__ */ new Set([...index.fileClassesName.keys(), ...index.tagsMatchingFileClasses.keys()])].filter((name) => name.toLowerCase().includes(query.toLowerCase())).sort((a, b) => a.localeCompare(b));
    if (this.tagsAndFileClasses.length) {
      return values.filter((value) => this.tagsAndFileClasses.includes(value));
    } else {
      return values;
    }
  }
  renderSuggestion(value, el) {
    el.setText(value);
    el.addClass("value-container");
  }
  onChooseSuggestion(item, evt) {
    return __async(this, null, function* () {
      var _a;
      const index = this.plugin.fieldIndex;
      const fileClass = index.fileClassesName.get(item) || index.tagsMatchingFileClasses.get(item);
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (fileClass && dvApi) {
        this.table.name = item;
        this.table.fileClass = fileClass;
        this.table.fileClassTableViewType = FILECLASS_TABLE_VIEW_TYPE + "__" + fileClass.name;
        this.table.openTableView();
      }
      this.close();
    });
  }
};

// src/components/fileClassTable.ts
var FILECLASS_TABLE_VIEW_TYPE = "FileClassTableView";
var FileClassTableView = class extends import_obsidian41.ItemView {
  constructor(leaf, plugin, component, name, fileClass) {
    super(leaf);
    this.leaf = leaf;
    this.plugin = plugin;
    this.component = component;
    this.name = name;
    this.fileClass = fileClass;
    this.containerEl.addClass("metadata-menu");
    this.navigation = false;
    this.icon = "file-spreadsheet";
    this.onunload = () => {
      this.plugin.app.viewRegistry.unregisterView(FILECLASS_TABLE_VIEW_TYPE + "__" + this.fileClass.name);
      this.plugin.removeChild(this.component);
      this.unload();
    };
  }
  getDisplayText() {
    return this.name || "FileClass";
  }
  getViewType() {
    return this.fileClass ? FILECLASS_TABLE_VIEW_TYPE + "__" + this.fileClass.name : FILECLASS_TABLE_VIEW_TYPE;
  }
  onOpen() {
    return __async(this, null, function* () {
      var _a, _b;
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      this.icon = ((_b = this.fileClass) == null ? void 0 : _b.getIcon()) || "file-spreadsheet";
      if (dvApi) {
        dvApi.executeJs(this.buildDvJSQuery(), this.contentEl, this, "");
      }
    });
  }
  buildDvJSQuery() {
    if (this.fileClass) {
      const fields = this.plugin.fieldIndex.fileClassesFields.get(this.fileClass.name) || [];
      let dvQuery = 'const {fieldModifier: f} = this.app.plugins.plugins["metadata-menu"].api;\ndv.table(["File",';
      dvQuery += fields.map((field) => `"${field.name}"`).join(",");
      dvQuery += `], dv.pages()
`;
      dvQuery += `    .where(p => p.fileClass === '${this.name}' || p.file.etags.values.includes('#${this.name}'))
`;
      dvQuery += "    .map(p => [\n        p.file.link,\n";
      dvQuery += fields.map((field) => `        f(dv, p, "${field.name}", {options: {alwaysOn: false, showAddField: true}})`).join(",\n");
      dvQuery += "    \n])\n);";
      return dvQuery;
    }
  }
};
var FileClassComponent2 = class extends import_obsidian41.Component {
  constructor(plugin, fileClass) {
    super();
    this.plugin = plugin;
    this.fileClass = fileClass;
    if (!this.fileClass) {
      this.fileClassTableViewType = FILECLASS_TABLE_VIEW_TYPE;
    } else {
      this.fileClassTableViewType = FILECLASS_TABLE_VIEW_TYPE + "__" + this.fileClass.name;
    }
  }
  onload() {
    return __async(this, null, function* () {
      if (this.fileClass) {
        this.name = this.fileClass.name;
        this.fileClassTableViewType = FILECLASS_TABLE_VIEW_TYPE + "__" + this.fileClass.name;
        yield this.openTableView();
      } else {
        const tagsAndFileClasses = this.getActiveFileTagsAndFileClasses();
        if (tagsAndFileClasses.length === 1) {
          const index = this.plugin.fieldIndex;
          const fileClassName = tagsAndFileClasses[0];
          const fileClass = index.fileClassesName.get(fileClassName) || index.tagsMatchingFileClasses.get(fileClassName);
          if (fileClass) {
            this.name = fileClass.name;
            this.fileClass = fileClass;
            this.fileClassTableViewType = FILECLASS_TABLE_VIEW_TYPE + "__" + fileClass.name;
            yield this.openTableView();
          } else {
            this.plugin.removeChild(this);
            this.unload();
          }
        } else {
          const choiceModal = new FileClassChoiceModal(this.plugin, this, tagsAndFileClasses);
          choiceModal.onClose = () => {
            if (!this.fileClass) {
              this.plugin.removeChild(this);
              this.unload();
            }
          };
          choiceModal.open();
        }
      }
    });
  }
  onunload() {
    this.plugin.app.workspace.detachLeavesOfType(this.fileClassTableViewType);
    this.plugin.app.viewRegistry.unregisterView(this.fileClassTableViewType);
  }
  openTableView() {
    return __async(this, null, function* () {
      this.plugin.app.workspace.detachLeavesOfType(this.fileClassTableViewType);
      this.plugin.registerView(this.fileClassTableViewType, (leaf) => new FileClassTableView(leaf, this.plugin, this, this.name, this.fileClass));
      yield this.plugin.app.workspace.getLeaf("tab", "vertical").setViewState({
        type: this.fileClassTableViewType,
        active: true
      });
      this.plugin.app.workspace.revealLeaf(this.plugin.app.workspace.getLeavesOfType(this.fileClassTableViewType).last());
    });
  }
  getActiveFileTagsAndFileClasses() {
    var _a, _b, _c;
    const index = this.plugin.fieldIndex;
    const activeFilePath = (_a = this.plugin.app.workspace.getActiveFile()) == null ? void 0 : _a.path;
    const tagsAndFileClasses = [];
    const dvApi = (_b = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _b.api;
    if (activeFilePath && dvApi) {
      tagsAndFileClasses.push(...((_c = dvApi.page(activeFilePath).etags) == null ? void 0 : _c.filter((tag) => [...index.tagsMatchingFileClasses.keys()].includes(tag))) || []);
      tagsAndFileClasses.push(...index.filesFileClassesNames.get(activeFilePath) || []);
    }
    return [...new Set(tagsAndFileClasses)];
  }
};

// src/options/FileClassOptionsList.ts
function isMenu(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand(location) {
  return location === "InsertFieldCommand";
}
function isSuggest(location) {
  return location.getItems !== void 0;
}
var FileClassOptionsList = class {
  constructor(plugin, file, location, fromFile) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.fromFile = fromFile;
    this.fileClass = this.plugin.fieldIndex.fileClassesPath.get(this.file.path);
  }
  createExtraOptionList(openAfterCreate = true) {
    var _a, _b;
    const mapWithTagAction = () => __async(this, null, function* () {
      var _a2;
      const frontmatter = (_a2 = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a2.frontmatter;
      if (frontmatter) {
        if (Object.keys(frontmatter).includes("mapWithTag")) {
          yield replaceValues(this.plugin, this.file, "mapWithTag", "true");
        } else {
          const lineNumber = frontmatter.position.end.line - 1;
          yield insertValues(this.plugin, this.file, "mapWithTag", "true", lineNumber, true);
        }
      } else {
        const fields = { "mapWithTag": "true" };
        yield insertFrontmatterWithFields(this.plugin, this.file, fields);
      }
    });
    const openFileClassTableViewAction = () => {
      const fileClassComponent = new FileClassComponent2(this.plugin, fileClass);
      this.plugin.addChild(fileClassComponent);
    };
    if (isMenu(this.location)) {
      this.location.addSeparator();
    }
    ;
    const fileClass = this.fileClass;
    const currentFieldsNames = [];
    let addMissingFieldsAction = () => {
      new import_obsidian42.Notice("Something went wrong, please check your fileClass definitions");
    };
    if (this.fromFile) {
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (dvApi) {
        const dvFile = dvApi.page(this.fromFile.path);
        if (dvFile) {
          currentFieldsNames.push(...genuineKeys(dvFile));
          const modal = new chooseSectionModal(this.plugin, this.fromFile, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment, fileClass == null ? void 0 : fileClass.name));
          addMissingFieldsAction = () => {
            modal.open();
          };
        }
      }
      ;
    }
    const missingFields = fileClass && this.fromFile ? !((_b = this.plugin.fieldIndex.fileClassesFields.get(fileClass.name)) == null ? void 0 : _b.map((f) => f.name).every((fieldName) => currentFieldsNames.includes(fieldName))) : false;
    if (isInsertFieldCommand(this.location) && fileClass) {
      const modal = new FileClassAttributeModal(this.plugin, fileClass);
      modal.open();
    } else if (isSuggest(this.location)) {
      if (fileClass) {
        this.location.options.push({
          id: `display_table_view_for_${fileClass.name.replace("/", "_")}`,
          actionLabel: `Display ${fileClass.name} table view`,
          action: openFileClassTableViewAction,
          icon: "file-spreadsheet"
        });
      }
      if (fileClass && !fileClass.isMappedWithTag()) {
        this.location.options.push({
          id: "map_fileClass_with_tag",
          actionLabel: `<span>Map <b>${fileClass.name}</b> with tag of same name</span>`,
          action: mapWithTagAction,
          icon: "hash"
        });
      }
      if (fileClass && missingFields && this.fromFile) {
        this.location.options.push({
          id: `insert_missig_fields_from_${fileClass.name.replace("/", "_")}`,
          actionLabel: `<span>Insert missing fields from <b>${fileClass.name}</b></span>`,
          action: addMissingFieldsAction,
          icon: "battery-full"
        });
      }
      this.buildFieldOptions();
      if (openAfterCreate)
        this.location.open();
    } else if (isMenu(this.location)) {
      if (fileClass) {
        this.location.addItem((item) => {
          item.setTitle(`Display ${fileClass.name} table view`);
          item.onClick(openFileClassTableViewAction);
          item.setIcon("file-spreadsheet");
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      if (fileClass && !fileClass.isMappedWithTag()) {
        this.location.addItem((item) => {
          item.setTitle(`Map ${fileClass.name} with tag`);
          item.setIcon("hash");
          item.onClick(mapWithTagAction);
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      if (fileClass && missingFields && this.fromFile) {
        this.location.addItem((item) => {
          item.setTitle(`Insert missing fields from ${fileClass.name}`);
          item.setIcon("battery-full");
          item.onClick(addMissingFieldsAction);
          item.setSection(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`);
        });
      }
      this.buildFieldOptions();
    } else {
      this.buildFieldOptions;
    }
  }
  buildFieldOptions() {
    var _a;
    (_a = this.fileClass) == null ? void 0 : _a.attributes.forEach((attr) => {
      const modal2 = new FileClassAttributeModal(this.plugin, this.fileClass, attr);
      if (isMenu(this.location)) {
        this.location.addItem((item) => {
          item.setTitle(`${this.fileClass.name} - ${attr.name}`);
          item.setIcon("wrench");
          item.onClick(() => {
            modal2.open();
          });
          item.setSection(`metadata-menu-fileclass.${this.fileClass.name}.fileclass-fields`);
        });
      } else if (isSuggest(this.location)) {
        this.location.options.push({
          id: `update_${attr.name}`,
          actionLabel: `<span>${attr.name}</span>`,
          action: () => modal2.open(),
          icon: "gear"
        });
      }
    });
    const modal = new FileClassAttributeModal(this.plugin, this.fileClass);
    const action = () => modal.open();
    if (isMenu(this.location) && this.fileClass) {
      this.location.addItem((item) => {
        item.setTitle("Add new field");
        item.setIcon("plus-circle");
        item.onClick(action);
        item.setSection(`metadata-menu-fileclass.${this.fileClass.name}.fileclass-fields`);
      });
    } else if (isSuggest(this.location) && this.fileClass) {
      this.location.options.push({
        id: "add_fileClass_attribute",
        actionLabel: `<span>Insert an attribute for <b>${this.fileClass.name}</b> fileClass</span>`,
        action,
        icon: "plus-circle"
      });
    }
  }
};

// src/options/OptionsList.ts
var import_obsidian44 = require("obsidian");

// src/modals/addNewFileClassModal.ts
var import_obsidian43 = require("obsidian");

// src/commands/createFileClass.ts
function createFileClass(_0, _1) {
  return __async(this, arguments, function* (plugin, name, mapWithTag = false, tagNames = []) {
    const classFilesPath = plugin.settings.classFilesPath;
    if (classFilesPath) {
      try {
        const content = mapWithTag ? `---
mapWithTag: true
${tagNames.length ? "tagNames: [" + tagNames.join(", ") + "]\n" : ""}---
` : "";
        yield plugin.app.vault.create(`${classFilesPath}${name}.md`, content);
      } catch (error) {
        throw error;
      }
    }
  });
}

// src/modals/addNewFileClassModal.ts
var AddNewFileClassModal = class extends import_obsidian43.Modal {
  constructor(plugin) {
    super(plugin.app);
    this.plugin = plugin;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    this.titleEl.setText("Add a new fileClass");
    this.buildAddFileClassForm();
  }
  buildAddFileClassForm() {
    const fileClassesPath = this.plugin.settings.classFilesPath;
    const fileClassAlias = this.plugin.settings.fileClassAlias;
    const nameContainer = this.contentEl.createDiv({ cls: "field-container" });
    nameContainer.createDiv({ text: `${fileClassAlias} name`, cls: "label" });
    const nameInput = new import_obsidian43.TextComponent(nameContainer);
    nameInput.inputEl.addClass("with-label");
    nameInput.inputEl.addClass("full-width");
    const nameErrorContainer = this.contentEl.createDiv({ cls: "field-error", text: `This ${fileClassAlias} file already exists` });
    const mapWithTagContainer = this.contentEl.createDiv({ cls: "field-container" });
    mapWithTagContainer.createDiv({ cls: "label", text: `Map this ${fileClassAlias} file with the tag of same name` });
    mapWithTagContainer.createDiv({ cls: "spacer" });
    const mapWithTagToggler = new import_obsidian43.ToggleComponent(mapWithTagContainer);
    mapWithTagToggler.setValue(false);
    mapWithTagToggler.onChange((value) => {
      if (value) {
        tagNamesContainer.show();
      } else {
        tagNamesContainer.hide();
      }
    });
    const tagNamesContainer = this.contentEl.createDiv({ cls: "field-container" });
    tagNamesContainer.createDiv({ cls: "label", text: "Aliases (optional)" });
    const tagNamesInput = new import_obsidian43.TextComponent(tagNamesContainer);
    tagNamesInput.inputEl.addClass("with-label");
    tagNamesInput.inputEl.addClass("full-width");
    tagNamesInput.setPlaceholder("Leave empty to map with the tag of same name as fileclass");
    tagNamesContainer.hide();
    const actionsContainer = this.contentEl.createDiv({ cls: "footer-actions" });
    actionsContainer.createDiv({ cls: "spacer" });
    const saveBtn = new import_obsidian43.ButtonComponent(actionsContainer);
    saveBtn.setDisabled(true);
    saveBtn.setIcon("file-plus-2");
    nameErrorContainer.hide();
    nameInput.onChange((value) => __async(this, null, function* () {
      nameErrorContainer.hide();
      saveBtn.setDisabled(false);
      saveBtn.setCta();
      if (yield this.plugin.app.vault.adapter.exists(`${fileClassesPath}${value}.md`)) {
        nameErrorContainer.show();
        saveBtn.setDisabled(true);
        saveBtn.removeCta();
      } else {
        saveBtn.setDisabled(false);
        saveBtn.setCta();
      }
    }));
    saveBtn.onClick(() => {
      createFileClass(this.plugin, nameInput.getValue(), mapWithTagToggler.getValue(), tagNamesInput.getValue().split(",").map((t) => t.trim()));
      this.close();
    });
  }
};

// src/options/OptionsList.ts
function isMenu2(location) {
  return location.addItem !== void 0;
}
function isInsertFieldCommand2(location) {
  return location === "InsertFieldCommand";
}
function isSuggest2(location) {
  return location.getItems !== void 0;
}
var OptionsList = class {
  constructor(plugin, file, location, includedFields) {
    this.plugin = plugin;
    this.file = file;
    this.location = location;
    this.includedFields = includedFields;
    this.fieldsFromIndex = {};
    this.file = file;
    this.location = location;
    this.attributes = {};
    this.includedFields = includedFields ? [this.plugin.settings.fileClassAlias, ...includedFields] : [this.plugin.settings.fileClassAlias];
    this.getFieldsFromIndex();
    this.getFieldsValues();
  }
  getFieldsValues() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins["dataview"]) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      try {
        genuineKeys(dvFile).forEach((key) => this.addAttribute(key, dvFile[key]));
      } catch (error) {
        throw error;
      }
    }
  }
  addAttribute(key, value) {
    const includedFields = this.includedFields.filter((f) => f !== this.plugin.settings.fileClassAlias);
    if (includedFields.length > 0) {
      if (this.includedFields.includes(key) && !this.plugin.settings.globallyIgnoredFields.includes(key)) {
        this.attributes[key] = value;
      }
    } else if (!this.plugin.settings.globallyIgnoredFields.includes(key)) {
      this.attributes[key] = value;
    }
  }
  getFieldsFromIndex() {
    const index = this.plugin.fieldIndex;
    const fields = index.filesFields.get(this.file.path);
    fields == null ? void 0 : fields.forEach((field) => this.fieldsFromIndex[field.name] = field);
  }
  createAndOpenFieldModal(fieldName) {
    const field = this.fieldsFromIndex[fieldName];
    if (field) {
      const fieldManager = new FieldManager[field.type](this.plugin, field);
      fieldManager.createAndOpenFieldModal(this.file, field.name, this.attributes[field.name]);
    } else {
      const defaultField = new Field_default(fieldName);
      defaultField.type = "Input" /* Input */;
      if (fieldName === this.plugin.settings.fileClassAlias) {
        this.buildFileClassFieldOptions(defaultField, this.attributes[fieldName]);
      } else if (this.location === "ManageAtCursorCommand") {
        const fieldManager = new Managers_default.Input(this.plugin, defaultField);
        fieldManager.createAndOpenFieldModal(this.file, fieldName, this.attributes[fieldName]);
      }
    }
  }
  createExtraOptionList(openAfterCreate = true) {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    const location = this.location;
    if (isMenu2(location)) {
      location.addSeparator();
    }
    ;
    if (isInsertFieldCommand2(location)) {
      this.addFieldAtCurrentPositionOption();
    } else if (isSuggest2(location)) {
      this.buildFieldOptions();
      this.addFieldAtCurrentPositionOption();
      this.addSectionSelectModalOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (dvApi) {
        const currentFieldsNames = genuineKeys(dvApi.page(this.file.path));
        if (![...this.plugin.fieldIndex.filesFields.get(this.file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          this.addAllMissingFieldsAtSection();
        }
      }
      const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
      fileClasses.forEach((fileClass) => {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
        const optionsList = new FileClassOptionsList(this.plugin, fileClass.getClassFile(), fieldCommandSuggestModal, this.file);
        optionsList.createExtraOptionList(false);
        location.options.push({
          id: "manage_fileClass_attributes",
          actionLabel: `<span>Manage <b>${fileClass.name}</b> fileClass fields</span>`,
          action: () => {
            fieldCommandSuggestModal.open();
          },
          icon: "wrench"
        });
      });
      this.addFileClassToFileOption();
      this.addNewFileClassOption();
      if (openAfterCreate)
        location.open();
    } else if (isMenu2(location)) {
      this.buildFieldOptions();
      this.addSectionSelectModalOption();
      this.addFieldAtCurrentPositionOption();
      this.addFieldAtTheEndOfFrontmatterOption();
      if (dvApi) {
        const currentFieldsNames = genuineKeys(dvApi.page(this.file.path));
        if (![...this.plugin.fieldIndex.filesFields.get(this.file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          this.addAllMissingFieldsAtSection();
        }
      }
      const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(this.file.path) || [];
      fileClasses.forEach((fileClass) => {
        const fileClassOptionsList = new FileClassOptionsList(this.plugin, fileClass.getClassFile(), location, this.file);
        fileClassOptionsList.createExtraOptionList(false);
      });
      this.addFileClassToFileOption();
      this.addNewFileClassOption();
    }
  }
  buildFileClassFieldOptions(field, value) {
    const modal = new InputModal(this.plugin, this.file, field, value);
    modal.titleEl.setText(`Change Value for <${field.name}>`);
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setTitle(`Update ${field.name}`);
        item.setIcon("wrench");
        item.onClick(() => modal.open());
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: `update_${field.name}`,
        actionLabel: `<span>Update <b>${field.name}</b></span>`,
        action: () => modal.open(),
        icon: FieldIcon["Input" /* Input */]
      });
    }
    ;
  }
  buildFieldOptions() {
    Object.keys(this.attributes).forEach((key) => {
      const value = this.attributes[key];
      const field = this.fieldsFromIndex[key];
      if (field) {
        const fieldManager = new FieldManager[field.type](this.plugin, field);
        fieldManager.addFieldOption(key, value, this.file, this.location);
      } else if (key !== "file" && (isSuggest2(this.location) || isMenu2(this.location))) {
        const defaultField = new Field_default(key);
        defaultField.type = "Input" /* Input */;
        if (key === this.plugin.settings.fileClassAlias) {
          this.buildFileClassFieldOptions(defaultField, value);
        } else {
          const fieldManager = new Managers_default.Input(this.plugin, defaultField);
          fieldManager.addFieldOption(key, value || "", this.file, this.location);
        }
      }
    });
  }
  addSectionSelectModalOption() {
    const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, after, asList, asComment));
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setIcon("enter");
        item.setTitle("Add field at section...");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("metadata-menu");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: "add_field_at_section",
        actionLabel: "Add field at section...",
        action: () => modal.open(),
        icon: "enter"
      });
    }
    ;
  }
  addAllMissingFieldsAtSection() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi) {
      const dvFile = dvApi.page(this.file.path);
      const modal = new chooseSectionModal(this.plugin, this.file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(this.plugin, dvFile.file.path, lineNumber, inFrontmatter, after, asList, asComment));
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("battery-full");
          item.setTitle("Add missing fields at section...");
          item.onClick((evt) => {
            modal.open();
          });
          item.setSection("metadata-menu");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_missing_fields_at_section",
          actionLabel: "Add missing fields at section...",
          action: () => modal.open(),
          icon: "battery-full"
        });
      }
      ;
    }
  }
  addFieldAtTheEndOfFrontmatterOption() {
    var _a;
    if ((_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter) {
      const lineNumber = this.plugin.app.metadataCache.getCache(this.file.path).frontmatter.position.end.line - 1;
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field in frontmatter");
          item.onClick((evt) => __async(this, null, function* () {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber + 1, true, false, false, false);
          }));
          item.setSection("metadata-menu");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_in_frontmatter",
          actionLabel: "Add a field in frontmatter...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber + 1, true, false, false, false),
          icon: "pin"
        });
      }
    }
  }
  addFieldAtCurrentPositionOption() {
    var _a;
    const currentView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian44.MarkdownView);
    const lineNumber = currentView == null ? void 0 : currentView.editor.getCursor().line;
    if (lineNumber !== void 0 && this.file.path == (currentView == null ? void 0 : currentView.file.path)) {
      let inFrontmatter = false;
      const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(this.file)) == null ? void 0 : _a.frontmatter;
      if (frontmatter) {
        const { position: { start: start2, end: end2 } } = frontmatter;
        if (lineNumber >= start2.line && lineNumber < end2.line)
          inFrontmatter = true;
      }
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("pin");
          item.setTitle("Add field at cursor");
          item.onClick((evt) => {
            FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, false, false);
          });
          item.setSection("metadata-menu");
        });
      } else if (isInsertFieldCommand2(this.location)) {
        FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, false, false);
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_field_at_cursor",
          actionLabel: "Add field at cursor...",
          action: () => FieldManager2.openFieldModal(this.plugin, this.file, void 0, "", lineNumber, inFrontmatter, false, false, false),
          icon: "pin"
        });
      }
      ;
    }
  }
  addFileClassToFileOption() {
    const modal = new AddFileClassToFileModal(this.plugin, this.file);
    const action = () => modal.open();
    if (isMenu2(this.location)) {
      this.location.addItem((item) => {
        item.setIcon("plus-square");
        item.setTitle(`Add ${this.plugin.settings.fileClassAlias} to ${this.file.basename}`);
        item.onClick(action);
        item.setSection("metadata-menu-fileclass");
      });
    } else if (isSuggest2(this.location)) {
      this.location.options.push({
        id: "add_fileclass_to_file",
        actionLabel: `Add ${this.plugin.settings.fileClassAlias} to ${this.file.basename}`,
        action,
        icon: "plus-square"
      });
    }
    ;
  }
  addNewFileClassOption() {
    const modal = new AddNewFileClassModal(this.plugin);
    const action = () => modal.open();
    if (this.plugin.settings.classFilesPath) {
      if (isMenu2(this.location)) {
        this.location.addItem((item) => {
          item.setIcon("file-plus-2");
          item.setTitle(`Add a new ${this.plugin.settings.fileClassAlias}`);
          item.onClick(action);
          item.setSection("metadata-menu-fileclass");
        });
      } else if (isSuggest2(this.location)) {
        this.location.options.push({
          id: "add_new_fileclass",
          actionLabel: `Add a new ${this.plugin.settings.fileClassAlias}`,
          action,
          icon: "file-plus-2"
        });
      }
    }
  }
};

// src/commands/paletteCommands.ts
function addFileClassAttributeOptions(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "fileClassAttr_options",
    name: "All fileClass attributes options",
    icon: "gear",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
      const inFileClass = !!(classFilesPath && !!(view == null ? void 0 : view.file) && view.file.path.startsWith(classFilesPath));
      if (checking) {
        return inFileClass;
      }
      if (inFileClass) {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(plugin.app);
        const optionsList = new FileClassOptionsList(plugin, view.file, fieldCommandSuggestModal);
        optionsList.createExtraOptionList();
      }
    }
  });
}
function addInsertFileClassAttribute(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "insert_fileClassAttr",
    name: "Insert a new fileClass attribute",
    icon: "list-plus",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
      const inFileClass = !!(classFilesPath && !!(view == null ? void 0 : view.file) && view.file.path.startsWith(classFilesPath));
      if (checking) {
        return inFileClass;
      }
      if (inFileClass) {
        try {
          const fileClassName = FileClass.getFileClassNameFromPath(plugin, view.file.path);
          if (fileClassName) {
            const fileClassAttributeModal = new FileClassAttributeModal(plugin, FileClass.createFileClass(plugin, fileClassName));
            fileClassAttributeModal.open();
          }
        } catch (error) {
          new import_obsidian45.Notice("plugin is not a valid fileClass");
        }
      }
    }
  });
}
function addInsertFieldAtPositionCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "insert_field_at_cursor",
    name: "Choose a field to insert at cursor",
    icon: "list-plus",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const optionsList = new OptionsList(plugin, view.file, "InsertFieldCommand");
        optionsList.createExtraOptionList();
      }
    }
  });
}
function addFieldOptionsCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "field_options",
    name: "Fields options",
    icon: "gear",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const fieldCommandSuggestModal = new FieldCommandSuggestModal(plugin.app);
        const optionsList = new OptionsList(plugin, view.file, fieldCommandSuggestModal);
        optionsList.createExtraOptionList();
      }
    }
  });
}
function addManageFieldAtCursorCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "field_at_cursor_options",
    name: "Manage field at cursor",
    icon: "text-cursor-input",
    checkCallback: (checking) => {
      var _a;
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
      const editor = view == null ? void 0 : view.editor;
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile && editor !== void 0;
      }
      if (inFile && editor !== void 0) {
        const optionsList = new OptionsList(plugin, view.file, "ManageAtCursorCommand");
        const frontmatter = (_a = plugin.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter;
        if (frontmatter && editor && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
          const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        } else if (editor) {
          const { attribute, values } = getLineFields(editor.getLine(editor.getCursor().line)).find((field) => editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) || {};
          if (attribute)
            optionsList.createAndOpenFieldModal(attribute);
        }
      }
    }
  });
}
function insertMissingFieldsCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "insert_missing_fields",
    name: "Bulk insert missing fields",
    icon: "battery-full",
    checkCallback: (checking) => {
      var _a;
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (dvApi && inFile) {
        const file = view.file;
        const currentFieldsNames = genuineKeys(dvApi.page(file.path));
        if (![...plugin.fieldIndex.filesFields.get(file.path) || []].map((field) => field.name).every((fieldName) => currentFieldsNames.includes(fieldName))) {
          new chooseSectionModal(plugin, file, (lineNumber, inFrontmatter, after, asList, asComment) => insertMissingFields(plugin, file.path, lineNumber, inFrontmatter, after, asList, asComment)).open();
        }
      }
    }
  });
}
function addUpdateLookups(plugin) {
  plugin.addCommand({
    id: "update_formulas",
    name: "Update formulas fields",
    icon: "function-square",
    checkCallback: (checking) => {
      if (checking)
        return true;
      plugin.fieldIndex.fullIndex("command", true);
    }
  });
}
function addOpenFieldsModalCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  plugin.addCommand({
    id: "open_fields_modal",
    name: "Open this note's fields modal",
    icon: "clipboard-list",
    checkCallback: (checking) => {
      const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
      const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
      if (checking) {
        return inFile;
      }
      if (inFile) {
        const file = view.file;
        if (inFile && file instanceof import_obsidian45.TFile && file.extension === "md") {
          const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
          }, file);
          plugin.addChild(noteFieldsComponent);
        }
      }
    }
  });
}
function addInsertFieldCommand(plugin) {
  const classFilesPath = plugin.settings.classFilesPath;
  const fields = [];
  plugin.settings.presetFields.forEach((f) => {
    if (f.command)
      fields.push(f);
  });
  [...plugin.fieldIndex.fileClassesFields].forEach(([fileClassName, _fields]) => {
    _fields.forEach((field) => {
      if (field.command) {
        fields.push(field);
      }
    });
  });
  fields.forEach((field) => {
    if (field.command) {
      const command = field.command;
      plugin.addCommand({
        id: command.id,
        name: command.label,
        icon: command.icon,
        checkCallback: (checking) => {
          var _a;
          const view = plugin.app.workspace.getActiveViewOfType(import_obsidian45.MarkdownView);
          const inFile = !!((view == null ? void 0 : view.file) && (!classFilesPath || !view.file.path.startsWith(classFilesPath)));
          const fR = command.id.match(new RegExp("insert__(?<fileClassName>.*)__(?<fieldName>.*)"));
          if (checking) {
            const fileClasses = (view == null ? void 0 : view.file) ? plugin.fieldIndex.filesFileClasses.get(view == null ? void 0 : view.file.path) : void 0;
            return (view == null ? void 0 : view.file) && (fileClasses && fileClasses.some((fileClass) => {
              var _a2;
              return fileClass.name === ((_a2 = fR == null ? void 0 : fR.groups) == null ? void 0 : _a2.fileClassName);
            }) || !fileClasses && ((_a = fR == null ? void 0 : fR.groups) == null ? void 0 : _a.fileClassName) === "presetField");
          }
          if ((fR == null ? void 0 : fR.groups) && (view == null ? void 0 : view.file)) {
            const fieldName = fR.groups.fieldName;
            new chooseSectionModal(plugin, view.file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(plugin, view.file, fieldName, "", lineNumber, inFrontmatter, after, asList, asComment)).open();
          }
        }
      });
    }
  });
}
function addFileClassTableViewCommand(plugin) {
  plugin.addCommand({
    id: "open_fileclass_view",
    name: "Open fileClass view",
    icon: "file-spreadsheet",
    checkCallback: (checking) => {
      var _a;
      if (checking) {
        return true;
      }
      const activeFilePath = (_a = plugin.app.workspace.getActiveFile()) == null ? void 0 : _a.path;
      const fileClass = activeFilePath ? plugin.fieldIndex.fileClassesPath.get(activeFilePath) : void 0;
      const fileClassComponent = new FileClassComponent2(plugin, fileClass);
      plugin.addChild(fileClassComponent);
    }
  });
}
function addCommands(plugin, view) {
  const classFilesPath = plugin.settings.classFilesPath;
  if (view && view instanceof import_obsidian45.FileView) {
    const file = plugin.app.vault.getAbstractFileByPath(view.file.path);
    if (file instanceof import_obsidian45.TFile && file.extension === "md") {
      if (classFilesPath && file.path.startsWith(classFilesPath)) {
        addFileClassAttributeOptions(plugin);
        addInsertFileClassAttribute(plugin);
      } else {
        addFieldOptionsCommand(plugin);
        addInsertFieldAtPositionCommand(plugin);
        addManageFieldAtCursorCommand(plugin);
        insertMissingFieldsCommand(plugin);
        addOpenFieldsModalCommand(plugin);
        addInsertFieldCommand(plugin);
      }
    }
  }
  addFileClassTableViewCommand(plugin);
  addUpdateLookups(plugin);
}

// src/components/ContextMenu.ts
var import_obsidian46 = require("obsidian");
var ContextMenu = class extends import_obsidian46.Component {
  constructor(plugin) {
    super();
    this.plugin = plugin;
  }
  onload() {
    this.plugin.registerEvent(this.plugin.app.workspace.on("file-menu", (menu, abstractFile, source) => {
      const file = this.plugin.app.vault.getAbstractFileByPath(abstractFile.path);
      this.buildOptions(file, menu);
    }));
    this.plugin.registerEvent(this.plugin.app.workspace.on("editor-menu", (menu, editor, view) => {
      var _a;
      const file = this.plugin.app.workspace.getActiveFile();
      const includedFields = [];
      const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(view.file)) == null ? void 0 : _a.frontmatter;
      if (frontmatter && editor.getCursor().line > frontmatter.position.start.line && editor.getCursor().line < frontmatter.position.end.line) {
        const attribute = frontMatterLineField(editor.getLine(editor.getCursor().line));
        if (attribute)
          includedFields.push(attribute);
      } else {
        getLineFields(editor.getLine(editor.getCursor().line)).forEach((field) => {
          if (editor.getCursor().ch <= field.index + field.length && editor.getCursor().ch >= field.index) {
            includedFields.push(field.attribute);
          }
        });
      }
      if (includedFields.length) {
        this.buildOptions(file, menu, includedFields);
      } else {
        this.buildOptions(file, menu);
      }
    }));
  }
  buildOptions(file, menu, includedFields) {
    const classFilesPath = this.plugin.settings.classFilesPath;
    if (file instanceof import_obsidian46.TFile && file.extension === "md") {
      if (!import_obsidian46.Platform.isMobile && (0, import_obsidian46.requireApiVersion)("0.16.0")) {
        if (classFilesPath && file.path.startsWith(classFilesPath)) {
          const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, file.path);
          menu.setSectionSubmenu(`metadata-menu-fileclass.${fileClassName}.fileclass-fields`, { title: "Manage fields", icon: "wrench" });
        } else {
          menu.setSectionSubmenu("metadata-menu.current_field", { title: "Current field", icon: "pencil" });
          menu.setSectionSubmenu("metadata-menu.fields", { title: "Manage fields", icon: "pencil" });
          const fileClasses = this.plugin.fieldIndex.filesFileClasses.get(file.path) || [];
          fileClasses.forEach((fileClass) => {
            menu.setSectionSubmenu(`metadata-menu-fileclass.${fileClass.name}.fileclass-fields`, { title: `Manage ${fileClass.name} fields`, icon: "wrench" });
          });
        }
      }
      if (this.plugin.settings.displayFieldsInContextMenu) {
        if (classFilesPath && file.path.startsWith(classFilesPath)) {
          const fileClassOptionsList = new FileClassOptionsList(this.plugin, file, menu);
          fileClassOptionsList.createExtraOptionList();
        } else {
          const optionsList = new OptionsList(this.plugin, file, menu, includedFields);
          optionsList.createExtraOptionList();
        }
        ;
      } else {
        menu.addItem((item) => {
          item.setIcon("list");
          item.setTitle("Field Options");
          item.onClick(() => {
            const fieldCommandSuggestModal = new FieldCommandSuggestModal(this.plugin.app);
            const optionsList = new OptionsList(this.plugin, file, fieldCommandSuggestModal);
            optionsList.createExtraOptionList();
          });
        });
      }
    }
    ;
  }
};

// src/components/ExtraButton.ts
var import_obsidian49 = require("obsidian");

// src/options/linkAttributes.ts
var import_obsidian47 = require("obsidian");
function clearExtraAttributes(link) {
  Object.values(link.attributes).forEach((attr) => {
    if (attr.name.includes("fileclass-name")) {
      link.removeAttribute(attr.name);
      const el = link.nextElementSibling;
      if (el == null ? void 0 : el.hasClass("fileclass-icon")) {
        el.remove();
      }
    }
  });
}
function setLinkMetadataFormButton(plugin, link, destName, viewTypeName, fileClassName) {
  var _a;
  switch (viewTypeName) {
    case "a.internal-link":
      if (!plugin.settings.enableLinks)
        return;
      break;
    case "tabHeader":
      if (!plugin.settings.enableTabHeader)
        return;
      break;
    case "starred":
      if (!plugin.settings.enableStarred)
        return;
      break;
    case "file-explorer":
      if (!plugin.settings.enableFileExplorer)
        return;
      break;
    case "backlink":
      if (!plugin.settings.enableBacklinks)
        return;
      break;
    case "search":
      if (!plugin.settings.enableSearch)
        return;
      break;
    default:
      return;
  }
  for (const a of link.attributes) {
    if (a.name.includes("fileclass-name") && a.name !== fileClassName) {
      link.removeAttribute(a.name);
      const el = link.nextElementSibling;
      if (el == null ? void 0 : el.hasClass("fileclass-icon")) {
        el.remove();
      }
    }
  }
  if (fileClassName) {
    const fileClass = plugin.fieldIndex.fileClassesName.get(fileClassName);
    if (fileClass) {
      const icon = fileClass.getIcon();
      link.setAttribute("fileclass-name", fileClassName);
      const el = link.nextElementSibling;
      if (!(el == null ? void 0 : el.hasClass("fileclass-icon"))) {
        const metadataMenuBtn = plugin.app.workspace.containerEl.createEl("a", { cls: "metadata-menu fileclass-icon" });
        if (metadataMenuBtn) {
          (0, import_obsidian47.setIcon)(metadataMenuBtn, icon || plugin.settings.buttonIcon);
          (_a = link.parentElement) == null ? void 0 : _a.insertBefore(metadataMenuBtn, link.nextSibling);
          metadataMenuBtn.onclick = (event) => {
            const file = plugin.app.vault.getAbstractFileByPath(`${destName}.md`);
            if (file instanceof import_obsidian47.TFile && file.extension === "md") {
              const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
              }, file);
              plugin.addChild(noteFieldsComponent);
            }
            event.stopPropagation();
          };
        }
      }
    }
  }
}
function updateLinkMetadataMenuFormButton(app2, plugin, link, viewTypeName, source) {
  var _a, _b;
  const linkHref = (_a = link.getAttribute("href")) == null ? void 0 : _a.split("#")[0];
  const dest = linkHref && app2.metadataCache.getFirstLinkpathDest(linkHref, source);
  if (dest) {
    const fileClassName = (_b = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _b.last();
    setLinkMetadataFormButton(plugin, link, dest.path.replace(/(.*).md/, "$1"), viewTypeName, fileClassName);
  }
}
function updateDivExtraAttributes(app2, plugin, link, viewTypeName, sourceName, _linkName) {
  var _a;
  const linkName = _linkName || link.textContent;
  const dest = linkName && app2.metadataCache.getFirstLinkpathDest((0, import_obsidian47.getLinkpath)(linkName), sourceName);
  if (dest) {
    const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _a.last();
    setLinkMetadataFormButton(plugin, link, dest.path.replace(/(.*).md/, "$1"), viewTypeName, fileClassName);
  }
}
function updateElLinks(app2, plugin, el, ctx) {
  const links = el.querySelectorAll("a.internal-link");
  const source = ctx.sourcePath.replace(/(.*).md/, "$1");
  links.forEach((link) => {
    updateLinkMetadataMenuFormButton(app2, plugin, link, "a.internal-link", source);
  });
}
function updateVisibleLinks(app2, plugin) {
  const settings = plugin.settings;
  app2.workspace.iterateRootLeaves((leaf) => {
    if (leaf.view instanceof import_obsidian47.MarkdownView && leaf.view.file) {
      const file = leaf.view.file;
      const cachedFile = app2.metadataCache.getFileCache(file);
      const fileName = file.path.replace(/(.*).md/, "$1");
      const tabHeader = leaf.tabHeaderInnerTitleEl;
      if (settings.enableTabHeader) {
        updateDivExtraAttributes(app2, plugin, tabHeader, "tabHeader", fileName);
      } else {
        clearExtraAttributes(tabHeader);
      }
      if ((cachedFile == null ? void 0 : cachedFile.links) && settings.enableLinks) {
        cachedFile.links.forEach((link) => {
          var _a;
          const dest = app2.metadataCache.getFirstLinkpathDest(link.link, fileName);
          if (dest) {
            const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(dest.path)) == null ? void 0 : _a.last();
            const internalLinks = leaf.view.containerEl.querySelectorAll(`a.internal-link[href="${link.link}"]`);
            internalLinks.forEach((internalLink) => setLinkMetadataFormButton(plugin, internalLink, fileName, `a.internal-link`, fileClassName));
          }
        });
      }
    }
  });
}

// src/components/ExtraButton.ts
var import_state2 = require("@codemirror/state");

// src/options/livePreview.ts
var import_obsidian48 = require("obsidian");
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var import_language = require("@codemirror/language");
var import_language2 = require("@codemirror/language");
function buildCMViewPlugin(plugin) {
  class HeaderWidget extends import_view.WidgetType {
    constructor(fileClassName, after, destName) {
      super();
      this.fileClassName = fileClassName;
      this.after = after;
      this.destName = destName;
    }
    toDOM() {
      let metadataMenuBtn = document.createElement("span");
      if (this.fileClassName) {
        metadataMenuBtn.setAttr("fileclass-name", this.fileClassName);
        metadataMenuBtn.addClass("fileclass-icon");
        metadataMenuBtn.addClass("metadata-menu");
        const fileClass = plugin.fieldIndex.fileClassesName.get(this.fileClassName);
        if (fileClass) {
          const icon = fileClass.getIcon();
          (0, import_obsidian48.setIcon)(metadataMenuBtn, icon || settings.buttonIcon);
          metadataMenuBtn.onclick = (event) => {
            const file = plugin.app.vault.getAbstractFileByPath(`${this.destName}.md`);
            if (file instanceof import_obsidian48.TFile && file.extension === "md") {
              const noteFieldsComponent = new NoteFieldsComponent(plugin, "1", () => {
              }, file);
              plugin.addChild(noteFieldsComponent);
            }
            event.stopPropagation();
          };
        }
      }
      return metadataMenuBtn;
    }
    ignoreEvent() {
      return true;
    }
  }
  const settings = plugin.settings;
  const viewPlugin = import_view.ViewPlugin.fromClass(class {
    constructor(view) {
      this.decorations = this.buildDecorations(view);
    }
    update(update) {
      if (update.docChanged || update.viewportChanged) {
        this.decorations = this.buildDecorations(update.view);
      }
    }
    destroy() {
    }
    buildDecorations(view) {
      let builder = new import_state.RangeSetBuilder();
      if (!settings.enableEditor) {
        return builder.finish();
      }
      const mdView = view.state.field(import_obsidian48.editorViewField);
      let lastAttributes = {};
      let iconDecoAfter = null;
      let iconDecoAfterWhere = null;
      let mdAliasFrom = null;
      let mdAliasTo = null;
      for (let { from, to } of view.visibleRanges) {
        (0, import_language.syntaxTree)(view.state).iterate({
          from,
          to,
          enter: (node) => {
            var _a;
            const tokenProps = node.type.prop(import_language2.tokenClassNodeProp);
            if (tokenProps) {
              const props = new Set(tokenProps.split(" "));
              const isLink = props.has("hmd-internal-link");
              const isAlias = props.has("link-alias");
              const isPipe = props.has("link-alias-pipe");
              const isMDLink = props.has("link");
              const isMDUrl = props.has("url");
              const isMDFormatting = props.has("formatting-link");
              if (isMDLink && !isMDFormatting) {
                mdAliasFrom = node.from;
                mdAliasTo = node.to;
              }
              if (!isPipe && !isAlias) {
                if (iconDecoAfter && iconDecoAfterWhere) {
                  builder.add(iconDecoAfterWhere, iconDecoAfterWhere, iconDecoAfter);
                  iconDecoAfter = null;
                  iconDecoAfterWhere = null;
                }
              }
              if (isLink && !isAlias && !isPipe || isMDUrl) {
                let linkText = view.state.doc.sliceString(node.from, node.to);
                linkText = linkText.split("#")[0];
                let file = plugin.app.metadataCache.getFirstLinkpathDest(linkText, mdView.file.basename);
                if (isMDUrl && !file) {
                  try {
                    file = plugin.app.vault.getAbstractFileByPath(decodeURIComponent(linkText));
                  } catch (e) {
                  }
                }
                if (file) {
                  const fileClassName = (_a = plugin.fieldIndex.filesFileClassesNames.get(file.path)) == null ? void 0 : _a.last();
                  if (fileClassName) {
                    const attributes = { "fileclass-name": fileClassName };
                    let deco = import_view.Decoration.mark({
                      attributes,
                      class: "fileclass-text"
                    });
                    iconDecoAfter = import_view.Decoration.widget({
                      widget: new HeaderWidget(fileClassName, true, file.path.replace(/(.*).md/, "$1"))
                    });
                    if (isMDUrl && mdAliasFrom && mdAliasTo) {
                      let deco2 = import_view.Decoration.mark({
                        attributes,
                        class: "fileclass-text"
                      });
                      builder.add(mdAliasFrom, mdAliasTo, deco2);
                      if (iconDecoAfter) {
                        builder.add(mdAliasTo, mdAliasTo, iconDecoAfter);
                        iconDecoAfter = null;
                        iconDecoAfterWhere = null;
                        mdAliasFrom = null;
                        mdAliasTo = null;
                      }
                    }
                    builder.add(node.from, node.to, deco);
                    lastAttributes = attributes;
                    iconDecoAfterWhere = node.to;
                  }
                }
              } else if (isLink && isAlias) {
                let deco = import_view.Decoration.mark({
                  attributes: lastAttributes,
                  class: "fileclass-text"
                });
                builder.add(node.from, node.to, deco);
                if (iconDecoAfter) {
                  builder.add(node.to, node.to, iconDecoAfter);
                  iconDecoAfter = null;
                  iconDecoAfterWhere = null;
                }
              }
            }
          }
        });
      }
      return builder.finish();
    }
  }, {
    decorations: (v) => v.decorations
  });
  return viewPlugin;
}

// src/components/ExtraButton.ts
var ExtraButton = class extends import_obsidian49.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.modalObservers = [];
  }
  onload() {
    this.plugin.registerMarkdownPostProcessor((el, ctx) => {
      updateElLinks(this.plugin.app, this.plugin, el, ctx);
    });
    const ext = import_state2.Prec.lowest(buildCMViewPlugin(this.plugin));
    this.plugin.registerEditorExtension(ext);
    this.plugin.registerMarkdownPostProcessor((el, ctx) => {
      updateElLinks(this.plugin.app, this.plugin, el, ctx);
    });
    const plugin = this.plugin;
    const updateLinks = (_file) => {
      updateVisibleLinks(plugin.app, plugin);
      this.observers.forEach(([observer, type, own_class]) => {
        const leaves = plugin.app.workspace.getLeavesOfType(type);
        leaves.forEach((leaf) => {
          this.updateContainer(leaf.view.containerEl, own_class, type);
        });
      });
    };
    this.observers = [];
    this.plugin.app.workspace.onLayoutReady(() => {
      this.initViewObservers();
      this.initModalObservers(document);
      updateVisibleLinks(this.plugin.app, this.plugin);
    });
    this.registerEvent(this.plugin.app.metadataCache.on("changed", (0, import_obsidian49.debounce)(updateLinks, 500, true)));
    this.registerEvent(this.plugin.app.workspace.on("layout-change", (0, import_obsidian49.debounce)(updateLinks, 10, true)));
    this.registerEvent(this.plugin.app.workspace.on("window-open", (window2, win) => this.initModalObservers(window2.getContainer().doc)));
    this.registerEvent(this.plugin.app.workspace.on("layout-change", () => this.initViewObservers()));
    this.registerEvent(this.plugin.app.workspace.on("metadata-menu:indexed", () => this.reloadObservers()));
  }
  initViewObservers() {
    var _a, _b, _c, _d, _e, _f;
    this.observers.forEach(([observer, type]) => {
      observer.disconnect();
    });
    this.observers = [];
    this.registerViewType("backlink", ".tree-item-inner", true);
    this.registerViewType("outgoing-link", ".tree-item-inner", true);
    this.registerViewType("search", ".tree-item-inner", true);
    this.registerViewType("BC-matrix", ".BC-Link");
    this.registerViewType("BC-ducks", ".internal-link");
    this.registerViewType("BC-tree", "a.internal-link");
    this.registerViewType("graph-analysis", ".internal-link");
    this.registerViewType("starred", ".nav-file-title-content", true);
    this.registerViewType("file-explorer", ".nav-file-title-content", true);
    this.registerViewType("recent-files", ".nav-file-title-content", true);
    if ((_f = (_e = (_d = (_c = (_b = (_a = this.plugin.app) == null ? void 0 : _a.internalPlugins) == null ? void 0 : _b.plugins) == null ? void 0 : _c.backlink) == null ? void 0 : _d.instance) == null ? void 0 : _e.options) == null ? void 0 : _f.backlinkInDocument) {
      this.registerViewType("markdown", ".tree-item-inner", true);
    }
  }
  initModalObservers(doc) {
    var _a;
    const config = {
      subtree: false,
      childList: true,
      attributes: false
    };
    this.modalObservers.push(new MutationObserver((records) => {
      records.forEach((mutation) => {
        if (mutation.type === "childList") {
          mutation.addedNodes.forEach((n) => {
            if ("className" in n && (n.className.includes("modal-container") && this.plugin.settings.enableQuickSwitcher || n.className.includes("suggestion-container") && this.plugin.settings.enableSuggestor)) {
              let selector = ".suggestion-title, .suggestion-note, .another-quick-switcher__item__title, .omnisearch-result__title";
              if (n.className.includes("suggestion-container")) {
                selector = ".suggestion-title, .suggestion-note";
              }
              this.updateContainer(n, selector, null);
              this._watchContainer(null, n, selector);
            }
          });
        }
      });
    }));
    (_a = this.modalObservers.last()) == null ? void 0 : _a.observe(doc.body, config);
  }
  registerViewType(viewTypeName, selector, updateDynamic = false) {
    const leaves = this.plugin.app.workspace.getLeavesOfType(viewTypeName);
    if (leaves.length > 1) {
      for (let i = 0; i < leaves.length; i++) {
        const container = leaves[i].view.containerEl;
        if (updateDynamic) {
          this._watchContainerDynamic(viewTypeName + i, container, selector);
        } else {
          this._watchContainer(viewTypeName + i, container, selector);
        }
      }
    } else if (leaves.length < 1)
      return;
    else {
      const container = leaves[0].view.containerEl;
      this.updateContainer(container, selector, viewTypeName);
      if (updateDynamic) {
        this._watchContainerDynamic(viewTypeName, container, selector);
      } else {
        this._watchContainer(viewTypeName, container, selector);
      }
    }
  }
  updateContainer(container, selector, viewTypeName) {
    const nodes = container.findAll(selector);
    for (let i = 0; i < nodes.length; ++i) {
      const el = nodes[i];
      updateDivExtraAttributes(this.plugin.app, this.plugin, el, viewTypeName, "");
    }
  }
  removeFromContainer(container, selector) {
    const nodes = container.findAll(selector);
    for (let i = 0; i < nodes.length; ++i) {
      const el = nodes[i];
      clearExtraAttributes(el);
    }
  }
  _watchContainer(viewType, container, selector) {
    let observer = new MutationObserver((records, _) => {
      this.updateContainer(container, selector, viewType);
    });
    observer.observe(container, { subtree: true, childList: true, attributes: false });
    if (viewType) {
      this.observers.push([observer, viewType, selector]);
    }
  }
  _watchContainerDynamic(viewType, container, selector, ownClass = "tree-item-inner", parent_class = "tree-item") {
    let observer = new MutationObserver((records, _) => {
      records.forEach((mutation) => {
        if (mutation.type === "childList") {
          mutation.addedNodes.forEach((n) => {
            if ("className" in n) {
              if (n.className.includes && typeof n.className.includes === "function" && n.className.includes(parent_class)) {
                const fileDivs = n.getElementsByClassName(ownClass);
                for (let i = 0; i < fileDivs.length; ++i) {
                  const link = fileDivs[i];
                  updateDivExtraAttributes(this.plugin.app, this.plugin, link, viewType, "");
                }
              }
            }
          });
        }
      });
    });
    observer.observe(container, { subtree: true, childList: true, attributes: false });
    this.observers.push([observer, viewType, selector]);
  }
  reloadObservers() {
    this.disconnectObservers();
    this.initModalObservers(document);
    this.initViewObservers();
    updateVisibleLinks(this.plugin.app, this.plugin);
  }
  disconnectObservers() {
    this.observers.forEach(([observer, type, own_class]) => {
      observer.disconnect();
      const leaves = this.plugin.app.workspace.getLeavesOfType(type);
      leaves.forEach((leaf) => {
        this.removeFromContainer(leaf.view.containerEl, own_class);
      });
    });
    for (const observer of this.modalObservers) {
      observer.disconnect();
    }
  }
  onunload() {
    this.disconnectObservers();
  }
};

// src/components/FieldIndex.ts
var import_obsidian52 = require("obsidian");

// src/fileClass/FileClassQuery.ts
var import_obsidian50 = require("obsidian");
var FileClassQuery = class {
  constructor(name = "", id = "", query = "", fileClassName = "") {
    this.name = name;
    this.id = id;
    this.query = query;
    this.fileClassName = fileClassName;
  }
  getResults(api) {
    try {
      return new Function("dv", `return ${this.query}`)(api);
    } catch (error) {
      new import_obsidian50.Notice(`Wrong query for <${this.name}>. Check your settings`);
      return [];
    }
  }
  matchFile(file) {
    const dataview = app.plugins.plugins.dataview;
    if (this.query && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
      try {
        const filesPath = this.getResults(dataview.api).values.map((v) => v.file.path);
        return filesPath.includes(file.path);
      } catch (error) {
        return false;
      }
    } else {
      return false;
    }
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.query = source.query;
    target.fileClassName = source.fileClassName;
  }
};
var FileClassQuery_default = FileClassQuery;

// src/commands/resolveLookups.ts
function resolveLookups(plugin, source = "") {
  var _a, _b;
  const f = plugin.fieldIndex;
  const lookupQueryResults = /* @__PURE__ */ new Map();
  [...f.lookupQueries].forEach(([lookupName, field]) => {
    const queryRelatedDVFiles = new Function("dv", `return ${field.options.dvQueryString}`)(f.dv.api).values;
    lookupQueryResults.set(lookupName, queryRelatedDVFiles);
  });
  [...f.filesFieldsExists].forEach(([filePath, fields]) => {
    fields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((lookupField) => {
      const queryRelatedDVFiles = lookupQueryResults.get(`${lookupField.fileClassName || "presetField"}___${lookupField.name}`) || [];
      const fileRelatedDVFiles = queryRelatedDVFiles.filter((dvFile) => {
        const targetValue = dvFile[lookupField.options.targetFieldName];
        if (Array.isArray(targetValue)) {
          return targetValue.filter((v) => f.dv.api.value.isLink(v)).map((v) => v.path).includes(filePath);
        } else {
          return (targetValue == null ? void 0 : targetValue.path) === filePath;
        }
      });
      const relatedFieldName = `${filePath}__related__${lookupField.fileClassName || "presetField"}___${lookupField.name}`;
      const existingFileLookupFields = f.fileLookupFiles.get(relatedFieldName);
      f.fileLookupFiles.set(relatedFieldName, fileRelatedDVFiles);
      if (!(f.fileLookupFieldsStatus.get(`${filePath}__${lookupField.name}`) === "changed" /* changed */))
        f.previousFileLookupFilesValues.set(relatedFieldName, (existingFileLookupFields || fileRelatedDVFiles).length);
      f.fileLookupFieldsStatus.set(`${filePath}__${lookupField.name}`, "changed" /* changed */);
    });
  });
  for (let id of f.fileLookupFiles.keys()) {
    const matchRegex = new RegExp("(?<filePath>.*)__related__(?<fileClassName>.*)___(?<fieldName>.*)");
    const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
    const existingLookFieldWithNameAndFileClassName = (_b = f.filesFields.get(filePath)) == null ? void 0 : _b.find((field) => field.name === fieldName && (field.fileClassName === void 0 && fileClassName === "presetField" || field.fileClassName === fileClassName));
    const dvPage = f.dv.api.page(filePath);
    if (dvPage === void 0 || dvPage[fieldName] === void 0 || !existingLookFieldWithNameAndFileClassName) {
      f.fileLookupFiles.delete(id);
      f.fileLookupFieldLastValue.delete(id);
      f.fileLookupFieldLastOutputType.delete(id);
      f.previousFileLookupFilesValues.delete(id);
      f.fileLookupFieldsStatus.delete(`${filePath}__${fieldName}`);
    }
  }
}

// src/commands/updateFormulas.ts
var import_obsidian51 = require("obsidian");
function cleanRemovedFormulasFromIndex(plugin) {
  var _a, _b;
  const f = plugin.fieldIndex;
  for (let id of f.fileFormulaFieldLastValue.keys()) {
    const matchRegex = new RegExp("(?<filePath>.*)__calculated__(?<fileClassName>.*)___(?<fieldName>.*)");
    const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
    const existingFormulaFieldWithNameAndFileClassName = (_b = f.filesFields.get(filePath)) == null ? void 0 : _b.find((field) => field.name === fieldName && (field.fileClassName === void 0 && fileClassName === "presetField" || field.fileClassName === fileClassName));
    const dvPage = f.dv.api.page(filePath);
    if (dvPage === void 0 || dvPage[fieldName] === void 0 || !existingFormulaFieldWithNameAndFileClassName) {
      f.fileFormulaFieldLastValue.delete(id);
    }
  }
}
function updateFormulas(plugin) {
  return __async(this, null, function* () {
    const start2 = Date.now();
    const f = plugin.fieldIndex;
    let renderingErrors = [];
    const fileFormulasFields = /* @__PURE__ */ new Map();
    [...f.filesFieldsExists].forEach(([filePath, fields]) => {
      fields.filter((field) => field.type === "Formula" /* Formula */).forEach((field) => {
        fileFormulasFields.set(`${filePath}__calculated__${field.fileClassName || "presetField"}___${field.name}`, field);
      });
    });
    [...fileFormulasFields].forEach((_0) => __async(this, [_0], function* ([id, field]) {
      var _a;
      const matchRegex = new RegExp("(?<filePath>.*)__calculated__(?<fileClassName>.*)___(?<fieldName>.*)");
      const { filePath, fileClassName, fieldName } = ((_a = id.match(matchRegex)) == null ? void 0 : _a.groups) || {};
      const dvFile = f.dv.api.page(filePath);
      const currentdvValue = dvFile && dvFile[field.name];
      const currentValue = currentdvValue ? currentdvValue.toString() : "";
      f.fileFormulaFieldLastValue.set(id, currentValue);
      try {
        const newValue = new Function("current, dv", `return ${field.options.formula}`)(dvFile, f.dv.api).toString();
        if (!currentValue && newValue !== "" || currentValue !== newValue) {
          yield plugin.fileTaskManager.pushTask(() => replaceValues(plugin, filePath, field.name, newValue));
          f.fileFormulaFieldLastValue.set(id, newValue);
        }
      } catch (e) {
        if (renderingErrors.includes(field.name))
          renderingErrors.push(field.name);
      }
    }));
    if (renderingErrors.length)
      new import_obsidian51.Notice(`Those fields have incorrect output rendering functions:
${renderingErrors.join(",\n")}`);
    cleanRemovedFormulasFromIndex(plugin);
  });
}

// src/components/FieldIndex.ts
var FieldIndex = class extends import_obsidian52.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.fileChanged = false;
    this.dvReady = false;
    this.firstIndexingDone = false;
    this.flushCache();
    this.fileLookupFiles = /* @__PURE__ */ new Map();
    this.fileLookupFieldLastValue = /* @__PURE__ */ new Map();
    this.fileLookupFieldsStatus = /* @__PURE__ */ new Map();
    this.previousFileLookupFilesValues = /* @__PURE__ */ new Map();
    this.fileLookupFieldLastOutputType = /* @__PURE__ */ new Map();
    this.fileFormulaFieldLastValue = /* @__PURE__ */ new Map();
    this.dv = this.plugin.app.plugins.plugins.dataview;
    this.classFilesPath = plugin.settings.classFilesPath;
  }
  onload() {
    return __async(this, null, function* () {
      var _a;
      this.loadTime = Date.now();
      yield (() => __async(this, null, function* () {
      }))();
      if ((_a = this.dv) == null ? void 0 : _a.api.index.initialized) {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.lastRevision = this.dv.api.index.revision;
        this.dvReady = true;
        yield this.fullIndex("dv is running", false);
      }
      this.registerEvent(this.plugin.app.metadataCache.on("dataview:index-ready", () => __async(this, null, function* () {
        this.dv = this.plugin.app.plugins.plugins.dataview;
        this.dvReady = true;
        yield this.fullIndex("dv index", false);
        this.lastRevision = this.dv.api.index.revision;
      })));
      this.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        var _a2;
        if (this.plugin.app.metadataCache.inProgressTaskCount === 0) {
          this.fileChanged = true;
          yield this.fullIndex("cache resolved", false, true);
          this.lastRevision = ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) || 0;
        }
      })));
      this.registerEvent(this.plugin.app.metadataCache.on("dataview:metadata-change", (op, file) => __async(this, null, function* () {
        var _a2;
        if (op === "update" && this.plugin.app.metadataCache.fileCache[file.path].mtime >= this.loadTime && ((_a2 = this.dv) == null ? void 0 : _a2.api.index.revision) !== this.lastRevision && this.fileChanged && this.dvReady) {
          cleanRemovedFormulasFromIndex(this.plugin);
          this.getFilesFieldsExists(file);
          if (this.classFilesPath && file.path.startsWith(this.classFilesPath)) {
            this.fullIndex("fileClass changed");
          } else {
            yield this.updateFormulas();
            this.resolveLookups(false);
            const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, file.path);
            yield this.updateLookups(fileClassName, false);
          }
          this.lastRevision = this.dv.api.index.revision;
        }
      })));
      this.plugin.app.workspace.trigger("metadata-menu:indexed");
    });
  }
  flushCache() {
    this.filesFields = /* @__PURE__ */ new Map();
    this.filesFieldsExists = /* @__PURE__ */ new Map();
    this.fileClassesFields = /* @__PURE__ */ new Map();
    this.fieldsFromGlobalFileClass = [];
    this.filesFieldsFromTags = /* @__PURE__ */ new Map();
    this.filesFieldsFromFileClassQueries = /* @__PURE__ */ new Map();
    this.filesFieldsFromInnerFileClasses = /* @__PURE__ */ new Map();
    this.fileClassesPath = /* @__PURE__ */ new Map();
    this.fileClassesName = /* @__PURE__ */ new Map();
    this.fileClassesAncestors = /* @__PURE__ */ new Map();
    this.valuesListNotePathValues = /* @__PURE__ */ new Map();
    this.tagsMatchingFileClasses = /* @__PURE__ */ new Map();
    this.filesFileClasses = /* @__PURE__ */ new Map();
    this.filesFileClassesNames = /* @__PURE__ */ new Map();
    this.lookupQueries = /* @__PURE__ */ new Map();
  }
  fullIndex(event, force_update_all = false, without_lookups = false) {
    return __async(this, null, function* () {
      let start2 = Date.now(), time = Date.now();
      this.flushCache();
      this.getFileClassesAncestors();
      this.getGlobalFileClass();
      this.getFileClasses();
      this.getLookupQueries();
      this.resolveFileClassMatchingTags();
      this.resolveFileClassQueries();
      this.getFilesFieldsFromFileClass();
      this.getFilesFields();
      this.getFilesFieldsExists();
      yield this.getValuesListNotePathValues();
      this.resolveLookups(without_lookups);
      yield this.updateLookups("full Index", without_lookups);
      if (force_update_all || !this.firstIndexingDone)
        yield this.updateFormulas();
      this.firstIndexingDone = true;
    });
  }
  resolveLookups(without_lookups) {
    if (!without_lookups)
      resolveLookups(this.plugin);
  }
  updateLookups(source = "", without_lookups) {
    return __async(this, null, function* () {
      if (!without_lookups)
        yield updateLookups(this.plugin, source);
    });
  }
  updateFormulas() {
    return __async(this, null, function* () {
      yield updateFormulas(this.plugin);
    });
  }
  getValuesListNotePathValues() {
    return __async(this, null, function* () {
      this.fileClassesName.forEach((fileClass) => {
        fileClass.attributes.forEach((attr) => __async(this, null, function* () {
          if (typeof attr.options === "object" && !!attr.options["valuesListNotePath"]) {
            this.valuesListNotePathValues.set(attr.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, attr.options.valuesListNotePath));
          }
        }));
      });
      this.plugin.settings.presetFields.forEach((setting) => __async(this, null, function* () {
        if (setting.options.valuesListNotePath) {
          this.valuesListNotePathValues.set(setting.options.valuesListNotePath, yield FieldSetting.getValuesListFromNote(this.plugin, setting.options.valuesListNotePath));
        }
      }));
    });
  }
  getFileClassesAncestors() {
    const classFilesPath = this.plugin.settings.classFilesPath;
    if (classFilesPath) {
      this.plugin.app.vault.getMarkdownFiles().filter((f) => f.path.includes(classFilesPath)).forEach((f) => {
        var _a, _b;
        const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, f.path);
        if (fileClassName) {
          const parent = (_b = (_a = this.plugin.app.metadataCache.getFileCache(f)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.extends;
          if (parent) {
            const parentFile = this.plugin.app.vault.getAbstractFileByPath(`${classFilesPath}${parent}.md`);
            if (parentFile) {
              this.fileClassesAncestors.set(fileClassName, [parent]);
            } else {
              this.fileClassesAncestors.set(fileClassName, []);
            }
          } else {
            this.fileClassesAncestors.set(fileClassName, []);
          }
        }
      });
    }
    [...this.fileClassesAncestors].forEach(([fileClassName, ancestors]) => {
      if (ancestors.length > 0) {
        this.getAncestorsRecursively(fileClassName);
      }
    });
  }
  getAncestorsRecursively(fileClassName) {
    var _a;
    const ancestors = this.fileClassesAncestors.get(fileClassName);
    if (ancestors && ancestors.length) {
      const lastAncestor = ancestors.last();
      const lastAncestorParent = (_a = this.fileClassesAncestors.get(lastAncestor)) == null ? void 0 : _a[0];
      if (lastAncestorParent && lastAncestorParent !== fileClassName) {
        this.fileClassesAncestors.set(fileClassName, [...ancestors, lastAncestorParent]);
        this.getAncestorsRecursively(fileClassName);
      }
    }
  }
  getGlobalFileClass() {
    const globalFileClass = this.plugin.settings.globalFileClass;
    if (!globalFileClass) {
      this.fieldsFromGlobalFileClass = [];
    } else {
      try {
        this.fieldsFromGlobalFileClass = FileClass.createFileClass(this.plugin, globalFileClass).attributes.map((attr) => attr.getField());
      } catch (error) {
      }
    }
  }
  getFileClasses() {
    const classFilesPath = this.classFilesPath;
    if (classFilesPath) {
      this.plugin.app.vault.getMarkdownFiles().filter((f) => f.path.includes(classFilesPath)).forEach((f) => {
        var _a, _b, _c;
        const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, f.path);
        if (fileClassName) {
          try {
            const fileClass = FileClass.createFileClass(this.plugin, fileClassName);
            this.fileClassesFields.set(fileClassName, fileClass.attributes.map((attr) => attr.getField()));
            this.fileClassesPath.set(f.path, fileClass);
            this.fileClassesName.set(fileClass.name, fileClass);
            const cache = this.plugin.app.metadataCache.getFileCache(f);
            if ((_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a.mapWithTag) {
              if ((_b = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _b.tagNames) {
                const _tagNames = (_c = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _c.tagNames;
                const tagNames = Array.isArray(_tagNames) ? [..._tagNames] : _tagNames.split(",").map((t) => t.trim());
                tagNames.forEach((tag) => {
                  if (!tag.includes(" ")) {
                    this.tagsMatchingFileClasses.set(tag, fileClass);
                  }
                });
              } else if (!fileClassName.includes(" ")) {
                this.tagsMatchingFileClasses.set(fileClassName, fileClass);
              }
            }
          } catch (error) {
          }
        }
      });
    }
  }
  getLookupQueries() {
    this.plugin.settings.presetFields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((field) => {
      this.lookupQueries.set(`presetField___${field.name}`, field);
    });
    [...this.fileClassesFields].forEach(([fileClassName, fields]) => {
      fields.filter((field) => field.type === "Lookup" /* Lookup */).forEach((field) => {
        this.lookupQueries.set(`${fileClassName}___${field.name}`, field);
      });
    });
  }
  resolveFileClassMatchingTags() {
    if (![...this.tagsMatchingFileClasses].length)
      return;
    const mappedTags = [...this.tagsMatchingFileClasses.keys()];
    const filesWithMappedTagQuery = mappedTags.map((t) => `#${t}`).join(" or ");
    this.dv.api.pages(filesWithMappedTagQuery).forEach((dvFile) => {
      dvFile.file.tags.forEach((_tag) => {
        const tag = _tag.replace(/^\#/, "");
        const fileClass = this.tagsMatchingFileClasses.get(tag);
        const filePath = dvFile.file.path;
        if (fileClass) {
          this.filesFileClasses.set(filePath, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(filePath) || [], fileClass])]);
          this.filesFileClassesNames.set(dvFile.file.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(filePath) || [], fileClass.name])]);
          const fileFileClassesFieldsFromTag = this.fileClassesFields.get(fileClass.name);
          const currentFields = this.filesFieldsFromTags.get(filePath);
          if (fileFileClassesFieldsFromTag) {
            const newFields = [...fileFileClassesFieldsFromTag];
            const filteredCurrentFields = (currentFields == null ? void 0 : currentFields.filter((field) => !newFields.map((f) => f.name).includes(field.name))) || [];
            newFields.push(...filteredCurrentFields);
            this.filesFieldsFromTags.set(filePath, newFields);
          }
        }
      });
    });
  }
  resolveFileClassQueries() {
    var _a;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    this.plugin.settings.fileClassQueries.forEach((sfcq) => {
      const fcq = new FileClassQuery_default(sfcq.name, sfcq.id, sfcq.query, sfcq.fileClassName);
      fcq.getResults(dvApi).forEach((result) => {
        const fileClass = this.fileClassesName.get(fcq.fileClassName);
        if (fileClass) {
          const f = result.file;
          this.filesFileClasses.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(f.path) || [], fileClass])]);
          this.filesFileClassesNames.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(f.path) || [], fileClass.name])]);
        }
        const fileFileClassesFieldsFromQuery = this.fileClassesFields.get(fcq.fileClassName);
        if (fileFileClassesFieldsFromQuery)
          this.filesFieldsFromFileClassQueries.set(result.file.path, fileFileClassesFieldsFromQuery);
      });
    });
  }
  getFilesFieldsFromFileClass() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.classFilesPath || !f.path.includes(this.classFilesPath)).forEach((f) => {
      var _a, _b;
      const fileFileClassesNames = [];
      const fileClassesCache = (_b = (_a = this.plugin.app.metadataCache.getFileCache(f)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b[this.plugin.settings.fileClassAlias];
      if (fileClassesCache) {
        Array.isArray(fileClassesCache) ? fileFileClassesNames.push(...fileClassesCache) : fileFileClassesNames.push(...fileClassesCache.split(",").map((fcn) => fcn.trim()));
        fileFileClassesNames.forEach((fileFileClassName) => {
          const fileClass = this.fileClassesName.get(fileFileClassName);
          if (fileClass) {
            this.filesFileClasses.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClasses.get(f.path) || [], fileClass])]);
            this.filesFileClassesNames.set(f.path, [.../* @__PURE__ */ new Set([...this.filesFileClassesNames.get(f.path) || [], fileClass.name])]);
            const fileClassesFieldsFromFile = this.fileClassesFields.get(fileFileClassName);
            const currentFields = this.filesFieldsFromInnerFileClasses.get(f.path);
            if (fileClassesFieldsFromFile) {
              const newFields = [...fileClassesFieldsFromFile];
              const filteredCurrentFields = (currentFields == null ? void 0 : currentFields.filter((field) => !newFields.map((f2) => f2.name).includes(field.name))) || [];
              newFields.push(...filteredCurrentFields);
              this.filesFieldsFromInnerFileClasses.set(f.path, newFields);
            } else {
              this.filesFieldsFromInnerFileClasses.set(f.path, []);
            }
          } else {
            this.filesFieldsFromInnerFileClasses.set(f.path, []);
          }
        });
      } else {
        this.filesFieldsFromInnerFileClasses.set(f.path, []);
      }
    });
  }
  getFilesFields() {
    this.plugin.app.vault.getMarkdownFiles().filter((f) => !this.classFilesPath || !f.path.includes(this.classFilesPath)).forEach((f) => {
      const fileFieldsFromInnerFileClasses = this.filesFieldsFromInnerFileClasses.get(f.path);
      const fileFieldsFromQuery = this.filesFieldsFromFileClassQueries.get(f.path);
      const fileFieldsFromTag = this.filesFieldsFromTags.get(f.path);
      if ((fileFieldsFromInnerFileClasses == null ? void 0 : fileFieldsFromInnerFileClasses.length) || (fileFieldsFromQuery == null ? void 0 : fileFieldsFromQuery.length) || (fileFieldsFromTag == null ? void 0 : fileFieldsFromTag.length)) {
        const filesFields = fileFieldsFromInnerFileClasses || [];
        filesFields.push(...(fileFieldsFromTag || []).filter((field) => !filesFields.map((f2) => f2.name).includes(field.name)));
        filesFields.push(...(fileFieldsFromQuery || []).filter((field) => !filesFields.map((f2) => f2.name).includes(field.name)));
        this.filesFields.set(f.path, filesFields);
      } else if (this.fieldsFromGlobalFileClass.length) {
        this.filesFields.set(f.path, this.fieldsFromGlobalFileClass);
        this.filesFileClasses.set(f.path, [this.fileClassesName.get(this.plugin.settings.globalFileClass)]);
        this.filesFileClassesNames.set(f.path, [this.plugin.settings.globalFileClass]);
      } else {
        const fields = this.plugin.settings.presetFields.map((prop) => {
          const property = new Field_default();
          return Object.assign(property, prop);
        });
        this.filesFields.set(f.path, fields);
      }
    });
  }
  getFilesFieldsExists(file) {
    let fileFields2;
    if (file) {
      fileFields2 = [[file.path, this.filesFields.get(file.path) || []]];
    } else {
      fileFields2 = [...this.filesFields];
    }
    fileFields2.forEach(([filePath, fields]) => {
      const dvFile = this.dv.api.page(filePath);
      const existingFields = [];
      fields.forEach((field) => {
        if (dvFile && dvFile[field.name] !== void 0) {
          existingFields.push(field);
        }
      });
      if (existingFields.length) {
        this.filesFieldsExists.set(filePath, existingFields);
      } else {
        this.filesFieldsExists.delete(filePath);
      }
    });
  }
};

// src/components/FileTaskManager.ts
var import_obsidian53 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset2 = 0) {
  return (byteToHex[arr[offset2 + 0]] + byteToHex[arr[offset2 + 1]] + byteToHex[arr[offset2 + 2]] + byteToHex[arr[offset2 + 3]] + "-" + byteToHex[arr[offset2 + 4]] + byteToHex[arr[offset2 + 5]] + "-" + byteToHex[arr[offset2 + 6]] + byteToHex[arr[offset2 + 7]] + "-" + byteToHex[arr[offset2 + 8]] + byteToHex[arr[offset2 + 9]] + "-" + byteToHex[arr[offset2 + 10]] + byteToHex[arr[offset2 + 11]] + byteToHex[arr[offset2 + 12]] + byteToHex[arr[offset2 + 13]] + byteToHex[arr[offset2 + 14]] + byteToHex[arr[offset2 + 15]]).toLowerCase();
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options, buf, offset2) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  options = options || {};
  const rnds = options.random || (options.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset2 = offset2 || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset2 + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// src/components/FileTaskManager.ts
var Task = class {
  constructor(fn2) {
    this.fn = fn2;
    this.status = "pending";
    this.id = v4_default();
  }
};
var FileTaskManager = class extends import_obsidian53.Component {
  constructor(plugin, cacheVersion, onChange) {
    super();
    this.plugin = plugin;
    this.cacheVersion = cacheVersion;
    this.onChange = onChange;
    this.busy = false;
    this.queue = /* @__PURE__ */ new Map();
  }
  onload() {
    return __async(this, null, function* () {
      this.plugin.registerEvent(this.plugin.app.metadataCache.on("resolved", () => __async(this, null, function* () {
        this.busy = false;
        yield this.executeNext();
      })));
    });
  }
  pushTask(fn2) {
    return __async(this, null, function* () {
      const task = new Task(fn2);
      this.queue.set(task.id, task);
      if (!this.busy)
        yield this.executeNext();
    });
  }
  executeNext() {
    return __async(this, null, function* () {
      const [firstTaskInQueueId, firstTaskInQueue] = [...this.queue][0] || [void 0, void 0];
      if (firstTaskInQueue && !this.plugin.app.metadataCache.inProgressTaskCount) {
        this.busy = true;
        firstTaskInQueue.status = "ongoing";
        yield firstTaskInQueue.fn();
        firstTaskInQueue.status = "done";
        this.queue.delete(firstTaskInQueueId);
      } else if (this.plugin.app.metadataCache.inProgressTaskCount) {
      } else {
      }
    });
  }
};

// src/commands/fieldModifier.ts
var import_obsidian54 = require("obsidian");
function buildAndOpenModal(plugin, file, fieldName, attrs) {
  var _a, _b;
  if (((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.inFrontmatter) && ((_b = plugin.app.metadataCache.getCache(file.path)) == null ? void 0 : _b.frontmatter)) {
    const lineNumber = plugin.app.metadataCache.getCache(file.path).frontmatter.position.end.line - 1;
    FieldManager2.openFieldModal(plugin, file, fieldName, "", lineNumber, true, false, false, false);
  } else {
    new chooseSectionModal(plugin, file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(plugin, file, fieldName, "", lineNumber, inFrontmatter, after, asList, asComment)).open();
  }
}
function createDvField(plugin, dv, p, fieldContainer, fieldName, attrs) {
  var _a;
  const field = (_a = plugin.fieldIndex.filesFields.get(p.file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
  if (field == null ? void 0 : field.type) {
    const fieldManager = new FieldManager[field.type](plugin, field);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  } else {
    const fieldManager = FieldManager2.createDefault(plugin, fieldName);
    fieldManager.createDvField(dv, p, fieldContainer, attrs);
  }
}
function fieldModifier(plugin, dv, p, fieldName, attrs) {
  var _a, _b;
  const fieldContainer = dv.el("div", "");
  fieldContainer.setAttr("class", "metadata-menu-dv-field-container");
  if (p[fieldName] === void 0) {
    if (!((_a = attrs == null ? void 0 : attrs.options) == null ? void 0 : _a.showAddField)) {
      const emptyField = dv.el("span", null, attrs);
      fieldContainer.appendChild(emptyField);
    } else {
      const addFieldBtn = dv.el("button", attrs);
      (0, import_obsidian54.setIcon)(addFieldBtn, "plus-with-circle");
      addFieldBtn.onclick = () => __async(this, null, function* () {
        var _a2;
        const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
        if (file instanceof import_obsidian54.TFile && file.extension == "md") {
          const field = (_a2 = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a2.find((field2) => field2.name === fieldName);
          if (field) {
            buildAndOpenModal(plugin, file, fieldName, attrs);
          } else {
            new chooseSectionModal(plugin, file, (lineNumber, inFrontmatter, after, asList, asComment) => FieldManager2.openFieldModal(plugin, file, void 0, "", lineNumber, inFrontmatter, after, asList, asComment)).open();
          }
        } else {
          throw Error("path doesn't correspond to a proper file");
        }
      });
      fieldContainer.appendChild(addFieldBtn);
    }
  } else {
    const file = plugin.app.vault.getAbstractFileByPath(p.file.path);
    if (file instanceof import_obsidian54.TFile && file.extension == "md") {
      const field = (_b = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _b.find((field2) => field2.name === fieldName);
      if (field) {
        createDvField(plugin, dv, p, fieldContainer, fieldName, attrs);
      } else {
        const fieldManager = FieldManager2.createDefault(plugin, fieldName);
        fieldManager.createDvField(dv, p, fieldContainer, attrs);
      }
    }
  }
  return fieldContainer;
}

// src/commands/fileFields.ts
var import_obsidian55 = require("obsidian");
var FieldInfo = class {
  constructor() {
    this.type = void 0;
    this.sourceType = void 0;
    this.fileClass = void 0;
    this.options = void 0;
    this.isValid = void 0;
    this.value = "";
    this.valuesListNotePath = void 0;
    this.unique = true;
  }
  setInfos(plugin, file, fieldName, value, matchingFileClassQuery) {
    var _a;
    this.value = value;
    this.ignoreInMenu = plugin.settings.globallyIgnoredFields.includes(fieldName);
    const field = (_a = plugin.fieldIndex.filesFields.get(file.path)) == null ? void 0 : _a.find((field2) => field2.name === fieldName);
    if (field) {
      const fieldManager = new FieldManager[field.type](plugin, field);
      this.isValid = fieldManager.validateValue(value);
      this.fileClass = field.fileClassName;
      this.type = field.type;
      this.options = field.options;
      this.sourceType = field.fileClassName ? "fileClass" : "settings";
    }
  }
};
function fileFields(plugin, fileOrfilePath) {
  var _a;
  let file;
  if (fileOrfilePath instanceof import_obsidian55.TFile) {
    file = fileOrfilePath;
  } else {
    const _file = plugin.app.vault.getAbstractFileByPath(fileOrfilePath);
    if (_file instanceof import_obsidian55.TFile && _file.extension == "md") {
      file = _file;
    } else {
      throw Error("path doesn't correspond to a proper file");
    }
  }
  const fields = {};
  const dvApi = (_a = plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
  if (dvApi) {
    const dvFile = dvApi.page(file.path);
    try {
      genuineKeys(dvFile).forEach((key) => __async(this, null, function* () {
        if (key !== "file") {
          const fieldInfo = new FieldInfo();
          fieldInfo.unique = !Object.keys(fields).includes(key);
          fields[key] = fieldInfo;
          fieldInfo.setInfos(plugin, file, key, dvFile[key]);
        }
      }));
    } catch (error) {
      throw error;
    }
  }
  return fields;
}

// src/MetadataMenuApi.ts
var MetadataMenuApi = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  make() {
    return {
      getValues: this.getValues(),
      replaceValues: this.replaceValues(),
      insertValues: this.insertValues(),
      fieldModifier: this.fieldModifier(),
      fileFields: this.fileFields(),
      insertMissingFields: this.insertMissingFields()
    };
  }
  getValues() {
    return (fileOrFilePath, attribute) => __async(this, null, function* () {
      return getValues(this.plugin, fileOrFilePath, attribute);
    });
  }
  replaceValues() {
    return (fileOrFilePath, attribute, input) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        replaceValues(this.plugin, fileOrFilePath, attribute, input);
      });
    });
  }
  insertValues() {
    return (fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment) => __async(this, null, function* () {
      return yield this.plugin.fileTaskManager.pushTask(() => {
        insertValues(this.plugin, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, after, asList, asComment);
      });
    });
  }
  fieldModifier() {
    return (dv, p, fieldName, attrs) => fieldModifier(this.plugin, dv, p, fieldName, attrs);
  }
  fileFields() {
    return (fileOrFilePath) => __async(this, null, function* () {
      return fileFields(this.plugin, fileOrFilePath);
    });
  }
  insertMissingFields() {
    return (fileOrFilePath, lineNumber, inFrontmatter, after, asList, asComment, fileClassName) => __async(this, null, function* () {
      return insertMissingFields(this.plugin, fileOrFilePath, lineNumber, inFrontmatter, after, asList, asComment, fileClassName);
    });
  }
};

// src/settings/MetadataMenuSettings.ts
var DEFAULT_SETTINGS = {
  presetFields: [],
  fileClassQueries: [],
  displayFieldsInContextMenu: true,
  globallyIgnoredFields: [],
  classFilesPath: null,
  isAutosuggestEnabled: true,
  fileClassAlias: "fileClass",
  settingsVersion: void 0,
  globalFileClass: void 0,
  firstDayOfWeek: 1,
  enableLinks: true,
  enableTabHeader: true,
  enableEditor: true,
  enableBacklinks: true,
  enableStarred: true,
  enableFileExplorer: true,
  enableSearch: true,
  buttonIcon: "clipboard-list"
};

// src/settings/MetadataMenuSettingTab.ts
var import_obsidian59 = require("obsidian");

// src/suggester/FolderSuggester.ts
var import_obsidian56 = require("obsidian");
var FolderSuggest = class extends TextInputSuggest {
  constructor(plugin, inputEl) {
    super(inputEl);
    this.plugin = plugin;
    this.inputEl = inputEl;
  }
  getSuggestions(inputStr) {
    const abstractFiles = this.plugin.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = inputStr.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian56.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/settings/FileClassQuerySettingModal.ts
var import_obsidian58 = require("obsidian");

// src/settings/FileClassQuerySetting.ts
var import_obsidian57 = require("obsidian");
var FileClassQuerySetting = class extends import_obsidian57.Setting {
  constructor(containerEl, property, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.plugin = plugin;
    this.fileClassQuery = property;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
    this.addMoveUpButton();
    this.settingEl.addClass("no-border");
  }
  setTextContentWithname() {
    this.infoEl.textContent = "";
    this.infoEl.addClass("setting-item");
    const fileClassQueryContainer = this.infoEl.createDiv();
    const nameContainer = fileClassQueryContainer.createEl("div", "name");
    nameContainer.innerHTML = `<strong>${this.fileClassQuery.name}</strong>`;
    const fileClassNameContainer = fileClassQueryContainer.createEl("div");
    fileClassNameContainer.innerHTML = `<span>FileClass</span> : ${this.fileClassQuery.fileClassName}`;
    const queryContainer = fileClassQueryContainer.createEl("div");
    queryContainer.innerHTML = `<span>Query</span> : ${this.fileClassQuery.query}`;
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FileClassQuerySettingsModal(this.plugin, this.containerEl, this, this.fileClassQuery);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.find((p) => p.id == this.fileClassQuery.id);
        if (currentExistingFileClassQuery) {
          this.plugin.initialFileClassQueries.remove(currentExistingFileClassQuery);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  addMoveUpButton() {
    this.addButton((b) => {
      b.setIcon("up-chevron-glyph").setTooltip("Move up (lower priority)").onClick(() => {
        const currentFileClassQueryIndex = this.plugin.initialFileClassQueries.map((fcq) => fcq.id).indexOf(this.fileClassQuery.id);
        if (currentFileClassQueryIndex > 0) {
          this.containerEl.insertBefore(this.settingEl, this.settingEl.previousElementSibling);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex, 1);
          this.plugin.initialFileClassQueries.splice(currentFileClassQueryIndex - 1, 0, this.fileClassQuery);
          this.plugin.saveSettings();
        }
      });
    });
  }
};

// src/settings/FileClassQuerySettingModal.ts
var FileClassQuerySettingsModal = class extends import_obsidian58.Modal {
  constructor(plugin, parentSettingContainer, parentSetting, fileClassQuery) {
    super(plugin.app);
    this.plugin = plugin;
    this.parentSettingContainer = parentSettingContainer;
    this.parentSetting = parentSetting;
    this.saved = false;
    this.new = true;
    this.initialFileClassQuery = new FileClassQuery_default();
    if (fileClassQuery) {
      this.new = false;
      this.fileClassQuery = fileClassQuery;
      FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
    } else {
      let newId = 1;
      this.plugin.initialFileClassQueries.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.fileClassQuery = new FileClassQuery_default();
      this.fileClassQuery.id = newId.toString();
      this.initialFileClassQuery.id = newId.toString();
    }
    ;
    this.containerEl.addClass("metadata-menu");
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.fileClassQuery.name == "") {
        this.titleEl.setText(`Select a fileClass and add an applicable query`);
      } else {
        this.titleEl.setText(`Manage ${this.fileClassQuery.name} settings`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.fileClassQuery, this.initialFileClassQuery);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FileClassQuerySetting(this.parentSettingContainer, this.fileClassQuery, this.plugin);
    }
    ;
  }
  createnameInputContainer(container) {
    container.createDiv({ cls: "label", text: `FileClass Query Name:` });
    const input = new import_obsidian58.TextComponent(container);
    input.inputEl.addClass("with-label");
    input.inputEl.addClass("full-width");
    const name = this.fileClassQuery.name;
    input.setValue(name);
    input.setPlaceholder("Name of this fileClass query");
    input.onChange((value) => {
      this.fileClassQuery.name = value;
      this.titleEl.setText(`Manage options for ${this.fileClassQuery.name}`);
    });
    return input;
  }
  createFileClassSelectorContainer(container) {
    container.createDiv({ cls: "label", text: `Fileclass:` });
    container.createDiv({ cls: "spacer" });
    const select = new import_obsidian58.DropdownComponent(container);
    const classFilesPath = this.plugin.settings.classFilesPath;
    const fileClasses = this.plugin.app.vault.getFiles().filter((f) => classFilesPath && f.path.startsWith(classFilesPath)).reverse();
    select.addOption("--Select a fileClass--", "--Select a fileClass--");
    fileClasses.forEach((fileClass) => {
      const fileClassName = FileClass.getFileClassNameFromPath(this.plugin, fileClass.path);
      if (fileClassName)
        select.addOption(fileClassName, fileClassName);
    });
    if (this.fileClassQuery.fileClassName) {
      select.setValue(this.fileClassQuery.fileClassName);
    }
    select.onChange((value) => {
      if (value != "--Select a fileClass--") {
        this.fileClassQuery.fileClassName = value;
      } else {
        this.fileClassQuery.fileClassName = "";
      }
    });
  }
  createQueryInputContainer(container) {
    container.createDiv({ text: "dataviewJS query:" });
    const queryStringInputContainer = container.createDiv({ cls: "field-container" });
    const queryStringInput = new import_obsidian58.TextAreaComponent(queryStringInputContainer);
    queryStringInput.inputEl.addClass("full-width");
    queryStringInput.inputEl.rows = 4;
    queryStringInput.setValue(this.fileClassQuery.query);
    queryStringInput.onChange((value) => this.fileClassQuery.query = value);
  }
  createForm() {
    return __async(this, null, function* () {
      const nameContainer = this.contentEl.createDiv({ cls: "field-container" });
      this.createnameInputContainer(nameContainer);
      const fileClassSelectContainer = this.contentEl.createDiv({ cls: "field-container" });
      this.createFileClassSelectorContainer(fileClassSelectContainer);
      const fileClassQueryContainer = this.contentEl.createDiv({ cls: "vstacked" });
      this.createQueryInputContainer(fileClassQueryContainer);
      const footer = this.contentEl.createDiv({ cls: "footer-actions" });
      footer.createDiv({ cls: "spacer" });
      this.createSaveButton(footer);
      this.createCancelButton(footer);
    });
  }
  createSaveButton(container) {
    const b = new import_obsidian58.ButtonComponent(container);
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      if (this.fileClassQuery.fileClassName && this.fileClassQuery.name && this.fileClassQuery.query) {
        this.saved = true;
        const currentExistingFileClassQuery = this.plugin.initialFileClassQueries.filter((p) => p.id == this.fileClassQuery.id)[0];
        if (currentExistingFileClassQuery) {
          FileClassQuery_default.copyProperty(currentExistingFileClassQuery, this.fileClassQuery);
        } else {
          this.plugin.initialFileClassQueries.push(this.fileClassQuery);
        }
        ;
        FileClassQuery_default.copyProperty(this.initialFileClassQuery, this.fileClassQuery);
        if (this.parentSetting)
          FileClassQuery_default.copyProperty(this.parentSetting.fileClassQuery, this.fileClassQuery);
        (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
        this.plugin.saveSettings();
        this.close();
      }
    }));
  }
  createCancelButton(container) {
    const b = new import_obsidian58.ButtonComponent(container);
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialFileClassQuery.name != "") {
        Object.assign(this.fileClassQuery, this.initialFileClassQuery);
      }
      ;
      this.close();
    });
  }
};

// src/settings/MetadataMenuSettingTab.ts
var MetadataMenuSettingTab = class extends import_obsidian59.PluginSettingTab {
  constructor(plugin) {
    super(app, plugin);
    this.plugin = plugin;
    this.containerEl.addClass("metadata-menu");
    this.containerEl.addClass("settings");
  }
  createSettingGroup(title, subTitle, withButton = false) {
    const settingHeader = this.containerEl.createEl("div");
    const settingHeaderContainer = settingHeader.createEl("div", { cls: "header-container" });
    const settingHeaderTextContainer = settingHeaderContainer.createEl("div", { cls: "text-container" });
    settingHeaderTextContainer.createEl("h4", { text: title, cls: "section-header" });
    if (subTitle)
      settingHeaderTextContainer.createEl("div", { text: subTitle, cls: "setting-item-description" });
    const settingsContainer = this.containerEl.createEl("div");
    if (withButton) {
      const settingsContainerShowButtonContainer = settingHeaderContainer.createEl("div", { cls: "setting-item-control" });
      const settingsContainerShowButton = new import_obsidian59.ButtonComponent(settingsContainerShowButtonContainer);
      settingsContainerShowButton.buttonEl.addClass("setting-item-control");
      settingsContainer.hide();
      settingsContainerShowButton.setCta();
      settingsContainerShowButton.setIcon("chevrons-up-down");
      const toggleState = () => {
        if (settingsContainer.isShown()) {
          settingsContainer.hide();
          settingsContainerShowButton.setIcon("chevrons-up-down");
          settingsContainerShowButton.setCta();
        } else {
          settingsContainer.show();
          settingsContainerShowButton.setIcon("chevrons-down-up");
          settingsContainerShowButton.removeCta();
        }
      };
      settingsContainerShowButton.onClick(() => toggleState());
    }
    return settingsContainer;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    const globalSettings = this.createSettingGroup("Global settings", "Global settings to apply to your whole vault", true);
    new import_obsidian59.Setting(globalSettings).setName("Display field options in context menu").setDesc("Choose to show or hide fields options in the context menu of a link or a file").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.displayFieldsInContextMenu);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.displayFieldsInContextMenu = value;
        yield this.plugin.saveSettings();
      }));
    }).settingEl.addClass("no-border");
    const globallyIgnoredFieldsSetting = new import_obsidian59.Setting(globalSettings).setName("Globally ignored fields").setDesc("Fields to be ignored by the plugin when adding options to the context menu").addTextArea((text) => {
      text.setPlaceholder("Enter fields as string, comma separated").setValue(this.plugin.settings.globallyIgnoredFields.join(", ")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.globallyIgnoredFields = value.split(",").map((item) => item.trim());
        yield this.plugin.saveSettings();
      }));
      text.inputEl.rows = 6;
      text.inputEl.cols = 25;
    });
    globallyIgnoredFieldsSetting.settingEl.addClass("vstacked");
    globallyIgnoredFieldsSetting.settingEl.addClass("no-border");
    globallyIgnoredFieldsSetting.controlEl.addClass("full-width");
    new import_obsidian59.Setting(globalSettings).setName("First day of week").setDesc("For date fields, which day the date picker's week should start with").addDropdown((cb) => {
      for (let i = 0; i < 2; i++) {
        cb.addOption(i.toString(), (0, import_obsidian59.moment)().day(i).format("dddd"));
      }
      cb.setValue(this.plugin.settings.firstDayOfWeek.toString() || "1");
      cb.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.firstDayOfWeek = parseInt(value);
        yield this.plugin.saveSettings();
      }));
    }).settingEl.addClass("no-border");
    containerEl.createDiv({ cls: "setting-divider" });
    const presetFieldsSettings = this.createSettingGroup("Preset Fields settings", "Manage globally predefined type and options for a field throughout your whole vault", true);
    new import_obsidian59.Setting(presetFieldsSettings).setName("Add New Field Setting").setDesc("Add a new Frontmatter property for which you want preset options.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("Add new").setCta().onClick(() => __async(this, null, function* () {
        let modal = new FieldSettingsModal(this.plugin, presetFieldsSettings);
        modal.open();
      }));
    }).settingEl.addClass("no-border");
    this.plugin.initialProperties.forEach((prop) => {
      const property = new Field_default();
      Object.assign(property, prop);
      new FieldSetting(presetFieldsSettings, property, this.plugin);
    });
    containerEl.createDiv({ cls: "setting-divider" });
    const classFilesSettings = this.createSettingGroup("FileClass settings", "Manage fileClass folder and alias. When a note has a fileClass defined, fileClass field properties will override global preset fields settings for the same field name", true);
    const path = new import_obsidian59.Setting(classFilesSettings).setName("class Files path").setDesc("Path to the files containing the authorized fields for a type of note").addSearch((cfs) => {
      new FolderSuggest(this.plugin, cfs.inputEl);
      cfs.setPlaceholder("Folder").setValue(this.plugin.settings.classFilesPath || "").onChange((new_folder) => {
        const newPath = new_folder.endsWith("/") || !new_folder ? new_folder : new_folder + "/";
        this.plugin.settings.classFilesPath = newPath || null;
        this.plugin.saveSettings();
      });
    });
    path.settingEl.addClass("no-border");
    path.settingEl.addClass("narrow-title");
    path.controlEl.addClass("full-width");
    const alias = new import_obsidian59.Setting(classFilesSettings).setName("fileClass field alias").setDesc("Choose another name for fileClass field in frontmatter (example: Category, type, ...").addText((text) => {
      text.setValue(this.plugin.settings.fileClassAlias).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.fileClassAlias = value || "fileClass";
        yield this.plugin.saveSettings();
      }));
    });
    alias.settingEl.addClass("no-border");
    alias.settingEl.addClass("narrow-title");
    alias.controlEl.addClass("full-width");
    const global = new import_obsidian59.Setting(classFilesSettings).setName("global fileClass").setDesc("Choose one fileClass to be applicable to all files (even it is not present as a fileClass attribute in their frontmatter). This will override the preset Fields defined above").addSearch((cfs) => {
      new FileSuggest(cfs.inputEl, this.plugin, this.plugin.settings.classFilesPath || "");
      cfs.setPlaceholder("Global fileClass");
      cfs.setValue(this.plugin.settings.globalFileClass ? this.plugin.settings.classFilesPath + this.plugin.settings.globalFileClass + ".md" : "").onChange((newPath) => {
        var _a;
        this.plugin.settings.globalFileClass = newPath ? (_a = newPath.split("\\").pop().split("/").pop()) == null ? void 0 : _a.replace(".md", "") : "";
        this.plugin.saveSettings();
      });
    });
    global.settingEl.addClass("no-border");
    global.settingEl.addClass("narrow-title");
    global.controlEl.addClass("full-width");
    containerEl.createDiv({ cls: "setting-divider" });
    const metadataMenuBtnSettings = this.createSettingGroup("Metadata Menu button", "Show extra button to access metadata menu modal of fields", true);
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("Metadata Menu button icon").setDesc("name of the default icon when not defined in fileClass").addText((text) => {
      text.setValue(this.plugin.settings.buttonIcon).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.buttonIcon = value || "clipboard-list";
        yield this.plugin.saveSettings();
      }));
    }).settingEl.addClass("no-border");
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("Reading mode links").setDesc("Display an extra button to access metadata menu form after a link in reading mode").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableLinks);
      cb.onChange((value) => {
        this.plugin.settings.enableLinks = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("Live preview mode").setDesc("Display an extra button to access metadata menu form after a link in live preview").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableEditor);
      cb.onChange((value) => {
        this.plugin.settings.enableEditor = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("Tab header").setDesc("Display an extra button to access metadata menu form in the tab header").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableTabHeader);
      cb.onChange((value) => {
        this.plugin.settings.enableTabHeader = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("Backlinks").setDesc("Display an extra button to access metadata menu form in the backlinks panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableBacklinks);
      cb.onChange((value) => {
        this.plugin.settings.enableBacklinks = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("Search").setDesc("Display an extra button to access metadata menu form in the search panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableSearch);
      cb.onChange((value) => {
        this.plugin.settings.enableSearch = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("File explorer").setDesc("Display an extra button to access metadata menu form in the file explorer").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableFileExplorer);
      cb.onChange((value) => {
        this.plugin.settings.enableFileExplorer = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    new import_obsidian59.Setting(metadataMenuBtnSettings).setName("Starred").setDesc("Display an extra button to access metadata menu form in the starred panel").addToggle((cb) => {
      cb.setValue(this.plugin.settings.enableStarred);
      cb.onChange((value) => {
        this.plugin.settings.enableStarred = value;
        this.plugin.saveSettings();
      });
    }).settingEl.addClass("no-border");
    containerEl.createDiv({ cls: "setting-divider" });
    const queryFileClassSettings = this.createSettingGroup("Query based FileClass settings", "Manage globally predefined type and options for a field matching this query", true);
    new import_obsidian59.Setting(queryFileClassSettings).setName("Add New Query for fileClass").setDesc("Add a new query and a FileClass that will apply to files matching this query.").addButton((button) => {
      return button.setTooltip("Add New fileClass query").setButtonText("Add new").setCta().onClick(() => __async(this, null, function* () {
        let modal = new FileClassQuerySettingsModal(this.plugin, queryFileClassSettings);
        modal.open();
      }));
    }).settingEl.addClass("no-border");
    this.plugin.initialFileClassQueries.forEach((query) => {
      const fileClassQuery = new FileClassQuery_default();
      Object.assign(fileClassQuery, query);
      new FileClassQuerySetting(queryFileClassSettings, fileClassQuery, this.plugin);
    });
  }
};

// src/settings/migrateSetting.ts
var migrateSettingsV1toV2 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (!Object.keys(p).contains("type")) {
      if (p.isMulti)
        p.type = "Multi" /* Multi */;
      else if (p.isCycle)
        p.type = "Cycle" /* Cycle */;
      else if (p.isBoolean)
        p.type = "Boolean" /* Boolean */;
      else if (p.options && Object.keys(p.options).length > 0)
        p.type = "Select" /* Select */;
      else
        p.type = "Input" /* Input */;
    }
    delete p.isMulti;
    delete p.isCycle;
    delete p.isBoolean;
    if (Object.getOwnPropertyDescriptor(p, "values") !== void 0) {
      Object.defineProperty(p, "options", Object.getOwnPropertyDescriptor(p, "values"));
      delete p["values"];
    }
  });
  plugin.settings.settingsVersion = 2;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 2");
});
var migrateSettingsV2toV3 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (["Select" /* Select */, "Multi" /* Multi */].includes(p.type)) {
      const currentOptionKeys = Object.keys(p.options);
      p.options.valuesList = {};
      currentOptionKeys.forEach((key) => p.options.valuesList[key] = p.options[key]);
      if (p.valuesListNotePath) {
        const selectType = "ValuesListNotePath" /* ValuesListNotePath */;
        p.options.sourceType = selectType;
        p.options[Key[selectType]];
      } else {
        p.options.sourceType = "ValuesList" /* ValuesList */;
      }
      p.options.valuesListNotePath = p.valuesListNotePath;
      currentOptionKeys.forEach((key) => delete p.options[key]);
      p.options.valuesFromDVQuery = "";
    }
    delete p.valuesListNotePath;
  });
  plugin.settings.settingsVersion = 3;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated to version 3");
});

// src/suggester/metadataSuggester.ts
var import_obsidian60 = require("obsidian");
var ValueSuggest = class extends import_obsidian60.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.inFrontmatter = false;
    this.inFullLine = false;
    this.inSentence = false;
    this.didSelect = false;
    this.filterOption = (firstValues, lastValue, option) => {
      return !firstValues || !(firstValues == null ? void 0 : firstValues.contains(encodeLink(option))) && (!lastValue || !!lastValue && encodeLink(option).includes(lastValue));
    };
    this.plugin = plugin;
    this.setInstructions([{ command: "Shift", purpose: "put a space after::" }]);
    this.scope.register(["Shift"], "Enter", (evt) => {
      this.suggestions.useSelectedItem(evt);
      return false;
    });
  }
  onTrigger(cursor, editor, file) {
    var _a;
    if (this.didSelect) {
      this.didSelect = false;
      return null;
    }
    if (!this.plugin.settings.isAutosuggestEnabled) {
      return null;
    }
    ;
    const frontmatter = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const fullLine = editor.getLine(editor.getCursor().line);
    this.inFrontmatter = !!frontmatter && frontmatter.position.start.line < cursor.line && cursor.line < frontmatter.position.end.line;
    if (this.inFrontmatter) {
      const regex = new RegExp(`^${genericFieldRegex}:(?<values>.*)`, "u");
      if (!regex.test(fullLine))
        return null;
    } else if (getLineFields(fullLine).length === 0) {
      return null;
    }
    return {
      start: cursor,
      end: cursor,
      query: editor.getLine(cursor.line)
    };
  }
  getAlias(tFile) {
    var _a, _b;
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    let alias = void 0;
    if (dvApi && ((_b = this.field) == null ? void 0 : _b.options.customRendering)) {
      alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(tFile.path));
    }
    return alias;
  }
  getSuggestions(context) {
    return __async(this, null, function* () {
      const suggestions = yield this.getValueSuggestions(context);
      if (suggestions.length) {
        return suggestions;
      }
      return [];
    });
  }
  getValueSuggestions(context) {
    return __async(this, null, function* () {
      var _a, _b, _c, _d, _e;
      const lineNumber = context.start.line;
      const matchField = { attribute: void 0, values: "" };
      const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
      if (!this.inFrontmatter) {
        const lineFields = getLineFields(encodeLink(context.editor.getLine(lineNumber)));
        const position = context.editor.getCursor().ch;
        const activeLineField = lineFields.find((lineField) => lineField.index <= position && lineField.index + lineField.length >= position);
        if (activeLineField) {
          this.inSentence = activeLineField.index > 0;
          this.inFullLine = activeLineField.index === 0;
          matchField.attribute = activeLineField.attribute;
          matchField.values = activeLineField.values;
        }
      } else {
        const regex = new RegExp(`^${genericFieldRegex}:(?<values>.+)?`, "u");
        const regexResult = context.editor.getRange({ line: lineNumber, ch: 0 }, context.end).match(regex);
        if (regexResult == null ? void 0 : regexResult.groups) {
          matchField.attribute = regexResult.groups.attribute;
          matchField.values = regexResult.groups.values;
        }
      }
      ;
      if (matchField.attribute) {
        const fieldName = matchField.attribute;
        this.field = (_b = this.plugin.fieldIndex.filesFields.get(context.file.path)) == null ? void 0 : _b.find((f) => f.name === fieldName);
        const valuesList = (_c = matchField.values) == null ? void 0 : _c.replace(/^\[|^\s\[|^\(|^\s\(/, "").replace(/\]$|\)$/, "").split(",").map((o) => encodeLink(o.trim()));
        const lastValue = valuesList == null ? void 0 : valuesList.last();
        const firstValues = valuesList == null ? void 0 : valuesList.slice(0, -1);
        if (fieldName === "tags" && this.inFrontmatter) {
          return Object.keys(this.plugin.app.metadataCache.getTags()).filter((t) => lastValue ? t.contains(lastValue) : t).sort().map((tag) => Object({ value: tag.replace(/^#/, "") }));
        }
        if (this.field && ["Cycle" /* Cycle */, "Multi" /* Multi */, "Select" /* Select */].contains(this.field.type)) {
          const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
          return fieldManager.getOptionsList(dvApi.page((_d = this.context) == null ? void 0 : _d.file.path)).filter((option) => this.filterOption(firstValues, lastValue, option)).map((_value) => Object({ value: _value }));
        } else if (this.field && ["File" /* File */, "MultiFile" /* MultiFile */].includes(this.field.type)) {
          const sortingMethod = new Function("a", "b", `return ${this.field.options.customSorting}`) || function(a, b) {
            return a.basename < b.basename ? -1 : 1;
          };
          const fieldManager = new FieldManager[this.field.type](this.plugin, this.field);
          const files = fieldManager.getFiles((_e = this.context) == null ? void 0 : _e.file).sort(sortingMethod);
          if (lastValue) {
            return files.filter((f) => {
              var _a2;
              return f.basename.toLowerCase().includes(lastValue) || ((_a2 = this.getAlias(f)) == null ? void 0 : _a2.toLowerCase().includes(lastValue));
            }).map((f) => {
              return Object({ value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, this.getAlias(f)) });
            });
          } else {
            return files.map((f) => {
              var _a2;
              let alias = void 0;
              if (dvApi && ((_a2 = this.field) == null ? void 0 : _a2.options.customRendering)) {
                alias = new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(f.path));
              }
              return Object({ value: FileField.buildMarkDownLink(this.plugin, context.file, f.basename, alias) });
            });
          }
        } else {
          return [];
        }
      }
      ;
      return [];
    });
  }
  renderSuggestion(suggestion, el) {
    var _a;
    el.addClass("metadata-menu");
    el.addClass("suggester");
    const [rawValue, alias] = suggestion.value.replace(/^\[\[/, "").replace(/\]\]$/, "").split("|");
    const targetFile = this.plugin.app.metadataCache.getFirstLinkpathDest(rawValue, this.context.file.path);
    const dvApi = (_a = this.plugin.app.plugins.plugins.dataview) == null ? void 0 : _a.api;
    if (dvApi && this.field && this.field.options.customRendering && targetFile) {
      if (alias) {
        const suggestionContainer = el.createDiv({ cls: "item-with-alias" });
        suggestionContainer.createDiv({ text: alias });
        const filePath = suggestionContainer.createDiv({ cls: "item-with-alias-filepath" });
        filePath.setText(rawValue);
      } else {
        el.setText(new Function("page", `return ${this.field.options.customRendering}`)(dvApi.page(targetFile.path)));
      }
    } else {
      el.setText(rawValue);
    }
  }
  selectSuggestion(suggestion, event) {
    var _a;
    const activeView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian60.MarkdownView);
    if (!activeView) {
      return;
    }
    ;
    const editor = activeView.editor;
    const activeLine = editor.getLine(this.context.start.line);
    if (this.inFrontmatter) {
      try {
        let parsedField = (0, import_obsidian60.parseYaml)(activeLine);
        let [attr, pastValues] = Object.entries(parsedField)[0];
        let newField;
        if (!pastValues) {
          newField = attr + ": " + suggestion.value;
        } else if (typeof pastValues == "string") {
          if (!pastValues.contains(",")) {
            newField = attr + ": " + suggestion.value;
          } else {
            newField = attr + ": [" + pastValues.split(",").map((o) => o.trim()).slice(0, -1).join(", ") + ", " + suggestion.value + "]";
          }
        } else if (Array.isArray(pastValues)) {
          if (activeLine.endsWith(",]") || activeLine.endsWith(", ]")) {
            newField = attr + ": [" + [...pastValues, suggestion.value].join(", ") + "]";
          } else {
            newField = attr + ": [" + [...pastValues.slice(0, -1), suggestion.value].join(", ") + "]";
          }
        } else {
          newField = attr + ": [" + [...pastValues].join(", ") + "]";
        }
        editor.replaceRange(newField, { line: this.context.start.line, ch: 0 }, { line: this.context.start.line, ch: activeLine.length });
        if (Array.isArray(pastValues) || typeof pastValues === "string" && pastValues.contains(",")) {
          editor.setCursor({ line: this.context.start.line, ch: newField.length - 1 });
        } else {
          editor.setCursor({ line: this.context.start.line, ch: newField.length });
        }
      } catch (error) {
        new import_obsidian60.Notice("Frontmatter wrongly formatted", 2e3);
        this.close();
        return;
      }
    } else if (this.inFullLine) {
      let cleanedLine = activeLine;
      while (![",", ":"].contains(cleanedLine.charAt(cleanedLine.length - 1))) {
        cleanedLine = cleanedLine.slice(0, -1);
      }
      editor.replaceRange(`${cleanedLine}${event.shiftKey ? " " : ""}` + suggestion.value, { line: this.context.start.line, ch: 0 }, this.context.end);
    } else if (this.inSentence) {
      const position = ((_a = this.context) == null ? void 0 : _a.editor.getCursor().ch) || 0;
      let beforeCursor = activeLine.slice(0, position);
      let afterCursor = activeLine.slice(position);
      let separatorPos = position;
      let currentValueLength = 0;
      while (!beforeCursor.endsWith("::") && !beforeCursor.endsWith(",") && beforeCursor.length) {
        separatorPos = separatorPos - 1;
        currentValueLength = currentValueLength + 1;
        beforeCursor = beforeCursor.slice(0, -1);
      }
      let nextBracketPos = position;
      while (!encodeLink(afterCursor).match("(\\]|\\)).*") && afterCursor.length) {
        nextBracketPos = nextBracketPos + 1;
        afterCursor = afterCursor.slice(nextBracketPos - position);
      }
      editor.replaceRange(suggestion.value, { line: this.context.start.line, ch: separatorPos }, { line: this.context.start.line, ch: nextBracketPos });
      editor.setCursor({ line: this.context.start.line, ch: nextBracketPos - currentValueLength + suggestion.value.length });
    }
    this.didSelect = true;
    this.close();
  }
};

// main.ts
var MetadataMenu = class extends import_obsidian61.Plugin {
  constructor() {
    super(...arguments);
    this.initialProperties = [];
    this.initialFileClassQueries = [];
  }
  onload() {
    return __async(this, null, function* () {
      console.log("Metadata Menu loaded");
      yield this.loadSettings();
      if (this.settings.settingsVersion === void 0)
        yield migrateSettingsV1toV2(this);
      if (this.settings.settingsVersion === 2)
        yield migrateSettingsV2toV3(this);
      this.fieldIndex = this.addChild(new FieldIndex(this, "1", () => {
      }));
      this.fileTaskManager = this.addChild(new FileTaskManager(this, "1", () => {
      }));
      this.extraButton = this.addChild(new ExtraButton(this, "1", () => {
      }));
      this.contextMenu = this.addChild(new ContextMenu(this));
      this.settings.presetFields.forEach((prop) => {
        const property = new Field_default();
        Object.assign(property, prop);
        this.initialProperties.push(property);
      });
      this.settings.fileClassQueries.forEach((query) => {
        const fileClassQuery = new FileClassQuery_default();
        Object.assign(fileClassQuery, query);
        this.initialFileClassQueries.push(fileClassQuery);
      });
      this.addSettingTab(new MetadataMenuSettingTab(this));
      this.registerEditorSuggest(new ValueSuggest(this));
      this.api = new MetadataMenuApi(this).make();
      this.registerEvent(this.app.workspace.on("active-leaf-change", (leaf) => {
        const view = leaf == null ? void 0 : leaf.view;
        addCommands(this, view);
      }));
      this.registerEvent(this.app.workspace.on("metadata-menu:indexed", () => {
        addCommands(this, void 0);
      }));
      addCommands(this, this.app.workspace.getActiveViewOfType(import_obsidian61.MarkdownView));
    });
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      this.settings.presetFields = this.initialProperties;
      this.settings.fileClassQueries = this.initialFileClassQueries;
      yield this.saveData(this.settings);
      yield this.fieldIndex.fullIndex("setting", true, false);
      this.extraButton.reloadObservers();
    });
  }
  onunload() {
    console.log("Metadata Menu unloaded");
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvY29tbWFuZHMvcGFsZXR0ZUNvbW1hbmRzLnRzIiwgInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHMudHMiLCAic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvSW5wdXRGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9JbnB1dE1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL2luc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcy50cyIsICJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlcy50cyIsICJzcmMvdHlwZXMvbG9va3VwVHlwZXMudHMiLCAic3JjL3V0aWxzL2xpc3QudHMiLCAic3JjL3V0aWxzL3BhcnNlci50cyIsICJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlci50cyIsICJzcmMvbW9kYWxzL2luc2VydEZpZWxkU3VnZ2VzdE1vZGFsLnRzIiwgInNyYy9tb2RhbHMvYWRkTmV3RmllbGRNb2RhbC50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsLnRzIiwgInNyYy9maWVsZHMvRmllbGQudHMiLCAic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZy50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9Cb29sZWFuTW9kYWwudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Jvb2xlYW5GaWVsZC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTnVtYmVyRmllbGQudHMiLCAic3JjL21vZGFscy9maWVsZHMvTnVtYmVyTW9kYWwudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL1NlbGVjdEZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL1NlbGVjdE1vZGFsLnRzIiwgInNyYy90eXBlcy9zZWxlY3RWYWx1ZXNTb3VyY2VUeXBlcy50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQWJzdHJhY3RMaXN0QmFzZWRGaWVsZC50cyIsICJzcmMvc3VnZ2VzdGVyL0ZpbGVTdWdnZXN0ZXIudHMiLCAic3JjL3N1Z2dlc3Rlci9zdWdnZXN0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZW51bXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Tm9kZU5hbWUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2luc3RhbmNlT2YuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvYXBwbHlTdHlsZXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvbWF0aC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9jb250YWlucy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzVGFibGVFbGVtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRQYXJlbnROb2RlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3dpdGhpbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEZyZXNoU2lkZU9iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21lcmdlUGFkZGluZ09iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9hcnJvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldFZhcmlhdGlvbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2V2ZW50TGlzdGVuZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0T3Bwb3NpdGVQbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRXaW5kb3dTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93U2Nyb2xsQmFyWC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRWaWV3cG9ydFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzU2Nyb2xsUGFyZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFNjcm9sbFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3JlY3RUb0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvY29tcHV0ZU9mZnNldHMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9kZXRlY3RPdmVyZmxvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2NvbXB1dGVBdXRvUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2ZsaXAuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvaGlkZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9vZmZzZXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcG9wcGVyT2Zmc2V0cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEFsdEF4aXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcHJldmVudE92ZXJmbG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q29tcG9zaXRlUmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZGVib3VuY2UuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9mb3JtYXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy92YWxpZGF0ZU1vZGlmaWVycy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3VuaXF1ZUJ5LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvbWVyZ2VCeU5hbWUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9jcmVhdGVQb3BwZXIuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9wb3BwZXIuanMiLCAic3JjL3V0aWxzL2ZpbGVVdGlscy50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvQ3ljbGVGaWVsZC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTXVsdGlGaWVsZC50cyIsICJzcmMvbW9kYWxzL2ZpZWxkcy9NdWx0aVNlbGVjdE1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9GaWxlRmllbGQudHMiLCAic3JjL21vZGFscy9maWVsZHMvU2luZ2xlRmlsZU1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9EYXRlRmllbGQudHMiLCAic3JjL21vZGFscy9maWVsZHMvRGF0ZU1vZGFsLnRzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vdHlwZXMvb3B0aW9ucy5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL2wxMG4vZGVmYXVsdC5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL2luZGV4LmpzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vdXRpbHMvZG9tLmpzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vdXRpbHMvZm9ybWF0dGluZy5qcyIsICJub2RlX21vZHVsZXMvZmxhdHBpY2tyL2Rpc3QvZXNtL3V0aWxzL2RhdGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vdXRpbHMvcG9seWZpbGxzLmpzIiwgIm5vZGVfbW9kdWxlcy9mbGF0cGlja3IvZGlzdC9lc20vaW5kZXguanMiLCAic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHMudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL011bHRpRmlsZUZpZWxkLnRzIiwgInNyYy9tb2RhbHMvZmllbGRzL011bHRpRmlsZU1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9Mb29rdXBGaWVsZC50cyIsICJzcmMvY29tbWFuZHMvdXBkYXRlTG9va3Vwcy50cyIsICJzcmMvY29tbWFuZHMvZ2V0VmFsdWVzLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9Gb3JtdWxhRmllbGQudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL01hbmFnZXJzLnRzIiwgInNyYy90eXBlcy9maWVsZFR5cGVzLnRzIiwgInNyYy9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9pbnNlcnRNaXNzaW5nRmllbGRzLnRzIiwgInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzQXR0cmlidXRlLnRzIiwgInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzLnRzIiwgInNyYy91dGlscy90ZXh0VXRpbHMudHMiLCAic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsLnRzIiwgInNyYy9vcHRpb25zL0ZpbGVDbGFzc09wdGlvbnNMaXN0LnRzIiwgInNyYy9jb21wb25lbnRzL2ZpbGVDbGFzc1RhYmxlLnRzIiwgInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzQ2hvaWNlTW9kYWwudHMiLCAic3JjL29wdGlvbnMvT3B0aW9uc0xpc3QudHMiLCAic3JjL21vZGFscy9hZGROZXdGaWxlQ2xhc3NNb2RhbC50cyIsICJzcmMvY29tbWFuZHMvY3JlYXRlRmlsZUNsYXNzLnRzIiwgInNyYy9jb21wb25lbnRzL0NvbnRleHRNZW51LnRzIiwgInNyYy9jb21wb25lbnRzL0V4dHJhQnV0dG9uLnRzIiwgInNyYy9vcHRpb25zL2xpbmtBdHRyaWJ1dGVzLnRzIiwgInNyYy9vcHRpb25zL2xpdmVQcmV2aWV3LnRzIiwgInNyYy9jb21wb25lbnRzL0ZpZWxkSW5kZXgudHMiLCAic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeS50cyIsICJzcmMvY29tbWFuZHMvcmVzb2x2ZUxvb2t1cHMudHMiLCAic3JjL2NvbW1hbmRzL3VwZGF0ZUZvcm11bGFzLnRzIiwgInNyYy9jb21wb25lbnRzL0ZpbGVUYXNrTWFuYWdlci50cyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JuZy5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3N0cmluZ2lmeS5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL25hdGl2ZS5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3Y0LmpzIiwgInNyYy9jb21tYW5kcy9maWVsZE1vZGlmaWVyLnRzIiwgInNyYy9jb21tYW5kcy9maWxlRmllbGRzLnRzIiwgInNyYy9NZXRhZGF0YU1lbnVBcGkudHMiLCAic3JjL3NldHRpbmdzL01ldGFkYXRhTWVudVNldHRpbmdzLnRzIiwgInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5nVGFiLnRzIiwgInNyYy9zdWdnZXN0ZXIvRm9sZGVyU3VnZ2VzdGVyLnRzIiwgInNyYy9zZXR0aW5ncy9GaWxlQ2xhc3NRdWVyeVNldHRpbmdNb2RhbC50cyIsICJzcmMvc2V0dGluZ3MvRmlsZUNsYXNzUXVlcnlTZXR0aW5nLnRzIiwgInNyYy9zZXR0aW5ncy9taWdyYXRlU2V0dGluZy50cyIsICJzcmMvc3VnZ2VzdGVyL21ldGFkYXRhU3VnZ2VzdGVyLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBNYXJrZG93blZpZXcsIFBsdWdpbiwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IGFkZENvbW1hbmRzIH0gZnJvbSAnc3JjL2NvbW1hbmRzL3BhbGV0dGVDb21tYW5kcyc7XG5pbXBvcnQgQ29udGV4dE1lbnUgZnJvbSAnc3JjL2NvbXBvbmVudHMvQ29udGV4dE1lbnUnO1xuaW1wb3J0IEV4dHJhQnV0dG9uIGZyb20gJ3NyYy9jb21wb25lbnRzL0V4dHJhQnV0dG9uJztcbmltcG9ydCBGaWVsZEluZGV4IGZyb20gJ3NyYy9jb21wb25lbnRzL0ZpZWxkSW5kZXgnO1xuaW1wb3J0IEZpbGVUYXNrTWFuYWdlciBmcm9tICdzcmMvY29tcG9uZW50cy9GaWxlVGFza01hbmFnZXInO1xuaW1wb3J0IEZpZWxkIGZyb20gJ3NyYy9maWVsZHMvRmllbGQnO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gJ3NyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnknO1xuaW1wb3J0IHR5cGUgeyBJTWV0YWRhdGFNZW51QXBpIH0gZnJvbSAnc3JjL01ldGFkYXRhTWVudUFwaSc7XG5pbXBvcnQgeyBNZXRhZGF0YU1lbnVBcGkgfSBmcm9tICdzcmMvTWV0YWRhdGFNZW51QXBpJztcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIE1ldGFkYXRhTWVudVNldHRpbmdzIH0gZnJvbSBcInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5nc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudVNldHRpbmdUYWIgZnJvbSBcInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5nVGFiXCI7XG5pbXBvcnQgKiBhcyBTZXR0aW5nc01pZ3JhdGlvbiBmcm9tICdzcmMvc2V0dGluZ3MvbWlncmF0ZVNldHRpbmcnO1xuaW1wb3J0IFZhbHVlU3VnZ2VzdCBmcm9tIFwic3JjL3N1Z2dlc3Rlci9tZXRhZGF0YVN1Z2dlc3RlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXRhZGF0YU1lbnUgZXh0ZW5kcyBQbHVnaW4ge1xuXHRwdWJsaWMgYXBpOiBJTWV0YWRhdGFNZW51QXBpO1xuXHRwdWJsaWMgc2V0dGluZ3M6IE1ldGFkYXRhTWVudVNldHRpbmdzO1xuXHRwdWJsaWMgaW5pdGlhbFByb3BlcnRpZXM6IEFycmF5PEZpZWxkPiA9IFtdO1xuXHRwdWJsaWMgaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXM6IEFycmF5PEZpbGVDbGFzc1F1ZXJ5PiA9IFtdO1xuXHRwdWJsaWMgc2V0dGluZ1RhYjogTWV0YWRhdGFNZW51U2V0dGluZ1RhYjtcblx0cHVibGljIGZpZWxkSW5kZXg6IEZpZWxkSW5kZXg7XG5cdHB1YmxpYyBmaWxlVGFza01hbmFnZXI6IEZpbGVUYXNrTWFuYWdlcjtcblx0cHVibGljIGV4dHJhQnV0dG9uOiBFeHRyYUJ1dHRvbjtcblx0cHVibGljIGNvbnRleHRNZW51OiBDb250ZXh0TWVudTtcblxuXHRhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc29sZS5sb2coJ01ldGFkYXRhIE1lbnUgbG9hZGVkJyk7XG5cblx0XHQvL2xvYWRpbmcgYW5kIG1pZ3JhdGluZyBzZXR0aW5nc1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0aWYgKHRoaXMuc2V0dGluZ3Muc2V0dGluZ3NWZXJzaW9uID09PSB1bmRlZmluZWQpIGF3YWl0IFNldHRpbmdzTWlncmF0aW9uLm1pZ3JhdGVTZXR0aW5nc1YxdG9WMih0aGlzKVxuXHRcdGlmICh0aGlzLnNldHRpbmdzLnNldHRpbmdzVmVyc2lvbiA9PT0gMikgYXdhaXQgU2V0dGluZ3NNaWdyYXRpb24ubWlncmF0ZVNldHRpbmdzVjJ0b1YzKHRoaXMpXG5cblx0XHQvL2xvYWRpbmcgY29tcG9uZW50c1xuXHRcdHRoaXMuZmllbGRJbmRleCA9IHRoaXMuYWRkQ2hpbGQobmV3IEZpZWxkSW5kZXgodGhpcywgXCIxXCIsICgpID0+IHsgfSkpXG5cdFx0dGhpcy5maWxlVGFza01hbmFnZXIgPSB0aGlzLmFkZENoaWxkKG5ldyBGaWxlVGFza01hbmFnZXIodGhpcywgXCIxXCIsICgpID0+IHsgfSkpXG5cdFx0dGhpcy5leHRyYUJ1dHRvbiA9IHRoaXMuYWRkQ2hpbGQobmV3IEV4dHJhQnV0dG9uKHRoaXMsIFwiMVwiLCAoKSA9PiB7IH0pKVxuXHRcdHRoaXMuY29udGV4dE1lbnUgPSB0aGlzLmFkZENoaWxkKG5ldyBDb250ZXh0TWVudSh0aGlzKSlcblxuXHRcdC8vYnVpbGRpbmcgc2V0dGluZ3MgdGFiXG5cdFx0dGhpcy5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZm9yRWFjaChwcm9wID0+IHtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcblx0XHRcdHRoaXMuaW5pdGlhbFByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnNldHRpbmdzLmZpbGVDbGFzc1F1ZXJpZXMuZm9yRWFjaChxdWVyeSA9PiB7XG5cdFx0XHRjb25zdCBmaWxlQ2xhc3NRdWVyeSA9IG5ldyBGaWxlQ2xhc3NRdWVyeSgpO1xuXHRcdFx0T2JqZWN0LmFzc2lnbihmaWxlQ2xhc3NRdWVyeSwgcXVlcnkpO1xuXHRcdFx0dGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5wdXNoKGZpbGVDbGFzc1F1ZXJ5KTtcblx0XHR9KVxuXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiKHRoaXMpKTtcblxuXHRcdC8vcmVnaXN0ZXJpbmcgTWV0YWRhdGEgTWVudSBzdWdnZXN0b3IgZm9yIGxpdmUgcHJldmlld1xuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JTdWdnZXN0KG5ldyBWYWx1ZVN1Z2dlc3QodGhpcykpO1xuXHRcdHRoaXMuYXBpID0gbmV3IE1ldGFkYXRhTWVudUFwaSh0aGlzKS5tYWtlKCk7XG5cblx0XHQvL3JlZ2lzdGVyaW5nIHBhbGV0dGUgY29tbWFuZCByZS1idWlsZCBvbiBsZWFmIGNoYW5nZVxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKGxlYWYpID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWY/LnZpZXdcblx0XHRcdFx0YWRkQ29tbWFuZHModGhpcywgdmlldyk7XG5cdFx0XHR9KVxuXHRcdClcblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ21ldGFkYXRhLW1lbnU6aW5kZXhlZCcsICgpID0+IHtcblx0XHRcdFx0YWRkQ29tbWFuZHModGhpcywgdW5kZWZpbmVkKTtcblx0XHRcdH0pXG5cdFx0KVxuXG5cdFx0Ly9idWlsZGluZyBwYWxldHRlIGNvbW1hbmRzXG5cdFx0YWRkQ29tbWFuZHModGhpcywgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KSk7XG5cdH07XG5cblx0Lypcblx0LS0tLS0tLS0tLS0tXG5cdFNldHRpbmdzXG5cdC0tLS0tLS0tLS0tLVxuXHQqL1xuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fTtcblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncy5wcmVzZXRGaWVsZHMgPSB0aGlzLmluaXRpYWxQcm9wZXJ0aWVzO1xuXHRcdHRoaXMuc2V0dGluZ3MuZmlsZUNsYXNzUXVlcmllcyA9IHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXM7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0XHRhd2FpdCB0aGlzLmZpZWxkSW5kZXguZnVsbEluZGV4KFwic2V0dGluZ1wiLCB0cnVlLCBmYWxzZSk7XG5cdFx0dGhpcy5leHRyYUJ1dHRvbi5yZWxvYWRPYnNlcnZlcnMoKTtcblx0fTtcblxuXHRvbnVubG9hZCgpIHtcblx0XHRjb25zb2xlLmxvZygnTWV0YWRhdGEgTWVudSB1bmxvYWRlZCcpO1xuXHR9O1xufVxuIiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZpbGVWaWV3LCBNYXJrZG93blZpZXcsIE5vdGljZSwgVEZpbGUsIFZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBOb3RlRmllbGRzQ29tcG9uZW50IGZyb20gXCJzcmMvY29tcG9uZW50cy9Ob3RlRmllbGRzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbFwiO1xuaW1wb3J0IGNob29zZVNlY3Rpb25Nb2RhbCBmcm9tIFwic3JjL21vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWxcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IEZpbGVDbGFzc09wdGlvbnNMaXN0IGZyb20gXCJzcmMvb3B0aW9ucy9GaWxlQ2xhc3NPcHRpb25zTGlzdFwiO1xuaW1wb3J0IE9wdGlvbnNMaXN0IGZyb20gXCJzcmMvb3B0aW9ucy9PcHRpb25zTGlzdFwiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCB7IGZyb250TWF0dGVyTGluZUZpZWxkLCBnZXRMaW5lRmllbGRzIH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcbmltcG9ydCB7IGluc2VydE1pc3NpbmdGaWVsZHMgfSBmcm9tIFwiLi9pbnNlcnRNaXNzaW5nRmllbGRzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzQ29tcG9uZW50IH0gZnJvbSBcInNyYy9jb21wb25lbnRzL2ZpbGVDbGFzc1RhYmxlXCI7XG5cbmZ1bmN0aW9uIGFkZEZpbGVDbGFzc0F0dHJpYnV0ZU9wdGlvbnMocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgIHBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICAgICAgaWQ6IFwiZmlsZUNsYXNzQXR0cl9vcHRpb25zXCIsXG4gICAgICAgIG5hbWU6IFwiQWxsIGZpbGVDbGFzcyBhdHRyaWJ1dGVzIG9wdGlvbnNcIixcbiAgICAgICAgaWNvbjogXCJnZWFyXCIsXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuICAgICAgICAgICAgY29uc3QgaW5GaWxlQ2xhc3MgPSAhIShjbGFzc0ZpbGVzUGF0aCAmJiAhISh2aWV3Py5maWxlKSAmJiB2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbkZpbGVDbGFzc1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsID0gbmV3IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbChwbHVnaW4uYXBwKVxuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IEZpbGVDbGFzc09wdGlvbnNMaXN0KHBsdWdpbiwgdmlldyEuZmlsZSwgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTtcbiAgICAgICAgICAgICAgICBvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gYWRkSW5zZXJ0RmlsZUNsYXNzQXR0cmlidXRlKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcImluc2VydF9maWxlQ2xhc3NBdHRyXCIsXG4gICAgICAgIG5hbWU6IFwiSW5zZXJ0IGEgbmV3IGZpbGVDbGFzcyBhdHRyaWJ1dGVcIixcbiAgICAgICAgaWNvbjogXCJsaXN0LXBsdXNcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG4gICAgICAgICAgICBjb25zdCBpbkZpbGVDbGFzcyA9ICEhKGNsYXNzRmlsZXNQYXRoICYmICEhKHZpZXc/LmZpbGUpICYmIHZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKVxuICAgICAgICAgICAgaWYgKGNoZWNraW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluRmlsZUNsYXNzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5GaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aChwbHVnaW4sIHZpZXchLmZpbGUucGF0aClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHBsdWdpbiwgRmlsZUNsYXNzLmNyZWF0ZUZpbGVDbGFzcyhwbHVnaW4sIGZpbGVDbGFzc05hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzQXR0cmlidXRlTW9kYWwub3BlbigpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwicGx1Z2luIGlzIG5vdCBhIHZhbGlkIGZpbGVDbGFzc1wiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gYWRkSW5zZXJ0RmllbGRBdFBvc2l0aW9uQ29tbWFuZChwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgcGx1Z2luLmFkZENvbW1hbmQoe1xuICAgICAgICBpZDogXCJpbnNlcnRfZmllbGRfYXRfY3Vyc29yXCIsXG4gICAgICAgIG5hbWU6IFwiQ2hvb3NlIGEgZmllbGQgdG8gaW5zZXJ0IGF0IGN1cnNvclwiLFxuICAgICAgICBpY29uOiBcImxpc3QtcGx1c1wiLFxuICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcbiAgICAgICAgICAgIGNvbnN0IGluRmlsZSA9ICEhKHZpZXc/LmZpbGUgJiYgKCFjbGFzc0ZpbGVzUGF0aCB8fCAhdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpKVxuICAgICAgICAgICAgaWYgKGNoZWNraW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluRmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHBsdWdpbiwgdmlldyEuZmlsZSwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIik7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5mdW5jdGlvbiBhZGRGaWVsZE9wdGlvbnNDb21tYW5kKHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcImZpZWxkX29wdGlvbnNcIixcbiAgICAgICAgbmFtZTogXCJGaWVsZHMgb3B0aW9uc1wiLFxuICAgICAgICBpY29uOiBcImdlYXJcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG4gICAgICAgICAgICBjb25zdCBpbkZpbGUgPSAhISh2aWV3Py5maWxlICYmICghY2xhc3NGaWxlc1BhdGggfHwgIXZpZXcuZmlsZS5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKSlcbiAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbkZpbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5GaWxlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsID0gbmV3IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbChwbHVnaW4uYXBwKVxuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHBsdWdpbiwgdmlldyEuZmlsZSwgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTtcbiAgICAgICAgICAgICAgICBvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gYWRkTWFuYWdlRmllbGRBdEN1cnNvckNvbW1hbmQocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgIHBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICAgICAgaWQ6IFwiZmllbGRfYXRfY3Vyc29yX29wdGlvbnNcIixcbiAgICAgICAgbmFtZTogXCJNYW5hZ2UgZmllbGQgYXQgY3Vyc29yXCIsXG4gICAgICAgIGljb246IFwidGV4dC1jdXJzb3ItaW5wdXRcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgY29uc3QgZWRpdG9yID0gdmlldz8uZWRpdG9yO1xuICAgICAgICAgICAgY29uc3QgaW5GaWxlID0gISEodmlldz8uZmlsZSAmJiAoIWNsYXNzRmlsZXNQYXRoIHx8ICF2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkpXG4gICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5GaWxlICYmIGVkaXRvciAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5GaWxlICYmIGVkaXRvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QocGx1Z2luLCB2aWV3IS5maWxlLCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh2aWV3IS5maWxlKT8uZnJvbnRtYXR0ZXI7XG4gICAgICAgICAgICAgICAgaWYgKGZyb250bWF0dGVyICYmIGVkaXRvclxuICAgICAgICAgICAgICAgICAgICAmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSA+IGZyb250bWF0dGVyLnBvc2l0aW9uLnN0YXJ0LmxpbmVcbiAgICAgICAgICAgICAgICAgICAgJiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPCBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBmcm9udE1hdHRlckxpbmVGaWVsZChlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSkpXG4gICAgICAgICAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUpIG9wdGlvbnNMaXN0LmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGF0dHJpYnV0ZSlcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBnZXRMaW5lRmllbGRzKGVkaXRvci5nZXRMaW5lKGVkaXRvci5nZXRDdXJzb3IoKS5saW5lKSkuZmluZChmaWVsZCA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgZWRpdG9yLmdldEN1cnNvcigpLmNoIDw9IGZpZWxkLmluZGV4ICsgZmllbGQubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBlZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggPj0gZmllbGQuaW5kZXgpIHx8IHt9O1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlKSBvcHRpb25zTGlzdC5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbChhdHRyaWJ1dGUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gaW5zZXJ0TWlzc2luZ0ZpZWxkc0NvbW1hbmQocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgIHBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICAgICAgaWQ6IFwiaW5zZXJ0X21pc3NpbmdfZmllbGRzXCIsXG4gICAgICAgIG5hbWU6IFwiQnVsayBpbnNlcnQgbWlzc2luZyBmaWVsZHNcIixcbiAgICAgICAgaWNvbjogXCJiYXR0ZXJ5LWZ1bGxcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgY29uc3QgaW5GaWxlID0gISEodmlldz8uZmlsZSAmJiAoIWNsYXNzRmlsZXNQYXRoIHx8ICF2aWV3LmZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkpXG4gICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5GaWxlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBkdkFwaSA9IHBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGk7XG4gICAgICAgICAgICBpZiAoZHZBcGkgJiYgaW5GaWxlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RmllbGRzTmFtZXMgPSBnZW51aW5lS2V5cyhkdkFwaS5wYWdlKGZpbGUucGF0aCkpXG4gICAgICAgICAgICAgICAgaWYgKCFbLi4ucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCkgfHwgW11dLm1hcChmaWVsZCA9PiBmaWVsZC5uYW1lKS5ldmVyeShmaWVsZE5hbWUgPT4gY3VycmVudEZpZWxkc05hbWVzLmluY2x1ZGVzKGZpZWxkTmFtZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTGlzdDogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQ6IGJvb2xlYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgPT4gaW5zZXJ0TWlzc2luZ0ZpZWxkcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICkub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGFkZFVwZGF0ZUxvb2t1cHMocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcInVwZGF0ZV9mb3JtdWxhc1wiLFxuICAgICAgICBuYW1lOiBcIlVwZGF0ZSBmb3JtdWxhcyBmaWVsZHNcIixcbiAgICAgICAgaWNvbjogXCJmdW5jdGlvbi1zcXVhcmVcIixcbiAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgcGx1Z2luLmZpZWxkSW5kZXguZnVsbEluZGV4KFwiY29tbWFuZFwiLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGFkZE9wZW5GaWVsZHNNb2RhbENvbW1hbmQocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgIHBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICAgICAgaWQ6IFwib3Blbl9maWVsZHNfbW9kYWxcIixcbiAgICAgICAgbmFtZTogXCJPcGVuIHRoaXMgbm90ZSdzIGZpZWxkcyBtb2RhbFwiLFxuICAgICAgICBpY29uOiBcImNsaXBib2FyZC1saXN0XCIsXG4gICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmlldyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgIGNvbnN0IGluRmlsZSA9ICEhKHZpZXc/LmZpbGUgJiYgKCFjbGFzc0ZpbGVzUGF0aCB8fCAhdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpKVxuICAgICAgICAgICAgaWYgKGNoZWNraW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluRmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGluRmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB2aWV3LmZpbGU7XG4gICAgICAgICAgICAgICAgaWYgKGluRmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlRmllbGRzQ29tcG9uZW50ID0gbmV3IE5vdGVGaWVsZHNDb21wb25lbnQocGx1Z2luLCBcIjFcIiwgKCkgPT4geyB9LCBmaWxlKVxuICAgICAgICAgICAgICAgICAgICBwbHVnaW4uYWRkQ2hpbGQobm90ZUZpZWxkc0NvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gYWRkSW5zZXJ0RmllbGRDb21tYW5kKHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSBwbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGg7XG4gICAgY29uc3QgZmllbGRzOiBGaWVsZFtdID0gW107XG4gICAgcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKGYgPT4geyBpZiAoZi5jb21tYW5kKSBmaWVsZHMucHVzaChmKSB9KTtcbiAgICBbLi4ucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNGaWVsZHNdLmZvckVhY2goKFtmaWxlQ2xhc3NOYW1lLCBfZmllbGRzXSkgPT4ge1xuICAgICAgICBfZmllbGRzLmZvckVhY2goZmllbGQgPT4geyBpZiAoZmllbGQuY29tbWFuZCkgeyBmaWVsZHMucHVzaChmaWVsZCkgfSB9KVxuICAgIH0pO1xuICAgIGZpZWxkcy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgICAgaWYgKGZpZWxkLmNvbW1hbmQpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1hbmQgPSBmaWVsZC5jb21tYW5kXG4gICAgICAgICAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICAgICAgaWQ6IGNvbW1hbmQuaWQsXG4gICAgICAgICAgICAgICAgbmFtZTogY29tbWFuZC5sYWJlbCxcbiAgICAgICAgICAgICAgICBpY29uOiBjb21tYW5kLmljb24sXG4gICAgICAgICAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluRmlsZSA9ICEhKHZpZXc/LmZpbGUgJiYgKCFjbGFzc0ZpbGVzUGF0aCB8fCAhdmlldy5maWxlLnBhdGguc3RhcnRzV2l0aChjbGFzc0ZpbGVzUGF0aCkpKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmUiA9IGNvbW1hbmQuaWQubWF0Y2goL2luc2VydF9fKD88ZmlsZUNsYXNzTmFtZT4uKilfXyg/PGZpZWxkTmFtZT4uKikvKVxuICAgICAgICAgICAgICAgICAgICBpZiAoY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc2VzID0gdmlldz8uZmlsZSA/IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXMuZ2V0KHZpZXc/LmZpbGUucGF0aCkgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3Py5maWxlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NlcyAmJiBmaWxlQ2xhc3Nlcy5zb21lKGZpbGVDbGFzcyA9PiBmaWxlQ2xhc3MubmFtZSA9PT0gZlI/Lmdyb3Vwcz8uZmlsZUNsYXNzTmFtZSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIWZpbGVDbGFzc2VzICYmIGZSPy5ncm91cHM/LmZpbGVDbGFzc05hbWUgPT09IFwicHJlc2V0RmllbGRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZlI/Lmdyb3VwcyAmJiB2aWV3Py5maWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE5hbWUgPSBmUi5ncm91cHMuZmllbGROYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3LmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT4gRi5vcGVuRmllbGRNb2RhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3LmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgKS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGFkZEZpbGVDbGFzc1RhYmxlVmlld0NvbW1hbmQocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgICAgIGlkOiBcIm9wZW5fZmlsZWNsYXNzX3ZpZXdcIixcbiAgICAgICAgbmFtZTogXCJPcGVuIGZpbGVDbGFzcyB2aWV3XCIsXG4gICAgICAgIGljb246IFwiZmlsZS1zcHJlYWRzaGVldFwiLFxuICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgIGlmIChjaGVja2luZykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBhY3RpdmVGaWxlUGF0aCA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKT8ucGF0aFxuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gYWN0aXZlRmlsZVBhdGggPyBwbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc1BhdGguZ2V0KGFjdGl2ZUZpbGVQYXRoKSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQ29tcG9uZW50ID0gbmV3IEZpbGVDbGFzc0NvbXBvbmVudChwbHVnaW4sIGZpbGVDbGFzcylcbiAgICAgICAgICAgIHBsdWdpbi5hZGRDaGlsZChmaWxlQ2xhc3NDb21wb25lbnQpO1xuICAgICAgICB9XG4gICAgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZENvbW1hbmRzKHBsdWdpbjogTWV0YWRhdGFNZW51LCB2aWV3OiBWaWV3IHwgdW5kZWZpbmVkIHwgbnVsbCkge1xuICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgaWYgKHZpZXcgJiYgdmlldyBpbnN0YW5jZW9mIEZpbGVWaWV3KSB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh2aWV3LmZpbGUucGF0aClcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgaWYgKGNsYXNzRmlsZXNQYXRoICYmIGZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkge1xuICAgICAgICAgICAgICAgIGFkZEZpbGVDbGFzc0F0dHJpYnV0ZU9wdGlvbnMocGx1Z2luKTtcbiAgICAgICAgICAgICAgICBhZGRJbnNlcnRGaWxlQ2xhc3NBdHRyaWJ1dGUocGx1Z2luKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWRkRmllbGRPcHRpb25zQ29tbWFuZChwbHVnaW4pO1xuICAgICAgICAgICAgICAgIGFkZEluc2VydEZpZWxkQXRQb3NpdGlvbkNvbW1hbmQocGx1Z2luKTtcbiAgICAgICAgICAgICAgICBhZGRNYW5hZ2VGaWVsZEF0Q3Vyc29yQ29tbWFuZChwbHVnaW4pO1xuICAgICAgICAgICAgICAgIGluc2VydE1pc3NpbmdGaWVsZHNDb21tYW5kKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgYWRkT3BlbkZpZWxkc01vZGFsQ29tbWFuZChwbHVnaW4pXG4gICAgICAgICAgICAgICAgYWRkSW5zZXJ0RmllbGRDb21tYW5kKHBsdWdpbilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBhZGRGaWxlQ2xhc3NUYWJsZVZpZXdDb21tYW5kKHBsdWdpbilcbiAgICBhZGRVcGRhdGVMb29rdXBzKHBsdWdpbilcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBDb21wb25lbnQsIE1vZGFsLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsXCI7XG5pbXBvcnQgQ2hvb3NlU2VjdGlvbk1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbFwiXG5pbXBvcnQgKiBhcyBGaWVsZFR5cGUgZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCJcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGTSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYsIEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgaW5zZXJ0TWlzc2luZ0ZpZWxkcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0TWlzc2luZ0ZpZWxkc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBnZW51aW5lS2V5cyB9IGZyb20gXCJzcmMvdXRpbHMvZGF0YXZpZXdVdGlsc1wiO1xuXG5leHBvcnQgY2xhc3MgRmllbGRPcHRpb25zIHtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7IH1cblxuICAgIHB1YmxpYyBhZGRPcHRpb24oaWNvbjogc3RyaW5nLCBvbmNsaWNrOiAoKSA9PiB7fSB8IHZvaWQsIHRvb2x0aXA/OiBzdHJpbmcsIGNsYXNzTmFtZT86IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWVsZE9wdGlvbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1pdGVtIGZpZWxkLW9wdGlvblwiIH0pXG4gICAgICAgIGNvbnN0IGZpZWxkT3B0aW9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZE9wdGlvbkNvbnRhaW5lcilcbiAgICAgICAgZmllbGRPcHRpb24uc2V0SWNvbihpY29uKVxuICAgICAgICBpZiAoY2xhc3NOYW1lKSBmaWVsZE9wdGlvbi5idXR0b25FbC5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICBmaWVsZE9wdGlvbi5vbkNsaWNrKCgpID0+IG9uY2xpY2soKSlcbiAgICAgICAgaWYgKHRvb2x0aXApIGZpZWxkT3B0aW9uLnNldFRvb2x0aXAodG9vbHRpcCk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgRmllbGRzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIGR2QXBpPzogYW55XG4gICAgcHVibGljIGZpZWxkczogRmllbGRbXVxuICAgIHB1YmxpYyBmaWVsZENvbnRhaW5lcnM6IEhUTUxEaXZFbGVtZW50W10gPSBbXTtcbiAgICBwcml2YXRlIG1heE9wdGlvbnM6IG51bWJlciA9IDA7XG4gICAgcHJpdmF0ZSBtaXNzaW5nRmllbGRzOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmR2QXBpID0gcGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaTtcbiAgICAgICAgdGhpcy5nZXRGaWVsZHMoKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm5vdGUtZmllbGRzLW1vZGFsXCIpXG4gICAgfVxuXG4gICAgLy9va1xuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYEZpZWxkcyBvZiAke3RoaXMuZmlsZS5iYXNlbmFtZX0uJHt0aGlzLmZpbGUuZXh0ZW5zaW9ufWApXG4gICAgICAgIHRoaXMuYnVpbGRGaWVsZHNDb250YWluZXIoKTtcbiAgICB9O1xuXG4gICAgLy9va1xuICAgIGdldEZpZWxkcygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWVsZHMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldCh0aGlzLmZpbGUucGF0aCkgfHwgW107XG4gICAgfVxuXG4gICAgLy9cbiAgICBidWlsZEZpZWxkQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGZpZWxkOiBGaWVsZCwgdmFsdWU/OiBzdHJpbmcgfCBudWxsIHwgdW5kZWZpbmVkKTogSFRNTERpdkVsZW1lbnQge1xuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRk1bZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIGZpZWxkKVxuICAgICAgICBjb25zdCBmaWVsZENvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgZmllbGROYW1lQ29udGFpbmVyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogYCR7ZmllbGQubmFtZX1gLCBjbHM6IFwiZmllbGQtaXRlbSBmaWVsZC1uYW1lXCIgfSk7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IGZpZWxkLmZpbGVDbGFzc05hbWUgPyB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmllbGQuZmlsZUNsYXNzTmFtZSkgOiB1bmRlZmluZWRcbiAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgZmllbGROYW1lQ29udGFpbmVyLmFkZENsYXNzKGBmaWxlQ2xhc3NGaWVsZF9fJHtmaWxlQ2xhc3MubmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9fX1wiKS5yZXBsYWNlKFwiIFwiLCBcIl9cIil9YClcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBmaWVsZFNldHRpbmdDb250YWluZXIgPSBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtaXRlbSBmaWVsZC1zZXR0aW5nXCIgfSk7XG4gICAgICAgIGNvbnN0IGZpZWxkU2V0dGluZ0J0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZmllbGRTZXR0aW5nQ29udGFpbmVyKTtcbiAgICAgICAgZmllbGRTZXR0aW5nQnRuLnNldEljb24oXCJnZWFyXCIpXG4gICAgICAgIGZpZWxkU2V0dGluZ0J0bi5zZXRUb29sdGlwKGAke2ZpZWxkLmZpbGVDbGFzc05hbWUgPyBmaWVsZC5maWxlQ2xhc3NOYW1lICsgXCIgPiBcIiA6IFwiUHJlc2V0IEZpZWxkID4gXCJ9ICR7ZmllbGQubmFtZX0gc2V0dGluZ3NgKVxuICAgICAgICBmaWVsZFNldHRpbmdCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBfZmlsZUNsYXNzID0gZmllbGQuZmlsZUNsYXNzTmFtZSA/IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWVsZC5maWxlQ2xhc3NOYW1lKSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlID0gX2ZpbGVDbGFzcz8uYXR0cmlidXRlcy5maW5kKGF0dHIgPT4gYXR0ci5uYW1lID09PSBmaWVsZC5uYW1lKVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZSAmJiBfZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwodGhpcy5wbHVnaW4sIF9maWxlQ2xhc3MsIGZpbGVDbGFzc0F0dHJpYnV0ZSlcbiAgICAgICAgICAgICAgICBmaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGZpZWxkVHlwZUNvbnRhaW5lciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogYGZpZWxkLWl0ZW1gIH0pO1xuICAgICAgICBmaWVsZFR5cGVDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogZmllbGQudHlwZSwgY2xzOiBgY2hpcCBmaWVsZC10eXBlICR7RmllbGRUeXBlLkZpZWxkQmFja2dyb3VuZENvbG9yQ2xhc3NbZmllbGQudHlwZV19YCB9KVxuICAgICAgICBjb25zdCBmaWVsZFZhbHVlQ29udGFpbmVyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogdmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCA/IFwiZmllbGQtaXRlbSBmaWVsZC12YWx1ZVwiIDogXCJmaWVsZC1pdGVtIGZpZWxkLXZhbHVlIGVtcHR5ZmllbGRcIlxuICAgICAgICB9KVxuICAgICAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIGZpZWxkVmFsdWVDb250YWluZXIuc2V0VGV4dChmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuRmllbGRUeXBlLkxvb2t1cCA/IFwiLS0tYXV0by0tLVwiIDogXCI8ZW1wdHk+XCIpO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMubWlzc2luZ0ZpZWxkcyA9IHRydWVcbiAgICAgICAgICAgIGZpZWxkVmFsdWVDb250YWluZXIuc2V0VGV4dChcIjxtaXNzaW5nPlwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpZWxkTWFuYWdlci5kaXNwbGF5VmFsdWUoZmllbGRWYWx1ZUNvbnRhaW5lciwgdGhpcy5maWxlLCBmaWVsZC5uYW1lLCAoKSA9PiB7IHRoaXMuY2xvc2UoKSB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpZWxkT3B0aW9ucyA9IG5ldyBGaWVsZE9wdGlvbnMoZmllbGRDb250YWluZXIpXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBmaWVsZE1hbmFnZXIuYWRkRmllbGRPcHRpb24oZmllbGQubmFtZSwgdmFsdWUsIHRoaXMuZmlsZSwgZmllbGRPcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkQnRuQ29udGFpbmVyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWl0ZW0gZmllbGQtb3B0aW9uXCIgfSlcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmaWVsZEJ0bkNvbnRhaW5lcilcbiAgICAgICAgICAgIGZpZWxkQnRuLnNldEljb24oXCJsaXN0LXBsdXNcIilcbiAgICAgICAgICAgIGZpZWxkQnRuLnNldFRvb2x0aXAoXCJBZGQgZmllbGQgYXQgc2VjdGlvblwiKVxuICAgICAgICAgICAgZmllbGRCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV3IENob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICkgPT4gRmllbGRNYW5hZ2VyLm9wZW5GaWVsZE1vZGFsKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnRcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICkub3BlbigpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvcHRpb25zQ291bnQgPSBmaWVsZENvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLmZpZWxkLW9wdGlvblwiKS5sZW5ndGhcbiAgICAgICAgaWYgKHRoaXMubWF4T3B0aW9ucyA8IG9wdGlvbnNDb3VudCkgdGhpcy5tYXhPcHRpb25zID0gb3B0aW9uc0NvdW50XG5cbiAgICAgICAgcmV0dXJuIGZpZWxkQ29udGFpbmVyXG4gICAgfVxuXG4gICAgb3Blbkluc2VydE1pc3NpbmdGaWVsZHNGb3JGaWxlQ2xhc3NNb2RhbChmaWxlQ2xhc3M6IEZpbGVDbGFzcyk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpO1xuICAgICAgICAgICAgaWYgKGR2RmlsZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IENob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICAgICAgICAgICkgPT4gaW5zZXJ0TWlzc2luZ0ZpZWxkcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgZHZGaWxlLmZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3MubmFtZVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG1pc3NpbmdGaWVsZHNGb3JGaWxlQ2xhc3MoZmlsZUNsYXNzOiBGaWxlQ2xhc3MpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY3VycmVudEZpZWxkc05hbWVzOiBzdHJpbmdbXSA9IFtdXG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aCk7XG4gICAgICAgICAgICBpZiAoZHZGaWxlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudEZpZWxkc05hbWVzLnB1c2goLi4uZ2VudWluZUtleXMoZHZGaWxlKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBtaXNzaW5nRmllbGRzID0gZmlsZUNsYXNzICYmIHRoaXMuZmlsZSA/XG4gICAgICAgICAgICAhdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQoZmlsZUNsYXNzLm5hbWUpPy5tYXAoZiA9PiBmLm5hbWUpLmV2ZXJ5KGZpZWxkTmFtZSA9PiBjdXJyZW50RmllbGRzTmFtZXMuaW5jbHVkZXMoZmllbGROYW1lKSkgOlxuICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgcmV0dXJuIG1pc3NpbmdGaWVsZHNcbiAgICB9XG5cbiAgICBidWlsZEZpbGVDbGFzc01hbmFnZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQodGhpcy5maWxlLnBhdGgpIHx8IFtdO1xuICAgICAgICBmaWxlQ2xhc3Nlcy5mb3JFYWNoKGZpbGVDbGFzcyA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NNYW5hZ2VyQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZHMtaW5oZXJpdGFuY2UtbWFuYWdlci1jb250YWluZXJcIiB9KVxuICAgICAgICAgICAgY29uc3QgX2FuY2VzdG9ycyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNBbmNlc3RvcnMuZ2V0KGZpbGVDbGFzcy5uYW1lKSB8fCBbXTtcbiAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9ycyA9IFsuLi5fYW5jZXN0b3JzXS5yZXZlcnNlKCk7XG4gICAgICAgICAgICBhbmNlc3RvcnMucHVzaChmaWxlQ2xhc3MubmFtZSk7XG4gICAgICAgICAgICBhbmNlc3RvcnMuZm9yRWFjaCgoZmlsZUNsYXNzTmFtZSwgaSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IF9maWxlQ2xhc3MgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICBpZiAoX2ZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NPcHRpb25zQ29udGFpbmVyID0gZmlsZUNsYXNzTWFuYWdlckNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmlsZWNsYXNzLW1hbmFnZXItY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZUNvbnRhaW5lciA9IGZpbGVDbGFzc09wdGlvbnNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm5hbWVcIiwgdGV4dDogX2ZpbGVDbGFzcy5uYW1lIH0pXG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXIuc2V0QXR0cihcImlkXCIsIGBmaWxlQ2xhc3NfXyR7X2ZpbGVDbGFzcy5uYW1lLnJlcGxhY2UoXCIvXCIsIFwiX19fXCIpLnJlcGxhY2UoXCIgXCIsIFwiX1wiKX1gKVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1pc3NpbmdGaWVsZHNGb3JGaWxlQ2xhc3MoX2ZpbGVDbGFzcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0luc2VydE1pc3NpbmdGaWVsZHNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpbGVDbGFzc09wdGlvbnNDb250YWluZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlQ2xhc3NJbnNlcnRNaXNzaW5nRmllbGRzQnRuLnNldEljb24oXCJiYXR0ZXJ5LWZ1bGxcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0luc2VydE1pc3NpbmdGaWVsZHNCdG4uc2V0VG9vbHRpcChgSW5zZXJ0IG1pc3NpbmcgZmllbGRzIGZvciAke19maWxlQ2xhc3MubmFtZX1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzSW5zZXJ0TWlzc2luZ0ZpZWxkc0J0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5JbnNlcnRNaXNzaW5nRmllbGRzRm9yRmlsZUNsYXNzTW9kYWwoX2ZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBZGRBdHRyaWJ1dGVCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpbGVDbGFzc09wdGlvbnNDb250YWluZXIpXG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0FkZEF0dHJpYnV0ZUJ0bi5zZXRJY29uKFwicGx1cy1jaXJjbGVcIilcbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzQWRkQXR0cmlidXRlQnRuLnNldFRvb2x0aXAoYEFkZCBmaWVsZCBkZWZpbml0aW9uIGluICR7X2ZpbGVDbGFzcy5uYW1lfWApXG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc0FkZEF0dHJpYnV0ZUJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCBfZmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzQXR0cmlidXRlTW9kYWwub3BlbigpXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIGlmIChpIDwgYW5jZXN0b3JzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc01hbmFnZXJDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCI+XCIsIGNsczogXCJzZXBhcmF0b3JcIiB9KVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzRmllbHNDb250YWluZXJzID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsKGBbY2xhc3MqPVwiZmlsZUNsYXNzRmllbGRfXyR7ZmlsZUNsYXNzTmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9fX1wiKS5yZXBsYWNlKFwiIFwiLCBcIl9cIil9XCJdYClcbiAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzRmllbHNDb250YWluZXJzLmZvckVhY2goZmllbGROYW1lQ29udGFpbmVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIChmaWVsZE5hbWVDb250YWluZXIgYXMgSFRNTERpdkVsZW1lbnQpLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXI/LmFkZENsYXNzKFwiYWN0aXZlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAoZmllbGROYW1lQ29udGFpbmVyIGFzIEhUTUxEaXZFbGVtZW50KS5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXI/LnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lckVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoYC5maWVsZC1pdGVtLmZpZWxkLW5hbWUuZmlsZUNsYXNzRmllbGRfXyR7ZmlsZUNsYXNzTmFtZS5yZXBsYWNlKFwiL1wiLCBcIl9fX1wiKS5yZXBsYWNlKFwiIFwiLCBcIl9cIil9YClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaChjb250ID0+IHsgY29udC5hZGRDbGFzcyhcImFjdGl2ZVwiKSB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZpbGVDbGFzc05hbWVDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyRWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbChgLmZpZWxkLWl0ZW0uZmllbGQtbmFtZS5maWxlQ2xhc3NGaWVsZF9fJHtmaWxlQ2xhc3NOYW1lLnJlcGxhY2UoXCIvXCIsIFwiX19fXCIpLnJlcGxhY2UoXCIgXCIsIFwiX1wiKX1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKGNvbnQgPT4geyBjb250LnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGZvcm1hdE9wdGlvbnNDb2x1bW5zKGZpZWxkc0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgLy9jcmVhdGUgZW1wdHkgY2VsbHMgZm9yIGZpZWxkIHdpdGggbGVzcyBvcHRpb25zIHNvIHRoYXQgb3B0aW9ucyBhcmUgcmlnaHQgYWxpZ25lZCBpbiB0aGUgdGFibGVcbiAgICAgICAgY29uc3QgZmllbGRDb250YWluZXJzID0gZmllbGRzQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5maWVsZC1jb250YWluZXInKVxuICAgICAgICBmaWVsZENvbnRhaW5lcnMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0gZmllbGQucXVlcnlTZWxlY3RvckFsbCgnLmZpZWxkLW9wdGlvbicpXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5sZW5ndGggPCB0aGlzLm1heE9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBvcHRpb25zWzBdPy5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1heE9wdGlvbnMgLSBvcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbXB0eUNlbGwgPSBwYXJlbnQuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWl0ZW0gZmllbGQtb3B0aW9uXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnNbMF0ucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKGVtcHR5Q2VsbCwgb3B0aW9uc1swXSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBidWlsZEZpZWxkc0NvbnRhaW5lcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5taXNzaW5nRmllbGRzID0gZmFsc2VcbiAgICAgICAgdGhpcy5jb250ZW50RWwucmVwbGFjZUNoaWxkcmVuKCk7XG4gICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKCdocicpXG4gICAgICAgIGNvbnN0IGZpZWxkc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJub3RlLWZpZWxkcy1jb250YWluZXJcIiB9KTtcbiAgICAgICAgdGhpcy5maWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZHZBcGkgPyB0aGlzLmR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpW2ZpZWxkLm5hbWVdIDogdW5kZWZpbmVkXG4gICAgICAgICAgICB0aGlzLmZpZWxkQ29udGFpbmVycy5wdXNoKHRoaXMuYnVpbGRGaWVsZENvbnRhaW5lcihmaWVsZHNDb250YWluZXIsIGZpZWxkLCB2YWx1ZSkpXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMuZm9ybWF0T3B0aW9uc0NvbHVtbnMoZmllbGRzQ29udGFpbmVyKTtcbiAgICAgICAgaWYgKHRoaXMubWlzc2luZ0ZpZWxkcykge1xuICAgICAgICAgICAgY29uc3QgaW5zZXJ0TWlzc2luZ0ZpZWxkc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJpbnNlcnQtYWxsLWZpZWxkc1wiIH0pO1xuICAgICAgICAgICAgaW5zZXJ0TWlzc2luZ0ZpZWxkc0NvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcIkluc2VydCBtaXNzaW5nIGZpZWxkc1wiIH0pO1xuICAgICAgICAgICAgY29uc3QgaW5zZXJ0TWlzc2luZ0ZpZWxkc0J0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5zZXJ0TWlzc2luZ0ZpZWxkc0NvbnRhaW5lcilcbiAgICAgICAgICAgIGluc2VydE1pc3NpbmdGaWVsZHNCdG4uc2V0SWNvbihcImJhdHRlcnktZnVsbFwiKVxuICAgICAgICAgICAgaW5zZXJ0TWlzc2luZ0ZpZWxkc0J0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkdkZpbGUgPSB0aGlzLmR2QXBpPy5wYWdlKHRoaXMuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChkdkZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IENob29zZVNlY3Rpb25Nb2RhbChcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTGlzdDogYm9vbGVhbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQ6IGJvb2xlYW5cbiAgICAgICAgICAgICAgICAgICAgICAgICkgPT4gaW5zZXJ0TWlzc2luZ0ZpZWxkcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdkZpbGUuZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICkub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoJ2hyJylcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzTWFuYWdlcnNDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGRzLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkRmlsZUNsYXNzTWFuYWdlcihmaWxlQ2xhc3NNYW5hZ2Vyc0NvbnRhaW5lcilcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE5vdGVGaWVsZHNDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgcHJpdmF0ZSBmaWVsZHNNb2RhbDogRmllbGRzTW9kYWw7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwdWJsaWMgY2FjaGVWZXJzaW9uOiBzdHJpbmcsXG4gICAgICAgIHB1YmxpYyBvbkNoYW5nZTogKCkgPT4gdm9pZCxcbiAgICAgICAgcHVibGljIGZpbGU6IFRGaWxlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZmllbGRzTW9kYWwgPSBuZXcgRmllbGRzTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUpXG4gICAgICAgIHRoaXMuZmllbGRzTW9kYWwub25DbG9zZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlbW92ZUNoaWxkKHRoaXMpXG4gICAgICAgICAgICB0aGlzLnVubG9hZCgpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbmxvYWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2RhdGF2aWV3Om1ldGFkYXRhLWNoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGRzTW9kYWwuZ2V0RmllbGRzKCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkc01vZGFsLmJ1aWxkRmllbGRzQ29udGFpbmVyKCk7XG4gICAgICAgIH0pKVxuICAgICAgICB0aGlzLmZpZWxkc01vZGFsLm9wZW4oKVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgRHJvcGRvd25Db21wb25lbnQsIE1vZGFsLCBUZXh0Q29tcG9uZW50LCBCdXR0b25Db21wb25lbnQsIE5vdGljZSwgVG9nZ2xlQ29tcG9uZW50LCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpZWxkVHlwZVRvb2x0aXAsIEZpZWxkVHlwZSwgRmllbGRUeXBlTGFiZWxNYXBwaW5nLCBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkLCB7IEZpZWxkQ29tbWFuZCB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5cbmNsYXNzIEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBuYW1lSW5wdXQ6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBhdHRyTmFtZTogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgZmllbGRNYW5hZ2VyOiBGO1xuICAgIHByaXZhdGUgZmllbGRPcHRpb25zQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGNvbW1hbmQ6IEZpZWxkQ29tbWFuZDtcbiAgICBwcml2YXRlIGFkZENvbW1hbmQ6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBpY29uTmFtZTogVGV4dENvbXBvbmVudDtcblxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSwgcHJpdmF0ZSBmaWxlQ2xhc3M6IEZpbGVDbGFzcywgcHJpdmF0ZSBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmluaXRpYWxGaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICBpZiAodGhpcy5hdHRyKSB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gYXR0ciEuZ2V0RmllbGQoKVxuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpZWxkLCB0aGlzLmZpZWxkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQgPSB0aGlzLmZpZWxkLmNvbW1hbmQgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb21tYW5kID0gdGhpcy5maWVsZC5jb21tYW5kIHx8IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmZpZWxkID8gYGluc2VydF9fJHt0aGlzLmZpZWxkLmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwifV9fJHt0aGlzLmZpZWxkLm5hbWV9YCA6IFwiXCIsXG4gICAgICAgICAgICBpY29uOiBcImxpc3QtcGx1c1wiLFxuICAgICAgICAgICAgbGFiZWw6IHRoaXMuZmllbGQgPyBgSW5zZXJ0ICR7dGhpcy5maWVsZC5uYW1lfSBmaWVsZGAgOiBcIlwiLFxuICAgICAgICAgICAgaG90a2V5OiB1bmRlZmluZWRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICAgICAgLy90aXRsZVxuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dCh0aGlzLmF0dHIgPyBgTWFuYWdlICR7dGhpcy5hdHRyLm5hbWV9YCA6IGBDcmVhdGUgYSBuZXcgYXR0cmlidXRlIGZvciAke3RoaXMuZmlsZUNsYXNzLm5hbWV9YCk7XG5cbiAgICAgICAgLyogTmFtZSAqL1xuICAgICAgICB0aGlzLmJ1aWxkTmFtZUlucHV0Q29udGFpbmVyKCk7XG4gICAgICAgIHRoaXMuYnVpbGRIZWFkZXIoKTtcbiAgICAgICAgdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICAvKiBDb21tYW5kICovXG4gICAgICAgIHRoaXMuYnVpbGRDb21tYW5kQ29udGFpbmVyKCk7XG5cbiAgICAgICAgLyogVHlwZSAqL1xuICAgICAgICBjb25zdCB0eXBlU2VsZWN0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgICAgIC8qIE9wdGlvbnMgKi9cbiAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcblxuICAgICAgICAvLyBmb290ZXIgYnV0dG9uc1xuICAgICAgICBjb25zdCBmb290ZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KTtcbiAgICAgICAgZm9vdGVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZVNhdmVCdG4oZm9vdGVyKTtcbiAgICAgICAgaWYgKHRoaXMuYXR0cikgdGhpcy5jcmVhdGVSZW1vdmVsQnRuKGZvb3Rlcik7XG4gICAgICAgIHRoaXMuY3JlYXRlQ2FuY2VsQnRuKGZvb3Rlcik7XG5cbiAgICAgICAgLyogaW5pdCBzdGF0ZSAqL1xuICAgICAgICB0aGlzLmJ1aWxkVHlwZVNlbGVjdENvbnRhaW5lcih0eXBlU2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIuY3JlYXRlU2V0dGluZ0NvbnRhaW5lcih0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciwgdGhpcy5wbHVnaW4sIFNldHRpbmdMb2NhdGlvbi5GaWxlQ2xhc3NBdHRyaWJ1dGVTZXR0aW5ncyk7XG5cbiAgICB9XG5cbiAgICBidWlsZE5hbWVJbnB1dENvbnRhaW5lcigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibGFiZWxcIiwgdGV4dDogXCJGaWVsZCBOYW1lOiBcIiB9KTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgaW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIHRoaXMuYXR0ciA/IGlucHV0LnNldFZhbHVlKHRoaXMuZmllbGQubmFtZSkgOiBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIk5hbWUgb2YgdGhlIGZpZWxkXCIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jb21tYW5kLmlkID0gYGluc2VydF9fJHt0aGlzLmZpZWxkLmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwifV9fJHt2YWx1ZX1gXG4gICAgICAgICAgICB0aGlzLmNvbW1hbmQubGFiZWwgPSBgSW5zZXJ0ICR7dmFsdWV9IGZpZWxkYFxuICAgICAgICAgICAgdGhpcy5hdHRyTmFtZS5zZXRUZXh0KGA8JHt2YWx1ZX0+YCk7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGlucHV0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubmFtZUlucHV0ID0gaW5wdXRcbiAgICB9XG5cbiAgICBidWlsZENvbW1hbmRDb250YWluZXIoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbW1hbmRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcblxuICAgICAgICAvL2xhYmVsXG4gICAgICAgIGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJzZXQgYSBjb21tYW5kIGZvciB0aGlzIGZpZWxkP1wiLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIC8vYWRkIGNvbW1hbmRcbiAgICAgICAgY29uc3QgYWRkQ29tbWFuZFRvZ2dsZXIgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGNvbW1hbmRDb250YWluZXIpO1xuICAgICAgICBhZGRDb21tYW5kVG9nZ2xlci5zZXRWYWx1ZSh0aGlzLmFkZENvbW1hbmQpO1xuXG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICB0aGlzLmFkZENvbW1hbmQgPyBpY29uQ29udGFpbmVyLnNob3coKSA6IGljb25Db250YWluZXIuaGlkZSgpO1xuXG4gICAgICAgIC8vIGljb25cbiAgICAgICAgaWNvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcIkljb24gbmFtZVwiLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgdGhpcy5pY29uTmFtZSA9IG5ldyBUZXh0Q29tcG9uZW50KGljb25Db250YWluZXIpO1xuICAgICAgICB0aGlzLmljb25OYW1lLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLmljb25OYW1lLmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICBjb25zdCBpY29uUHJldmlldyA9IGljb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tcHJldmlld1wiIH0pXG4gICAgICAgIHRoaXMuaWNvbk5hbWUuc2V0VmFsdWUodGhpcy5jb21tYW5kLmljb24pXG4gICAgICAgIHNldEljb24oaWNvblByZXZpZXcsIHRoaXMuY29tbWFuZC5pY29uKVxuICAgICAgICB0aGlzLmljb25OYW1lLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5pY29uID0gdmFsdWU7XG4gICAgICAgICAgICBzZXRJY29uKGljb25QcmV2aWV3LCB2YWx1ZSlcbiAgICAgICAgfSlcblxuICAgICAgICBhZGRDb21tYW5kVG9nZ2xlci5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmFkZENvbW1hbmQgPSB2YWx1ZVxuICAgICAgICAgICAgdGhpcy5hZGRDb21tYW5kID8gaWNvbkNvbnRhaW5lci5zaG93KCkgOiBpY29uQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYnVpbGRIZWFkZXIoKTogdm9pZCB7XG4gICAgICAgIC8vaGVhZGVyIGZvciBzZWxlY3RcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RIZWFkZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGF0dHJMaW5lID0gdHlwZVNlbGVjdEhlYWRlci5jcmVhdGVFbChcImRpdlwiKTtcbiAgICAgICAgdGhpcy5hdHRyTmFtZSA9IGF0dHJMaW5lLmNyZWF0ZUVsKFwic3Ryb25nXCIpO1xuICAgICAgICB0aGlzLmF0dHJOYW1lLnNldFRleHQoYDwke3RoaXMuZmllbGQubmFtZX0+YCk7XG4gICAgICAgIGF0dHJMaW5lLmFwcGVuZChgIGF2YWlsYWJsZSBpbiBmaWxlcyB3aXRoICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXN9ID0gJHt0aGlzLmZpZWxkLmZpbGVDbGFzc05hbWV9YCk7XG5cbiAgICB9XG5cbiAgICBidWlsZFR5cGVTZWxlY3RDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuXG4gICAgICAgIC8vZHJvcGRvd25cbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdG9yQ29udGFpbmVyTGFiZWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIHR5cGVTZWxlY3RvckNvbnRhaW5lckxhYmVsLnNldFRleHQoYEZpZWxkIHR5cGU6YCk7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBPYmplY3Qua2V5cyhGaWVsZFR5cGVUb29sdGlwKS5mb3JFYWNoKChrZXk6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUpID0+IHR5cGVTZWxlY3QuYWRkT3B0aW9uKGtleSwgRmllbGRUeXBlVG9vbHRpcFtrZXldKSlcbiAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSkge1xuICAgICAgICAgICAgdHlwZVNlbGVjdC5zZXRWYWx1ZSh0aGlzLmZpZWxkLnR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHR5cGVTZWxlY3Qub25DaGFuZ2UoKHR5cGVMYWJlbDoga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuZmllbGQsIHRoaXMuaW5pdGlhbEZpZWxkKTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSA9IHRoaXMubmFtZUlucHV0LmdldFZhbHVlKClcbiAgICAgICAgICAgIHRoaXMuZmllbGQudHlwZSA9IEZpZWxkVHlwZUxhYmVsTWFwcGluZ1t0eXBlTGFiZWxdO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSAhPT0gdGhpcy5pbml0aWFsRmllbGQudHlwZSAmJlxuICAgICAgICAgICAgICAgICFbdGhpcy5maWVsZC50eXBlLCB0aGlzLmluaXRpYWxGaWVsZC50eXBlXS5ldmVyeShmaWVsZFR5cGUgPT5cbiAgICAgICAgICAgICAgICAgICAgW0ZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLkN5Y2xlXS5pbmNsdWRlcyhmaWVsZFR5cGUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZClcbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyLmNyZWF0ZVNldHRpbmdDb250YWluZXIodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIsIHRoaXMucGx1Z2luLCBTZXR0aW5nTG9jYXRpb24uRmlsZUNsYXNzQXR0cmlidXRlU2V0dGluZ3MpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZUZpZWxkcygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGRNYW5hZ2VyLnZhbGlkYXRlTmFtZShcbiAgICAgICAgICAgIHRoaXMubmFtZUlucHV0LFxuICAgICAgICAgICAgdGhpcy5jb250ZW50RWxcbiAgICAgICAgKSAmJlxuICAgICAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIudmFsaWRhdGVPcHRpb25zKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVTYXZlQnRuKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRUb29sdGlwKFwiU2F2ZVwiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGVycm9yID0gIXRoaXMudmFsaWRhdGVGaWVsZHMoKTtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGaXggZXJyb3JzIGJlZm9yZSBzYXZpbmcuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGhpcy5hZGRDb21tYW5kKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5jb21tYW5kID0gdGhpcy5jb21tYW5kXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmZpZWxkLmNvbW1hbmRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZSh0aGlzLmZpZWxkLnR5cGUsIHRoaXMuZmllbGQubmFtZSwgdGhpcy5maWVsZC5vcHRpb25zLCB0aGlzLmF0dHIsIHRoaXMuZmllbGQuY29tbWFuZCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVSZW1vdmVsQnRuKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmVtb3ZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICByZW1vdmVCdXR0b24uc2V0SWNvbihcInRyYXNoXCIpO1xuICAgICAgICByZW1vdmVCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb25maXJtTW9kYWwgPSBuZXcgTW9kYWwodGhpcy5wbHVnaW4uYXBwKTtcbiAgICAgICAgICAgIGNvbmZpcm1Nb2RhbC5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiUGxlYXNlIGNvbmZpcm1cIik7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwuY29udGVudEVsLmNyZWF0ZURpdigpLnNldFRleHQoYERvIHlvdSByZWFsbHkgd2FudCB0byByZW1vdmUgJHt0aGlzLmF0dHI/Lm5hbWV9IGF0dHJpYnV0ZSBmcm9tICR7dGhpcy5maWxlQ2xhc3MubmFtZX0/YCk7XG4gICAgICAgICAgICBjb25zdCBjb25maXJtRm9vdGVyID0gY29uZmlybU1vZGFsLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KTtcbiAgICAgICAgICAgIGNvbmZpcm1Gb290ZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgICAgICBjb25zdCBjb25maXJtQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb25maXJtRm9vdGVyKTtcbiAgICAgICAgICAgIGNvbmZpcm1CdXR0b24uc2V0V2FybmluZygpO1xuICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdHRyKSB0aGlzLmZpbGVDbGFzcy5yZW1vdmVBdHRyaWJ1dGUodGhpcy5hdHRyKTtcbiAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgY29uc3QgZGlzbWlzc0J1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29uZmlybUZvb3Rlcik7XG4gICAgICAgICAgICBkaXNtaXNzQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgICAgIGRpc21pc3NCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICAgICAgICAgICAgY29uZmlybU1vZGFsLm9wZW4oKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ0bihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgc2V0SWNvbiwgVGV4dEFyZWFDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBJbnB1dE1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2ZpZWxkcy9JbnB1dE1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5wdXRGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5JbnB1dClcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IElucHV0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgVmFsdWUgZm9yIDwke25hbWV9PmApO1xuICAgICAgICBjb25zdCBpY29uTmFtZSA9IEZpZWxkSWNvbltGaWVsZFR5cGUuSW5wdXRdO1xuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG4gICAgICAgIGlmIChJbnB1dEZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKGljb25OYW1lKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoSW5wdXRGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogaWNvbk5hbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKElucHV0RmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5JbnB1dF0sIGFjdGlvbiwgYFVwZGF0ZSAke25hbWV9J3MgdmFsdWVgKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSk6IHZvaWQge1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJUZW1wbGF0ZVwiLCBjbHM6ICdsYWJlbCcgfSlcbiAgICAgICAgY29uc3QgdGVtcGxhdGVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBjb25zdCB0ZW1wbGF0ZVZhbHVlID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KHRlbXBsYXRlQ29udGFpbmVyKVxuICAgICAgICB0ZW1wbGF0ZVZhbHVlLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICB0ZW1wbGF0ZVZhbHVlLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRlbXBsYXRlVmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIilcbiAgICAgICAgdGVtcGxhdGVWYWx1ZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMudGVtcGxhdGUgfHwgXCJcIilcbiAgICAgICAgdGVtcGxhdGVWYWx1ZS5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnRlbXBsYXRlID0gdmFsdWU7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgLy9hbHdheXMgdHJ1ZSBzaW5jZSB0aGVyZSBhcmUgbm8gb3B0aW9uc1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBJbnB1dE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM6IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSA9IHt9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGF0dHJzLmNscyA9IFwidmFsdWUtY29udGFpbmVyXCJcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IChkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpIGFzIEhUTUxEaXZFbGVtZW50KTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHt9KTtcbiAgICAgICAgaW5wdXRDb250YWluZXIuaGlkZSgpO1xuICAgICAgICBjb25zdCBpbnB1dCA9IGlucHV0Q29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIik7XG4gICAgICAgIGlucHV0LnZhbHVlID0gcFt0aGlzLmZpZWxkLm5hbWVdO1xuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXItMVwiIH0pO1xuICAgICAgICBpZiAoYXR0cnMub3B0aW9ucz8uYWx3YXlzT24pIHNwYWNlci5oaWRlKCk7XG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGVkaXRCdG4gPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKTtcbiAgICAgICAgc2V0SWNvbihlZGl0QnRuLCBGaWVsZEljb25bRmllbGRUeXBlLklucHV0XSk7XG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBlZGl0QnRuLmhpZGUoKTtcbiAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWlucHV0Q29udGFpbmVyLmlzU2hvd24oKSkge1xuICAgICAgICAgICAgICAgICAgICBlZGl0QnRuLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVkaXRCdG4uaGlkZSgpO1xuICAgICAgICAgICAgICAgIGlmICghYXR0cnMub3B0aW9ucz8uYWx3YXlzT24pIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB2YWxpZGF0ZUljb24gPSBpbnB1dENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKTtcbiAgICAgICAgc2V0SWNvbih2YWxpZGF0ZUljb24sIFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICB2YWxpZGF0ZUljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBJbnB1dEZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0LnZhbHVlKTtcbiAgICAgICAgICAgIGlucHV0Q29udGFpbmVyLmhpZGUoKVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNhbmNlbEljb24gPSBpbnB1dENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKTtcbiAgICAgICAgc2V0SWNvbihjYW5jZWxJY29uLCBcImNyb3NzXCIpO1xuICAgICAgICBjYW5jZWxJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgaW5wdXRDb250YWluZXIuaGlkZSgpO1xuICAgICAgICAgICAgZmllbGRWYWx1ZS5zaG93KCk7XG4gICAgICAgICAgICBlZGl0QnRuLnNob3coKTtcbiAgICAgICAgICAgIGlmICghYXR0cnMub3B0aW9ucz8uYWx3YXlzT24pIHNwYWNlci5zaG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgaW5wdXQuZm9jdXMoKVxuXG4gICAgICAgIGlucHV0Lm9ua2V5ZG93biA9IChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIElucHV0RmllbGQucmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgcC5maWxlLnBhdGgsIHRoaXMuZmllbGQubmFtZSwgaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgICAgIGlucHV0Q29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgICAgICAgICBpbnB1dENvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgZmllbGRWYWx1ZS5zaG93KCk7XG4gICAgICAgICAgICAgICAgZWRpdEJ0bi5zaG93KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFhdHRycy5vcHRpb25zPy5hbHdheXNPbikgc3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBidXR0b24gb24gY2xpY2sgOiByZW1vdmUgYnV0dG9uIGFuZCBmaWVsZCBhbmQgZGlzcGxheSBpbnB1dCBmaWVsZCovXG4gICAgICAgIGVkaXRCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMudGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwLmZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnB1dE1vZGFsID0gbmV3IElucHV0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0TW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5wdXRDb250YWluZXIuc2hvdygpO1xuICAgICAgICAgICAgICAgIGlucHV0LmZvY3VzKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkVmFsdWUuaGlkZSgpO1xuICAgICAgICAgICAgZWRpdEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBzcGFjZXIuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgc2V0SWNvbiwgVGV4dEFyZWFDb21wb25lbnQsIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIElucHV0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSB0ZW1wbGF0ZVZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgIHByaXZhdGUgcmVuZGVyZWRWYWx1ZTogVGV4dEFyZWFDb21wb25lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkgeyBzdXBlcihwbHVnaW4uYXBwKTsgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGVGaWVsZFJlZ2V4ID0gbmV3IFJlZ0V4cChgXFxcXHtcXFxceyg/PGZpZWxkPlteXFxcXH1dKz8pXFxcXH1cXFxcfWAsIFwiZ3VcIik7XG4gICAgICAgICAgICBjb25zdCB0RiA9IHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZS5tYXRjaEFsbCh0ZW1wbGF0ZUZpZWxkUmVnZXgpXG4gICAgICAgICAgICBsZXQgbmV4dCA9IHRGLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbmV4dC52YWx1ZS5ncm91cHMuZmllbGRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgW25hbWUsIG9wdGlvbnNTdHJpbmddID0gdmFsdWUuc3BsaXQoLzooLiopL3MpLm1hcCgodjogc3RyaW5nKSA9PiB2LnRyaW0oKSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wbGF0ZVZhbHVlc1tuYW1lXSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0gSlNPTi5wYXJzZShvcHRpb25zU3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRUZW1wbGF0ZVNlbGVjdEl0ZW0odGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pLCBuYW1lLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRUZW1wbGF0ZUlucHV0SXRlbSh0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSksIG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5leHQgPSB0Ri5uZXh0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IHRleHQ6IFwiUmVzdWx0IHByZXZpZXdcIiB9KTtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRSZXN1bHRQcmV2aWV3KHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KSk7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkU2F2ZUJ0bih0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkSW5wdXRFbCh0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgfTtcblxuICAgIHByaXZhdGUgcmVuZGVyVmFsdWUoKSB7XG4gICAgICAgIGxldCByZW5kZXJlZFN0cmluZyA9IHRoaXMuZmllbGQub3B0aW9ucy50ZW1wbGF0ZS5zbGljZSgpXG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMudGVtcGxhdGVWYWx1ZXMpLmZvckVhY2goayA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZFJlZ2V4ID0gbmV3IFJlZ0V4cChgXFxcXHtcXFxceyR7ay5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpfSg6W15cXFxcfV0qKT9cXFxcfVxcXFx9YCwgXCJ1XCIpXG4gICAgICAgICAgICByZW5kZXJlZFN0cmluZyA9IHJlbmRlcmVkU3RyaW5nLnJlcGxhY2UoZmllbGRSZWdleCwgdGhpcy50ZW1wbGF0ZVZhbHVlc1trXSlcbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLnJlbmRlcmVkVmFsdWUuc2V0VmFsdWUocmVuZGVyZWRTdHJpbmcpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZFRlbXBsYXRlSW5wdXRJdGVtKGZpZWxkQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgbmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiBuYW1lIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgaW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihgRW50ZXIgYSB2YWx1ZSBmb3IgJHtuYW1lfWApO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlVmFsdWVzW25hbWVdID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnJlbmRlclZhbHVlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRUZW1wbGF0ZVNlbGVjdEl0ZW0oZmllbGRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IHN0cmluZ1tdKSB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IG5hbWUsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3Qgc2VsZWN0RWwgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJcIiwgXCItLXNlbGVjdC0tXCIpXG4gICAgICAgIG9wdGlvbnMuZm9yRWFjaChvID0+IHNlbGVjdEVsLmFkZE9wdGlvbihvLCBvKSk7XG4gICAgICAgIHNlbGVjdEVsLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVWYWx1ZXNbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyVmFsdWUoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkUmVzdWx0UHJldmlldyhmaWVsZENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5yZW5kZXJlZFZhbHVlID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKVxuICAgICAgICB0aGlzLnJlbmRlcmVkVmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIilcbiAgICAgICAgdGhpcy5yZW5kZXJlZFZhbHVlLmlucHV0RWwucm93cyA9IDM7XG4gICAgICAgIHRoaXMucmVuZGVyZWRWYWx1ZS5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkU2F2ZUJ0bihmaWVsZENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IHNhdmVCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgc2F2ZUJ0bi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnRuLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGlucHV0VmFsdWUgPSB0aGlzLnJlbmRlcmVkVmFsdWUuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0VmFsdWUpIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGlucHV0RWwuaW5wdXRFbC5mb2N1cygpO1xuICAgICAgICBpbnB1dEVsLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBpbnB1dEVsLnNldFZhbHVlKGAke3RoaXMudmFsdWV9YCk7XG4gICAgICAgIGNvbnN0IHNhdmVCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIHNhdmVCdG4uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ0bi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlID0gaW5wdXRFbC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dFZhbHVlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KSB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyB9IGZyb20gXCIuL2luc2VydEZyb250bWF0dGVyV2l0aEZpZWxkc1wiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5zZXJ0VmFsdWVzKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZyxcbiAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICB2YWx1ZTogc3RyaW5nLFxuICAgIGxpbmVOdW1iZXI/OiBudW1iZXIsXG4gICAgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sXG4gICAgYWZ0ZXI6IGJvb2xlYW4gPSB0cnVlLFxuICAgIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPckZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPckZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yRmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBmcm9udG1hdHRlciA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyXG4gICAgaWYgKGluRnJvbnRtYXR0ZXIgJiYgbGluZU51bWJlciA9PSAtMiAmJiAhZnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgY29uc3QgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cbiAgICAgICAgZmllbGRzW2ZpZWxkTmFtZV0gPSB2YWx1ZVxuICAgICAgICBhd2FpdCBpbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHMocGx1Z2luLCBmaWxlLCBmaWVsZHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuICAgICAgICBsZXQgbmV3Q29udGVudDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgY29uc3QgdGFyZ2V0TGluZU51bWJlciA9IGluRnJvbnRtYXR0ZXIgJiYgbGluZU51bWJlciA9PSAtMiAmJiBmcm9udG1hdHRlciA/XG4gICAgICAgICAgICBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZSA6IGxpbmVOdW1iZXJcbiAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBpZiAoX2xpbmVOdW1iZXIgPT0gdGFyZ2V0TGluZU51bWJlcikge1xuICAgICAgICAgICAgICAgIGlmIChhZnRlcikgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld0xpbmUgPSBgJHshaW5Gcm9udG1hdHRlciAmJiBhc0NvbW1lbnQgPyBcIj5cIiA6IFwiXCJ9JHshaW5Gcm9udG1hdHRlciAmJiBhc0xpc3QgPyBcIi0gXCIgOiBcIlwifSR7ZmllbGROYW1lfSR7aW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke3ZhbHVlfWA7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKG5ld0xpbmUpO1xuICAgICAgICAgICAgICAgIGlmICghYWZ0ZXIpIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3JcbiAgICAgICAgaWYgKGVkaXRvcikge1xuICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lXG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogZWRpdG9yLmdldEN1cnNvcigpLmxpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShsaW5lTnVtYmVyKS5sZW5ndGggfSlcbiAgICAgICAgfVxuICAgIH1cblxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNYXJrZG93blZpZXcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLFxuICAgIGZpZWxkczogUmVjb3JkPHN0cmluZywgc3RyaW5nPixcbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGxldCBmaWxlOiBURmlsZTtcbiAgICBpZiAoZmlsZU9yRmlsZVBhdGggaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICBmaWxlID0gZmlsZU9yRmlsZVBhdGg7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgX2ZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlT3JGaWxlUGF0aClcbiAgICAgICAgaWYgKF9maWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgX2ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmlsZSA9IF9maWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IFwiLS0tXFxuXCIgKyBPYmplY3QuZW50cmllcyhmaWVsZHMpLm1hcCgoW2ZpZWxkTmFtZSwgdmFsdWVdKSA9PiBgJHtmaWVsZE5hbWV9OiAke3ZhbHVlfWApLmpvaW4oXCJcXG5cIikgKyAoXCJcXG4tLS1cXG5cIilcblxuICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGZyb250bWF0dGVyICsgY29udGVudCk7XG4gICAgY29uc3QgZWRpdG9yID0gcGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3JcbiAgICBpZiAoZWRpdG9yKSB7XG4gICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZVxuICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogZWRpdG9yLmdldEN1cnNvcigpLmxpbmUsIGNoOiBlZGl0b3IuZ2V0TGluZShsaW5lTnVtYmVyKS5sZW5ndGggfSlcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCAqIGFzIExvb2t1cCBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdldExpc3RCb3VuZHMgfSBmcm9tIFwic3JjL3V0aWxzL2xpc3RcIjtcbmltcG9ydCB7IGZpZWxkQ29tcG9uZW50cywgaW5saW5lRmllbGRSZWdleCwgZW5jb2RlTGluaywgZGVjb2RlTGluayB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5cbmNvbnN0IGVudW0gTG9jYXRpb24ge1xuICAgICdmdWxsTGluZScgPSAnZnVsbExpbmUnLFxuICAgICdicmFja2V0cycgPSAnYnJhY2tldHMnLFxuICAgICdwYXJlbnRoZXNpcycgPSAncGFyZW50aGVzaXMnXG59XG5cbmNvbnN0IExvY2F0aW9uV3JhcHBlcjogUmVjb3JkPGtleW9mIHR5cGVvZiBMb2NhdGlvbiwgeyBzdGFydDogXCJcIiB8IFwiW1wiIHwgXCIoXCIsIGVuZDogXCJcIiB8IFwiXVwiIHwgXCIpXCIgfT4gPSB7XG4gICAgXCJmdWxsTGluZVwiOiB7IHN0YXJ0OiBcIlwiLCBlbmQ6IFwiXCIgfSxcbiAgICBcImJyYWNrZXRzXCI6IHsgc3RhcnQ6IFwiW1wiLCBlbmQ6IFwiXVwiIH0sXG4gICAgXCJwYXJlbnRoZXNpc1wiOiB7IHN0YXJ0OiBcIihcIiwgZW5kOiBcIilcIiB9XG59XG5cbnR5cGUgRmllbGRSZXBsYWNlID0ge1xuICAgIG9sZEZpZWxkOiBzdHJpbmcsXG4gICAgbmV3RmllbGQ6IHN0cmluZyxcbn1cblxuZXhwb3J0IGNvbnN0IG1hdGNoSW5saW5lRmllbGRzID0gKHJlZ2V4OiBSZWdFeHAsIGxpbmU6IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcsIGxvY2F0aW9uOiBrZXlvZiB0eXBlb2YgTG9jYXRpb24gPSBcImZ1bGxMaW5lXCIpOiBGaWVsZFJlcGxhY2VbXSA9PiB7XG4gICAgY29uc3Qgc1IgPSBsaW5lLm1hdGNoQWxsKHJlZ2V4KTtcbiAgICBsZXQgbmV4dCA9IHNSLm5leHQoKTtcbiAgICBjb25zdCBuZXdGaWVsZHM6IEZpZWxkUmVwbGFjZVtdID0gW107XG4gICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBuZXh0LnZhbHVlO1xuICAgICAgICBpZiAobWF0Y2guZ3JvdXBzICYmIE9iamVjdC5rZXlzKG1hdGNoLmdyb3VwcykuZXZlcnkoaiA9PiBmaWVsZENvbXBvbmVudHMuaW5jbHVkZXMoaikpKSB7XG4gICAgICAgICAgICBjb25zdCB7IGluTGlzdCwgaW5RdW90ZSwgc3RhcnRTdHlsZSwgZW5kU3R5bGUsIGJlZm9yZVNlcGFyYXRvclNwYWNlciwgYWZ0ZXJTZXBhcmF0b3JTcGFjZXIsIHZhbHVlcyB9ID0gbWF0Y2guZ3JvdXBzXG4gICAgICAgICAgICBjb25zdCBpbnB1dEFycmF5ID0gaW5wdXQgPyBpbnB1dC5yZXBsYWNlKC8oXFwsXFxzKykvZywgJywnKS5zcGxpdCgnLCcpIDogW1wiXCJdO1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkuam9pbignLCAnKX1gO1xuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBMb2NhdGlvbldyYXBwZXJbbG9jYXRpb25dLnN0YXJ0O1xuICAgICAgICAgICAgY29uc3QgZW5kID0gTG9jYXRpb25XcmFwcGVyW2xvY2F0aW9uXS5lbmQ7XG4gICAgICAgICAgICBuZXdGaWVsZHMucHVzaCh7XG4gICAgICAgICAgICAgICAgb2xkRmllbGQ6IG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgIG5ld0ZpZWxkOiBgJHtpblF1b3RlIHx8IFwiXCJ9JHtzdGFydH0ke2luTGlzdCB8fCBcIlwifSR7c3RhcnRTdHlsZX0ke2F0dHJpYnV0ZX0ke2VuZFN0eWxlfSR7YmVmb3JlU2VwYXJhdG9yU3BhY2VyfTo6JHthZnRlclNlcGFyYXRvclNwYWNlcn0ke25ld1ZhbHVlfSR7ZW5kfWAsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIG5leHQgPSBzUi5uZXh0KClcbiAgICB9XG4gICAgcmV0dXJuIG5ld0ZpZWxkc1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVwbGFjZVZhbHVlcyhcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsXG4gICAgYXR0cmlidXRlOiBzdHJpbmcsXG4gICAgaW5wdXQ6IHN0cmluZyxcbiAgICBwcmV2aW91c0l0ZW1zQ291bnQ6IG51bWJlciA9IDBcbik6IFByb21pc2U8dm9pZD4ge1xuICAgIGxldCBmaWxlOiBURmlsZTtcbiAgICBpZiAoZmlsZU9yRmlsZVBhdGggaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICBmaWxlID0gZmlsZU9yRmlsZVBhdGg7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgX2ZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlT3JGaWxlUGF0aClcbiAgICAgICAgaWYgKF9maWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgX2ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmlsZSA9IF9maWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGNvbnRlbnQgPSAoYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpKS5zcGxpdCgnXFxuJyk7XG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcjtcbiAgICAvL2ZpcnN0IGxvb2sgZm9yIGxvb2t1cCBsaXN0c1xuXG4gICAgY29uc3Qgc2tpcHBlZExpbmVzOiBudW1iZXJbXSA9IFtdXG5cbiAgICBjb25zdCB7IHBvc2l0aW9uOiB7IHN0YXJ0LCBlbmQgfSB9ID0gZnJvbnRtYXR0ZXIgPyBmcm9udG1hdHRlciA6IHsgcG9zaXRpb246IHsgc3RhcnQ6IHVuZGVmaW5lZCwgZW5kOiB1bmRlZmluZWQgfSB9O1xuICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBjb250ZW50Lm1hcCgobGluZSwgaSkgPT4ge1xuICAgICAgICBpZiAoc3RhcnQgJiYgZW5kICYmIGkgPj0gc3RhcnQubGluZSAmJiBpIDw9IGVuZC5saW5lKSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYF4ke2F0dHJpYnV0ZX06YCwgJ3UnKTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBsaW5lLm1hdGNoKHJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChyICYmIHIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSBpbnB1dCA/IGlucHV0LnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykgOiBbXCJcIl07XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGBbJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9XWA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2F0dHJpYnV0ZX06ICR7bmV3VmFsdWV9YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlbmNvZGVkSW5wdXQgPSBlbmNvZGVMaW5rKGlucHV0KVxuICAgICAgICAgICAgbGV0IGVuY29kZWRMaW5lID0gZW5jb2RlTGluayhsaW5lKVxuICAgICAgICAgICAgY29uc3QgZnVsbExpbmVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX0oPzx2YWx1ZXM+W15cXFxcXV0qKWAsIFwidVwiKTtcbiAgICAgICAgICAgIGNvbnN0IGZSID0gZW5jb2RlZExpbmUubWF0Y2goZnVsbExpbmVSZWdleCk7XG4gICAgICAgICAgICBpZiAoZlI/Lmdyb3VwcyAmJiBPYmplY3Qua2V5cyhmUi5ncm91cHMpLmV2ZXJ5KGogPT4gZmllbGRDb21wb25lbnRzLmluY2x1ZGVzKGopKSkge1xuICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgdGhpcyBmaWVsZCBpcyBhIGxvb2t1cCBhbmQgZ2V0IGxpc3QgYm91bmRhcmllc1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZiA9PiBmLm5hbWUgPT09IGF0dHJpYnV0ZSlcbiAgICAgICAgICAgICAgICBpZiAoZmllbGQ/LnR5cGUgPT09IEZpZWxkVHlwZS5Mb29rdXApIHtcblxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKHByZXZpb3VzSXRlbXNDb3VudClcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYm91bmRzID0gZ2V0TGlzdEJvdW5kcyhwbHVnaW4sIGZpbGUsIGkpXG4gICAgICAgICAgICAgICAgICAgIGlmIChib3VuZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgc3RhcnQsIGVuZCB9ID0gYm91bmRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IHN0YXJ0ICsgMTsgaiA8IHN0YXJ0ICsgcHJldmlvdXNJdGVtc0NvdW50ICsgMSAmJiBqIDwgZW5kICsgMTsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZExpbmVzLnB1c2goailcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCB7IGluTGlzdCwgaW5RdW90ZSwgc3RhcnRTdHlsZSwgZW5kU3R5bGUsIGJlZm9yZVNlcGFyYXRvclNwYWNlciwgYWZ0ZXJTZXBhcmF0b3JTcGFjZXIsIHZhbHVlcyB9ID0gZlIuZ3JvdXBzXG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXRBcnJheSA9IGlucHV0ID8gaW5wdXQucmVwbGFjZSgvKFxcLFxccyspL2csICcsJykuc3BsaXQoJywnKS5zb3J0KCkgOiBbXTtcbiAgICAgICAgICAgICAgICBsZXQgbmV3VmFsdWU6IHN0cmluZztcbiAgICAgICAgICAgICAgICBsZXQgaGlkZGVuVmFsdWUgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkPy50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwICYmIExvb2t1cC5idWxsZXRMaXN0TG9va3VwVHlwZXMuaW5jbHVkZXMoZmllbGQ/Lm9wdGlvbnMub3V0cHV0VHlwZSBhcyBMb29rdXAuVHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gXCJcXG4tIFwiICsgaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkubGVuZ3RoID4gMCA/IFwiXFxuXCIgOiBcIlwifSR7aW5wdXRBcnJheS5tYXAoaXRlbSA9PiBcIi0gXCIgKyBpdGVtKS5qb2luKCdcXG4nKX1gO1xuICAgICAgICAgICAgICAgICAgICAvLyBoaWRlIHRoZSB2YWx1ZXMgbmV4dCB0byB0aGUgZmllbGQgc28gdGhhdCB0aGV5IGFyZSByZWFkYWJsZSBieSBnZXRWYWx1ZXMuIFxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIGdldFZhbHVlcyBpbnN0ZWFkIG9mIGR2LnBhZ2UgdG8gaGF2ZSB0aGUgcmF3VmFsdWUgYmVjYXVzZSBkdiBpcyB0cmFuc2Zvcm1pbmcgZGF0YSwgbWFraW5nIGNvbXBhcmlzb24gaW1wb3NzaWJsZVxuICAgICAgICAgICAgICAgICAgICBoaWRkZW5WYWx1ZSA9IGA8ZGl2IGhpZGRlbiBpZD1cIiR7ZmllbGQubmFtZX1fdmFsdWVzXCI+JHtpbnB1dH08L2Rpdj5gXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkuam9pbignLCAnKX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7aW5RdW90ZSB8fCBcIlwifSR7aW5MaXN0IHx8IFwiXCJ9JHtzdGFydFN0eWxlfSR7YXR0cmlidXRlfSR7ZW5kU3R5bGV9JHtiZWZvcmVTZXBhcmF0b3JTcGFjZXJ9Ojoke2FmdGVyU2VwYXJhdG9yU3BhY2VyfSR7aGlkZGVuVmFsdWUgKyBuZXdWYWx1ZX1gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGaWVsZHM6IEZpZWxkUmVwbGFjZVtdID0gW107XG4gICAgICAgICAgICAgICAgY29uc3QgaW5TZW50ZW5jZVJlZ2V4QnJhY2tldHMgPSBuZXcgUmVnRXhwKGBcXFxcWyR7aW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpfSg/PHZhbHVlcz5bXlxcXFxdXSspP1xcXFxdYCwgXCJndVwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhQYXIgPSBuZXcgUmVnRXhwKGBcXFxcKCR7aW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpfSg/PHZhbHVlcz5bXlxcXFwpXSspP1xcXFwpYCwgXCJndVwiKTtcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5tYXRjaElubGluZUZpZWxkcyhpblNlbnRlbmNlUmVnZXhCcmFja2V0cywgZW5jb2RlZExpbmUsIGF0dHJpYnV0ZSwgZW5jb2RlZElucHV0LCBMb2NhdGlvbi5icmFja2V0cykpXG4gICAgICAgICAgICAgICAgbmV3RmllbGRzLnB1c2goLi4ubWF0Y2hJbmxpbmVGaWVsZHMoaW5TZW50ZW5jZVJlZ2V4UGFyLCBlbmNvZGVkTGluZSwgYXR0cmlidXRlLCBlbmNvZGVkSW5wdXQsIExvY2F0aW9uLnBhcmVudGhlc2lzKSlcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkUmVnZXggPSBuZXcgUmVnRXhwKGZpZWxkLm9sZEZpZWxkLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyksIFwidVwiKVxuICAgICAgICAgICAgICAgICAgICBlbmNvZGVkTGluZSA9IGVuY29kZWRMaW5lLnJlcGxhY2UoZmllbGRSZWdleCwgZmllbGQubmV3RmllbGQpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZUxpbmsoZW5jb2RlZExpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0ZWQgd3JpdGluZy4uLlwiLCBpbnB1dClcbiAgICBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmZpbHRlcigobGluZSwgaSkgPT4gIXNraXBwZWRMaW5lcy5pbmNsdWRlcyhpKSkuam9pbignXFxuJykpO1xuICAgIC8vY29uc29sZS5sb2coXCJmaW5pc2hlZCB3cml0aW5nLi4uXCIsIGlucHV0KVxuICAgIGNvbnN0IGVkaXRvciA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZWRpdG9yXG4gICAgaWYgKGVkaXRvcikge1xuICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gZWRpdG9yLmdldEN1cnNvcigpLmxpbmVcbiAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGVkaXRvci5nZXRDdXJzb3IoKS5saW5lLCBjaDogZWRpdG9yLmdldExpbmUobGluZU51bWJlcikubGVuZ3RoIH0pXG4gICAgfVxufSIsICJleHBvcnQgZW51bSBCdWlsdGluU3VtbWFyaXppbmcge1xuICAgIFwiU3VtXCIgPSBcIlN1bVwiLFxuICAgIFwiQ291bnRcIiA9IFwiQ291bnRcIixcbiAgICBcIkNvdW50QWxsXCIgPSBcIkNvdW50QWxsXCIsXG4gICAgXCJBdmVyYWdlXCIgPSBcIkF2ZXJhZ2VcIixcbiAgICBcIk1heFwiID0gXCJNYXhcIixcbiAgICBcIk1pblwiID0gXCJNaW5cIlxufVxuXG5leHBvcnQgY29uc3QgQnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb25EZXNjcmlwdGlvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBCdWlsdGluU3VtbWFyaXppbmcsIHN0cmluZz4gPSB7XG4gICAgXCJTdW1cIjogXCJSZXR1cm5zIHRoZSBzdW0gb2YgPHt7c3VtbWFyaXplZEZpZWxkTmFtZX19PiBmaWVsZHMgaW4gdGhlIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeVwiLFxuICAgIFwiQ291bnRcIjogXCJDb3VudHMgYWxsIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeSB3aGVyZSA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGlzIG5vbiBlbXB0eVwiLFxuICAgIFwiQ291bnRBbGxcIjogXCJDb3VudHMgYWxsIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeSAoaW5jbHVkaW5nIGVtcHR5IGZpZWxkcylcIixcbiAgICBcIkF2ZXJhZ2VcIjogXCJSZXR1cm5zIHRoZSBhdmVyYWdlIHZhbHVlIG9mIDx7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fT4gZmllbGRzIGluIHRoZSBwYWdlcyBtYXRjaGluZyB0aGUgcXVlcnlcIixcbiAgICBcIk1heFwiOiBcIlJldHVybnMgdGhlIG1heGltdW0gdmFsdWUgb2YgPHt7c3VtbWFyaXplZEZpZWxkTmFtZX19PiBmaWVsZHMgaW4gdGhlIHBhZ2VzIG1hdGNoaW5nIHRoZSBxdWVyeVwiLFxuICAgIFwiTWluXCI6IFwiUmV0dXJucyB0aGUgbWluaW11bSB2YWx1ZSBvZiA8e3tzdW1tYXJpemVkRmllbGROYW1lfX0+IGZpZWxkcyBpbiB0aGUgcGFnZXMgbWF0Y2hpbmcgdGhlIHF1ZXJ5XCIsXG59XG5cbmV4cG9ydCBjb25zdCBCdWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBCdWlsdGluU3VtbWFyaXppbmcsIHN0cmluZz4gPSB7XG4gICAgXCJTdW1cIjogXCJjb25zdCBpPTA7Y29uc3Qgc3VtID0gcGFnZXMucmVkdWNlKChwLCBjKSA9PiBwICsgY1tcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSwgaSk7IHJldHVybiBzdW1cIixcbiAgICBcIkNvdW50QWxsXCI6IFwicmV0dXJuIHBhZ2VzLmxlbmd0aFwiLFxuICAgIFwiQ291bnRcIjogXCJyZXR1cm4gcGFnZXMuZmlsdGVyKHAgPT4gISFwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdKS5sZW5ndGhcIixcbiAgICBcIkF2ZXJhZ2VcIjogXCJjb25zdCBpPTAuMDtjb25zdCBzdW0gPSBwYWdlcy5yZWR1Y2UoKHAsIGMpID0+IHAgKyBjW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdLCBpKTsgcmV0dXJuIHN1bSAvIHBhZ2VzLmxlbmd0aFwiLFxuICAgIFwiTWF4XCI6IFwicmV0dXJuIHBhZ2VzLnJlZHVjZSgocCxjKSA9PiBwW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdID49IGNbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl0gPyBwIDogYylbXFxcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XFxcIl1cIixcbiAgICBcIk1pblwiOiBcInJldHVybiBwYWdlcy5yZWR1Y2UoKHAsYykgPT4gcFtcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSE9PW51bGwgJiYgcFtcXFwie3tzdW1tYXJpemVkRmllbGROYW1lfX1cXFwiXSA8PSBjW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdID8gcCA6IGMpW1xcXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVxcXCJdXCJcbn1cblxuZXhwb3J0IGVudW0gVHlwZSB7XG4gICAgXCJMaW5rc0xpc3RcIiA9IFwiTGlua3NMaXN0XCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIiA9IFwiTGlua3NCdWxsZXRMaXN0XCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIiA9IFwiQnVpbHRpblN1bW1hcml6aW5nXCIsXG4gICAgXCJDdXN0b21MaXN0XCIgPSBcIkN1c3RvbUxpc3RcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIiA9IFwiQ3VzdG9tQnVsbGV0TGlzdFwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIiA9IFwiQ3VzdG9tU3VtbWFyaXppbmdcIlxufVxuXG5leHBvcnQgY29uc3QgU2hvcnREZXNjcmlwdGlvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiSW5saW5lIGxpc3Qgb2YgbGlua3NcIixcbiAgICBcIkxpbmtzQnVsbGV0TGlzdFwiOiBcIkJ1bGxldCBsaXN0IG9mIGxpbmtzXCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogXCJcIixcbiAgICBcIkN1c3RvbUxpc3RcIjogXCJJbmxpbmUgbGlzdCBvZiBjdXN0b21pemVkIGxpbmtzXCIsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IFwiQnVsbGV0IGxpc3Qgb2YgY3VzdG9taXplZCBsaW5rc1wiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJDdXN0b20gc3VtbWFyaXppbmcgZnVuY3Rpb25cIlxufVxuXG5leHBvcnQgY29uc3QgTWFwcGluZ0xhYmVsOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIFR5cGU+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFR5cGUuTGlua3NMaXN0LFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFR5cGUuTGlua3NCdWxsZXRMaXN0LFxuICAgIFwiQnVpbHRpblN1bW1hcml6aW5nXCI6IFR5cGUuQnVpbHRpblN1bW1hcml6aW5nLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBUeXBlLkN1c3RvbUxpc3QsXG4gICAgXCJDdXN0b21CdWxsZXRMaXN0XCI6IFR5cGUuQ3VzdG9tQnVsbGV0TGlzdCxcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IFR5cGUuQ3VzdG9tU3VtbWFyaXppbmdcbn1cblxuZXhwb3J0IGNvbnN0IERlc2NyaXB0aW9uOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJMaW5rc0xpc3RcIjogXCJMaXN0IG9mIHJlbGF0ZWQgbGlua3MgZGlzcGxheWVkIGlubGluZVwiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiTGlzdCBvZiByZWxhdGVkIGxpbmtzIGRpc3BsYXllZCBiZWxvdyB0aGUgZmllbGRcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIkJ1aWx0LWluIHN1bW1hcml6aW5nIGZ1bmN0aW9uXCIsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwiQ3VzdG9tIGxpc3QgcmVuZGVyaW5nIGZ1bmN0aW9uIGRpc3BsYXllZCBpbmxpbmVcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJDdXN0b20gbGlzdCByZW5kZXJpbmcgZnVuY3Rpb24gZGlzcGxheWVkIGJlbG93IHRoZSBmaWVsZFwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJDdXN0b20gc3VtbWFyaXppbmcgZnVuY3Rpb25cIlxufVxuXG5leHBvcnQgY29uc3QgT3B0aW9uTGFiZWw6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIkxpbmtzTGlzdFwiOiBcIlwiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiXCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogXCJCdWlsdC1pbiBzdW1tYXJpemUgZnVuY3Rpb246XCIsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwiUXVlcnkncyByZXN1bHRzJyBsaXN0J3MgcmVuZGVyaW5nIGZ1bmN0aW9uOlwiLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBcIlF1ZXJ5J3MgcmVzdWx0cycgbGlzdCdzIHJlbmRlcmluZyBmdW5jdGlvbjpcIixcbiAgICBcIkN1c3RvbVN1bW1hcml6aW5nXCI6IFwiUXVlcnkncyByZXN1bHRzJyBsaXN0J3Mgc3VtbWFyaXppbmcgZnVuY3Rpb246XCJcbn1cblxuXG5leHBvcnQgY29uc3QgT3B0aW9uU3ViTGFiZWw6IFJlY29yZDxrZXlvZiB0eXBlb2YgVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIkxpbmtzTGlzdFwiOiBcIlwiLFxuICAgIFwiTGlua3NCdWxsZXRMaXN0XCI6IFwiXCIsXG4gICAgXCJCdWlsdGluU3VtbWFyaXppbmdcIjogXCJcIixcbiAgICBcIkN1c3RvbUxpc3RcIjogYGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIDxmdW5jdGlvbiB1c2luZyBcInBhZ2VcIj47IH1gLFxuICAgIFwiQ3VzdG9tQnVsbGV0TGlzdFwiOiBgZnVuY3Rpb24ocGFnZSkgeyByZXR1cm4gPGZ1bmN0aW9uIHVzaW5nIFwicGFnZVwiPjsgfWAsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBgZnVuY3Rpb24ocGFnZSkgeyByZXR1cm4gPGZ1bmN0aW9uIHVzaW5nIFwicGFnZVwiPjsgfWBcbn1cblxuZXhwb3J0IGNvbnN0IEhlbHBlcjogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBcIlwiLFxuICAgIFwiQ3VzdG9tTGlzdFwiOiBcIkphdmFzY3JpcHQgc3RyaW5nLCBcIiArXG4gICAgICAgIFwidGhlIFxcXCJwYWdlXFxcIiAoZGF0YXZpZXcgcGFnZSB0eXBlKSB2YXJpYWJsZSBpcyBhdmFpbGFibGVcXG5cIiArXG4gICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJKYXZhc2NyaXB0IHN0cmluZywgXCIgK1xuICAgICAgICBcInRoZSBcXFwicGFnZVxcXCIgKGRhdGF2aWV3IHBhZ2UgdHlwZSkgdmFyaWFibGUgaXMgYXZhaWxhYmxlXFxuXCIgK1xuICAgICAgICBcImV4YW1wbGUgMTogcGFnZS5maWxlLm5hbWVcXG5leGFtcGxlIDI6IGAke3BhZ2UuZmlsZS5uYW1lfSBvZiBnZW5kZXIgJHtwYWdlLmdlbmRlcn1gXCIsXG4gICAgXCJDdXN0b21TdW1tYXJpemluZ1wiOiBcIkphdmFzY3JpcHQgc3RyaW5nLCB0aGUgXFxcInBhZ2VzXFxcIiAoZGF0YXZpZXcgcGFnZXMgdHlwZSkgXCIgK1xuICAgICAgICBcInZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcbmV4YW1wbGU6IFwiICtcbiAgICAgICAgXCJcXG5jb25zdCBpbml0aWFsVmFsdWUgPSAwO1xcbmNvbnN0IHN1bVdpdGhJbml0aWFsID0gcGFnZXMucmVkdWNlKFxcblwiICtcbiAgICAgICAgXCIgICAgKHByZXZpb3VzVmFsdWUsIGN1cnJlbnRWYWx1ZSkgPT4gcHJldmlvdXNWYWx1ZSArIGN1cnJlbnRWYWx1ZSxcXG5cIiArXG4gICAgICAgIFwiICAgIGluaXRpYWxWYWx1ZVxcbik7XFxucmV0dXJuIGAke3N1bVdpdGhJbml0aWFsfWBcXG5cIlxufVxuXG5leHBvcnQgY29uc3QgRGVmYXVsdDogUmVjb3JkPGtleW9mIHR5cGVvZiBUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiTGlua3NMaXN0XCI6IFwiXCIsXG4gICAgXCJMaW5rc0J1bGxldExpc3RcIjogXCJcIixcbiAgICBcIkJ1aWx0aW5TdW1tYXJpemluZ1wiOiBCdWlsdGluU3VtbWFyaXppbmcuQ291bnQsXG4gICAgXCJDdXN0b21MaXN0XCI6IFwicGFnZS5maWxlLm5hbWVcIixcbiAgICBcIkN1c3RvbUJ1bGxldExpc3RcIjogXCJwYWdlLmZpbGUubmFtZVwiLFxuICAgIFwiQ3VzdG9tU3VtbWFyaXppbmdcIjogXCJyZXR1cm4gcGFnZXMubGVuZ3RoXCJcbn1cblxuZXhwb3J0IGNvbnN0IGJ1bGxldExpc3RMb29rdXBUeXBlcyA9IFtcbiAgICBUeXBlLkxpbmtzQnVsbGV0TGlzdCxcbiAgICBUeXBlLkN1c3RvbUJ1bGxldExpc3Rcbl1cblxuZXhwb3J0IGVudW0gU3RhdHVzIHtcbiAgICBcImNoYW5nZWRcIiA9IFwiY2hhbmdlZFwiLFxuICAgIFwidXBUb0RhdGVcIiA9IFwidXBUb0RhdGVcIlxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBMaXN0SXRlbUNhY2hlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGlzdEJvdW5kcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZTogVEZpbGUsIHBhcmVudDogbnVtYmVyKTogeyBzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlciB9IHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBsaXN0SXRlbXM6IExpc3RJdGVtQ2FjaGVbXSA9IChwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5saXN0SXRlbXMgfHwgW10pXG4gICAgcmV0dXJuIGdldExpc3RCb3VuZHNGcm9tTGlzdEl0ZW1DYWNoZUxpc3QobGlzdEl0ZW1zLCBwYXJlbnQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaXN0Qm91bmRzRnJvbUxpc3RJdGVtQ2FjaGVMaXN0KFxuICAgIGxpc3RJdGVtczogTGlzdEl0ZW1DYWNoZVtdLFxuICAgIHBhcmVudDogbnVtYmVyXG4pOiB7IHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyIH0gfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IHN1YlBhcmVudHNMaW5lcyA9IFstcGFyZW50IC0gMV07XG4gICAgbGV0IHN0YXJ0OiBudW1iZXIgPSBwYXJlbnQ7XG4gICAgbGV0IGVuZDogbnVtYmVyID0gLTE7XG4gICAgbGV0IG91dE9mTGlzdDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGxpc3RJdGVtc1xuICAgICAgICAuc29ydCgoYSwgYikgPT4gYS5wb3NpdGlvbi5zdGFydC5saW5lIC0gYi5wb3NpdGlvbi5zdGFydC5saW5lKVxuICAgICAgICAuZm9yRWFjaChsaXN0SXRlbSA9PiB7XG4gICAgICAgICAgICBpZiAoc3ViUGFyZW50c0xpbmVzLmluY2x1ZGVzKGxpc3RJdGVtLnBhcmVudCkgJiYgIW91dE9mTGlzdCkge1xuICAgICAgICAgICAgICAgIHN1YlBhcmVudHNMaW5lcy5wdXNoKGxpc3RJdGVtLnBvc2l0aW9uLnN0YXJ0LmxpbmUpO1xuICAgICAgICAgICAgICAgIGlmIChzdGFydCA+IGxpc3RJdGVtLnBvc2l0aW9uLnN0YXJ0LmxpbmUpIHN0YXJ0ID0gbGlzdEl0ZW0ucG9zaXRpb24uc3RhcnQubGluZTtcbiAgICAgICAgICAgICAgICBpZiAoZW5kIDw9IGxpc3RJdGVtLnBvc2l0aW9uLmVuZC5saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsaXN0SXRlbS5wb3NpdGlvbi5lbmQubGluZSA9PSBsaXN0SXRlbS5wb3NpdGlvbi5zdGFydC5saW5lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbmQgPSBsaXN0SXRlbS5wb3NpdGlvbi5lbmQubGluZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZCA9IGxpc3RJdGVtLnBvc2l0aW9uLnN0YXJ0LmxpbmU7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRPZkxpc3QgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgaWYgKGVuZCA+PSAwKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2coeyBzdGFydDogc3RhcnQsIGVuZDogZW5kIH0pXG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQgfVxuICAgIH1cbiAgICByZXR1cm5cbn0iLCAiZXhwb3J0IGNvbnN0IGZpZWxkQ29tcG9uZW50cyA9IFsnaW5RdW90ZScsICdpbkxpc3QnLCAnc3RhcnRTdHlsZScsICdhdHRyaWJ1dGUnLCAnZW5kU3R5bGUnLCAnYmVmb3JlU2VwYXJhdG9yU3BhY2VyJywgJ2FmdGVyU2VwYXJhdG9yU3BhY2VyJywgJ3ZhbHVlcyddXG5cbmV4cG9ydCBjb25zdCBnZW5lcmljRmllbGRSZWdleCA9IFwiKD88aW5RdW90ZT5cXD4oXFxcXHMrKT8pPyg/PGluTGlzdD4tICk/KD88c3RhcnRTdHlsZT5bX1xcXFwqfmBdKikoPzxhdHRyaWJ1dGU+WzAtOVxcXFx3XFxcXHB7TGV0dGVyfVxcXFxwe0Vtb2ppX1ByZXNlbnRhdGlvbn1dWy0wLTlcXFxcd1xcXFxwe0xldHRlcn1cXFxccHtFbW9qaV9QcmVzZW50YXRpb259XFxcXHNdKikoPzxlbmRTdHlsZT5bX1xcXFwqfmBdKikoPzxiZWZvcmVTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKVwiO1xuXG5leHBvcnQgY29uc3QgaW5saW5lRmllbGRSZWdleCA9IChhdHRyaWJ1dGU6IHN0cmluZykgPT4gYCg/PGluUXVvdGU+XFw+KFxcXFxzKyk/KT8oPzxpbkxpc3Q+LSApPyg/PHN0YXJ0U3R5bGU+W19cXFxcKn5cXGBdKikoPzxhdHRyaWJ1dGU+JHthdHRyaWJ1dGV9KSg/PGVuZFN0eWxlPltfXFxcXCp+XFxgXSopKD88YmVmb3JlU2VwYXJhdG9yU3BhY2VyPlxcXFxzKik6Oig/PGFmdGVyU2VwYXJhdG9yU3BhY2VyPlxcXFxzKilgO1xuXG5leHBvcnQgY29uc3QgZnVsbExpbmVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTo6XFxcXHMqKD88dmFsdWVzPi4qKT9gLCBcInVcIik7XG5cbmV4cG9ydCBjb25zdCBpblNlbnRlbmNlUmVnZXhCcmFja2V0cyA9IG5ldyBSZWdFeHAoYFxcXFxbJHtnZW5lcmljRmllbGRSZWdleH06OlxcXFxzKig/PHZhbHVlcz5bXlxcXFxdXSspP1xcXFxdYCwgXCJndVwiKTtcblxuZXhwb3J0IGNvbnN0IGluU2VudGVuY2VSZWdleFBhciA9IG5ldyBSZWdFeHAoYFxcXFwoJHtnZW5lcmljRmllbGRSZWdleH06OlxcXFxzKig/PHZhbHVlcz5bXlxcXFwpXSspP1xcXFwpYCwgXCJndVwiKTtcblxuZXhwb3J0IGNvbnN0IGVuY29kZUxpbmsgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgLyogcmVwbGFjZSBsaW5rIGJyYWNrZXRzIGJ5IFwiaW1wb3NzaWJsZVwiIGNvbWJpbmF0aW9uIG9mIGNoYXJhY3RlcnMgc28gdGhhdCB0aGV5IHdvbid0IGJlIG1peGVkIHVwIHdpdGggaW5TZW50ZW5jZSBmaWVsZCBicmFja2V0cyB3aGVuIHNlYWNoaW5nIHdpdGggcmVnZXgqL1xuICAgIHJldHVybiB2YWx1ZSA/IHZhbHVlXG4gICAgICAgIC5yZXBsYWNlKC9cXFtcXFsvZywgXCJcdUQ4M0RcdUREMjdcdUQ4M0RcdURDMDBcIilcbiAgICAgICAgLnJlcGxhY2UoL1xcXVxcXS9nLCBcIlx1RDgzRFx1REMxM1x1RDgzRFx1REQ0Q1wiKSA6IHZhbHVlXG59XG5cbmV4cG9ydCBjb25zdCBkZWNvZGVMaW5rID0gKHZhbHVlOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIC8qIHJlcGxhY2UgbGluayBicmFja2V0cyBieSBcImltcG9zc2libGVcIiBjb21iaW5hdGlvbiBvZiBjaGFyYWN0ZXJzIHNvIHRoYXQgdGhleSB3b24ndCBiZSBtaXhlZCB1cCB3aXRoIGluU2VudGVuY2UgZmllbGQgYnJhY2tldHMgd2hlbiBzZWFjaGluZyB3aXRoIHJlZ2V4Ki9cbiAgICByZXR1cm4gdmFsdWUgPyB2YWx1ZVxuICAgICAgICAucmVwbGFjZSgvXHVEODNEXHVERDI3XHVEODNEXHVEQzAwL2d1LCBcIltbXCIpXG4gICAgICAgIC5yZXBsYWNlKC9cdUQ4M0RcdURDMTNcdUQ4M0RcdURENEMvZ3UsIFwiXV1cIikgOiB2YWx1ZVxufVxuXG5leHBvcnQgY29uc3QgZnJvbnRNYXR0ZXJMaW5lRmllbGQgPSAobGluZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IHtcbiAgICBjb25zdCBmcm9udE1hdHRlclJlZ2V4ID0gbmV3IFJlZ0V4cCgvKD88YXR0cmlidXRlPlswLTlcXHdcXHB7TGV0dGVyfVxccHtFbW9qaV9QcmVzZW50YXRpb259XVstMC05XFx3XFxwe0xldHRlcn1cXHB7RW1vamlfUHJlc2VudGF0aW9ufVxcc10qW15cXHNdKSg/PGJlZm9yZVNlcGFyYXRvclNwYWNlcj5cXHMqKTooPzxhZnRlclNlcGFyYXRvclNwYWNlcj5cXHMqKSg/PHZhbHVlcz4uKikvdSlcbiAgICBjb25zdCBmUiA9IGxpbmUubWF0Y2goZnJvbnRNYXR0ZXJSZWdleCk7XG5cbiAgICBpZiAoZlI/Lmdyb3Vwcykge1xuICAgICAgICBjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBmUj8uZ3JvdXBzXG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBnZXRMaW5lRmllbGRzID0gKGxpbmU6IHN0cmluZyk6IHsgYXR0cmlidXRlOiBzdHJpbmcsIHZhbHVlczogc3RyaW5nLCBpbmRleDogbnVtYmVyLCBsZW5ndGg6IG51bWJlciB9W10gPT4ge1xuICAgIGNvbnN0IGZpZWxkczogeyBhdHRyaWJ1dGU6IHN0cmluZywgdmFsdWVzOiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyIH1bXSA9IFtdXG4gICAgY29uc3QgZlIgPSBsaW5lLm1hdGNoKGZ1bGxMaW5lUmVnZXgpO1xuICAgIGlmIChmUj8uZ3JvdXBzKSB7XG4gICAgICAgIGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IGZSPy5ncm91cHNcbiAgICAgICAgZmllbGRzLnB1c2goeyBhdHRyaWJ1dGUsIHZhbHVlcywgaW5kZXg6IDAsIGxlbmd0aDogbGluZS5sZW5ndGggfSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzUkJrID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhCcmFja2V0cyk7XG4gICAgICAgIGxldCBuZXh0ID0gc1JCay5uZXh0KCk7XG4gICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICBpZiAobmV4dC52YWx1ZS5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBuZXh0LnZhbHVlLmdyb3VwcztcbiAgICAgICAgICAgICAgICBmaWVsZHMucHVzaCh7IGF0dHJpYnV0ZSwgdmFsdWVzOiBkZWNvZGVMaW5rKHZhbHVlcyksIGluZGV4OiBuZXh0LnZhbHVlLmluZGV4IHx8IDAsIGxlbmd0aDogbmV4dC52YWx1ZVswXS5sZW5ndGggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXh0ID0gc1JCay5uZXh0KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc1JCYyA9IGVuY29kZUxpbmsobGluZSkubWF0Y2hBbGwoaW5TZW50ZW5jZVJlZ2V4UGFyKTtcbiAgICAgICAgbmV4dCA9IHNSQmMubmV4dCgpO1xuICAgICAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBhdHRyaWJ1dGUsIHZhbHVlcyB9ID0gbmV4dC52YWx1ZS5ncm91cHM7XG4gICAgICAgICAgICAgICAgZmllbGRzLnB1c2goeyBhdHRyaWJ1dGUsIHZhbHVlczogZGVjb2RlTGluayh2YWx1ZXMpLCBpbmRleDogbmV4dC52YWx1ZS5pbmRleCB8fCAwLCBsZW5ndGg6IG5leHQudmFsdWVbMF0ubGVuZ3RoIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV4dCA9IHNSQmMubmV4dCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpZWxkcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGlmIChhLmluZGV4IDwgYi5pbmRleCkgcmV0dXJuIC0xO1xuICAgICAgICBpZiAoYS5pbmRleCA+IGIuaW5kZXgpIHJldHVybiAxO1xuICAgICAgICByZXR1cm4gMFxuICAgIH0pXG4gICAgcmV0dXJuIGZpZWxkc1xufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZDU00gZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcbmltcG9ydCBJbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL21vZGFscy9pbnNlcnRGaWVsZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEZNLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi9GaWVsZFwiO1xuXG5leHBvcnQgY29uc3QgZW51bSBTZXR0aW5nTG9jYXRpb24ge1xuICAgIFwiUGx1Z2luU2V0dGluZ3NcIixcbiAgICBcIkZpbGVDbGFzc0F0dHJpYnV0ZVNldHRpbmdzXCJcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBhYnN0cmFjdCBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZDU00gfCBGaWVsZE9wdGlvbnMpOiB2b2lkO1xuICAgIGFic3RyYWN0IHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuO1xuICAgIGFic3RyYWN0IGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZDtcbiAgICBhYnN0cmFjdCBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7XG4gICAgICAgICAgICBjbHM/OiBzdHJpbmcsXG4gICAgICAgICAgICBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPixcbiAgICAgICAgICAgIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG4gICAgICAgIH1cbiAgICApOiB2b2lkXG4gICAgYWJzdHJhY3QgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmc7XG4gICAgYWJzdHJhY3QgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogdm9pZDtcbiAgICBwdWJsaWMgc2hvd01vZGFsT3B0aW9uOiBib29sZWFuID0gdHJ1ZTtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBwbHVnaW46IE1ldGFkYXRhTWVudSwgcHVibGljIGZpZWxkOiBGaWVsZCwgcHVibGljIHR5cGU6IEZpZWxkVHlwZSkge1xuICAgICAgICBpZiAoZmllbGQudHlwZSAhPT0gdHlwZSkgdGhyb3cgRXJyb3IoYFRoaXMgZmllbGQgaXMgbm90IG9mIHR5cGUgJHt0eXBlfWApXG4gICAgfVxuXG4gICAgc3RhdGljIGJ1aWxkTWFya0Rvd25MaW5rKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgcGF0aDogc3RyaW5nLCBhbGlhcz86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGRlc3RGaWxlID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHBhdGgsIGZpbGUucGF0aClcbiAgICAgICAgaWYgKGRlc3RGaWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gcGx1Z2luLmFwcC5maWxlTWFuYWdlci5nZW5lcmF0ZU1hcmtkb3duTGluayhcbiAgICAgICAgICAgICAgICBkZXN0RmlsZSxcbiAgICAgICAgICAgICAgICBmaWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGFsaWFzLFxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlTmFtZSh0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQsIGNvbnRlbnRFbDogRWxlbWVudCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgaWYgKC9eWyM+LV0vLnRlc3QodGhpcy5maWVsZC5uYW1lKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0ZXh0SW5wdXQsXG4gICAgICAgICAgICAgICAgXCJGaWVsZCBuYW1lIGNhbm5vdCBzdGFydCB3aXRoICMsID4sIC1cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRleHRJbnB1dCxcbiAgICAgICAgICAgICAgICBcIkZpZWxkIG5hbWUgY2FuIG5vdCBiZSBFbXB0eVwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gIWVycm9yXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHJlcGxhY2VWYWx1ZXMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHBhdGg6IHN0cmluZywgZmllbGROYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uZmlsZVRhc2tNYW5hZ2VyLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyhwbHVnaW4sIGZpbGUsIGZpZWxkTmFtZSwgdmFsdWUpIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpc01lbnUobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIE1lbnUge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIE1lbnUpLmFkZEl0ZW0gIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBpc1N1Z2dlc3QobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIEZDU00ge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIEZDU00pLmdldEl0ZW1zICE9PSB1bmRlZmluZWQ7XG4gICAgfTtcblxuICAgIHB1YmxpYyBzdGF0aWMgaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRkNTTSB8IEZpZWxkT3B0aW9ucyk6IGxvY2F0aW9uIGlzIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIge1xuICAgICAgICByZXR1cm4gKGxvY2F0aW9uIGFzIHN0cmluZykgPT09IFwiSW5zZXJ0RmllbGRDb21tYW5kXCI7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGQ1NNIHwgRmllbGRPcHRpb25zKTogbG9jYXRpb24gaXMgRmllbGRPcHRpb25zIHtcbiAgICAgICAgcmV0dXJuIChsb2NhdGlvbiBhcyBGaWVsZE9wdGlvbnMpLmFkZE9wdGlvbiAhPT0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgY3JlYXRlQW5kT3Blbk1vZGFsKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZmlsZTogVEZpbGUsXG4gICAgICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgICAgICBmaWVsZDogRmllbGQgfCB1bmRlZmluZWQsXG4gICAgICAgIHZhbHVlPzogc3RyaW5nLFxuICAgICAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgICAgICBpbkZyb250bWF0dGVyPzogYm9vbGVhbixcbiAgICAgICAgYWZ0ZXI/OiBib29sZWFuLFxuICAgICAgICBhc0xpc3Q/OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ/OiBib29sZWFuXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZNW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGUsIGZpZWxkTmFtZSwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBGaWVsZE1hbmFnZXIuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSEpO1xuICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGUsIGZpZWxkTmFtZSEsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBvcGVuRmllbGRNb2RhbChcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBmaWVsZE5hbWU6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICBhZnRlcjogYm9vbGVhbixcbiAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICBhc0NvbW1lbnQ6IGJvb2xlYW5cbiAgICApIHtcbiAgICAgICAgaWYgKCFmaWVsZE5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEluc2VydEZpZWxkU3VnZ2VzdE1vZGFsKHBsdWdpbiwgZmlsZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIpO1xuICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSBmaWVsZE5hbWUpXG4gICAgICAgICAgICBpZiAoZmllbGQpIHRoaXMuY3JlYXRlQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBmaWVsZCwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZURlZmF1bHQocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZyk6IEZpZWxkTWFuYWdlciB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gRmllbGQuY3JlYXRlRGVmYXVsdChuYW1lKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGTVtmaWVsZC50eXBlXShwbHVnaW4sIGZpZWxkKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIHN0cmluZ1RvQm9vbGVhbih2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB0b0Jvb2xlYW5WYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgICAgICBpZiAoaXNCb29sZWFuKHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmICgvdHJ1ZS9pLnRlc3QodmFsdWUpIHx8IC8xLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKC9mYWxzZS9pLnRlc3QodmFsdWUpIHx8IC8wLy50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRvQm9vbGVhblZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQgPSAoKSA9PiB7IH0pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IHZhbHVlVGV4dDogc3RyaW5nO1xuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZHZBcGkucGFnZShmaWxlLnBhdGgpW2ZpZWxkTmFtZV0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogdmFsdWVUZXh0ID0gXCJcIjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBudWxsOiB2YWx1ZVRleHQgPSBcIlwiOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGZhbHNlOiB2YWx1ZVRleHQgPSBcImZhbHNlXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMDogdmFsdWVUZXh0ID0gXCIwXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHZhbHVlVGV4dCA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWVUZXh0ID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdmFsdWVUZXh0IH0pXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGdXp6eU1hdGNoLCBGdXp6eVN1Z2dlc3RNb2RhbCwgc2V0SWNvbiwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUsIEZpZWxkVHlwZVRhZ0NsYXNzIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgYWRkTmV3RmllbGRNb2RhbCBmcm9tIFwiLi9hZGROZXdGaWVsZE1vZGFsXCI7XG5cblxuaW50ZXJmYWNlIE9wdGlvbiB7XG4gICAgYWN0aW9uTGFiZWw6IHN0cmluZyxcbiAgICB0eXBlPzogRmllbGRUeXBlXG59XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSW5zZXJ0RmllbGRTdWdnZXN0TW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxPcHRpb24+IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuLFxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcbiAgICB9O1xuXG4gICAgZ2V0SXRlbXMoKTogT3B0aW9uW10ge1xuICAgICAgICByZXR1cm4gW3sgYWN0aW9uTGFiZWw6ICcrK05ldysrJyB9XVxuICAgICAgICAgICAgLmNvbmNhdCh0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzXG4gICAgICAgICAgICAgICAgLmdldCh0aGlzLmZpbGUucGF0aCk/Lm1hcChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IGFjdGlvbkxhYmVsOiBmaWVsZC5uYW1lLCB0eXBlOiBmaWVsZC50eXBlIH1cbiAgICAgICAgICAgICAgICB9KSB8fCBbXVxuICAgICAgICAgICAgKTtcbiAgICB9XG5cbiAgICBnZXRJdGVtVGV4dChpdGVtOiBPcHRpb24pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaXRlbS5hY3Rpb25MYWJlbDtcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IEZ1enp5TWF0Y2g8T3B0aW9uPiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY29udGFpbmVyXCIpXG4gICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwiaWNvbi1jb250YWluZXJcIiB9KVxuICAgICAgICBpdGVtLml0ZW0udHlwZSA/IHNldEljb24oaWNvbkNvbnRhaW5lciwgRmllbGRJY29uW2l0ZW0uaXRlbS50eXBlXSkgOiBzZXRJY29uKGljb25Db250YWluZXIsIFwicGx1cy13aXRoLWNpcmNsZVwiKVxuICAgICAgICBlbC5jcmVhdGVEaXYoeyB0ZXh0OiBpdGVtLml0ZW0uYWN0aW9uTGFiZWwgfSlcbiAgICAgICAgZWwuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGlmIChpdGVtLml0ZW0udHlwZSkgZWwuY3JlYXRlRGl2KHsgY2xzOiBgY2hpcCAke0ZpZWxkVHlwZVRhZ0NsYXNzW2l0ZW0uaXRlbS50eXBlXX1gLCB0ZXh0OiBpdGVtLml0ZW0udHlwZSB9KVxuICAgIH1cblxuICAgIG9uQ2hvb3NlSXRlbShpdGVtOiBPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGl0ZW0uYWN0aW9uTGFiZWwgPT09IFwiKytOZXcrK1wiKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdGaWVsZE1vZGFsID0gbmV3IGFkZE5ld0ZpZWxkTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMubGluZU51bWJlciwgdGhpcy5maWxlLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIpO1xuICAgICAgICAgICAgbmV3RmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZCA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSBpdGVtLmFjdGlvbkxhYmVsKVxuICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmZpbGUsIGl0ZW0uYWN0aW9uTGFiZWwsIFwiXCIsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBNb2RhbCwgVGV4dENvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgYWRkTmV3RmllbGRNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcixcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgIH1cblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoXCJJbnNlcnQgbmV3IGZpZWxkXCIpO1xuICAgICAgICBjb25zdCBuYW1lQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBuYW1lQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiRmllbGQgbmFtZTogXCIsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChuYW1lQ29udGFpbmVyKTtcbiAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICBuYW1lSW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB2YWx1ZUNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcIkZpZWxkIHZhbHVlOiBcIiwgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlSW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIik7XG4gICAgICAgIHZhbHVlSW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGNvbnN0IGZvb3RlckJ1dHRvbnMgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiAnZm9vdGVyLWFjdGlvbnMnXG4gICAgICAgIH0pO1xuICAgICAgICBmb290ZXJCdXR0b25zLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyQnV0dG9ucyk7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBuYW1lSW5wdXQuZ2V0VmFsdWUoKSwgdmFsdWVJbnB1dC5nZXRWYWx1ZSgpLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlcikgfSk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyQnV0dG9ucyk7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEJ1dHRvbkNvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIE1vZGFsLCBOb3RpY2UsIFRleHRDb21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCwgeyBGaWVsZENvbW1hbmQgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUsIEZpZWxkVHlwZUxhYmVsTWFwcGluZywgRmllbGRUeXBlVG9vbHRpcCB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZFNldHRpbmdzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHJpdmF0ZSBuYW1lUHJvbXB0Q29tcG9uZW50OiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgc2F2ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGZpZWxkOiBGaWVsZDtcbiAgICBwcml2YXRlIGluaXRpYWxGaWVsZDogRmllbGQ7XG4gICAgcHJpdmF0ZSBuZXc6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHByaXZhdGUgZmllbGRPcHRpb25zQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIGZpZWxkTWFuYWdlcjogRjtcbiAgICBwcml2YXRlIGNvbW1hbmQ6IEZpZWxkQ29tbWFuZDtcbiAgICBwcml2YXRlIGFkZENvbW1hbmQ6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBpY29uTmFtZTogVGV4dENvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmdDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmc/OiBGaWVsZFNldHRpbmcsXG4gICAgICAgIGZpZWxkPzogRmllbGRcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbEZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgdGhpcy5uZXcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSBmaWVsZDtcbiAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWVsZCwgdGhpcy5maWVsZClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBuZXdJZCA9IDE7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChwcm9wLmlkKSAmJiBwYXJzZUludChwcm9wLmlkKSA+PSBuZXdJZCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdJZCA9IHBhcnNlSW50KHByb3AuaWQpICsgMTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbEZpZWxkLmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpO1xuICAgICAgICB0aGlzLmFkZENvbW1hbmQgPSB0aGlzLmZpZWxkLmNvbW1hbmQgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5jb21tYW5kID0gdGhpcy5maWVsZC5jb21tYW5kIHx8IHtcbiAgICAgICAgICAgIGlkOiB0aGlzLmZpZWxkID8gYGluc2VydF9fJHt0aGlzLmZpZWxkLmZpbGVDbGFzc05hbWUgfHwgXCJwcmVzZXRGaWVsZFwifV9fJHt0aGlzLmZpZWxkLm5hbWV9YCA6IFwiXCIsXG4gICAgICAgICAgICBpY29uOiBcImxpc3QtcGx1c1wiLFxuICAgICAgICAgICAgbGFiZWw6IHRoaXMuZmllbGQgPyBgSW5zZXJ0ICR7dGhpcy5maWVsZC5uYW1lfSBmaWVsZGAgOiBcIlwiLFxuICAgICAgICAgICAgaG90a2V5OiB1bmRlZmluZWRcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm5hbWUgPT0gXCJcIikge1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYEFkZCBhIGZpZWxkIGFuZCBkZWZpbmUgb3B0aW9uc2ApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYE1hbmFnZSBzZXR0aW5ncyBvcHRpb25zIGZvciAke3RoaXMuZmllbGQubmFtZX1gKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKiBOYW1lICovXG4gICAgICAgIHRoaXMuY3JlYXRlbmFtZUlucHV0Q29udGFpbmVyKCk7XG4gICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICAgICAgLyogQ29tbWFuZCAqL1xuICAgICAgICB0aGlzLmNyZWF0ZUNvbW1hbmRDb250YWluZXIoKTtcblxuICAgICAgICAvKiBUeXBlICovXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICAgICAgLyogT3B0aW9ucyAqL1xuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuXG4gICAgICAgIC8qIGZvb3RlciBidXR0b25zKi9cbiAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZvb3Rlci1hY3Rpb25zXCIgfSk7XG4gICAgICAgIGZvb3Rlci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgdGhpcy5jcmVhdGVTYXZlQnV0dG9uKGZvb3Rlcik7XG4gICAgICAgIHRoaXMuY3JlYXRlQ2FuY2VsQnV0dG9uKGZvb3Rlcik7XG5cbiAgICAgICAgLyogaW5pdCBzdGF0ZSAqL1xuICAgICAgICB0aGlzLmNyZWF0ZVR5cGVTZWxlY3RvckNvbnRhaW5lcih0eXBlU2VsZWN0Q29udGFpbmVyKVxuICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci5jcmVhdGVTZXR0aW5nQ29udGFpbmVyKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLCB0aGlzLnBsdWdpbiwgU2V0dGluZ0xvY2F0aW9uLlBsdWdpblNldHRpbmdzKVxuICAgIH07XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZmllbGQsIHRoaXMuaW5pdGlhbEZpZWxkKTtcbiAgICAgICAgaWYgKCF0aGlzLm5ldyAmJiB0aGlzLnBhcmVudFNldHRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50U2V0dGluZy5zZXRUZXh0Q29udGVudFdpdGhuYW1lKClcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNhdmVkKSB7XG4gICAgICAgICAgICBuZXcgRmllbGRTZXR0aW5nKHRoaXMucGFyZW50U2V0dGluZ0NvbnRhaW5lciwgdGhpcy5maWVsZCwgdGhpcy5wbHVnaW4pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcigpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibGFiZWxcIiwgdGV4dDogXCJGaWVsZCBOYW1lOiBcIiB9KTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgaW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmZpZWxkLm5hbWU7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKG5hbWUpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIk5hbWUgb2YgdGhlIGZpZWxkXCIpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5pZCA9IGBpbnNlcnRfXyR7dGhpcy5maWVsZC5maWxlQ2xhc3NOYW1lIHx8IFwicHJlc2V0RmllbGRcIn1fXyR7dmFsdWV9YFxuICAgICAgICAgICAgdGhpcy5jb21tYW5kLmxhYmVsID0gYEluc2VydCAke3ZhbHVlfSBmaWVsZGBcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBNYW5hZ2UgcHJlZGVmaW5lZCBvcHRpb25zIGZvciAke3RoaXMuZmllbGQubmFtZX1gKTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoaW5wdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50ID0gaW5wdXQ7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlVHlwZVNlbGVjdG9yQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RvckNvbnRhaW5lckxhYmVsID0gcGFyZW50Tm9kZS5jcmVhdGVEaXYoeyBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgdHlwZVNlbGVjdG9yQ29udGFpbmVyTGFiZWwuc2V0VGV4dChgRmllbGQgdHlwZTpgKTtcbiAgICAgICAgcGFyZW50Tm9kZS5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHBhcmVudE5vZGUpO1xuICAgICAgICBPYmplY3Qua2V5cyhGaWVsZFR5cGVMYWJlbE1hcHBpbmcpLmZvckVhY2goKGY6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUpID0+IHNlbGVjdC5hZGRPcHRpb24oZiwgRmllbGRUeXBlVG9vbHRpcFtmXSkpXG4gICAgICAgIGlmICh0aGlzLmZpZWxkLnR5cGUpIHtcbiAgICAgICAgICAgIHNlbGVjdC5zZXRWYWx1ZSh0aGlzLmZpZWxkLnR5cGUpXG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0Lm9uQ2hhbmdlKCh0eXBlTGFiZWw6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSBuZXcgRmllbGQoKTtcbiAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eSh0aGlzLmZpZWxkLCB0aGlzLmluaXRpYWxGaWVsZCk7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUgPSB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQuZ2V0VmFsdWUoKVxuICAgICAgICAgICAgdGhpcy5maWVsZC50eXBlID0gRmllbGRUeXBlTGFiZWxNYXBwaW5nW3R5cGVMYWJlbF07XG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZC50eXBlICE9PSB0aGlzLmluaXRpYWxGaWVsZC50eXBlICYmXG4gICAgICAgICAgICAgICAgIVt0aGlzLmZpZWxkLnR5cGUsIHRoaXMuaW5pdGlhbEZpZWxkLnR5cGVdLmV2ZXJ5KGZpZWxkVHlwZSA9PlxuICAgICAgICAgICAgICAgICAgICBbRmllbGRUeXBlLk11bHRpLCBGaWVsZFR5cGUuU2VsZWN0LCBGaWVsZFR5cGUuQ3ljbGVdLmluY2x1ZGVzKGZpZWxkVHlwZSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMgPSB7fVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIuY3JlYXRlU2V0dGluZ0NvbnRhaW5lcih0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciwgdGhpcy5wbHVnaW4sIFNldHRpbmdMb2NhdGlvbi5QbHVnaW5TZXR0aW5ncylcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNvbW1hbmRDb250YWluZXIoKTogdm9pZCB7XG5cbiAgICAgICAgY29uc3QgY29tbWFuZENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICAvL2xhYmVsXG4gICAgICAgIGNvbW1hbmRDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogXCJzZXQgYSBjb21tYW5kIGZvciB0aGlzIGZpZWxkP1wiLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgY29tbWFuZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIC8vYWRkIGNvbW1hbmRcbiAgICAgICAgY29uc3QgYWRkQ29tbWFuZFRvZ2dsZXIgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGNvbW1hbmRDb250YWluZXIpO1xuICAgICAgICBhZGRDb21tYW5kVG9nZ2xlci5zZXRWYWx1ZSh0aGlzLmFkZENvbW1hbmQpO1xuXG4gICAgICAgIC8vIG9wdGlvbnNcbiAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICB0aGlzLmFkZENvbW1hbmQgPyBpY29uQ29udGFpbmVyLnNob3coKSA6IGljb25Db250YWluZXIuaGlkZSgpO1xuXG4gICAgICAgIC8vIGljb25cbiAgICAgICAgaWNvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBcIkljb24gbmFtZVwiLCBjbHM6IFwibGFiZWxcIiB9KVxuICAgICAgICB0aGlzLmljb25OYW1lID0gbmV3IFRleHRDb21wb25lbnQoaWNvbkNvbnRhaW5lcilcbiAgICAgICAgdGhpcy5pY29uTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgdGhpcy5pY29uTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgY29uc3QgaWNvblByZXZpZXcgPSBpY29uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJpY29uLXByZXZpZXdcIiB9KVxuICAgICAgICB0aGlzLmljb25OYW1lLnNldFZhbHVlKHRoaXMuY29tbWFuZC5pY29uKVxuICAgICAgICBzZXRJY29uKGljb25QcmV2aWV3LCB0aGlzLmNvbW1hbmQuaWNvbilcbiAgICAgICAgdGhpcy5pY29uTmFtZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmQuaWNvbiA9IHZhbHVlO1xuICAgICAgICAgICAgc2V0SWNvbihpY29uUHJldmlldywgdmFsdWUpXG4gICAgICAgIH0pXG5cbiAgICAgICAgYWRkQ29tbWFuZFRvZ2dsZXIub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5hZGRDb21tYW5kID0gdmFsdWVcbiAgICAgICAgICAgIHRoaXMuYWRkQ29tbWFuZCA/IGljb25Db250YWluZXIuc2hvdygpIDogaWNvbkNvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgdmFsaWRhdGVGaWVsZHMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU5hbWUoXG4gICAgICAgICAgICB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQsXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRFbFxuICAgICAgICApICYmXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU9wdGlvbnMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVNhdmVCdXR0b24oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBiID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpXG4gICAgICAgIGIuc2V0VG9vbHRpcChcIlNhdmVcIik7XG4gICAgICAgIGIuc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgYi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGxldCBlcnJvciA9ICF0aGlzLnZhbGlkYXRlRmllbGRzKCk7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRml4IGVycm9ycyBiZWZvcmUgc2F2aW5nLlwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMuYWRkQ29tbWFuZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQuY29tbWFuZCA9IHRoaXMuY29tbWFuZFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWVsZC5jb21tYW5kXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNhdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpZWxkID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmlsdGVyKHAgPT4gcC5pZCA9PSB0aGlzLmZpZWxkLmlkKVswXTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdGaWVsZCkge1xuICAgICAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eShjdXJyZW50RXhpc3RpbmdGaWVsZCwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2godGhpcy5maWVsZCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgRmllbGQuY29weVByb3BlcnR5KHRoaXMuaW5pdGlhbEZpZWxkLCB0aGlzLmZpZWxkKVxuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50U2V0dGluZykgRmllbGQuY29weVByb3BlcnR5KHRoaXMucGFyZW50U2V0dGluZy5maWVsZCwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmc/LnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ1dHRvbihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGIgPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGIuc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgICAgICAuc2V0VG9vbHRpcChcIkNhbmNlbFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvKiByZXNldCBvcHRpb25zIGZyb20gc2V0dGluZ3MgKi9cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0aWFsRmllbGQubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qIHV0aWxzIGZ1bmN0aW9ucyAqL1xuXG4gICAgcHVibGljIHN0YXRpYyBzZXRWYWxpZGF0aW9uRXJyb3IodGV4dElucHV0OiBUZXh0Q29tcG9uZW50LCBtZXNzYWdlPzogc3RyaW5nKSB7XG4gICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiaXMtaW52YWxpZFwiKTtcbiAgICAgICAgY29uc3QgZmllbGRDb250YWluZXIgPSB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50O1xuICAgICAgICBjb25zdCBmaWVsZHNDb250YWluZXIgPSBmaWVsZENvbnRhaW5lcj8ucGFyZW50RWxlbWVudDtcbiAgICAgICAgaWYgKG1lc3NhZ2UgJiYgZmllbGRzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICBsZXQgbURpdiA9IGZpZWxkc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmZpZWxkLWVycm9yXCIpIGFzIEhUTUxEaXZFbGVtZW50O1xuICAgICAgICAgICAgaWYgKCFtRGl2KSBtRGl2ID0gY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWVycm9yXCIgfSk7XG4gICAgICAgICAgICBtRGl2LmlubmVyVGV4dCA9IG1lc3NhZ2U7XG4gICAgICAgICAgICBmaWVsZHNDb250YWluZXIuaW5zZXJ0QmVmb3JlKG1EaXYsIGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIHJlbW92ZVZhbGlkYXRpb25FcnJvcih0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQgfCBUZXh0QXJlYUNvbXBvbmVudCkge1xuICAgICAgICBpZiAodGV4dElucHV0LmlucHV0RWwuaGFzQ2xhc3MoXCJpcy1pbnZhbGlkXCIpKSB0ZXh0SW5wdXQuaW5wdXRFbC5yZW1vdmVDbGFzcyhcImlzLWludmFsaWRcIik7XG4gICAgICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyID0gdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudDtcbiAgICAgICAgY29uc3QgZmllbGRzQ29udGFpbmVyID0gZmllbGRDb250YWluZXI/LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGZpZWxkRXJyb3IgPSBmaWVsZHNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoXCIuZmllbGQtZXJyb3JcIilcbiAgICAgICAgaWYgKGZpZWxkRXJyb3IpIGZpZWxkc0NvbnRhaW5lciEucmVtb3ZlQ2hpbGQoZmllbGRFcnJvcilcbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcIi4uL3R5cGVzL2ZpZWxkVHlwZXNcIlxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkQ29tbWFuZCB7XG4gICAgaWQ6IHN0cmluZyxcbiAgICBsYWJlbDogc3RyaW5nLFxuICAgIGljb246IHN0cmluZyxcbiAgICBob3RrZXk/OiBzdHJpbmdcbn1cblxuY2xhc3MgRmllbGQge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgb3B0aW9uczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9LFxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIHB1YmxpYyB0eXBlOiBGaWVsZFR5cGUgPSBGaWVsZFR5cGUuSW5wdXQsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3NOYW1lPzogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgY29tbWFuZD86IEZpZWxkQ29tbWFuZFxuICAgICkgeyB9O1xuXG4gICAgc3RhdGljIGNvcHlQcm9wZXJ0eSh0YXJnZXQ6IEZpZWxkLCBzb3VyY2U6IEZpZWxkKSB7XG4gICAgICAgIHRhcmdldC5pZCA9IHNvdXJjZS5pZDtcbiAgICAgICAgdGFyZ2V0Lm5hbWUgPSBzb3VyY2UubmFtZTtcbiAgICAgICAgdGFyZ2V0LnR5cGUgPSBzb3VyY2UudHlwZVxuICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2Uub3B0aW9ucykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIHRhcmdldC5vcHRpb25zW2tdID0gc291cmNlLm9wdGlvbnNba107XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3Qua2V5cyh0YXJnZXQub3B0aW9ucykuZm9yRWFjaChrID0+IHtcbiAgICAgICAgICAgIGlmICghT2JqZWN0LmtleXMoc291cmNlLm9wdGlvbnMpLmluY2x1ZGVzKGspKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRhcmdldC5vcHRpb25zW2tdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRhcmdldC5jb21tYW5kID0gc291cmNlLmNvbW1hbmRcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVEZWZhdWx0KG5hbWU6IHN0cmluZyk6IEZpZWxkIHtcbiAgICAgICAgY29uc3QgZmllbGQgPSBuZXcgRmllbGQoKTtcbiAgICAgICAgZmllbGQudHlwZSA9IEZpZWxkVHlwZS5JbnB1dDtcbiAgICAgICAgZmllbGQubmFtZSA9IG5hbWU7XG4gICAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBGaWVsZDsiLCAiaW1wb3J0IHsgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGVUYWdDbGFzcyB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRTZXR0aW5nIGV4dGVuZHMgU2V0dGluZyB7XG4gICAgcHJpdmF0ZSBmaWVsZE5hbWVDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudDtcbiAgICBwcml2YXRlIHR5cGVDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudDtcbiAgICBwcml2YXRlIGZpZWxkT3B0aW9uc0NvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBwdWJsaWMgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51XG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGNvbnRhaW5lckVsKTtcbiAgICAgICAgdGhpcy5zZXRUZXh0Q29udGVudFdpdGhuYW1lKCk7XG4gICAgICAgIHRoaXMuYWRkRWRpdEJ1dHRvbigpO1xuICAgICAgICB0aGlzLmFkZERlbGV0ZUJ1dHRvbigpO1xuICAgICAgICB0aGlzLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKVxuICAgIH07XG5cbiAgICBwdWJsaWMgc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpOiB2b2lkIHtcblxuICAgICAgICBjb25zdCBtYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKSBhcyBGO1xuICAgICAgICB0aGlzLmluZm9FbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIHRoaXMuaW5mb0VsLmFkZENsYXNzKFwic2V0dGluZy1pdGVtXCIpXG4gICAgICAgIHRoaXMuZmllbGROYW1lQ29udGFpbmVyID0gdGhpcy5pbmZvRWwuY3JlYXRlRWwoXCJkaXZcIiwgXCJuYW1lXCIpXG4gICAgICAgIHRoaXMuZmllbGROYW1lQ29udGFpbmVyLnNldFRleHQodGhpcy5maWVsZC5uYW1lKVxuICAgICAgICB0aGlzLnR5cGVDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVFbChcImRpdlwiKVxuICAgICAgICB0aGlzLnR5cGVDb250YWluZXIuc2V0QXR0cihcImNsYXNzXCIsIGBjaGlwICR7RmllbGRUeXBlVGFnQ2xhc3NbdGhpcy5maWVsZC50eXBlXX1gKVxuICAgICAgICB0aGlzLnR5cGVDb250YWluZXIuc2V0VGV4dCh0aGlzLmZpZWxkLnR5cGUpXG4gICAgICAgIHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyID0gdGhpcy5pbmZvRWwuY3JlYXRlRWwoXCJkaXZcIilcbiAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuc2V0VGV4dChgJHttYW5hZ2VyLmdldE9wdGlvbnNTdHIoKX1gKVxuICAgIH07XG5cbiAgICBwcml2YXRlIGFkZEVkaXRCdXR0b24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJwZW5jaWxcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkVkaXRcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtb2RhbCA9IG5ldyBGaWVsZFNldHRpbmdzTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuY29udGFpbmVyRWwsIHRoaXMsIHRoaXMuZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFkZERlbGV0ZUJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJEZWxldGVcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ1Byb3BlcnR5ID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmlsdGVyKHAgPT4gcC5pZCA9PSB0aGlzLmZpZWxkLmlkKVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ1Byb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5yZW1vdmUoY3VycmVudEV4aXN0aW5nUHJvcGVydHkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdFbC5wYXJlbnRFbGVtZW50Py5yZW1vdmVDaGlsZCh0aGlzLnNldHRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRWYWx1ZXNMaXN0RnJvbU5vdGUocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5vdGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIGxldCB2YWx1ZXM6IEFycmF5PHN0cmluZz4gPSBbXTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5vdGVQYXRoKTtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmICgvXiguKikkLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNb2RhbCwgVEZpbGUsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb29sZWFuTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgdmFsdWU6IGJvb2xlYW4sXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlciA9IGluRnJvbnRtYXR0ZXI7XG4gICAgICAgIHRoaXMuYWZ0ZXIgPSBhZnRlcjtcbiAgICAgICAgdGhpcy5hc0xpc3QgPSBhc0xpc3Q7XG4gICAgICAgIHRoaXMuYXNDb21tZW50ID0gYXNDb21tZW50O1xuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGRcbiAgICB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibmFycm93XCIpXG4gICAgICAgIHRoaXMuYnVpbGRUb2dnbGVFbCgpO1xuICAgIH07XG5cblxuICAgIHByaXZhdGUgYnVpbGRUb2dnbGVFbCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2hvaWNlc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJ2YWx1ZS1jb250YWluZXJcIiB9KVxuICAgICAgICBjaG9pY2VzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgdHJ1ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY2hvaWNlc0NvbnRhaW5lcik7XG4gICAgICAgIHRydWVCdXR0b24uc2V0QnV0dG9uVGV4dChcIlRydWVcIilcbiAgICAgICAgY2hvaWNlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIGNvbnN0IGZhbHNlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjaG9pY2VzQ29udGFpbmVyKTtcbiAgICAgICAgZmFsc2VCdXR0b24uc2V0QnV0dG9uVGV4dChcIkZhbHNlXCIpXG4gICAgICAgIGNob2ljZXNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgdHJ1ZUJ1dHRvbi5zZXRDdGEoKTtcbiAgICAgICAgICAgIGZhbHNlQnV0dG9uLnJlbW92ZUN0YSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmFsc2VCdXR0b24uc2V0Q3RhKCk7XG4gICAgICAgICAgICB0cnVlQnV0dG9uLnJlbW92ZUN0YSgpO1xuICAgICAgICB9XG4gICAgICAgIGZhbHNlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgZmFsc2VCdXR0b24uc2V0Q3RhKCk7XG4gICAgICAgICAgICB0cnVlQnV0dG9uLnJlbW92ZUN0YSgpO1xuICAgICAgICB9KVxuICAgICAgICB0cnVlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRydWU7XG4gICAgICAgICAgICB0cnVlQnV0dG9uLnNldEN0YSgpO1xuICAgICAgICAgICAgZmFsc2VCdXR0b24ucmVtb3ZlQ3RhKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNob2ljZXNDb250YWluZXIpO1xuXG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZS50b1N0cmluZygpXG4gICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB2YWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB2YWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIlxuaW1wb3J0IEJvb2xlYW5Nb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvQm9vbGVhbk1vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUsIEZpZWxkSWNvbiB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb29sZWFuRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuQm9vbGVhbik7XG4gICAgICAgIHRoaXMuc2hvd01vZGFsT3B0aW9uID0gZmFsc2VcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gQm9vbGVhbkZpZWxkLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSk7XG4gICAgICAgIGNvbnN0IGljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5Cb29sZWFuXVxuICAgICAgICBjb25zdCBhY3Rpb24gPSBhc3luYyAoKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUsIG5hbWUsICghYlZhbHVlKS50b1N0cmluZygpKSB9KVxuICAgICAgICBpZiAoQm9vbGVhbkZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gJHtiVmFsdWUgPyBcIlx1MjcwNSBcdTI1QjcgXHUyNzRDXCIgOiBcIlx1Mjc0QyBcdTI1QjcgXHUyNzA1XCJ9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKGljb25OYW1lKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbkZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj48Yj4ke25hbWV9PC9iPiAke2JWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIn08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBpY29uTmFtZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoQm9vbGVhbkZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFxuICAgICAgICAgICAgICAgIGJWYWx1ZSA/IFwieC1zcXVhcmVcIiA6IFwiY2hlY2stc3F1YXJlXCIsXG4gICAgICAgICAgICAgICAgYWN0aW9uLFxuICAgICAgICAgICAgICAgIGJWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIik7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIC8vbm8gbmVlZCBvZiBzZXR0aW5ncyBmb3IgYm9vbGVhbiBmaWVsZFxuICAgIH1cblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGJWYWx1ZSA9IEJvb2xlYW5GaWVsZC5zdHJpbmdUb0Jvb2xlYW4odmFsdWUpXG4gICAgICAgICAgICByZXR1cm4gaXNCb29sZWFuKGJWYWx1ZSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgLy9hbHdheXMgdHJ1ZSBzaW5jZSB0aGVyZSBhcmUgbm8gb3B0aW9uc1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gQm9vbGVhbkZpZWxkLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSB8fCBcImZhbHNlXCIpO1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IEJvb2xlYW5Nb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgYlZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpXG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZXQgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2hlY2tib3g6IEhUTUxJbnB1dEVsZW1lbnQgPSBkdi5lbChcImlucHV0XCIsIFwiXCIsIHsgLi4uYXR0cnMsIFwidHlwZVwiOiBcImNoZWNrYm94XCIgfSlcbiAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHBbdGhpcy5maWVsZC5uYW1lXVxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChjaGVja2JveClcbiAgICAgICAgY2hlY2tib3gub25jaGFuZ2UgPSAodmFsdWUpID0+IHtcbiAgICAgICAgICAgIEJvb2xlYW5GaWVsZC5yZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBwLmZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBjaGVja2JveC5jaGVja2VkLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgTnVtYmVyTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL051bWJlck1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRPcHRpb25zIH0gZnJvbSBcInNyYy9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTnVtYmVyRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBudW1iZXJWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBudW1iZXJTdGVwVmFsdWU6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBudW1iZXJNaW5WYWx1ZTogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIG51bWJlck1heFZhbHVlOiBUZXh0Q29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTnVtYmVyKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBvcHRpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpLmZvckVhY2goKGspID0+IHsgaWYgKHRoaXMuZmllbGQub3B0aW9uc1trXSkgb3B0aW9ucy5wdXNoKGAke2t9OiAke3RoaXMuZmllbGQub3B0aW9uc1trXX1gKSB9KVxuICAgICAgICByZXR1cm4gb3B0aW9ucy5qb2luKFwiIHwgXCIpXG4gICAgfVxuXG4gICAgcHVibGljIGNhbkRlY3JlbWVudCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWluIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgY29uc3QgZk1pbiA9IHBhcnNlRmxvYXQobWluKTtcbiAgICAgICAgcmV0dXJuICEoXG4gICAgICAgICAgICBpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkgfHxcbiAgICAgICAgICAgICFpc05hTihmTWluKSAmJlxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICFpc05hTihmU3RlcCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSAtIGZTdGVwIDwgZk1pbiB8fFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSAtIDEgPCBmTWluXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHVibGljIGNhbkluY3JlbWVudCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KTtcbiAgICAgICAgcmV0dXJuICEoXG4gICAgICAgICAgICBpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkgfHxcbiAgICAgICAgICAgICFpc05hTihmTWF4KSAmJlxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICFpc05hTihmU3RlcCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIGZTdGVwID4gZk1heCB8fFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIDEgPiBmTWF4XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB7IG1pbiwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbik7XG4gICAgICAgIGNvbnN0IGZNYXggPSBwYXJzZUZsb2F0KG1heCk7XG4gICAgICAgIGNvbnN0IGZWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgIWlzTmFOKGZWYWx1ZSkgJiYgKGlzTmFOKGZNaW4pIHx8IGZWYWx1ZSA+PSBmTWluKSAmJiAoaXNOYU4oZk1heCkgfHwgZlZhbHVlIDw9IGZNYXgpXG4gICAgICAgIClcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgTnVtYmVyTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgVmFsdWUgZm9yIDwke25hbWV9PmApO1xuICAgICAgICBjb25zdCB7IG1pbiwgbWF4LCBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbilcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KVxuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgY29uc3QgZlZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSlcbiAgICAgICAgY29uc3QgY2FuRGVjcmVhc2UgPSAhaXNOYU4oZk1pbikgJiYgZlZhbHVlIC0gZlN0ZXAgPj0gZk1pbjtcbiAgICAgICAgY29uc3QgY2FuSW5jcmVhc2UgPSAhaXNOYU4oZk1heCkgJiYgZlZhbHVlICsgZlN0ZXAgPD0gZk1heDtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGNvbnN0IGRlY3JlYXNlID0gYXN5bmMgKCkgPT4gYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCBuYW1lLCAoZlZhbHVlIC0gZlN0ZXApLnRvU3RyaW5nKCkpIH0pO1xuICAgICAgICBjb25zdCBpbmNyZWFzZSA9IGFzeW5jICgpID0+IGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgbmFtZSwgKGZWYWx1ZSArIGZTdGVwKS50b1N0cmluZygpKSB9KTtcbiAgICAgICAgaWYgKE51bWJlckZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuTnVtYmVyXSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpZiAoZlN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuRGVjcmVhc2UpXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcIm1pbnVzLXNxdWFyZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYDwke25hbWV9PiBcdTIxOThcdUZFMEYgJHtmVmFsdWUgLSBmU3RlcH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhkZWNyZWFzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICBpZiAoY2FuSW5jcmVhc2UpXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcInBsdXMtc3F1YXJlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgPCR7bmFtZX0+IFx1MjE5N1x1RkUwRiAke2ZWYWx1ZSArIGZTdGVwfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGluY3JlYXNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKE51bWJlckZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE51bWJlckZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgaWYgKHN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuRGVjcmVhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKFwibWludXMtc3F1YXJlXCIsIGRlY3JlYXNlLCBgRGVjcmVhc2UgJHtuYW1lfSBieSAke3N0ZXB9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjYW5JbmNyZWFzZSkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oXCJwbHVzLXNxdWFyZVwiLCBpbmNyZWFzZSwgYEluY3JlYXNlICR7bmFtZX0gYnkgJHtzdGVwfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihGaWVsZEljb25bRmllbGRUeXBlLk51bWJlcl0sIGFjdGlvbiwgYFVwZGF0ZSAke25hbWV9J3MgdmFsdWVgKVxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZU51bWJlckNvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlN0ZXAgKG9wdGlvbmFsKVwiLCBjbHM6ICdsYWJlbCcgfSlcbiAgICAgICAgbnVtYmVyU3RlcFZhbHVlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgdGhpcy5udW1iZXJTdGVwVmFsdWUgPSBuZXcgVGV4dENvbXBvbmVudChudW1iZXJTdGVwVmFsdWVDb250YWluZXIpXG4gICAgICAgIHRoaXMubnVtYmVyU3RlcFZhbHVlLmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpXG4gICAgICAgIHRoaXMubnVtYmVyU3RlcFZhbHVlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5zdGVwIHx8IFwiXCIpXG5cbiAgICAgICAgY29uc3QgbnVtYmVyTWluVmFsdWVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBudW1iZXJNaW5WYWx1ZUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIk1pbiB2YWx1ZSAob3B0aW9uYWwpXCIsIGNsczogJ2xhYmVsJyB9KVxuICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlID0gbmV3IFRleHRDb21wb25lbnQobnVtYmVyTWluVmFsdWVDb250YWluZXIpXG4gICAgICAgIHRoaXMubnVtYmVyTWluVmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIHRoaXMubnVtYmVyTWluVmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIilcbiAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMubWluIHx8IFwiXCIpXG5cbiAgICAgICAgY29uc3QgbnVtYmVyTWF4VmFsdWVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBudW1iZXJNYXhWYWx1ZUNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIk1heCB2YWx1ZSAob3B0aW9uYWwpXCIsIGNsczogJ2xhYmVsJyB9KVxuICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlID0gbmV3IFRleHRDb21wb25lbnQobnVtYmVyTWF4VmFsdWVDb250YWluZXIpXG4gICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIilcbiAgICAgICAgdGhpcy5udW1iZXJNYXhWYWx1ZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMubWF4IHx8IFwiXCIpXG4gICAgICAgIHRoaXMubnVtYmVyU3RlcFZhbHVlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5zdGVwID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRoaXMubnVtYmVyU3RlcFZhbHVlKTtcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMubWluID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRoaXMubnVtYmVyTWluVmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5tYXggPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5udW1iZXJNYXhWYWx1ZSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpOiB2b2lkIHtcblxuICAgICAgICB0aGlzLmNyZWF0ZU51bWJlckNvbnRhaW5lcihjb250YWluZXIpXG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2VcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5zdGVwICYmIGlzTmFOKHBhcnNlRmxvYXQodGhpcy5maWVsZC5vcHRpb25zLnN0ZXApKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZSxcbiAgICAgICAgICAgICAgICBcIlZhbHVlcyBtdXN0IGJlIG51bWVyaWMuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5taW4gJiYgaXNOYU4ocGFyc2VGbG9hdCh0aGlzLmZpZWxkLm9wdGlvbnMubWluKSkpIHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZSxcbiAgICAgICAgICAgICAgICBcIlZhbHVlcyBtdXN0IGJlIG51bWVyaWMuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5tYXggJiYgaXNOYU4ocGFyc2VGbG9hdCh0aGlzLmZpZWxkLm9wdGlvbnMubWF4KSkpIHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5udW1iZXJNYXhWYWx1ZSxcbiAgICAgICAgICAgICAgICBcIlZhbHVlcyBtdXN0IGJlIG51bWVyaWMuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFlcnJvclxuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBOdW1iZXJNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUgfHwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdG46IEhUTUxCdXR0b25FbGVtZW50LCBpbmNyZW1lbnRCdG46IEhUTUxCdXR0b25FbGVtZW50LCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbkRlY3JlbWVudCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ0bi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ0bi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jYW5JbmNyZW1lbnQodmFsdWUpKSB7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdG4ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdG4uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRyczogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9ID0ge31cbiAgICApOiB2b2lkIHtcbiAgICAgICAgYXR0cnMuY2xzID0gXCJ2YWx1ZS1jb250YWluZXJcIlxuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gKGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycykgYXMgSFRNTERpdkVsZW1lbnQpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKVxuICAgICAgICBjb25zdCBpbnB1dENvbnRhaW5lciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7fSk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gaW5wdXRDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiKTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSBwW3RoaXMuZmllbGQubmFtZV07XG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3QgdHJpcGxlU3BhY2VyID0gZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlci0zXCIgfSk7XG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgZWRpdEJ1dHRvbiA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGVkaXRCdXR0b24sIEZpZWxkSWNvbltGaWVsZFR5cGUuTnVtYmVyXSk7XG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgZGVjcmVtZW50QnV0dG9uID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oZGVjcmVtZW50QnV0dG9uLCBcImxlZnQtYXJyb3dcIik7XG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgaW5jcmVtZW50QnV0dG9uID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG4gICAgICAgIHNldEljb24oaW5jcmVtZW50QnV0dG9uLCBcInJpZ2h0LWFycm93XCIpO1xuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBlZGl0QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgdHJpcGxlU3BhY2VyLnNob3coKTtcblxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZWRpdEJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICAgICAgZGVjcmVtZW50QnV0dG9uLnNob3coKTtcbiAgICAgICAgICAgICAgICBpbmNyZW1lbnRCdXR0b24uc2hvdygpO1xuICAgICAgICAgICAgICAgIHRyaXBsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGVkaXRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIGRlY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgaW5jcmVtZW50QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB0cmlwbGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmFsaWRhdGVJY29uID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbih2YWxpZGF0ZUljb24sIFwiY2hlY2ttYXJrXCIpXG4gICAgICAgIHZhbGlkYXRlSWNvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVWYWx1ZShpbnB1dC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwLmZpbGUucGF0aClcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXQudmFsdWUpIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdXR0b24sIGluY3JlbWVudEJ1dHRvbiwgaW5wdXQudmFsdWUpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlucHV0Q29udGFpbmVyPy5hcHBlbmRDaGlsZCh2YWxpZGF0ZUljb24pXG4gICAgICAgIGNvbnN0IGNhbmNlbEljb24gPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiKVxuICAgICAgICBzZXRJY29uKGNhbmNlbEljb24sIFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGNhbmNlbEljb24pO1xuICAgICAgICBpbnB1dC5mb2N1cygpO1xuXG4gICAgICAgIGlucHV0Lm9ua2V5dXAgPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlVmFsdWUoaW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQuYWRkQ2xhc3MoJ2lzLWludmFsaWQnKTtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZUljb24uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlucHV0LnJlbW92ZUNsYXNzKCdpcy1pbnZhbGlkJyk7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVJY29uLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaW5wdXQub25rZXlkb3duID0gYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVWYWx1ZShpbnB1dC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIGlucHV0LnZhbHVlKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBpbnB1dC52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoaW5jcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGVkaXRCdXR0b24gb24gY2xpY2sgOiByZW1vdmUgYnV0dG9uIGFuZCBmaWVsZCBhbmQgZGlzcGxheSBpbnB1dCBmaWVsZCovXG4gICAgICAgIGVkaXRCdXR0b24ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChkZWNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5jcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHRyaXBsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgICAgICBpbnB1dC5mb2N1cygpXG4gICAgICAgIH1cblxuICAgICAgICAvKiBkZWNyZW1lbnQgYnV0dG9uIG9uIGNsaWNrOiBkZWNyZW1lbnQgYnkgc3RlcCBvciBieSAxICovXG4gICAgICAgIGRlY3JlbWVudEJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuRGVjcmVtZW50KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAoISFmU3RlcCA/IHBbdGhpcy5maWVsZC5uYW1lXSAtIGZTdGVwIDogcFt0aGlzLmZpZWxkLm5hbWVdIC0gMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIG5ld1ZhbHVlKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbmNyZW1lbnQgYnV0dG9uIG9uIGNsaWNrOiBpbmNyZW1lbnQgYnkgc3RlcCBvciBieSAxICovXG4gICAgICAgIGluY3JlbWVudEJ1dHRvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuSW5jcmVtZW50KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAoISFmU3RlcCA/IHBbdGhpcy5maWVsZC5uYW1lXSArIGZTdGVwIDogcFt0aGlzLmZpZWxkLm5hbWVdICsgMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIG5ld1ZhbHVlKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGRlY3JlbWVudEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbmNyZW1lbnRCdXR0b24pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh0cmlwbGVTcGFjZXIpO1xuICAgICAgICB0aGlzLnRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdXR0b24sIGluY3JlbWVudEJ1dHRvbiwgcFt0aGlzLmZpZWxkLm5hbWVdKTtcbiAgICB9XG59IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1vZGFsLCBUZXh0Q29tcG9uZW50LCBURmlsZSwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgTnVtYmVyRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9OdW1iZXJGaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE51bWJlck1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBmaWVsZE1hbmFnZXI6IE51bWJlckZpZWxkO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBwcml2YXRlIHZhbHVlOiBzdHJpbmcsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgIH07XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMuYnVpbGRJbnB1dEVsKCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgZGVjcmVtZW50KG51bWJlcklucHV0OiBUZXh0Q29tcG9uZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcCk7XG4gICAgICAgIGlmICghaXNOYU4oZlN0ZXApKSB7XG4gICAgICAgICAgICBudW1iZXJJbnB1dC5zZXRWYWx1ZSgocGFyc2VGbG9hdChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSAtIGZTdGVwKS50b1N0cmluZygpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG51bWJlcklucHV0LnNldFZhbHVlKChwYXJzZUZsb2F0KG51bWJlcklucHV0LmdldFZhbHVlKCkpIC0gMSkudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGluY3JlbWVudChudW1iZXJJbnB1dDogVGV4dENvbXBvbmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgaWYgKCFpc05hTihmU3RlcCkpIHtcbiAgICAgICAgICAgIG51bWJlcklucHV0LnNldFZhbHVlKChwYXJzZUZsb2F0KG51bWJlcklucHV0LmdldFZhbHVlKCkpICsgZlN0ZXApLnRvU3RyaW5nKCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbnVtYmVySW5wdXQuc2V0VmFsdWUoKHBhcnNlRmxvYXQobnVtYmVySW5wdXQuZ2V0VmFsdWUoKSkgKyAxKS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuOiBCdXR0b25Db21wb25lbnQsIHBsdXNCdG46IEJ1dHRvbkNvbXBvbmVudCwgbnVtYmVySW5wdXQ6IFRleHRDb21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgbWludXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkRlY3JlbWVudChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSk7XG4gICAgICAgIHBsdXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkluY3JlbWVudChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSk7XG4gICAgICAgIGlmICh0aGlzLmZpZWxkTWFuYWdlci5jYW5EZWNyZW1lbnQobnVtYmVySW5wdXQuZ2V0VmFsdWUoKSkpIHtcbiAgICAgICAgICAgIG1pbnVzQnRuLnNldEN0YSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWludXNCdG4ucmVtb3ZlQ3RhKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmllbGRNYW5hZ2VyLmNhbkluY3JlbWVudChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSkge1xuICAgICAgICAgICAgcGx1c0J0bi5zZXRDdGEoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBsdXNCdG4ucmVtb3ZlQ3RhKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkSW5wdXRFbCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnNcblxuICAgICAgICBjb25zdCBmaWVsZENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG5cbiAgICAgICAgY29uc3QgbnVtYmVySW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChmaWVsZENvbnRhaW5lcik7XG4gICAgICAgIG51bWJlcklucHV0LmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgbnVtYmVySW5wdXQuc2V0VmFsdWUoYCR7dGhpcy52YWx1ZX1gKTtcblxuICAgICAgICBjb25zdCBtaW51c0J0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZmllbGRDb250YWluZXIpO1xuICAgICAgICBtaW51c0J0bi5zZXRCdXR0b25UZXh0KGAtICR7ISFzdGVwID8gc3RlcCA6IDF9YCk7XG4gICAgICAgIG1pbnVzQnRuLnNldERpc2FibGVkKCF0aGlzLmZpZWxkTWFuYWdlci5jYW5EZWNyZW1lbnQobnVtYmVySW5wdXQuZ2V0VmFsdWUoKSkpO1xuXG4gICAgICAgIGNvbnN0IHBsdXNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgcGx1c0J0bi5zZXRCdXR0b25UZXh0KGArICR7ISFzdGVwID8gc3RlcCA6IDF9YCk7XG4gICAgICAgIHBsdXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkluY3JlbWVudChudW1iZXJJbnB1dC5nZXRWYWx1ZSgpKSk7XG5cbiAgICAgICAgZmllbGRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG5cbiAgICAgICAgY29uc3QgdmFsaWRhdGVCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgdmFsaWRhdGVCdG4uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcblxuICAgICAgICBjb25zdCBjYW5jZWxCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgY2FuY2VsQnRuLnNldEljb24oXCJjcm9zc1wiKTtcblxuICAgICAgICBjb25zdCBlcnJvckZpZWxkID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwiZmllbGQtZXJyb3JcIiB9KVxuICAgICAgICBlcnJvckZpZWxkLmhpZGUoKVxuXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuLCBwbHVzQnRuLCBudW1iZXJJbnB1dCk7XG5cbiAgICAgICAgLy9ldmVudCBoYW5kbGVyc1xuICAgICAgICBudW1iZXJJbnB1dC5vbkNoYW5nZSgoKSA9PiB7XG4gICAgICAgICAgICBudW1iZXJJbnB1dC5pbnB1dEVsLnJlbW92ZUNsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgZXJyb3JGaWVsZC5oaWRlKCk7XG4gICAgICAgICAgICBlcnJvckZpZWxkLnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbnNTdGF0ZShtaW51c0J0biwgcGx1c0J0biwgbnVtYmVySW5wdXQpXG4gICAgICAgIH0pXG5cbiAgICAgICAgcGx1c0J0bi5vbkNsaWNrKChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmluY3JlbWVudChudW1iZXJJbnB1dCk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbnNTdGF0ZShtaW51c0J0biwgcGx1c0J0biwgbnVtYmVySW5wdXQpO1xuICAgICAgICB9KVxuXG4gICAgICAgIG1pbnVzQnRuLm9uQ2xpY2soKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuZGVjcmVtZW50KG51bWJlcklucHV0KTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuLCBwbHVzQnRuLCBudW1iZXJJbnB1dCk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgY2FuY2VsQnRuLm9uQ2xpY2soKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICB9KVxuXG4gICAgICAgIHZhbGlkYXRlQnRuLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGlucHV0VmFsdWUgPSBudW1iZXJJbnB1dC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZVZhbHVlKGlucHV0VmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBtaW4sIG1heCB9ID0gdGhpcy5maWVsZC5vcHRpb25zXG4gICAgICAgICAgICAgICAgZXJyb3JGaWVsZC5zaG93KCk7XG4gICAgICAgICAgICAgICAgZXJyb3JGaWVsZC5zZXRUZXh0KGB2YWx1ZSBtdXN0IGJlIG51bWVyaWMke21pbiA/IFwiIGFuZCA+PSBcIiArIG1pbiA6IFwiXCJ9ICR7bWF4ID8gXCIgYW5kIDw9IFwiICsgbWF4IDogXCJcIn1gKVxuICAgICAgICAgICAgICAgIG51bWJlcklucHV0LmlucHV0RWwuc2V0QXR0cihcImNsYXNzXCIsIFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSkgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dFZhbHVlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KSB9KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IE1lbnUsIHNldEljb24sIFRleHRDb21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwiLi9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWxlY3RGaWVsZCBleHRlbmRzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQge1xuXG4gICAgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD4gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLlNlbGVjdClcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHZhbHVlLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlXCIpO1xuICAgICAgICBjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKClcbiAgICAgICAgaWYgKFNlbGVjdEZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgJHtuYW1lfWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihGaWVsZEljb25bRmllbGRUeXBlLlNlbGVjdF0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoU2VsZWN0RmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuU2VsZWN0XVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoU2VsZWN0RmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5NdWx0aV0sIGFjdGlvbiwgYFVwZGF0ZSAke25hbWV9J3MgdmFsdWVgKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHVibGljIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZT86IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIGFmdGVyPzogYm9vbGVhbiwgYXNMaXN0PzogYm9vbGVhbiwgYXNDb21tZW50PzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IFNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB2YWx1ZSB8fCBcIlwiLCB0aGlzLmZpZWxkLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IG9wdGlvbiBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRyczogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9ID0ge31cbiAgICApOiB2b2lkIHtcbiAgICAgICAgYXR0cnMuY2xzID0gXCJ2YWx1ZS1jb250YWluZXJcIlxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSB8fCBcIlwiLCBhdHRycykpXG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3Qgc3BhY2VyID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic3BhY2VyLTFcIiB9KVxuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBtb2RhbCAqL1xuICAgICAgICBjb25zdCBkcm9wRG93bkJ1dHRvbiA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGRyb3BEb3duQnV0dG9uLCBcImRvd24tY2hldnJvbi1nbHlwaFwiKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogU2VsZWN0TW9kYWw7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IFNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCBwW3RoaXMuZmllbGQubmFtZV0sIHRoaXMuZmllbGQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cblxuICAgICAgICBkcm9wRG93bkJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gZmllbGRNb2RhbC5vcGVuKClcbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIGRyb3BEb3duQnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBkcm9wRG93bkJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZHJvcERvd25CdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCB7IFRGaWxlLCBTdWdnZXN0TW9kYWwsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0ICogYXMgc2VsZWN0VmFsdWVzU291cmNlIGZyb20gXCJzcmMvdHlwZXMvc2VsZWN0VmFsdWVzU291cmNlVHlwZXNcIlxuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Fic3RyYWN0TGlzdEJhc2VkRmllbGRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmFsdWVTdWdnZXN0TW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8c3RyaW5nPntcblxuICAgIHByaXZhdGUgYWRkQnV0dG9uOiBCdXR0b25Db21wb25lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSxcbiAgICAgICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYWZ0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0xpc3Q6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhc0NvbW1lbnQ6IGJvb2xlYW4gPSBmYWxzZVxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgc3VwZXIub25PcGVuKClcbiAgICAgICAgY29uc3QgaW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJzdWdnZXN0ZXItaW5wdXRcIiB9KVxuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmlucHV0RWwpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZmluZChcIi5wcm9tcHRcIikucHJlcGVuZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KVxuICAgICAgICBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGluZm9Db250YWluZXIgPSBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImluZm9cIiB9KVxuICAgICAgICBpbmZvQ29udGFpbmVyLnNldFRleHQoXCJTaGlmdCtFbnRlciB0byBzYXZlXCIpXG4gICAgICAgIC8vIGFkZEJ1dHRvblxuICAgICAgICB0aGlzLmFkZEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLnNldEljb24oXCJwbHVzXCIpXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5hZGROZXdWYWx1ZVRvU2V0dGluZ3MoKSlcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0Q3RhKCk7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLnNldFRvb2x0aXAoXCJBZGQgdGhpcyB2YWx1ZSB0byB0aGlzIGZpZWxkIHNldHRpbmdzXCIpXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKTtcbiAgICAgICAgLy9jYW5jZWwgYnV0dG9uXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuY2xvc2UoKSlcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldFRvb2x0aXAoXCJDYW5jZWxcIilcbiAgICAgICAgLy9jbGVhciB2YWx1ZSBidXR0b25cbiAgICAgICAgY29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2xlYXJCdXR0b24uc2V0SWNvbihcImVyYXNlclwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2xlYXJWYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgY2xlYXJCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJkYW5nZXJcIilcbiAgICAgICAgY2xlYXJCdXR0b24uc2V0VG9vbHRpcChcIkNsZWFyIHRoZSBmaWVsZCB2YWx1ZVwiKVxuICAgICAgICB0aGlzLm1vZGFsRWwuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKTtcbiAgICB9XG5cbiAgICBhc3luYyBhZGROZXdWYWx1ZVRvU2V0dGluZ3MoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gdGhpcy5pbnB1dEVsLnZhbHVlO1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQodGhpcy5maWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IHRoaXMuZmllbGQubmFtZSk/LmZpbGVDbGFzc05hbWVcbiAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlID0gZmlsZUNsYXNzPy5hdHRyaWJ1dGVzLmZpbmQoYXR0ciA9PiBhdHRyLm5hbWUgPT09IHRoaXMuZmllbGQubmFtZSlcbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MgJiYgZmlsZUNsYXNzQXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgbGV0IG5ld09wdGlvbnM6IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucykpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IFsuLi5maWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucywgbmV3VmFsdWVdXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdCBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zW2Ake09iamVjdC5rZXlzKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnZhbHVlc0xpc3QpLmxlbmd0aCArIDF9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlLCBmaWxlQ2xhc3NBdHRyaWJ1dGUubmFtZSwgbmV3T3B0aW9ucywgZmlsZUNsYXNzQXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHZhbHVlc0ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQodmFsdWVzRmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkodmFsdWVzRmlsZSwgYCR7cmVzdWx0fVxcbiR7bmV3VmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnNbYCR7T2JqZWN0LmtleXMoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMpLmxlbmd0aH1gXSA9IG5ld1ZhbHVlXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUoZmlsZUNsYXNzQXR0cmlidXRlLnR5cGUsIGZpbGVDbGFzc0F0dHJpYnV0ZS5uYW1lLCBuZXdPcHRpb25zLCBmaWxlQ2xhc3NBdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByZXNldEZpZWxkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKVxuICAgICAgICAgICAgaWYgKHByZXNldEZpZWxkPy5vcHRpb25zLnNvdXJjZVR5cGUgPT09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0ZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHByZXNldEZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgdmFsdWVzRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkodmFsdWVzRmlsZSwgYCR7cmVzdWx0fVxcbiR7bmV3VmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChwcmVzZXRGaWVsZD8ub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nRmllbGQgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maW5kKHAgPT4gcC5pZCA9PSB0aGlzLmZpZWxkLmlkKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzTGlzdCA9IGN1cnJlbnRFeGlzdGluZ0ZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXNMaXN0W2Ake09iamVjdC5rZXlzKHZhbHVlc0xpc3QpLmxlbmd0aCArIDF9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVJdGVtKG5ld1ZhbHVlKTtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cblxuICAgIGFzeW5jIGNsZWFyVmFsdWVzKCkge1xuICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIikgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBcIlwiLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy5hZnRlciwgdGhpcy5hc0xpc3QsIHRoaXMuYXNDb21tZW50KSB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBsZXQgZHZGaWxlOiBhbnk7XG4gICAgICAgIGlmIChkdkFwaSkgZHZGaWxlID0gZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aClcbiAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKSBhcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IGZpZWxkTWFuYWdlci5nZXRPcHRpb25zTGlzdChkdkZpbGUpLmZpbHRlcihvID0+IG8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSlcbiAgICAgICAgaWYgKHRoaXMuYWRkQnV0dG9uKSB7XG4gICAgICAgICAgICAodmFsdWVzLnNvbWUocCA9PiBwID09PSBxdWVyeSkgfHwgdGhpcy5maWVsZC5vcHRpb25zLnNvdXJjZVR5cGUgPT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzRnJvbURWUXVlcnkgfHwgIXF1ZXJ5KSA/XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuaGlkZSgpIDpcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5zaG93KCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB2YWx1ZXNcbiAgICB9XG5cbiAgICByZW5kZXJTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5zZXRUZXh0KHZhbHVlKVxuICAgICAgICBlbC5hZGRDbGFzcyhcInZhbHVlLWNvbnRhaW5lclwiKTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLnZhbHVlKSBlbC5hZGRDbGFzcyhcInZhbHVlLWNoZWNrZWRcIilcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVJdGVtKGl0ZW06IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaXRlbS50b1N0cmluZygpKSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIGl0ZW0udG9TdHJpbmcoKSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VTdWdnZXN0aW9uKGl0ZW06IHN0cmluZywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICB0aGlzLnNhdmVJdGVtKGl0ZW0pXG4gICAgfVxufSIsICJleHBvcnQgZW51bSBUeXBlIHtcbiAgICBcIlZhbHVlc0xpc3RcIiA9IFwiVmFsdWVzTGlzdFwiLFxuICAgIFwiVmFsdWVzTGlzdE5vdGVQYXRoXCIgPSBcIlZhbHVlc0xpc3ROb3RlUGF0aFwiLFxuICAgIFwiVmFsdWVzRnJvbURWUXVlcnlcIiA9IFwiVmFsdWVzRnJvbURWUXVlcnlcIlxufVxuXG5leHBvcnQgY29uc3QgS2V5OiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJWYWx1ZXNMaXN0XCI6IFwidmFsdWVzTGlzdFwiLFxuICAgIFwiVmFsdWVzTGlzdE5vdGVQYXRoXCI6IFwidmFsdWVzTGlzdE5vdGVQYXRoXCIsXG4gICAgXCJWYWx1ZXNGcm9tRFZRdWVyeVwiOiBcInZhbHVlc0Zyb21EVlF1ZXJ5XCJcbn1cblxuZXhwb3J0IGNvbnN0IHR5cGVEaXNwbGF5OiBSZWNvcmQ8a2V5b2YgdHlwZW9mIFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJWYWx1ZXNMaXN0XCI6IFwiVmFsdWVzIGRlZmluZWQgaW4gdGhlc2Ugc2V0dGluZ3NcIixcbiAgICBcIlZhbHVlc0xpc3ROb3RlUGF0aFwiOiBcIlZhbHVlcyBmcm9tIGEgbm90ZVwiLFxuICAgIFwiVmFsdWVzRnJvbURWUXVlcnlcIjogXCJWYWx1ZXMgcmV0dXJuZWQgZnJvbSBhIGRhdGF2aWV3IHF1ZXJ5XCJcbn0iLCAiaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgc2V0SWNvbiwgRHJvcGRvd25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWxlU3VnZ2VzdCB9IGZyb20gXCJzcmMvc3VnZ2VzdGVyL0ZpbGVTdWdnZXN0ZXJcIjtcbmltcG9ydCAqIGFzIHNlbGVjdFZhbHVlc1NvdXJjZSBmcm9tIFwic3JjL3R5cGVzL3NlbGVjdFZhbHVlc1NvdXJjZVR5cGVzXCJcblxuZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBhYnN0cmFjdCB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQsIHR5cGU6IEZpZWxkVHlwZSkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCB0eXBlKVxuICAgIH1cblxuICAgIC8vU2V0dGluZ3NcbiAgICBwcml2YXRlIHNldFZhbHVlTGlzdFRleHQoaGVhZGVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBoZWFkZXIuc2V0VGV4dChgUHJlc2V0IG9wdGlvbnM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkuam9pbignLCAnKX1gKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVMaXN0Tm90ZVBhdGhDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpOiBIVE1MRGl2RWxlbWVudCB7XG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiBgUGF0aCBvZiB0aGUgbm90ZWAsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lcik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBpbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgbmV3IEZpbGVTdWdnZXN0KFxuICAgICAgICAgICAgaW5wdXQuaW5wdXRFbCxcbiAgICAgICAgICAgIHBsdWdpbixcbiAgICAgICAgICAgIFwiL1wiXG4gICAgICAgIClcbiAgICAgICAgY29uc3QgbGlzdE5vdGVQYXRoID0gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aDtcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUobGlzdE5vdGVQYXRoIHx8IFwiXCIpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIlBhdGgvb2YvdGhlL25vdGUubWRcIik7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGggPSB2YWx1ZSk7XG4gICAgICAgIHJldHVybiB2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXI7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW1vdmVQcmVzZXRWYWx1ZShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBsZXQgbmV3VmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICAgIGZvciAobGV0IF9rZXkgaW4gdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT09IF9rZXkpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZXNbX2tleV0gPSB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdFtfa2V5XTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0ID0gbmV3VmFsdWVzO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVZhbHVlc0xpc3RDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgY29uc3QgcHJlc2V0VmFsdWVzRmllbGRzID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpXG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBwcmVzZXRWYWx1ZXNGaWVsZHMuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3RIZWFkZXIgPSB2YWx1ZXNMaXN0LmNyZWF0ZURpdih7fSk7XG4gICAgICAgIHZhbHVlc0xpc3RIZWFkZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogYFByZXNldCBvcHRpb25zOiAke09iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpLmpvaW4oJywgJyl9YCB9KTtcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEJvZHkgPSB2YWx1ZXNMaXN0LmNyZWF0ZURpdigpO1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnB1c2godGhpcy5jcmVhdGVWYWx1ZUNvbnRhaW5lcih2YWx1ZXNMaXN0Qm9keSwgdmFsdWVzTGlzdEhlYWRlciwga2V5KSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNyZWF0ZUFkZEJ1dHRvbih2YWx1ZXNMaXN0LCB2YWx1ZXNMaXN0Qm9keSwgdmFsdWVzTGlzdEhlYWRlcilcbiAgICAgICAgcmV0dXJuIHByZXNldFZhbHVlc0ZpZWxkcztcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVZhbHVlQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50LCBoZWFkZXI6IEhUTUxEaXZFbGVtZW50LCBrZXk6IHN0cmluZyk6IFRleHRDb21wb25lbnQge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCB8fCB7fTtcbiAgICAgICAgY29uc3QgcHJlc2V0VmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7IGNsczogJ2ZpZWxkLWNvbnRhaW5lcicsIH0pO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgaW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5wdXNoKGlucHV0KVxuICAgICAgICBpbnB1dC5zZXRWYWx1ZShwcmVzZXRWYWx1ZSk7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsdWVMaXN0VGV4dChoZWFkZXIpO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcihpbnB1dCk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB2YWx1ZVJlbW92ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQodmFsdWVDb250YWluZXIpO1xuICAgICAgICB2YWx1ZVJlbW92ZUJ1dHRvbi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVQcmVzZXRWYWx1ZShrZXkpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFsdWVMaXN0VGV4dChoZWFkZXIpO1xuICAgICAgICAgICAgICAgIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodmFsdWVDb250YWluZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5yZW1vdmUoaW5wdXQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIGlmIChrZXkgIT0gT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKVswXSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWVVcGdyYWRlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICBzZXRJY29uKHZhbHVlVXBncmFkZUJ1dHRvbi5idXR0b25FbCwgXCJ1cC1jaGV2cm9uLWdseXBoXCIpO1xuICAgICAgICAgICAgdmFsdWVVcGdyYWRlQnV0dG9uLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRoaXNWYWx1ZSA9IHZhbHVlc1trZXldO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0SW5kZXggPSB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMuaW5kZXhPZihpbnB1dClcbiAgICAgICAgICAgICAgICBjb25zdCB1cHBlckNvbXBvbmVudCA9IGlucHV0SW5kZXggIT09IC0xID8gdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzW2lucHV0SW5kZXggLSAxXSA6IHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50cy5sYXN0KCk7XG4gICAgICAgICAgICAgICAgaWYgKHVwcGVyQ29tcG9uZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwcGVyVmFsdWUgPSB1cHBlckNvbXBvbmVudC5pbnB1dEVsLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cHBlcktleSA9IE9iamVjdC5rZXlzKHZhbHVlcykuZmlsdGVyKGsgPT4gdmFsdWVzW2tdID09IHVwcGVyVmFsdWUpWzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodXBwZXJLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyQ29tcG9uZW50LnNldFZhbHVlKHRoaXNWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbdXBwZXJLZXldID0gdGhpc1ZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQuc2V0VmFsdWUodXBwZXJWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNba2V5XSA9IHVwcGVyVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfTtcblxuICAgIHB1YmxpYyB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgLy90b2RvIDogbWFuYWdlIGJvdGggcmF3IGxpbmtzIGFuZCBkdiBMaW5rIG9iamVjdHNcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICBzd2l0Y2ggKHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgICAgIGNhc2Ugc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdE5vdGVQYXRoOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoXG4gICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0Zyb21EVlF1ZXJ5OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzRnJvbURWUXVlcnlcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiXCJcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNMaXN0KGR2RmlsZTogYW55ID0gdW5kZWZpbmVkKTogc3RyaW5nW10ge1xuICAgICAgICBsZXQgdmFsdWVzOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0aGlzLmZpZWxkLm9wdGlvbnMpKSB7XG4gICAgICAgICAgICB2YWx1ZXMgPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlKSB7XG4gICAgICAgICAgICB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuZmllbGQub3B0aW9ucyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0OlxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGg6XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXgudmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAuZ2V0KHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgpIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0Zyb21EVlF1ZXJ5OlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gbmV3IEZ1bmN0aW9uKFwiZHZcIiwgXCJjdXJyZW50XCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzRnJvbURWUXVlcnl9YCkoZHZBcGksIGR2RmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgICAgICAgaWYgKC9bLF0vZ3UudGVzdChpbnB1dC5pbnB1dEVsLnZhbHVlKSAmJiBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgXCJWYWx1ZXMgY2Fubm90IGNvbnRhaW4gYSBjb21tYVwiXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGlucHV0LmlucHV0RWwudmFsdWUgPT0gXCJcIiAmJiBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgXCJWYWx1ZXMgY2FuJ3QgYmUgbnVsbC5cIlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiAhZXJyb3JcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUFkZEJ1dHRvbih2YWx1ZXNMaXN0OiBIVE1MRGl2RWxlbWVudCwgdmFsdWVzTGlzdEJvZHk6IEhUTUxEaXZFbGVtZW50LCB2YWx1ZXNMaXN0SGVhZGVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0Rm9vdGVyID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgYWRkVmFsdWUgPSB2YWx1ZXNMaXN0Rm9vdGVyLmNyZWF0ZUVsKCdidXR0b24nKTtcbiAgICAgICAgYWRkVmFsdWUudHlwZSA9ICdidXR0b24nO1xuICAgICAgICBhZGRWYWx1ZS50ZXh0Q29udGVudCA9ICdBZGQgYSB2YWx1ZSc7XG4gICAgICAgIGFkZFZhbHVlLm9uQ2xpY2tFdmVudChhc3luYyAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQ7XG5cbiAgICAgICAgICAgIGxldCBuZXdLZXlOdW1iZXIgPSAxO1xuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0xpc3QpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoa2V5KSAmJiBwYXJzZUludChrZXkpID49IG5ld0tleU51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICBuZXdLZXlOdW1iZXIgPSBwYXJzZUludChrZXkpICsgMTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBuZXdLZXkgPSBuZXdLZXlOdW1iZXIudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNMaXN0W25ld0tleV0gPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVWYWx1ZUNvbnRhaW5lcih2YWx1ZXNMaXN0Qm9keSwgdmFsdWVzTGlzdEhlYWRlciwgbmV3S2V5KVxuICAgICAgICB9KTtcbiAgICAgICAgdmFsdWVzTGlzdC5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlVmFsdWVzRnJvbURWUXVlcnlDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IEhUTUxEaXZFbGVtZW50IHtcbiAgICAgICAgY29uc3QgdmFsdWVzRnJvbURWUXVlcnlUb3BDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSlcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnlUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJEYXRhdmlldyBmdW5jdGlvblwiIH0pO1xuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeVRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IHF1ZXJ5IHJldHVybmluZyBhIGxpc3Qgb2Ygc3RyaW5nICg8ZHY+IG9iamVjdCBpcyBhdmFpbGFibGUpXCIsIGNsczogXCJzdWItdGV4dFwiIH0pO1xuICAgICAgICBjb25zdCB2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lciA9IHZhbHVlc0Zyb21EVlF1ZXJ5VG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICBjb25zdCB2YWx1ZXNGcm9tRFZRdWVyeSA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudCh2YWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeS5pbnB1dEVsLmNvbHMgPSA2NTtcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuaW5wdXRFbC5yb3dzID0gODtcbiAgICAgICAgdmFsdWVzRnJvbURWUXVlcnkuc2V0UGxhY2Vob2xkZXIoXCJleDogZHYucGFnZXMoJyNzdHVkZW50JykubWFwKHAgPT4gcC5uYW1lKVwiKVxuICAgICAgICB2YWx1ZXNGcm9tRFZRdWVyeS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzRnJvbURWUXVlcnkgfHwgXCJcIik7XG4gICAgICAgIHZhbHVlc0Zyb21EVlF1ZXJ5Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5ID0gdmFsdWVcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIHZhbHVlc0Zyb21EVlF1ZXJ5VG9wQ29udGFpbmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgZGlzcGxheVNlbGVjdGVkVHlwZUNvbnRhaW5lcihvcHRpb25Db250YWluZXJzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLCBIVE1MRGl2RWxlbWVudD4sIHZhbHVlOiBrZXlvZiB0eXBlb2Ygc2VsZWN0VmFsdWVzU291cmNlLlR5cGUpIHtcbiAgICAgICAgT2JqZWN0LmtleXMob3B0aW9uQ29udGFpbmVycykuZm9yRWFjaCgoa2V5OiBrZXlvZiB0eXBlb2Ygc2VsZWN0VmFsdWVzU291cmNlLlR5cGUpID0+IHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uQ29udGFpbmVyc1trZXldLnNob3coKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBvcHRpb25Db250YWluZXJzW2tleV0uaGlkZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNvdXJjZVR5cGVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBzb3VyY2VUeXBlQ29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiVmFsdWVzIHNvdXJjZSB0eXBlXCIsIGNsczogXCJsYWJlbFwiIH0pXG4gICAgICAgIHNvdXJjZVR5cGVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pO1xuICAgICAgICBjb25zdCBzb3VyY2VUeXBlID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHNvdXJjZVR5cGVDb250YWluZXIpO1xuXG4gICAgICAgIC8vbWFuYWdlIG5ldyBmaWVsZCBhbmQgZmlsZUNsYXNzIGxlZ2FjeSBmaWVsZFxuICAgICAgICBpZiAoIXRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlKSB7XG4gICAgICAgICAgICAvL3RoaXMgaXMgYSBuZXcgZmllbGQgb3IgZmlsZUNsYXNzIGxlZ2FjeSBmaWVsZFxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmZpZWxkLm9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKS5ldmVyeShrZXkgPT4gIWlzTmFOKHBhcnNlSW50KGtleSkpKSkge1xuICAgICAgICAgICAgICAgIC8vdGhpcyBpcyBhIGZpbGVDbGFzcyBsZWdhY3kgZmllbGRcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNMaXN0OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB2YWx1ZXNMaXN0W2tleV0gPSB0aGlzLmZpZWxkLm9wdGlvbnNba2V5XSk7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdCA9IHZhbHVlc0xpc3Q7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucyA9IHt9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSA9IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0xpc3Q7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy52YWx1ZXNGcm9tRFZRdWVyeSA9IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmtleXMoc2VsZWN0VmFsdWVzU291cmNlLlR5cGUpLmZvckVhY2goKG9wdGlvbjoga2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKSA9PiBzb3VyY2VUeXBlLmFkZE9wdGlvbihvcHRpb24sIHNlbGVjdFZhbHVlc1NvdXJjZS50eXBlRGlzcGxheVtvcHRpb25dKSlcbiAgICAgICAgc291cmNlVHlwZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSB8fCBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0KVxuXG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3ROb3RlUGF0aENvbnRhaW5lciA9IHRoaXMuY3JlYXRlTGlzdE5vdGVQYXRoQ29udGFpbmVyKGNvbnRhaW5lciwgcGx1Z2luKTtcbiAgICAgICAgY29uc3QgcHJlc2V0VmFsdWVzRmllbGRzQ29udGFpbmVyID0gdGhpcy5jcmVhdGVWYWx1ZXNMaXN0Q29udGFpbmVyKGNvbnRhaW5lcik7XG4gICAgICAgIGNvbnN0IHZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyID0gdGhpcy5jcmVhdGVWYWx1ZXNGcm9tRFZRdWVyeUNvbnRhaW5lcihjb250YWluZXIpO1xuXG4gICAgICAgIGNvbnN0IHZhbHVlc0NvbnRhaW5lcnM6IFJlY29yZDxrZXlvZiB0eXBlb2Ygc2VsZWN0VmFsdWVzU291cmNlLlR5cGUsIEhUTUxEaXZFbGVtZW50PiA9IHtcbiAgICAgICAgICAgIFwiVmFsdWVzTGlzdFwiOiBwcmVzZXRWYWx1ZXNGaWVsZHNDb250YWluZXIsXG4gICAgICAgICAgICBcIlZhbHVlc0xpc3ROb3RlUGF0aFwiOiB2YWx1ZXNMaXN0Tm90ZVBhdGhDb250YWluZXIsXG4gICAgICAgICAgICBcIlZhbHVlc0Zyb21EVlF1ZXJ5XCI6IHZhbHVlc0Zyb21EVlF1ZXJ5Q29udGFpbmVyXG4gICAgICAgIH1cblxuICAgICAgICBzb3VyY2VUeXBlLm9uQ2hhbmdlKCh2YWx1ZToga2V5b2YgdHlwZW9mIHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRUeXBlQ29udGFpbmVyKHZhbHVlc0NvbnRhaW5lcnMsIHZhbHVlKVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMuZGlzcGxheVNlbGVjdGVkVHlwZUNvbnRhaW5lcih2YWx1ZXNDb250YWluZXJzLCB0aGlzLmZpZWxkLm9wdGlvbnMuc291cmNlVHlwZSlcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzOiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0gPSB7fVxuICAgICk6IHZvaWQge1xuICAgICAgICBhdHRycy5jbHMgPSBcInZhbHVlLWNvbnRhaW5lclwiXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycykpXG4gICAgfVxufSIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuXG5pbXBvcnQgeyBUQWJzdHJhY3RGaWxlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgVGV4dElucHV0U3VnZ2VzdCB9IGZyb20gXCIuL3N1Z2dlc3RcIjtcbmltcG9ydCB7IGdldF90ZmlsZXNfZnJvbV9mb2xkZXIgfSBmcm9tIFwiLi4vdXRpbHMvZmlsZVV0aWxzXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWxlU3VnZ2VzdCBleHRlbmRzIFRleHRJbnB1dFN1Z2dlc3Q8VEZpbGU+IHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHB1YmxpYyBmb2xkZXI6IHN0cmluZ1xuICAgICkge1xuICAgICAgICBzdXBlcihpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhpbnB1dF9zdHI6IHN0cmluZyk6IFRGaWxlW10ge1xuICAgICAgICBjb25zdCBhbGxfZmlsZXMgPSBbXVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYWxsX2ZpbGVzLnB1c2goLi4uZ2V0X3RmaWxlc19mcm9tX2ZvbGRlcih0aGlzLnBsdWdpbiwgdGhpcy5mb2xkZXIpKVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmlsZXM6IFRGaWxlW10gPSBbXTtcbiAgICAgICAgY29uc3QgbG93ZXJfaW5wdXRfc3RyID0gaW5wdXRfc3RyLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgYWxsX2ZpbGVzLmZvckVhY2goKGZpbGU6IFRBYnN0cmFjdEZpbGUpID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiZcbiAgICAgICAgICAgICAgICBmaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiICYmXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLnRvTG93ZXJDYXNlKCkuY29udGFpbnMobG93ZXJfaW5wdXRfc3RyKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgZmlsZXMucHVzaChmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZpbGVzO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5zZXRUZXh0KGZpbGUucGF0aCk7XG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihmaWxlOiBURmlsZSk6IHZvaWQge1xuICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSBmaWxlLnBhdGg7XG4gICAgICAgIHRoaXMuaW5wdXRFbC50cmlnZ2VyKFwiaW5wdXRcIik7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCAiLy8gQ3JlZGl0cyBnbyB0byBMaWFtJ3MgUGVyaW9kaWMgTm90ZXMgUGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vbGlhbWNhaW4vb2JzaWRpYW4tcGVyaW9kaWMtbm90ZXNcblxuaW1wb3J0IHsgSVN1Z2dlc3RPd25lciwgU2NvcGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGNyZWF0ZVBvcHBlciwgSW5zdGFuY2UgYXMgUG9wcGVySW5zdGFuY2UgfSBmcm9tIFwiQHBvcHBlcmpzL2NvcmVcIjtcblxuY29uc3Qgd3JhcEFyb3VuZCA9ICh2YWx1ZTogbnVtYmVyLCBzaXplOiBudW1iZXIpOiBudW1iZXIgPT4ge1xuICAgIHJldHVybiAoKHZhbHVlICUgc2l6ZSkgKyBzaXplKSAlIHNpemU7XG59O1xuXG5jbGFzcyBTdWdnZXN0PFQ+IHtcbiAgICBwcml2YXRlIHZhbHVlczogVFtdO1xuICAgIHByaXZhdGUgc3VnZ2VzdGlvbnM6IEhUTUxEaXZFbGVtZW50W107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZEl0ZW06IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIG93bmVyOiBJU3VnZ2VzdE93bmVyPFQ+LFxuICAgICAgICBwcml2YXRlIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcbiAgICAgICAgc2NvcGU6IFNjb3BlXG4gICAgKSB7XG5cbiAgICAgICAgY29udGFpbmVyRWwub24oXG4gICAgICAgICAgICBcImNsaWNrXCIsXG4gICAgICAgICAgICBcIi5zdWdnZXN0aW9uLWl0ZW1cIixcbiAgICAgICAgICAgIHRoaXMub25TdWdnZXN0aW9uQ2xpY2suYmluZCh0aGlzKVxuICAgICAgICApO1xuICAgICAgICBjb250YWluZXJFbC5vbihcbiAgICAgICAgICAgIFwibW91c2Vtb3ZlXCIsXG4gICAgICAgICAgICBcIi5zdWdnZXN0aW9uLWl0ZW1cIixcbiAgICAgICAgICAgIHRoaXMub25TdWdnZXN0aW9uTW91c2VvdmVyLmJpbmQodGhpcylcbiAgICAgICAgKTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJBcnJvd1VwXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKHRoaXMuc2VsZWN0ZWRJdGVtIC0gMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJBcnJvd0Rvd25cIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoIWV2ZW50LmlzQ29tcG9zaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0odGhpcy5zZWxlY3RlZEl0ZW0gKyAxLCB0cnVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVudGVyXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMudXNlU2VsZWN0ZWRJdGVtKGV2ZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uU3VnZ2VzdGlvbkNsaWNrKGV2ZW50OiBNb3VzZUV2ZW50LCBlbDogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5zdWdnZXN0aW9ucy5pbmRleE9mKGVsKTtcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0oaXRlbSwgZmFsc2UpO1xuICAgICAgICB0aGlzLnVzZVNlbGVjdGVkSXRlbShldmVudCk7XG4gICAgfVxuXG4gICAgb25TdWdnZXN0aW9uTW91c2VvdmVyKF9ldmVudDogTW91c2VFdmVudCwgZWw6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLnN1Z2dlc3Rpb25zLmluZGV4T2YoZWwpO1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbShpdGVtLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgc2V0U3VnZ2VzdGlvbnModmFsdWVzOiBUW10pIHtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uRWxzOiBIVE1MRGl2RWxlbWVudFtdID0gW107XG5cbiAgICAgICAgdmFsdWVzLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uRWwgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdihcInN1Z2dlc3Rpb24taXRlbVwiKTtcbiAgICAgICAgICAgIHRoaXMub3duZXIucmVuZGVyU3VnZ2VzdGlvbih2YWx1ZSwgc3VnZ2VzdGlvbkVsKTtcbiAgICAgICAgICAgIHN1Z2dlc3Rpb25FbHMucHVzaChzdWdnZXN0aW9uRWwpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcztcbiAgICAgICAgdGhpcy5zdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25FbHM7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKDAsIGZhbHNlKTtcbiAgICB9XG5cbiAgICB1c2VTZWxlY3RlZEl0ZW0oZXZlbnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHRoaXMudmFsdWVzW3RoaXMuc2VsZWN0ZWRJdGVtXTtcbiAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5vd25lci5zZWxlY3RTdWdnZXN0aW9uKGN1cnJlbnRWYWx1ZSwgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0U2VsZWN0ZWRJdGVtKHNlbGVjdGVkSW5kZXg6IG51bWJlciwgc2Nyb2xsSW50b1ZpZXc6IGJvb2xlYW4pIHtcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZEluZGV4ID0gd3JhcEFyb3VuZChcbiAgICAgICAgICAgIHNlbGVjdGVkSW5kZXgsXG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Rpb25zLmxlbmd0aFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBwcmV2U2VsZWN0ZWRTdWdnZXN0aW9uID0gdGhpcy5zdWdnZXN0aW9uc1t0aGlzLnNlbGVjdGVkSXRlbV07XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkU3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdGlvbnNbbm9ybWFsaXplZEluZGV4XTtcblxuICAgICAgICBwcmV2U2VsZWN0ZWRTdWdnZXN0aW9uPy5yZW1vdmVDbGFzcyhcImlzLXNlbGVjdGVkXCIpO1xuICAgICAgICBzZWxlY3RlZFN1Z2dlc3Rpb24/LmFkZENsYXNzKFwiaXMtc2VsZWN0ZWRcIik7XG5cbiAgICAgICAgdGhpcy5zZWxlY3RlZEl0ZW0gPSBub3JtYWxpemVkSW5kZXg7XG5cbiAgICAgICAgaWYgKHNjcm9sbEludG9WaWV3KSB7XG4gICAgICAgICAgICBzZWxlY3RlZFN1Z2dlc3Rpb24uc2Nyb2xsSW50b1ZpZXcoZmFsc2UpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVGV4dElucHV0U3VnZ2VzdDxUPiBpbXBsZW1lbnRzIElTdWdnZXN0T3duZXI8VD4ge1xuICAgIHByb3RlY3RlZCBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudDtcblxuICAgIHByaXZhdGUgcG9wcGVyOiBQb3BwZXJJbnN0YW5jZTtcbiAgICBwcml2YXRlIHNjb3BlOiBTY29wZTtcbiAgICBwcml2YXRlIHN1Z2dlc3RFbDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzdWdnZXN0OiBTdWdnZXN0PFQ+O1xuXG4gICAgY29uc3RydWN0b3IoaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsID0gaW5wdXRFbDtcbiAgICAgICAgdGhpcy5zY29wZSA9IG5ldyBTY29wZSgpO1xuXG4gICAgICAgIHRoaXMuc3VnZ2VzdEVsID0gY3JlYXRlRGl2KFwic3VnZ2VzdGlvbi1jb250YWluZXJcIik7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb24gPSB0aGlzLnN1Z2dlc3RFbC5jcmVhdGVEaXYoXCJzdWdnZXN0aW9uXCIpO1xuICAgICAgICB0aGlzLnN1Z2dlc3QgPSBuZXcgU3VnZ2VzdCh0aGlzLCBzdWdnZXN0aW9uLCB0aGlzLnNjb3BlKTtcblxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVzY2FwZVwiLCB0aGlzLmNsb3NlLmJpbmQodGhpcykpO1xuXG4gICAgICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgdGhpcy5vbklucHV0Q2hhbmdlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCB0aGlzLm9uSW5wdXRDaGFuZ2VkLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0RWwub24oXG4gICAgICAgICAgICBcIm1vdXNlZG93blwiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1jb250YWluZXJcIixcbiAgICAgICAgICAgIChldmVudDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgb25JbnB1dENoYW5nZWQoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGlucHV0U3RyID0gdGhpcy5pbnB1dEVsLnZhbHVlO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9ucyA9IHRoaXMuZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHIpO1xuXG4gICAgICAgIGlmICghc3VnZ2VzdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnN1Z2dlc3Quc2V0U3VnZ2VzdGlvbnMoc3VnZ2VzdGlvbnMpO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIHRoaXMub3BlbigoPGFueT5hcHApLmRvbS5hcHBDb250YWluZXJFbCwgdGhpcy5pbnB1dEVsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9wZW4oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaW5wdXRFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgKDxhbnk+YXBwKS5rZXltYXAucHVzaFNjb3BlKHRoaXMuc2NvcGUpO1xuXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnN1Z2dlc3RFbCk7XG4gICAgICAgIHRoaXMucG9wcGVyID0gY3JlYXRlUG9wcGVyKGlucHV0RWwsIHRoaXMuc3VnZ2VzdEVsLCB7XG4gICAgICAgICAgICBwbGFjZW1lbnQ6IFwiYm90dG9tLXN0YXJ0XCIsXG4gICAgICAgICAgICBtb2RpZmllcnM6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFwic2FtZVdpZHRoXCIsXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGZuOiAoeyBzdGF0ZSwgaW5zdGFuY2UgfSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90ZTogcG9zaXRpb25pbmcgbmVlZHMgdG8gYmUgY2FsY3VsYXRlZCB0d2ljZSAtXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmaXJzdCBwYXNzIC0gcG9zaXRpb25pbmcgaXQgYWNjb3JkaW5nIHRvIHRoZSB3aWR0aCBvZiB0aGUgcG9wcGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWNvbmQgcGFzcyAtIHBvc2l0aW9uIGl0IHdpdGggdGhlIHdpZHRoIGJvdW5kIHRvIHRoZSByZWZlcmVuY2UgZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBlYXJseSBleGl0IHRvIGF2b2lkIGFuIGluZmluaXRlIGxvb3BcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldFdpZHRoID0gYCR7c3RhdGUucmVjdHMucmVmZXJlbmNlLndpZHRofXB4YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5zdHlsZXMucG9wcGVyLndpZHRoID09PSB0YXJnZXRXaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlLnN0eWxlcy5wb3BwZXIud2lkdGggPSB0YXJnZXRXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwaGFzZTogXCJiZWZvcmVXcml0ZVwiLFxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlczogW1wiY29tcHV0ZVN0eWxlc1wiXSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKTogdm9pZCB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICg8YW55PmFwcCkua2V5bWFwLnBvcFNjb3BlKHRoaXMuc2NvcGUpO1xuXG4gICAgICAgIHRoaXMuc3VnZ2VzdC5zZXRTdWdnZXN0aW9ucyhbXSk7XG4gICAgICAgIGlmICh0aGlzLnBvcHBlcikgdGhpcy5wb3BwZXIuZGVzdHJveSgpO1xuICAgICAgICB0aGlzLnN1Z2dlc3RFbC5kZXRhY2goKTtcbiAgICB9XG5cbiAgICBhYnN0cmFjdCBnZXRTdWdnZXN0aW9ucyhpbnB1dFN0cjogc3RyaW5nKTogVFtdO1xuICAgIGFic3RyYWN0IHJlbmRlclN1Z2dlc3Rpb24oaXRlbTogVCwgZWw6IEhUTUxFbGVtZW50KTogdm9pZDtcbiAgICBhYnN0cmFjdCBzZWxlY3RTdWdnZXN0aW9uKGl0ZW06IFQpOiB2b2lkO1xufVxuIiwgImV4cG9ydCB2YXIgdG9wID0gJ3RvcCc7XG5leHBvcnQgdmFyIGJvdHRvbSA9ICdib3R0b20nO1xuZXhwb3J0IHZhciByaWdodCA9ICdyaWdodCc7XG5leHBvcnQgdmFyIGxlZnQgPSAnbGVmdCc7XG5leHBvcnQgdmFyIGF1dG8gPSAnYXV0byc7XG5leHBvcnQgdmFyIGJhc2VQbGFjZW1lbnRzID0gW3RvcCwgYm90dG9tLCByaWdodCwgbGVmdF07XG5leHBvcnQgdmFyIHN0YXJ0ID0gJ3N0YXJ0JztcbmV4cG9ydCB2YXIgZW5kID0gJ2VuZCc7XG5leHBvcnQgdmFyIGNsaXBwaW5nUGFyZW50cyA9ICdjbGlwcGluZ1BhcmVudHMnO1xuZXhwb3J0IHZhciB2aWV3cG9ydCA9ICd2aWV3cG9ydCc7XG5leHBvcnQgdmFyIHBvcHBlciA9ICdwb3BwZXInO1xuZXhwb3J0IHZhciByZWZlcmVuY2UgPSAncmVmZXJlbmNlJztcbmV4cG9ydCB2YXIgdmFyaWF0aW9uUGxhY2VtZW50cyA9IC8qI19fUFVSRV9fKi9iYXNlUGxhY2VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gIHJldHVybiBhY2MuY29uY2F0KFtwbGFjZW1lbnQgKyBcIi1cIiArIHN0YXJ0LCBwbGFjZW1lbnQgKyBcIi1cIiArIGVuZF0pO1xufSwgW10pO1xuZXhwb3J0IHZhciBwbGFjZW1lbnRzID0gLyojX19QVVJFX18qL1tdLmNvbmNhdChiYXNlUGxhY2VtZW50cywgW2F1dG9dKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gIHJldHVybiBhY2MuY29uY2F0KFtwbGFjZW1lbnQsIHBsYWNlbWVudCArIFwiLVwiICsgc3RhcnQsIHBsYWNlbWVudCArIFwiLVwiICsgZW5kXSk7XG59LCBbXSk7IC8vIG1vZGlmaWVycyB0aGF0IG5lZWQgdG8gcmVhZCB0aGUgRE9NXG5cbmV4cG9ydCB2YXIgYmVmb3JlUmVhZCA9ICdiZWZvcmVSZWFkJztcbmV4cG9ydCB2YXIgcmVhZCA9ICdyZWFkJztcbmV4cG9ydCB2YXIgYWZ0ZXJSZWFkID0gJ2FmdGVyUmVhZCc7IC8vIHB1cmUtbG9naWMgbW9kaWZpZXJzXG5cbmV4cG9ydCB2YXIgYmVmb3JlTWFpbiA9ICdiZWZvcmVNYWluJztcbmV4cG9ydCB2YXIgbWFpbiA9ICdtYWluJztcbmV4cG9ydCB2YXIgYWZ0ZXJNYWluID0gJ2FmdGVyTWFpbic7IC8vIG1vZGlmaWVyIHdpdGggdGhlIHB1cnBvc2UgdG8gd3JpdGUgdG8gdGhlIERPTSAob3Igd3JpdGUgaW50byBhIGZyYW1ld29yayBzdGF0ZSlcblxuZXhwb3J0IHZhciBiZWZvcmVXcml0ZSA9ICdiZWZvcmVXcml0ZSc7XG5leHBvcnQgdmFyIHdyaXRlID0gJ3dyaXRlJztcbmV4cG9ydCB2YXIgYWZ0ZXJXcml0ZSA9ICdhZnRlcldyaXRlJztcbmV4cG9ydCB2YXIgbW9kaWZpZXJQaGFzZXMgPSBbYmVmb3JlUmVhZCwgcmVhZCwgYWZ0ZXJSZWFkLCBiZWZvcmVNYWluLCBtYWluLCBhZnRlck1haW4sIGJlZm9yZVdyaXRlLCB3cml0ZSwgYWZ0ZXJXcml0ZV07IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE5vZGVOYW1lKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGVsZW1lbnQgPyAoZWxlbWVudC5ub2RlTmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKSA6IG51bGw7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFdpbmRvdyhub2RlKSB7XG4gIGlmIChub2RlID09IG51bGwpIHtcbiAgICByZXR1cm4gd2luZG93O1xuICB9XG5cbiAgaWYgKG5vZGUudG9TdHJpbmcoKSAhPT0gJ1tvYmplY3QgV2luZG93XScpIHtcbiAgICB2YXIgb3duZXJEb2N1bWVudCA9IG5vZGUub3duZXJEb2N1bWVudDtcbiAgICByZXR1cm4gb3duZXJEb2N1bWVudCA/IG93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcgfHwgd2luZG93IDogd2luZG93O1xuICB9XG5cbiAgcmV0dXJuIG5vZGU7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5cbmZ1bmN0aW9uIGlzRWxlbWVudChub2RlKSB7XG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLkVsZW1lbnQ7XG4gIHJldHVybiBub2RlIGluc3RhbmNlb2YgT3duRWxlbWVudCB8fCBub2RlIGluc3RhbmNlb2YgRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gaXNIVE1MRWxlbWVudChub2RlKSB7XG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLkhUTUxFbGVtZW50O1xuICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIE93bkVsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50O1xufVxuXG5mdW5jdGlvbiBpc1NoYWRvd1Jvb3Qobm9kZSkge1xuICAvLyBJRSAxMSBoYXMgbm8gU2hhZG93Um9vdFxuICBpZiAodHlwZW9mIFNoYWRvd1Jvb3QgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdmFyIE93bkVsZW1lbnQgPSBnZXRXaW5kb3cobm9kZSkuU2hhZG93Um9vdDtcbiAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBPd25FbGVtZW50IHx8IG5vZGUgaW5zdGFuY2VvZiBTaGFkb3dSb290O1xufVxuXG5leHBvcnQgeyBpc0VsZW1lbnQsIGlzSFRNTEVsZW1lbnQsIGlzU2hhZG93Um9vdCB9OyIsICJpbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4uL2RvbS11dGlscy9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuLi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qc1wiOyAvLyBUaGlzIG1vZGlmaWVyIHRha2VzIHRoZSBzdHlsZXMgcHJlcGFyZWQgYnkgdGhlIGBjb21wdXRlU3R5bGVzYCBtb2RpZmllclxuLy8gYW5kIGFwcGxpZXMgdGhlbSB0byB0aGUgSFRNTEVsZW1lbnRzIHN1Y2ggYXMgcG9wcGVyIGFuZCBhcnJvd1xuXG5mdW5jdGlvbiBhcHBseVN0eWxlcyhfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGU7XG4gIE9iamVjdC5rZXlzKHN0YXRlLmVsZW1lbnRzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdmFyIHN0eWxlID0gc3RhdGUuc3R5bGVzW25hbWVdIHx8IHt9O1xuICAgIHZhciBhdHRyaWJ1dGVzID0gc3RhdGUuYXR0cmlidXRlc1tuYW1lXSB8fCB7fTtcbiAgICB2YXIgZWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzW25hbWVdOyAvLyBhcnJvdyBpcyBvcHRpb25hbCArIHZpcnR1YWwgZWxlbWVudHNcblxuICAgIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSB8fCAhZ2V0Tm9kZU5hbWUoZWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIEZsb3cgZG9lc24ndCBzdXBwb3J0IHRvIGV4dGVuZCB0aGlzIHByb3BlcnR5LCBidXQgaXQncyB0aGUgbW9zdFxuICAgIC8vIGVmZmVjdGl2ZSB3YXkgdG8gYXBwbHkgc3R5bGVzIHRvIGFuIEhUTUxFbGVtZW50XG4gICAgLy8gJEZsb3dGaXhNZVtjYW5ub3Qtd3JpdGVdXG5cblxuICAgIE9iamVjdC5hc3NpZ24oZWxlbWVudC5zdHlsZSwgc3R5bGUpO1xuICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG5cbiAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUobmFtZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSA9PT0gdHJ1ZSA/ICcnIDogdmFsdWUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZWZmZWN0KF9yZWYyKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYyLnN0YXRlO1xuICB2YXIgaW5pdGlhbFN0eWxlcyA9IHtcbiAgICBwb3BwZXI6IHtcbiAgICAgIHBvc2l0aW9uOiBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5LFxuICAgICAgbGVmdDogJzAnLFxuICAgICAgdG9wOiAnMCcsXG4gICAgICBtYXJnaW46ICcwJ1xuICAgIH0sXG4gICAgYXJyb3c6IHtcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnXG4gICAgfSxcbiAgICByZWZlcmVuY2U6IHt9XG4gIH07XG4gIE9iamVjdC5hc3NpZ24oc3RhdGUuZWxlbWVudHMucG9wcGVyLnN0eWxlLCBpbml0aWFsU3R5bGVzLnBvcHBlcik7XG4gIHN0YXRlLnN0eWxlcyA9IGluaXRpYWxTdHlsZXM7XG5cbiAgaWYgKHN0YXRlLmVsZW1lbnRzLmFycm93KSB7XG4gICAgT2JqZWN0LmFzc2lnbihzdGF0ZS5lbGVtZW50cy5hcnJvdy5zdHlsZSwgaW5pdGlhbFN0eWxlcy5hcnJvdyk7XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIE9iamVjdC5rZXlzKHN0YXRlLmVsZW1lbnRzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICB2YXIgZWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzW25hbWVdO1xuICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBzdGF0ZS5hdHRyaWJ1dGVzW25hbWVdIHx8IHt9O1xuICAgICAgdmFyIHN0eWxlUHJvcGVydGllcyA9IE9iamVjdC5rZXlzKHN0YXRlLnN0eWxlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSA/IHN0YXRlLnN0eWxlc1tuYW1lXSA6IGluaXRpYWxTdHlsZXNbbmFtZV0pOyAvLyBTZXQgYWxsIHZhbHVlcyB0byBhbiBlbXB0eSBzdHJpbmcgdG8gdW5zZXQgdGhlbVxuXG4gICAgICB2YXIgc3R5bGUgPSBzdHlsZVByb3BlcnRpZXMucmVkdWNlKGZ1bmN0aW9uIChzdHlsZSwgcHJvcGVydHkpIHtcbiAgICAgICAgc3R5bGVbcHJvcGVydHldID0gJyc7XG4gICAgICAgIHJldHVybiBzdHlsZTtcbiAgICAgIH0sIHt9KTsgLy8gYXJyb3cgaXMgb3B0aW9uYWwgKyB2aXJ0dWFsIGVsZW1lbnRzXG5cbiAgICAgIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSB8fCAhZ2V0Tm9kZU5hbWUoZWxlbWVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBPYmplY3QuYXNzaWduKGVsZW1lbnQuc3R5bGUsIHN0eWxlKTtcbiAgICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xuICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdhcHBseVN0eWxlcycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnd3JpdGUnLFxuICBmbjogYXBwbHlTdHlsZXMsXG4gIGVmZmVjdDogZWZmZWN0LFxuICByZXF1aXJlczogWydjb21wdXRlU3R5bGVzJ11cbn07IiwgImltcG9ydCB7IGF1dG8gfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQuc3BsaXQoJy0nKVswXTtcbn0iLCAiZXhwb3J0IHZhciBtYXggPSBNYXRoLm1heDtcbmV4cG9ydCB2YXIgbWluID0gTWF0aC5taW47XG5leHBvcnQgdmFyIHJvdW5kID0gTWF0aC5yb3VuZDsiLCAiaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCB7IHJvdW5kIH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50LCBpbmNsdWRlU2NhbGUpIHtcbiAgaWYgKGluY2x1ZGVTY2FsZSA9PT0gdm9pZCAwKSB7XG4gICAgaW5jbHVkZVNjYWxlID0gZmFsc2U7XG4gIH1cblxuICB2YXIgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHZhciBzY2FsZVggPSAxO1xuICB2YXIgc2NhbGVZID0gMTtcblxuICBpZiAoaXNIVE1MRWxlbWVudChlbGVtZW50KSAmJiBpbmNsdWRlU2NhbGUpIHtcbiAgICB2YXIgb2Zmc2V0SGVpZ2h0ID0gZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG4gICAgdmFyIG9mZnNldFdpZHRoID0gZWxlbWVudC5vZmZzZXRXaWR0aDsgLy8gRG8gbm90IGF0dGVtcHQgdG8gZGl2aWRlIGJ5IDAsIG90aGVyd2lzZSB3ZSBnZXQgYEluZmluaXR5YCBhcyBzY2FsZVxuICAgIC8vIEZhbGxiYWNrIHRvIDEgaW4gY2FzZSBib3RoIHZhbHVlcyBhcmUgYDBgXG5cbiAgICBpZiAob2Zmc2V0V2lkdGggPiAwKSB7XG4gICAgICBzY2FsZVggPSByb3VuZChyZWN0LndpZHRoKSAvIG9mZnNldFdpZHRoIHx8IDE7XG4gICAgfVxuXG4gICAgaWYgKG9mZnNldEhlaWdodCA+IDApIHtcbiAgICAgIHNjYWxlWSA9IHJvdW5kKHJlY3QuaGVpZ2h0KSAvIG9mZnNldEhlaWdodCB8fCAxO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2lkdGg6IHJlY3Qud2lkdGggLyBzY2FsZVgsXG4gICAgaGVpZ2h0OiByZWN0LmhlaWdodCAvIHNjYWxlWSxcbiAgICB0b3A6IHJlY3QudG9wIC8gc2NhbGVZLFxuICAgIHJpZ2h0OiByZWN0LnJpZ2h0IC8gc2NhbGVYLFxuICAgIGJvdHRvbTogcmVjdC5ib3R0b20gLyBzY2FsZVksXG4gICAgbGVmdDogcmVjdC5sZWZ0IC8gc2NhbGVYLFxuICAgIHg6IHJlY3QubGVmdCAvIHNjYWxlWCxcbiAgICB5OiByZWN0LnRvcCAvIHNjYWxlWVxuICB9O1xufSIsICJpbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiOyAvLyBSZXR1cm5zIHRoZSBsYXlvdXQgcmVjdCBvZiBhbiBlbGVtZW50IHJlbGF0aXZlIHRvIGl0cyBvZmZzZXRQYXJlbnQuIExheW91dFxuLy8gbWVhbnMgaXQgZG9lc24ndCB0YWtlIGludG8gYWNjb3VudCB0cmFuc2Zvcm1zLlxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRMYXlvdXRSZWN0KGVsZW1lbnQpIHtcbiAgdmFyIGNsaWVudFJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCk7IC8vIFVzZSB0aGUgY2xpZW50UmVjdCBzaXplcyBpZiBpdCdzIG5vdCBiZWVuIHRyYW5zZm9ybWVkLlxuICAvLyBGaXhlcyBodHRwczovL2dpdGh1Yi5jb20vcG9wcGVyanMvcG9wcGVyLWNvcmUvaXNzdWVzLzEyMjNcblxuICB2YXIgd2lkdGggPSBlbGVtZW50Lm9mZnNldFdpZHRoO1xuICB2YXIgaGVpZ2h0ID0gZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cbiAgaWYgKE1hdGguYWJzKGNsaWVudFJlY3Qud2lkdGggLSB3aWR0aCkgPD0gMSkge1xuICAgIHdpZHRoID0gY2xpZW50UmVjdC53aWR0aDtcbiAgfVxuXG4gIGlmIChNYXRoLmFicyhjbGllbnRSZWN0LmhlaWdodCAtIGhlaWdodCkgPD0gMSkge1xuICAgIGhlaWdodCA9IGNsaWVudFJlY3QuaGVpZ2h0O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB4OiBlbGVtZW50Lm9mZnNldExlZnQsXG4gICAgeTogZWxlbWVudC5vZmZzZXRUb3AsXG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0XG4gIH07XG59IiwgImltcG9ydCB7IGlzU2hhZG93Um9vdCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbnRhaW5zKHBhcmVudCwgY2hpbGQpIHtcbiAgdmFyIHJvb3ROb2RlID0gY2hpbGQuZ2V0Um9vdE5vZGUgJiYgY2hpbGQuZ2V0Um9vdE5vZGUoKTsgLy8gRmlyc3QsIGF0dGVtcHQgd2l0aCBmYXN0ZXIgbmF0aXZlIG1ldGhvZFxuXG4gIGlmIChwYXJlbnQuY29udGFpbnMoY2hpbGQpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gLy8gdGhlbiBmYWxsYmFjayB0byBjdXN0b20gaW1wbGVtZW50YXRpb24gd2l0aCBTaGFkb3cgRE9NIHN1cHBvcnRcbiAgZWxzZSBpZiAocm9vdE5vZGUgJiYgaXNTaGFkb3dSb290KHJvb3ROb2RlKSkge1xuICAgICAgdmFyIG5leHQgPSBjaGlsZDtcblxuICAgICAgZG8ge1xuICAgICAgICBpZiAobmV4dCAmJiBwYXJlbnQuaXNTYW1lTm9kZShuZXh0KSkge1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXTogbmVlZCBhIGJldHRlciB3YXkgdG8gaGFuZGxlIHRoaXMuLi5cblxuXG4gICAgICAgIG5leHQgPSBuZXh0LnBhcmVudE5vZGUgfHwgbmV4dC5ob3N0O1xuICAgICAgfSB3aGlsZSAobmV4dCk7XG4gICAgfSAvLyBHaXZlIHVwLCB0aGUgcmVzdWx0IGlzIGZhbHNlXG5cblxuICByZXR1cm4gZmFsc2U7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpIHtcbiAgcmV0dXJuIGdldFdpbmRvdyhlbGVtZW50KS5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xufSIsICJpbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzVGFibGVFbGVtZW50KGVsZW1lbnQpIHtcbiAgcmV0dXJuIFsndGFibGUnLCAndGQnLCAndGgnXS5pbmRleE9mKGdldE5vZGVOYW1lKGVsZW1lbnQpKSA+PSAwO1xufSIsICJpbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkge1xuICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dOiBhc3N1bWUgYm9keSBpcyBhbHdheXMgYXZhaWxhYmxlXG4gIHJldHVybiAoKGlzRWxlbWVudChlbGVtZW50KSA/IGVsZW1lbnQub3duZXJEb2N1bWVudCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICBlbGVtZW50LmRvY3VtZW50KSB8fCB3aW5kb3cuZG9jdW1lbnQpLmRvY3VtZW50RWxlbWVudDtcbn0iLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IHsgaXNTaGFkb3dSb290IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0UGFyZW50Tm9kZShlbGVtZW50KSB7XG4gIGlmIChnZXROb2RlTmFtZShlbGVtZW50KSA9PT0gJ2h0bWwnKSB7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH1cblxuICByZXR1cm4gKC8vIHRoaXMgaXMgYSBxdWlja2VyIChidXQgbGVzcyB0eXBlIHNhZmUpIHdheSB0byBzYXZlIHF1aXRlIHNvbWUgYnl0ZXMgZnJvbSB0aGUgYnVuZGxlXG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXVxuICAgIC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgIGVsZW1lbnQuYXNzaWduZWRTbG90IHx8IC8vIHN0ZXAgaW50byB0aGUgc2hhZG93IERPTSBvZiB0aGUgcGFyZW50IG9mIGEgc2xvdHRlZCBub2RlXG4gICAgZWxlbWVudC5wYXJlbnROb2RlIHx8ICggLy8gRE9NIEVsZW1lbnQgZGV0ZWN0ZWRcbiAgICBpc1NoYWRvd1Jvb3QoZWxlbWVudCkgPyBlbGVtZW50Lmhvc3QgOiBudWxsKSB8fCAvLyBTaGFkb3dSb290IGRldGVjdGVkXG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF06IEhUTUxFbGVtZW50IGlzIGEgTm9kZVxuICAgIGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSAvLyBmYWxsYmFja1xuXG4gICk7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQsIGlzU2hhZG93Um9vdCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBpc1RhYmxlRWxlbWVudCBmcm9tIFwiLi9pc1RhYmxlRWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuXG5mdW5jdGlvbiBnZXRUcnVlT2Zmc2V0UGFyZW50KGVsZW1lbnQpIHtcbiAgaWYgKCFpc0hUTUxFbGVtZW50KGVsZW1lbnQpIHx8IC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9wb3BwZXJqcy9wb3BwZXItY29yZS9pc3N1ZXMvODM3XG4gIGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkucG9zaXRpb24gPT09ICdmaXhlZCcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiBlbGVtZW50Lm9mZnNldFBhcmVudDtcbn0gLy8gYC5vZmZzZXRQYXJlbnRgIHJlcG9ydHMgYG51bGxgIGZvciBmaXhlZCBlbGVtZW50cywgd2hpbGUgYWJzb2x1dGUgZWxlbWVudHNcbi8vIHJldHVybiB0aGUgY29udGFpbmluZyBibG9ja1xuXG5cbmZ1bmN0aW9uIGdldENvbnRhaW5pbmdCbG9jayhlbGVtZW50KSB7XG4gIHZhciBpc0ZpcmVmb3ggPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkuaW5kZXhPZignZmlyZWZveCcpICE9PSAtMTtcbiAgdmFyIGlzSUUgPSBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoJ1RyaWRlbnQnKSAhPT0gLTE7XG5cbiAgaWYgKGlzSUUgJiYgaXNIVE1MRWxlbWVudChlbGVtZW50KSkge1xuICAgIC8vIEluIElFIDksIDEwIGFuZCAxMSBmaXhlZCBlbGVtZW50cyBjb250YWluaW5nIGJsb2NrIGlzIGFsd2F5cyBlc3RhYmxpc2hlZCBieSB0aGUgdmlld3BvcnRcbiAgICB2YXIgZWxlbWVudENzcyA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG5cbiAgICBpZiAoZWxlbWVudENzcy5wb3NpdGlvbiA9PT0gJ2ZpeGVkJykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgdmFyIGN1cnJlbnROb2RlID0gZ2V0UGFyZW50Tm9kZShlbGVtZW50KTtcblxuICBpZiAoaXNTaGFkb3dSb290KGN1cnJlbnROb2RlKSkge1xuICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUuaG9zdDtcbiAgfVxuXG4gIHdoaWxlIChpc0hUTUxFbGVtZW50KGN1cnJlbnROb2RlKSAmJiBbJ2h0bWwnLCAnYm9keSddLmluZGV4T2YoZ2V0Tm9kZU5hbWUoY3VycmVudE5vZGUpKSA8IDApIHtcbiAgICB2YXIgY3NzID0gZ2V0Q29tcHV0ZWRTdHlsZShjdXJyZW50Tm9kZSk7IC8vIFRoaXMgaXMgbm9uLWV4aGF1c3RpdmUgYnV0IGNvdmVycyB0aGUgbW9zdCBjb21tb24gQ1NTIHByb3BlcnRpZXMgdGhhdFxuICAgIC8vIGNyZWF0ZSBhIGNvbnRhaW5pbmcgYmxvY2suXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL0NvbnRhaW5pbmdfYmxvY2sjaWRlbnRpZnlpbmdfdGhlX2NvbnRhaW5pbmdfYmxvY2tcblxuICAgIGlmIChjc3MudHJhbnNmb3JtICE9PSAnbm9uZScgfHwgY3NzLnBlcnNwZWN0aXZlICE9PSAnbm9uZScgfHwgY3NzLmNvbnRhaW4gPT09ICdwYWludCcgfHwgWyd0cmFuc2Zvcm0nLCAncGVyc3BlY3RpdmUnXS5pbmRleE9mKGNzcy53aWxsQ2hhbmdlKSAhPT0gLTEgfHwgaXNGaXJlZm94ICYmIGNzcy53aWxsQ2hhbmdlID09PSAnZmlsdGVyJyB8fCBpc0ZpcmVmb3ggJiYgY3NzLmZpbHRlciAmJiBjc3MuZmlsdGVyICE9PSAnbm9uZScpIHtcbiAgICAgIHJldHVybiBjdXJyZW50Tm9kZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBudWxsO1xufSAvLyBHZXRzIHRoZSBjbG9zZXN0IGFuY2VzdG9yIHBvc2l0aW9uZWQgZWxlbWVudC4gSGFuZGxlcyBzb21lIGVkZ2UgY2FzZXMsXG4vLyBzdWNoIGFzIHRhYmxlIGFuY2VzdG9ycyBhbmQgY3Jvc3MgYnJvd3NlciBidWdzLlxuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE9mZnNldFBhcmVudChlbGVtZW50KSB7XG4gIHZhciB3aW5kb3cgPSBnZXRXaW5kb3coZWxlbWVudCk7XG4gIHZhciBvZmZzZXRQYXJlbnQgPSBnZXRUcnVlT2Zmc2V0UGFyZW50KGVsZW1lbnQpO1xuXG4gIHdoaWxlIChvZmZzZXRQYXJlbnQgJiYgaXNUYWJsZUVsZW1lbnQob2Zmc2V0UGFyZW50KSAmJiBnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCkucG9zaXRpb24gPT09ICdzdGF0aWMnKSB7XG4gICAgb2Zmc2V0UGFyZW50ID0gZ2V0VHJ1ZU9mZnNldFBhcmVudChvZmZzZXRQYXJlbnQpO1xuICB9XG5cbiAgaWYgKG9mZnNldFBhcmVudCAmJiAoZ2V0Tm9kZU5hbWUob2Zmc2V0UGFyZW50KSA9PT0gJ2h0bWwnIHx8IGdldE5vZGVOYW1lKG9mZnNldFBhcmVudCkgPT09ICdib2R5JyAmJiBnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCkucG9zaXRpb24gPT09ICdzdGF0aWMnKSkge1xuICAgIHJldHVybiB3aW5kb3c7XG4gIH1cblxuICByZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGdldENvbnRhaW5pbmdCbG9jayhlbGVtZW50KSB8fCB3aW5kb3c7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIFsndG9wJywgJ2JvdHRvbSddLmluZGV4T2YocGxhY2VtZW50KSA+PSAwID8gJ3gnIDogJ3knO1xufSIsICJpbXBvcnQgeyBtYXggYXMgbWF0aE1heCwgbWluIGFzIG1hdGhNaW4gfSBmcm9tIFwiLi9tYXRoLmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gd2l0aGluKG1pbiwgdmFsdWUsIG1heCkge1xuICByZXR1cm4gbWF0aE1heChtaW4sIG1hdGhNaW4odmFsdWUsIG1heCkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhpbk1heENsYW1wKG1pbiwgdmFsdWUsIG1heCkge1xuICB2YXIgdiA9IHdpdGhpbihtaW4sIHZhbHVlLCBtYXgpO1xuICByZXR1cm4gdiA+IG1heCA/IG1heCA6IHY7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEZyZXNoU2lkZU9iamVjdCgpIHtcbiAgcmV0dXJuIHtcbiAgICB0b3A6IDAsXG4gICAgcmlnaHQ6IDAsXG4gICAgYm90dG9tOiAwLFxuICAgIGxlZnQ6IDBcbiAgfTtcbn0iLCAiaW1wb3J0IGdldEZyZXNoU2lkZU9iamVjdCBmcm9tIFwiLi9nZXRGcmVzaFNpZGVPYmplY3QuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG1lcmdlUGFkZGluZ09iamVjdChwYWRkaW5nT2JqZWN0KSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBnZXRGcmVzaFNpZGVPYmplY3QoKSwgcGFkZGluZ09iamVjdCk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGV4cGFuZFRvSGFzaE1hcCh2YWx1ZSwga2V5cykge1xuICByZXR1cm4ga2V5cy5yZWR1Y2UoZnVuY3Rpb24gKGhhc2hNYXAsIGtleSkge1xuICAgIGhhc2hNYXBba2V5XSA9IHZhbHVlO1xuICAgIHJldHVybiBoYXNoTWFwO1xuICB9LCB7fSk7XG59IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBjb250YWlucyBmcm9tIFwiLi4vZG9tLXV0aWxzL2NvbnRhaW5zLmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQuanNcIjtcbmltcG9ydCB7IHdpdGhpbiB9IGZyb20gXCIuLi91dGlscy93aXRoaW4uanNcIjtcbmltcG9ydCBtZXJnZVBhZGRpbmdPYmplY3QgZnJvbSBcIi4uL3V0aWxzL21lcmdlUGFkZGluZ09iamVjdC5qc1wiO1xuaW1wb3J0IGV4cGFuZFRvSGFzaE1hcCBmcm9tIFwiLi4vdXRpbHMvZXhwYW5kVG9IYXNoTWFwLmpzXCI7XG5pbXBvcnQgeyBsZWZ0LCByaWdodCwgYmFzZVBsYWNlbWVudHMsIHRvcCwgYm90dG9tIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4uL2RvbS11dGlscy9pbnN0YW5jZU9mLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxudmFyIHRvUGFkZGluZ09iamVjdCA9IGZ1bmN0aW9uIHRvUGFkZGluZ09iamVjdChwYWRkaW5nLCBzdGF0ZSkge1xuICBwYWRkaW5nID0gdHlwZW9mIHBhZGRpbmcgPT09ICdmdW5jdGlvbicgPyBwYWRkaW5nKE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnJlY3RzLCB7XG4gICAgcGxhY2VtZW50OiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSkpIDogcGFkZGluZztcbiAgcmV0dXJuIG1lcmdlUGFkZGluZ09iamVjdCh0eXBlb2YgcGFkZGluZyAhPT0gJ251bWJlcicgPyBwYWRkaW5nIDogZXhwYW5kVG9IYXNoTWFwKHBhZGRpbmcsIGJhc2VQbGFjZW1lbnRzKSk7XG59O1xuXG5mdW5jdGlvbiBhcnJvdyhfcmVmKSB7XG4gIHZhciBfc3RhdGUkbW9kaWZpZXJzRGF0YSQ7XG5cbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWUsXG4gICAgICBvcHRpb25zID0gX3JlZi5vcHRpb25zO1xuICB2YXIgYXJyb3dFbGVtZW50ID0gc3RhdGUuZWxlbWVudHMuYXJyb3c7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzO1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQoc3RhdGUucGxhY2VtZW50KTtcbiAgdmFyIGF4aXMgPSBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQoYmFzZVBsYWNlbWVudCk7XG4gIHZhciBpc1ZlcnRpY2FsID0gW2xlZnQsIHJpZ2h0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpID49IDA7XG4gIHZhciBsZW4gPSBpc1ZlcnRpY2FsID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gIGlmICghYXJyb3dFbGVtZW50IHx8ICFwb3BwZXJPZmZzZXRzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHBhZGRpbmdPYmplY3QgPSB0b1BhZGRpbmdPYmplY3Qob3B0aW9ucy5wYWRkaW5nLCBzdGF0ZSk7XG4gIHZhciBhcnJvd1JlY3QgPSBnZXRMYXlvdXRSZWN0KGFycm93RWxlbWVudCk7XG4gIHZhciBtaW5Qcm9wID0gYXhpcyA9PT0gJ3knID8gdG9wIDogbGVmdDtcbiAgdmFyIG1heFByb3AgPSBheGlzID09PSAneScgPyBib3R0b20gOiByaWdodDtcbiAgdmFyIGVuZERpZmYgPSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2VbbGVuXSArIHN0YXRlLnJlY3RzLnJlZmVyZW5jZVtheGlzXSAtIHBvcHBlck9mZnNldHNbYXhpc10gLSBzdGF0ZS5yZWN0cy5wb3BwZXJbbGVuXTtcbiAgdmFyIHN0YXJ0RGlmZiA9IHBvcHBlck9mZnNldHNbYXhpc10gLSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2VbYXhpc107XG4gIHZhciBhcnJvd09mZnNldFBhcmVudCA9IGdldE9mZnNldFBhcmVudChhcnJvd0VsZW1lbnQpO1xuICB2YXIgY2xpZW50U2l6ZSA9IGFycm93T2Zmc2V0UGFyZW50ID8gYXhpcyA9PT0gJ3knID8gYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50SGVpZ2h0IHx8IDAgOiBhcnJvd09mZnNldFBhcmVudC5jbGllbnRXaWR0aCB8fCAwIDogMDtcbiAgdmFyIGNlbnRlclRvUmVmZXJlbmNlID0gZW5kRGlmZiAvIDIgLSBzdGFydERpZmYgLyAyOyAvLyBNYWtlIHN1cmUgdGhlIGFycm93IGRvZXNuJ3Qgb3ZlcmZsb3cgdGhlIHBvcHBlciBpZiB0aGUgY2VudGVyIHBvaW50IGlzXG4gIC8vIG91dHNpZGUgb2YgdGhlIHBvcHBlciBib3VuZHNcblxuICB2YXIgbWluID0gcGFkZGluZ09iamVjdFttaW5Qcm9wXTtcbiAgdmFyIG1heCA9IGNsaWVudFNpemUgLSBhcnJvd1JlY3RbbGVuXSAtIHBhZGRpbmdPYmplY3RbbWF4UHJvcF07XG4gIHZhciBjZW50ZXIgPSBjbGllbnRTaXplIC8gMiAtIGFycm93UmVjdFtsZW5dIC8gMiArIGNlbnRlclRvUmVmZXJlbmNlO1xuICB2YXIgb2Zmc2V0ID0gd2l0aGluKG1pbiwgY2VudGVyLCBtYXgpOyAvLyBQcmV2ZW50cyBicmVha2luZyBzeW50YXggaGlnaGxpZ2h0aW5nLi4uXG5cbiAgdmFyIGF4aXNQcm9wID0gYXhpcztcbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IChfc3RhdGUkbW9kaWZpZXJzRGF0YSQgPSB7fSwgX3N0YXRlJG1vZGlmaWVyc0RhdGEkW2F4aXNQcm9wXSA9IG9mZnNldCwgX3N0YXRlJG1vZGlmaWVyc0RhdGEkLmNlbnRlck9mZnNldCA9IG9mZnNldCAtIGNlbnRlciwgX3N0YXRlJG1vZGlmaWVyc0RhdGEkKTtcbn1cblxuZnVuY3Rpb24gZWZmZWN0KF9yZWYyKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYyLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYyLm9wdGlvbnM7XG4gIHZhciBfb3B0aW9ucyRlbGVtZW50ID0gb3B0aW9ucy5lbGVtZW50LFxuICAgICAgYXJyb3dFbGVtZW50ID0gX29wdGlvbnMkZWxlbWVudCA9PT0gdm9pZCAwID8gJ1tkYXRhLXBvcHBlci1hcnJvd10nIDogX29wdGlvbnMkZWxlbWVudDtcblxuICBpZiAoYXJyb3dFbGVtZW50ID09IG51bGwpIHtcbiAgICByZXR1cm47XG4gIH0gLy8gQ1NTIHNlbGVjdG9yXG5cblxuICBpZiAodHlwZW9mIGFycm93RWxlbWVudCA9PT0gJ3N0cmluZycpIHtcbiAgICBhcnJvd0VsZW1lbnQgPSBzdGF0ZS5lbGVtZW50cy5wb3BwZXIucXVlcnlTZWxlY3RvcihhcnJvd0VsZW1lbnQpO1xuXG4gICAgaWYgKCFhcnJvd0VsZW1lbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgaWYgKCFpc0hUTUxFbGVtZW50KGFycm93RWxlbWVudCkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoWydQb3BwZXI6IFwiYXJyb3dcIiBlbGVtZW50IG11c3QgYmUgYW4gSFRNTEVsZW1lbnQgKG5vdCBhbiBTVkdFbGVtZW50KS4nLCAnVG8gdXNlIGFuIFNWRyBhcnJvdywgd3JhcCBpdCBpbiBhbiBIVE1MRWxlbWVudCB0aGF0IHdpbGwgYmUgdXNlZCBhcycsICd0aGUgYXJyb3cuJ10uam9pbignICcpKTtcbiAgICB9XG4gIH1cblxuICBpZiAoIWNvbnRhaW5zKHN0YXRlLmVsZW1lbnRzLnBvcHBlciwgYXJyb3dFbGVtZW50KSkge1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoWydQb3BwZXI6IFwiYXJyb3dcIiBtb2RpZmllclxcJ3MgYGVsZW1lbnRgIG11c3QgYmUgYSBjaGlsZCBvZiB0aGUgcG9wcGVyJywgJ2VsZW1lbnQuJ10uam9pbignICcpKTtcbiAgICB9XG5cbiAgICByZXR1cm47XG4gIH1cblxuICBzdGF0ZS5lbGVtZW50cy5hcnJvdyA9IGFycm93RWxlbWVudDtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2Fycm93JyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgZm46IGFycm93LFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgcmVxdWlyZXM6IFsncG9wcGVyT2Zmc2V0cyddLFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ3ByZXZlbnRPdmVyZmxvdyddXG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRWYXJpYXRpb24ocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQuc3BsaXQoJy0nKVsxXTtcbn0iLCAiaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgYm90dG9tLCBlbmQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IHsgcm91bmQgfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbnZhciB1bnNldFNpZGVzID0ge1xuICB0b3A6ICdhdXRvJyxcbiAgcmlnaHQ6ICdhdXRvJyxcbiAgYm90dG9tOiAnYXV0bycsXG4gIGxlZnQ6ICdhdXRvJ1xufTsgLy8gUm91bmQgdGhlIG9mZnNldHMgdG8gdGhlIG5lYXJlc3Qgc3VpdGFibGUgc3VicGl4ZWwgYmFzZWQgb24gdGhlIERQUi5cbi8vIFpvb21pbmcgY2FuIGNoYW5nZSB0aGUgRFBSLCBidXQgaXQgc2VlbXMgdG8gcmVwb3J0IGEgdmFsdWUgdGhhdCB3aWxsXG4vLyBjbGVhbmx5IGRpdmlkZSB0aGUgdmFsdWVzIGludG8gdGhlIGFwcHJvcHJpYXRlIHN1YnBpeGVscy5cblxuZnVuY3Rpb24gcm91bmRPZmZzZXRzQnlEUFIoX3JlZikge1xuICB2YXIgeCA9IF9yZWYueCxcbiAgICAgIHkgPSBfcmVmLnk7XG4gIHZhciB3aW4gPSB3aW5kb3c7XG4gIHZhciBkcHIgPSB3aW4uZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICByZXR1cm4ge1xuICAgIHg6IHJvdW5kKHggKiBkcHIpIC8gZHByIHx8IDAsXG4gICAgeTogcm91bmQoeSAqIGRwcikgLyBkcHIgfHwgMFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFwVG9TdHlsZXMoX3JlZjIpIHtcbiAgdmFyIF9PYmplY3QkYXNzaWduMjtcblxuICB2YXIgcG9wcGVyID0gX3JlZjIucG9wcGVyLFxuICAgICAgcG9wcGVyUmVjdCA9IF9yZWYyLnBvcHBlclJlY3QsXG4gICAgICBwbGFjZW1lbnQgPSBfcmVmMi5wbGFjZW1lbnQsXG4gICAgICB2YXJpYXRpb24gPSBfcmVmMi52YXJpYXRpb24sXG4gICAgICBvZmZzZXRzID0gX3JlZjIub2Zmc2V0cyxcbiAgICAgIHBvc2l0aW9uID0gX3JlZjIucG9zaXRpb24sXG4gICAgICBncHVBY2NlbGVyYXRpb24gPSBfcmVmMi5ncHVBY2NlbGVyYXRpb24sXG4gICAgICBhZGFwdGl2ZSA9IF9yZWYyLmFkYXB0aXZlLFxuICAgICAgcm91bmRPZmZzZXRzID0gX3JlZjIucm91bmRPZmZzZXRzLFxuICAgICAgaXNGaXhlZCA9IF9yZWYyLmlzRml4ZWQ7XG4gIHZhciBfb2Zmc2V0cyR4ID0gb2Zmc2V0cy54LFxuICAgICAgeCA9IF9vZmZzZXRzJHggPT09IHZvaWQgMCA/IDAgOiBfb2Zmc2V0cyR4LFxuICAgICAgX29mZnNldHMkeSA9IG9mZnNldHMueSxcbiAgICAgIHkgPSBfb2Zmc2V0cyR5ID09PSB2b2lkIDAgPyAwIDogX29mZnNldHMkeTtcblxuICB2YXIgX3JlZjMgPSB0eXBlb2Ygcm91bmRPZmZzZXRzID09PSAnZnVuY3Rpb24nID8gcm91bmRPZmZzZXRzKHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfSkgOiB7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH07XG5cbiAgeCA9IF9yZWYzLng7XG4gIHkgPSBfcmVmMy55O1xuICB2YXIgaGFzWCA9IG9mZnNldHMuaGFzT3duUHJvcGVydHkoJ3gnKTtcbiAgdmFyIGhhc1kgPSBvZmZzZXRzLmhhc093blByb3BlcnR5KCd5Jyk7XG4gIHZhciBzaWRlWCA9IGxlZnQ7XG4gIHZhciBzaWRlWSA9IHRvcDtcbiAgdmFyIHdpbiA9IHdpbmRvdztcblxuICBpZiAoYWRhcHRpdmUpIHtcbiAgICB2YXIgb2Zmc2V0UGFyZW50ID0gZ2V0T2Zmc2V0UGFyZW50KHBvcHBlcik7XG4gICAgdmFyIGhlaWdodFByb3AgPSAnY2xpZW50SGVpZ2h0JztcbiAgICB2YXIgd2lkdGhQcm9wID0gJ2NsaWVudFdpZHRoJztcblxuICAgIGlmIChvZmZzZXRQYXJlbnQgPT09IGdldFdpbmRvdyhwb3BwZXIpKSB7XG4gICAgICBvZmZzZXRQYXJlbnQgPSBnZXREb2N1bWVudEVsZW1lbnQocG9wcGVyKTtcblxuICAgICAgaWYgKGdldENvbXB1dGVkU3R5bGUob2Zmc2V0UGFyZW50KS5wb3NpdGlvbiAhPT0gJ3N0YXRpYycgJiYgcG9zaXRpb24gPT09ICdhYnNvbHV0ZScpIHtcbiAgICAgICAgaGVpZ2h0UHJvcCA9ICdzY3JvbGxIZWlnaHQnO1xuICAgICAgICB3aWR0aFByb3AgPSAnc2Nyb2xsV2lkdGgnO1xuICAgICAgfVxuICAgIH0gLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FzdF06IGZvcmNlIHR5cGUgcmVmaW5lbWVudCwgd2UgY29tcGFyZSBvZmZzZXRQYXJlbnQgd2l0aCB3aW5kb3cgYWJvdmUsIGJ1dCBGbG93IGRvZXNuJ3QgZGV0ZWN0IGl0XG5cblxuICAgIG9mZnNldFBhcmVudCA9IG9mZnNldFBhcmVudDtcblxuICAgIGlmIChwbGFjZW1lbnQgPT09IHRvcCB8fCAocGxhY2VtZW50ID09PSBsZWZ0IHx8IHBsYWNlbWVudCA9PT0gcmlnaHQpICYmIHZhcmlhdGlvbiA9PT0gZW5kKSB7XG4gICAgICBzaWRlWSA9IGJvdHRvbTtcbiAgICAgIHZhciBvZmZzZXRZID0gaXNGaXhlZCAmJiBvZmZzZXRQYXJlbnQgPT09IHdpbiAmJiB3aW4udmlzdWFsVmlld3BvcnQgPyB3aW4udmlzdWFsVmlld3BvcnQuaGVpZ2h0IDogLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gICAgICBvZmZzZXRQYXJlbnRbaGVpZ2h0UHJvcF07XG4gICAgICB5IC09IG9mZnNldFkgLSBwb3BwZXJSZWN0LmhlaWdodDtcbiAgICAgIHkgKj0gZ3B1QWNjZWxlcmF0aW9uID8gMSA6IC0xO1xuICAgIH1cblxuICAgIGlmIChwbGFjZW1lbnQgPT09IGxlZnQgfHwgKHBsYWNlbWVudCA9PT0gdG9wIHx8IHBsYWNlbWVudCA9PT0gYm90dG9tKSAmJiB2YXJpYXRpb24gPT09IGVuZCkge1xuICAgICAgc2lkZVggPSByaWdodDtcbiAgICAgIHZhciBvZmZzZXRYID0gaXNGaXhlZCAmJiBvZmZzZXRQYXJlbnQgPT09IHdpbiAmJiB3aW4udmlzdWFsVmlld3BvcnQgPyB3aW4udmlzdWFsVmlld3BvcnQud2lkdGggOiAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgICAgIG9mZnNldFBhcmVudFt3aWR0aFByb3BdO1xuICAgICAgeCAtPSBvZmZzZXRYIC0gcG9wcGVyUmVjdC53aWR0aDtcbiAgICAgIHggKj0gZ3B1QWNjZWxlcmF0aW9uID8gMSA6IC0xO1xuICAgIH1cbiAgfVxuXG4gIHZhciBjb21tb25TdHlsZXMgPSBPYmplY3QuYXNzaWduKHtcbiAgICBwb3NpdGlvbjogcG9zaXRpb25cbiAgfSwgYWRhcHRpdmUgJiYgdW5zZXRTaWRlcyk7XG5cbiAgdmFyIF9yZWY0ID0gcm91bmRPZmZzZXRzID09PSB0cnVlID8gcm91bmRPZmZzZXRzQnlEUFIoe1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9KSA6IHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcblxuICB4ID0gX3JlZjQueDtcbiAgeSA9IF9yZWY0Lnk7XG5cbiAgaWYgKGdwdUFjY2VsZXJhdGlvbikge1xuICAgIHZhciBfT2JqZWN0JGFzc2lnbjtcblxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIChfT2JqZWN0JGFzc2lnbiA9IHt9LCBfT2JqZWN0JGFzc2lnbltzaWRlWV0gPSBoYXNZID8gJzAnIDogJycsIF9PYmplY3QkYXNzaWduW3NpZGVYXSA9IGhhc1ggPyAnMCcgOiAnJywgX09iamVjdCRhc3NpZ24udHJhbnNmb3JtID0gKHdpbi5kZXZpY2VQaXhlbFJhdGlvIHx8IDEpIDw9IDEgPyBcInRyYW5zbGF0ZShcIiArIHggKyBcInB4LCBcIiArIHkgKyBcInB4KVwiIDogXCJ0cmFuc2xhdGUzZChcIiArIHggKyBcInB4LCBcIiArIHkgKyBcInB4LCAwKVwiLCBfT2JqZWN0JGFzc2lnbikpO1xuICB9XG5cbiAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywgKF9PYmplY3QkYXNzaWduMiA9IHt9LCBfT2JqZWN0JGFzc2lnbjJbc2lkZVldID0gaGFzWSA/IHkgKyBcInB4XCIgOiAnJywgX09iamVjdCRhc3NpZ24yW3NpZGVYXSA9IGhhc1ggPyB4ICsgXCJweFwiIDogJycsIF9PYmplY3QkYXNzaWduMi50cmFuc2Zvcm0gPSAnJywgX09iamVjdCRhc3NpZ24yKSk7XG59XG5cbmZ1bmN0aW9uIGNvbXB1dGVTdHlsZXMoX3JlZjUpIHtcbiAgdmFyIHN0YXRlID0gX3JlZjUuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZjUub3B0aW9ucztcbiAgdmFyIF9vcHRpb25zJGdwdUFjY2VsZXJhdCA9IG9wdGlvbnMuZ3B1QWNjZWxlcmF0aW9uLFxuICAgICAgZ3B1QWNjZWxlcmF0aW9uID0gX29wdGlvbnMkZ3B1QWNjZWxlcmF0ID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkZ3B1QWNjZWxlcmF0LFxuICAgICAgX29wdGlvbnMkYWRhcHRpdmUgPSBvcHRpb25zLmFkYXB0aXZlLFxuICAgICAgYWRhcHRpdmUgPSBfb3B0aW9ucyRhZGFwdGl2ZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJGFkYXB0aXZlLFxuICAgICAgX29wdGlvbnMkcm91bmRPZmZzZXRzID0gb3B0aW9ucy5yb3VuZE9mZnNldHMsXG4gICAgICByb3VuZE9mZnNldHMgPSBfb3B0aW9ucyRyb3VuZE9mZnNldHMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRyb3VuZE9mZnNldHM7XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIHZhciB0cmFuc2l0aW9uUHJvcGVydHkgPSBnZXRDb21wdXRlZFN0eWxlKHN0YXRlLmVsZW1lbnRzLnBvcHBlcikudHJhbnNpdGlvblByb3BlcnR5IHx8ICcnO1xuXG4gICAgaWYgKGFkYXB0aXZlICYmIFsndHJhbnNmb3JtJywgJ3RvcCcsICdyaWdodCcsICdib3R0b20nLCAnbGVmdCddLnNvbWUoZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICByZXR1cm4gdHJhbnNpdGlvblByb3BlcnR5LmluZGV4T2YocHJvcGVydHkpID49IDA7XG4gICAgfSkpIHtcbiAgICAgIGNvbnNvbGUud2FybihbJ1BvcHBlcjogRGV0ZWN0ZWQgQ1NTIHRyYW5zaXRpb25zIG9uIGF0IGxlYXN0IG9uZSBvZiB0aGUgZm9sbG93aW5nJywgJ0NTUyBwcm9wZXJ0aWVzOiBcInRyYW5zZm9ybVwiLCBcInRvcFwiLCBcInJpZ2h0XCIsIFwiYm90dG9tXCIsIFwibGVmdFwiLicsICdcXG5cXG4nLCAnRGlzYWJsZSB0aGUgXCJjb21wdXRlU3R5bGVzXCIgbW9kaWZpZXJcXCdzIGBhZGFwdGl2ZWAgb3B0aW9uIHRvIGFsbG93JywgJ2ZvciBzbW9vdGggdHJhbnNpdGlvbnMsIG9yIHJlbW92ZSB0aGVzZSBwcm9wZXJ0aWVzIGZyb20gdGhlIENTUycsICd0cmFuc2l0aW9uIGRlY2xhcmF0aW9uIG9uIHRoZSBwb3BwZXIgZWxlbWVudCBpZiBvbmx5IHRyYW5zaXRpb25pbmcnLCAnb3BhY2l0eSBvciBiYWNrZ3JvdW5kLWNvbG9yIGZvciBleGFtcGxlLicsICdcXG5cXG4nLCAnV2UgcmVjb21tZW5kIHVzaW5nIHRoZSBwb3BwZXIgZWxlbWVudCBhcyBhIHdyYXBwZXIgYXJvdW5kIGFuIGlubmVyJywgJ2VsZW1lbnQgdGhhdCBjYW4gaGF2ZSBhbnkgQ1NTIHByb3BlcnR5IHRyYW5zaXRpb25lZCBmb3IgYW5pbWF0aW9ucy4nXS5qb2luKCcgJykpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBjb21tb25TdHlsZXMgPSB7XG4gICAgcGxhY2VtZW50OiBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCksXG4gICAgdmFyaWF0aW9uOiBnZXRWYXJpYXRpb24oc3RhdGUucGxhY2VtZW50KSxcbiAgICBwb3BwZXI6IHN0YXRlLmVsZW1lbnRzLnBvcHBlcixcbiAgICBwb3BwZXJSZWN0OiBzdGF0ZS5yZWN0cy5wb3BwZXIsXG4gICAgZ3B1QWNjZWxlcmF0aW9uOiBncHVBY2NlbGVyYXRpb24sXG4gICAgaXNGaXhlZDogc3RhdGUub3B0aW9ucy5zdHJhdGVneSA9PT0gJ2ZpeGVkJ1xuICB9O1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMgIT0gbnVsbCkge1xuICAgIHN0YXRlLnN0eWxlcy5wb3BwZXIgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5zdHlsZXMucG9wcGVyLCBtYXBUb1N0eWxlcyhPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIHtcbiAgICAgIG9mZnNldHM6IHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyxcbiAgICAgIHBvc2l0aW9uOiBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5LFxuICAgICAgYWRhcHRpdmU6IGFkYXB0aXZlLFxuICAgICAgcm91bmRPZmZzZXRzOiByb3VuZE9mZnNldHNcbiAgICB9KSkpO1xuICB9XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEuYXJyb3cgIT0gbnVsbCkge1xuICAgIHN0YXRlLnN0eWxlcy5hcnJvdyA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnN0eWxlcy5hcnJvdywgbWFwVG9TdHlsZXMoT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCB7XG4gICAgICBvZmZzZXRzOiBzdGF0ZS5tb2RpZmllcnNEYXRhLmFycm93LFxuICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICBhZGFwdGl2ZTogZmFsc2UsXG4gICAgICByb3VuZE9mZnNldHM6IHJvdW5kT2Zmc2V0c1xuICAgIH0pKSk7XG4gIH1cblxuICBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyLCB7XG4gICAgJ2RhdGEtcG9wcGVyLXBsYWNlbWVudCc6IHN0YXRlLnBsYWNlbWVudFxuICB9KTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2NvbXB1dGVTdHlsZXMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ2JlZm9yZVdyaXRlJyxcbiAgZm46IGNvbXB1dGVTdHlsZXMsXG4gIGRhdGE6IHt9XG59OyIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0V2luZG93LmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxudmFyIHBhc3NpdmUgPSB7XG4gIHBhc3NpdmU6IHRydWVcbn07XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBpbnN0YW5jZSA9IF9yZWYuaW5zdGFuY2UsXG4gICAgICBvcHRpb25zID0gX3JlZi5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkc2Nyb2xsID0gb3B0aW9ucy5zY3JvbGwsXG4gICAgICBzY3JvbGwgPSBfb3B0aW9ucyRzY3JvbGwgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRzY3JvbGwsXG4gICAgICBfb3B0aW9ucyRyZXNpemUgPSBvcHRpb25zLnJlc2l6ZSxcbiAgICAgIHJlc2l6ZSA9IF9vcHRpb25zJHJlc2l6ZSA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHJlc2l6ZTtcbiAgdmFyIHdpbmRvdyA9IGdldFdpbmRvdyhzdGF0ZS5lbGVtZW50cy5wb3BwZXIpO1xuICB2YXIgc2Nyb2xsUGFyZW50cyA9IFtdLmNvbmNhdChzdGF0ZS5zY3JvbGxQYXJlbnRzLnJlZmVyZW5jZSwgc3RhdGUuc2Nyb2xsUGFyZW50cy5wb3BwZXIpO1xuXG4gIGlmIChzY3JvbGwpIHtcbiAgICBzY3JvbGxQYXJlbnRzLmZvckVhY2goZnVuY3Rpb24gKHNjcm9sbFBhcmVudCkge1xuICAgICAgc2Nyb2xsUGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gICAgfSk7XG4gIH1cblxuICBpZiAocmVzaXplKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmIChzY3JvbGwpIHtcbiAgICAgIHNjcm9sbFBhcmVudHMuZm9yRWFjaChmdW5jdGlvbiAoc2Nyb2xsUGFyZW50KSB7XG4gICAgICAgIHNjcm9sbFBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlc2l6ZSkge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGluc3RhbmNlLnVwZGF0ZSwgcGFzc2l2ZSk7XG4gICAgfVxuICB9O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnZXZlbnRMaXN0ZW5lcnMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ3dyaXRlJyxcbiAgZm46IGZ1bmN0aW9uIGZuKCkge30sXG4gIGVmZmVjdDogZWZmZWN0LFxuICBkYXRhOiB7fVxufTsiLCAidmFyIGhhc2ggPSB7XG4gIGxlZnQ6ICdyaWdodCcsXG4gIHJpZ2h0OiAnbGVmdCcsXG4gIGJvdHRvbTogJ3RvcCcsXG4gIHRvcDogJ2JvdHRvbSdcbn07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRPcHBvc2l0ZVBsYWNlbWVudChwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5yZXBsYWNlKC9sZWZ0fHJpZ2h0fGJvdHRvbXx0b3AvZywgZnVuY3Rpb24gKG1hdGNoZWQpIHtcbiAgICByZXR1cm4gaGFzaFttYXRjaGVkXTtcbiAgfSk7XG59IiwgInZhciBoYXNoID0ge1xuICBzdGFydDogJ2VuZCcsXG4gIGVuZDogJ3N0YXJ0J1xufTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnJlcGxhY2UoL3N0YXJ0fGVuZC9nLCBmdW5jdGlvbiAobWF0Y2hlZCkge1xuICAgIHJldHVybiBoYXNoW21hdGNoZWRdO1xuICB9KTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFdpbmRvd1Njcm9sbChub2RlKSB7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3cobm9kZSk7XG4gIHZhciBzY3JvbGxMZWZ0ID0gd2luLnBhZ2VYT2Zmc2V0O1xuICB2YXIgc2Nyb2xsVG9wID0gd2luLnBhZ2VZT2Zmc2V0O1xuICByZXR1cm4ge1xuICAgIHNjcm9sbExlZnQ6IHNjcm9sbExlZnQsXG4gICAgc2Nyb2xsVG9wOiBzY3JvbGxUb3BcbiAgfTtcbn0iLCAiaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KSB7XG4gIC8vIElmIDxodG1sPiBoYXMgYSBDU1Mgd2lkdGggZ3JlYXRlciB0aGFuIHRoZSB2aWV3cG9ydCwgdGhlbiB0aGlzIHdpbGwgYmVcbiAgLy8gaW5jb3JyZWN0IGZvciBSVEwuXG4gIC8vIFBvcHBlciAxIGlzIGJyb2tlbiBpbiB0aGlzIGNhc2UgYW5kIG5ldmVyIGhhZCBhIGJ1ZyByZXBvcnQgc28gbGV0J3MgYXNzdW1lXG4gIC8vIGl0J3Mgbm90IGFuIGlzc3VlLiBJIGRvbid0IHRoaW5rIGFueW9uZSBldmVyIHNwZWNpZmllcyB3aWR0aCBvbiA8aHRtbD5cbiAgLy8gYW55d2F5LlxuICAvLyBCcm93c2VycyB3aGVyZSB0aGUgbGVmdCBzY3JvbGxiYXIgZG9lc24ndCBjYXVzZSBhbiBpc3N1ZSByZXBvcnQgYDBgIGZvclxuICAvLyB0aGlzIChlLmcuIEVkZ2UgMjAxOSwgSUUxMSwgU2FmYXJpKVxuICByZXR1cm4gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSkubGVmdCArIGdldFdpbmRvd1Njcm9sbChlbGVtZW50KS5zY3JvbGxMZWZ0O1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGxCYXJYIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbEJhclguanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFZpZXdwb3J0UmVjdChlbGVtZW50KSB7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3coZWxlbWVudCk7XG4gIHZhciBodG1sID0gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpO1xuICB2YXIgdmlzdWFsVmlld3BvcnQgPSB3aW4udmlzdWFsVmlld3BvcnQ7XG4gIHZhciB3aWR0aCA9IGh0bWwuY2xpZW50V2lkdGg7XG4gIHZhciBoZWlnaHQgPSBodG1sLmNsaWVudEhlaWdodDtcbiAgdmFyIHggPSAwO1xuICB2YXIgeSA9IDA7IC8vIE5COiBUaGlzIGlzbid0IHN1cHBvcnRlZCBvbiBpT1MgPD0gMTIuIElmIHRoZSBrZXlib2FyZCBpcyBvcGVuLCB0aGUgcG9wcGVyXG4gIC8vIGNhbiBiZSBvYnNjdXJlZCB1bmRlcm5lYXRoIGl0LlxuICAvLyBBbHNvLCBgaHRtbC5jbGllbnRIZWlnaHRgIGFkZHMgdGhlIGJvdHRvbSBiYXIgaGVpZ2h0IGluIFNhZmFyaSBpT1MsIGV2ZW5cbiAgLy8gaWYgaXQgaXNuJ3Qgb3Blbiwgc28gaWYgdGhpcyBpc24ndCBhdmFpbGFibGUsIHRoZSBwb3BwZXIgd2lsbCBiZSBkZXRlY3RlZFxuICAvLyB0byBvdmVyZmxvdyB0aGUgYm90dG9tIG9mIHRoZSBzY3JlZW4gdG9vIGVhcmx5LlxuXG4gIGlmICh2aXN1YWxWaWV3cG9ydCkge1xuICAgIHdpZHRoID0gdmlzdWFsVmlld3BvcnQud2lkdGg7XG4gICAgaGVpZ2h0ID0gdmlzdWFsVmlld3BvcnQuaGVpZ2h0OyAvLyBVc2VzIExheW91dCBWaWV3cG9ydCAobGlrZSBDaHJvbWU7IFNhZmFyaSBkb2VzIG5vdCBjdXJyZW50bHkpXG4gICAgLy8gSW4gQ2hyb21lLCBpdCByZXR1cm5zIGEgdmFsdWUgdmVyeSBjbG9zZSB0byAwICgrLy0pIGJ1dCBjb250YWlucyByb3VuZGluZ1xuICAgIC8vIGVycm9ycyBkdWUgdG8gZmxvYXRpbmcgcG9pbnQgbnVtYmVycywgc28gd2UgbmVlZCB0byBjaGVjayBwcmVjaXNpb24uXG4gICAgLy8gU2FmYXJpIHJldHVybnMgYSBudW1iZXIgPD0gMCwgdXN1YWxseSA8IC0xIHdoZW4gcGluY2gtem9vbWVkXG4gICAgLy8gRmVhdHVyZSBkZXRlY3Rpb24gZmFpbHMgaW4gbW9iaWxlIGVtdWxhdGlvbiBtb2RlIGluIENocm9tZS5cbiAgICAvLyBNYXRoLmFicyh3aW4uaW5uZXJXaWR0aCAvIHZpc3VhbFZpZXdwb3J0LnNjYWxlIC0gdmlzdWFsVmlld3BvcnQud2lkdGgpIDxcbiAgICAvLyAwLjAwMVxuICAgIC8vIEZhbGxiYWNrIGhlcmU6IFwiTm90IFNhZmFyaVwiIHVzZXJBZ2VudFxuXG4gICAgaWYgKCEvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XG4gICAgICB4ID0gdmlzdWFsVmlld3BvcnQub2Zmc2V0TGVmdDtcbiAgICAgIHkgPSB2aXN1YWxWaWV3cG9ydC5vZmZzZXRUb3A7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB3aWR0aDogd2lkdGgsXG4gICAgaGVpZ2h0OiBoZWlnaHQsXG4gICAgeDogeCArIGdldFdpbmRvd1Njcm9sbEJhclgoZWxlbWVudCksXG4gICAgeTogeVxuICB9O1xufSIsICJpbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbEJhclggZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsQmFyWC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGwuanNcIjtcbmltcG9ydCB7IG1heCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7IC8vIEdldHMgdGhlIGVudGlyZSBzaXplIG9mIHRoZSBzY3JvbGxhYmxlIGRvY3VtZW50IGFyZWEsIGV2ZW4gZXh0ZW5kaW5nIG91dHNpZGVcbi8vIG9mIHRoZSBgPGh0bWw+YCBhbmQgYDxib2R5PmAgcmVjdCBib3VuZHMgaWYgaG9yaXpvbnRhbGx5IHNjcm9sbGFibGVcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0RG9jdW1lbnRSZWN0KGVsZW1lbnQpIHtcbiAgdmFyIF9lbGVtZW50JG93bmVyRG9jdW1lbjtcblxuICB2YXIgaHRtbCA9IGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KTtcbiAgdmFyIHdpblNjcm9sbCA9IGdldFdpbmRvd1Njcm9sbChlbGVtZW50KTtcbiAgdmFyIGJvZHkgPSAoX2VsZW1lbnQkb3duZXJEb2N1bWVuID0gZWxlbWVudC5vd25lckRvY3VtZW50KSA9PSBudWxsID8gdm9pZCAwIDogX2VsZW1lbnQkb3duZXJEb2N1bWVuLmJvZHk7XG4gIHZhciB3aWR0aCA9IG1heChodG1sLnNjcm9sbFdpZHRoLCBodG1sLmNsaWVudFdpZHRoLCBib2R5ID8gYm9keS5zY3JvbGxXaWR0aCA6IDAsIGJvZHkgPyBib2R5LmNsaWVudFdpZHRoIDogMCk7XG4gIHZhciBoZWlnaHQgPSBtYXgoaHRtbC5zY3JvbGxIZWlnaHQsIGh0bWwuY2xpZW50SGVpZ2h0LCBib2R5ID8gYm9keS5zY3JvbGxIZWlnaHQgOiAwLCBib2R5ID8gYm9keS5jbGllbnRIZWlnaHQgOiAwKTtcbiAgdmFyIHggPSAtd2luU2Nyb2xsLnNjcm9sbExlZnQgKyBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpO1xuICB2YXIgeSA9IC13aW5TY3JvbGwuc2Nyb2xsVG9wO1xuXG4gIGlmIChnZXRDb21wdXRlZFN0eWxlKGJvZHkgfHwgaHRtbCkuZGlyZWN0aW9uID09PSAncnRsJykge1xuICAgIHggKz0gbWF4KGh0bWwuY2xpZW50V2lkdGgsIGJvZHkgPyBib2R5LmNsaWVudFdpZHRoIDogMCkgLSB3aWR0aDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xufSIsICJpbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1Njcm9sbFBhcmVudChlbGVtZW50KSB7XG4gIC8vIEZpcmVmb3ggd2FudHMgdXMgdG8gY2hlY2sgYC14YCBhbmQgYC15YCB2YXJpYXRpb25zIGFzIHdlbGxcbiAgdmFyIF9nZXRDb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSxcbiAgICAgIG92ZXJmbG93ID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3csXG4gICAgICBvdmVyZmxvd1ggPSBfZ2V0Q29tcHV0ZWRTdHlsZS5vdmVyZmxvd1gsXG4gICAgICBvdmVyZmxvd1kgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5vdmVyZmxvd1k7XG5cbiAgcmV0dXJuIC9hdXRvfHNjcm9sbHxvdmVybGF5fGhpZGRlbi8udGVzdChvdmVyZmxvdyArIG92ZXJmbG93WSArIG92ZXJmbG93WCk7XG59IiwgImltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBpc1Njcm9sbFBhcmVudCBmcm9tIFwiLi9pc1Njcm9sbFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0U2Nyb2xsUGFyZW50KG5vZGUpIHtcbiAgaWYgKFsnaHRtbCcsICdib2R5JywgJyNkb2N1bWVudCddLmluZGV4T2YoZ2V0Tm9kZU5hbWUobm9kZSkpID49IDApIHtcbiAgICAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dOiBhc3N1bWUgYm9keSBpcyBhbHdheXMgYXZhaWxhYmxlXG4gICAgcmV0dXJuIG5vZGUub3duZXJEb2N1bWVudC5ib2R5O1xuICB9XG5cbiAgaWYgKGlzSFRNTEVsZW1lbnQobm9kZSkgJiYgaXNTY3JvbGxQYXJlbnQobm9kZSkpIHtcbiAgICByZXR1cm4gbm9kZTtcbiAgfVxuXG4gIHJldHVybiBnZXRTY3JvbGxQYXJlbnQoZ2V0UGFyZW50Tm9kZShub2RlKSk7XG59IiwgImltcG9ydCBnZXRTY3JvbGxQYXJlbnQgZnJvbSBcIi4vZ2V0U2Nyb2xsUGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGlzU2Nyb2xsUGFyZW50IGZyb20gXCIuL2lzU2Nyb2xsUGFyZW50LmpzXCI7XG4vKlxuZ2l2ZW4gYSBET00gZWxlbWVudCwgcmV0dXJuIHRoZSBsaXN0IG9mIGFsbCBzY3JvbGwgcGFyZW50cywgdXAgdGhlIGxpc3Qgb2YgYW5jZXNvcnNcbnVudGlsIHdlIGdldCB0byB0aGUgdG9wIHdpbmRvdyBvYmplY3QuIFRoaXMgbGlzdCBpcyB3aGF0IHdlIGF0dGFjaCBzY3JvbGwgbGlzdGVuZXJzXG50bywgYmVjYXVzZSBpZiBhbnkgb2YgdGhlc2UgcGFyZW50IGVsZW1lbnRzIHNjcm9sbCwgd2UnbGwgbmVlZCB0byByZS1jYWxjdWxhdGUgdGhlXG5yZWZlcmVuY2UgZWxlbWVudCdzIHBvc2l0aW9uLlxuKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbGlzdFNjcm9sbFBhcmVudHMoZWxlbWVudCwgbGlzdCkge1xuICB2YXIgX2VsZW1lbnQkb3duZXJEb2N1bWVuO1xuXG4gIGlmIChsaXN0ID09PSB2b2lkIDApIHtcbiAgICBsaXN0ID0gW107XG4gIH1cblxuICB2YXIgc2Nyb2xsUGFyZW50ID0gZ2V0U2Nyb2xsUGFyZW50KGVsZW1lbnQpO1xuICB2YXIgaXNCb2R5ID0gc2Nyb2xsUGFyZW50ID09PSAoKF9lbGVtZW50JG93bmVyRG9jdW1lbiA9IGVsZW1lbnQub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9lbGVtZW50JG93bmVyRG9jdW1lbi5ib2R5KTtcbiAgdmFyIHdpbiA9IGdldFdpbmRvdyhzY3JvbGxQYXJlbnQpO1xuICB2YXIgdGFyZ2V0ID0gaXNCb2R5ID8gW3dpbl0uY29uY2F0KHdpbi52aXN1YWxWaWV3cG9ydCB8fCBbXSwgaXNTY3JvbGxQYXJlbnQoc2Nyb2xsUGFyZW50KSA/IHNjcm9sbFBhcmVudCA6IFtdKSA6IHNjcm9sbFBhcmVudDtcbiAgdmFyIHVwZGF0ZWRMaXN0ID0gbGlzdC5jb25jYXQodGFyZ2V0KTtcbiAgcmV0dXJuIGlzQm9keSA/IHVwZGF0ZWRMaXN0IDogLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF06IGlzQm9keSB0ZWxscyB1cyB0YXJnZXQgd2lsbCBiZSBhbiBIVE1MRWxlbWVudCBoZXJlXG4gIHVwZGF0ZWRMaXN0LmNvbmNhdChsaXN0U2Nyb2xsUGFyZW50cyhnZXRQYXJlbnROb2RlKHRhcmdldCkpKTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcmVjdFRvQ2xpZW50UmVjdChyZWN0KSB7XG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCByZWN0LCB7XG4gICAgbGVmdDogcmVjdC54LFxuICAgIHRvcDogcmVjdC55LFxuICAgIHJpZ2h0OiByZWN0LnggKyByZWN0LndpZHRoLFxuICAgIGJvdHRvbTogcmVjdC55ICsgcmVjdC5oZWlnaHRcbiAgfSk7XG59IiwgImltcG9ydCB7IHZpZXdwb3J0IH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZ2V0Vmlld3BvcnRSZWN0IGZyb20gXCIuL2dldFZpZXdwb3J0UmVjdC5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50UmVjdCBmcm9tIFwiLi9nZXREb2N1bWVudFJlY3QuanNcIjtcbmltcG9ydCBsaXN0U2Nyb2xsUGFyZW50cyBmcm9tIFwiLi9saXN0U2Nyb2xsUGFyZW50cy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgeyBpc0VsZW1lbnQsIGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuL2dldEJvdW5kaW5nQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGNvbnRhaW5zIGZyb20gXCIuL2NvbnRhaW5zLmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCByZWN0VG9DbGllbnRSZWN0IGZyb20gXCIuLi91dGlscy9yZWN0VG9DbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgeyBtYXgsIG1pbiB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5cbmZ1bmN0aW9uIGdldElubmVyQm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQpIHtcbiAgdmFyIHJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCk7XG4gIHJlY3QudG9wID0gcmVjdC50b3AgKyBlbGVtZW50LmNsaWVudFRvcDtcbiAgcmVjdC5sZWZ0ID0gcmVjdC5sZWZ0ICsgZWxlbWVudC5jbGllbnRMZWZ0O1xuICByZWN0LmJvdHRvbSA9IHJlY3QudG9wICsgZWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gIHJlY3QucmlnaHQgPSByZWN0LmxlZnQgKyBlbGVtZW50LmNsaWVudFdpZHRoO1xuICByZWN0LndpZHRoID0gZWxlbWVudC5jbGllbnRXaWR0aDtcbiAgcmVjdC5oZWlnaHQgPSBlbGVtZW50LmNsaWVudEhlaWdodDtcbiAgcmVjdC54ID0gcmVjdC5sZWZ0O1xuICByZWN0LnkgPSByZWN0LnRvcDtcbiAgcmV0dXJuIHJlY3Q7XG59XG5cbmZ1bmN0aW9uIGdldENsaWVudFJlY3RGcm9tTWl4ZWRUeXBlKGVsZW1lbnQsIGNsaXBwaW5nUGFyZW50KSB7XG4gIHJldHVybiBjbGlwcGluZ1BhcmVudCA9PT0gdmlld3BvcnQgPyByZWN0VG9DbGllbnRSZWN0KGdldFZpZXdwb3J0UmVjdChlbGVtZW50KSkgOiBpc0VsZW1lbnQoY2xpcHBpbmdQYXJlbnQpID8gZ2V0SW5uZXJCb3VuZGluZ0NsaWVudFJlY3QoY2xpcHBpbmdQYXJlbnQpIDogcmVjdFRvQ2xpZW50UmVjdChnZXREb2N1bWVudFJlY3QoZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpKSk7XG59IC8vIEEgXCJjbGlwcGluZyBwYXJlbnRcIiBpcyBhbiBvdmVyZmxvd2FibGUgY29udGFpbmVyIHdpdGggdGhlIGNoYXJhY3RlcmlzdGljIG9mXG4vLyBjbGlwcGluZyAob3IgaGlkaW5nKSBvdmVyZmxvd2luZyBlbGVtZW50cyB3aXRoIGEgcG9zaXRpb24gZGlmZmVyZW50IGZyb21cbi8vIGBpbml0aWFsYFxuXG5cbmZ1bmN0aW9uIGdldENsaXBwaW5nUGFyZW50cyhlbGVtZW50KSB7XG4gIHZhciBjbGlwcGluZ1BhcmVudHMgPSBsaXN0U2Nyb2xsUGFyZW50cyhnZXRQYXJlbnROb2RlKGVsZW1lbnQpKTtcbiAgdmFyIGNhbkVzY2FwZUNsaXBwaW5nID0gWydhYnNvbHV0ZScsICdmaXhlZCddLmluZGV4T2YoZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KS5wb3NpdGlvbikgPj0gMDtcbiAgdmFyIGNsaXBwZXJFbGVtZW50ID0gY2FuRXNjYXBlQ2xpcHBpbmcgJiYgaXNIVE1MRWxlbWVudChlbGVtZW50KSA/IGdldE9mZnNldFBhcmVudChlbGVtZW50KSA6IGVsZW1lbnQ7XG5cbiAgaWYgKCFpc0VsZW1lbnQoY2xpcHBlckVsZW1lbnQpKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl06IGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9mbG93L2lzc3Vlcy8xNDE0XG5cblxuICByZXR1cm4gY2xpcHBpbmdQYXJlbnRzLmZpbHRlcihmdW5jdGlvbiAoY2xpcHBpbmdQYXJlbnQpIHtcbiAgICByZXR1cm4gaXNFbGVtZW50KGNsaXBwaW5nUGFyZW50KSAmJiBjb250YWlucyhjbGlwcGluZ1BhcmVudCwgY2xpcHBlckVsZW1lbnQpICYmIGdldE5vZGVOYW1lKGNsaXBwaW5nUGFyZW50KSAhPT0gJ2JvZHknO1xuICB9KTtcbn0gLy8gR2V0cyB0aGUgbWF4aW11bSBhcmVhIHRoYXQgdGhlIGVsZW1lbnQgaXMgdmlzaWJsZSBpbiBkdWUgdG8gYW55IG51bWJlciBvZlxuLy8gY2xpcHBpbmcgcGFyZW50c1xuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldENsaXBwaW5nUmVjdChlbGVtZW50LCBib3VuZGFyeSwgcm9vdEJvdW5kYXJ5KSB7XG4gIHZhciBtYWluQ2xpcHBpbmdQYXJlbnRzID0gYm91bmRhcnkgPT09ICdjbGlwcGluZ1BhcmVudHMnID8gZ2V0Q2xpcHBpbmdQYXJlbnRzKGVsZW1lbnQpIDogW10uY29uY2F0KGJvdW5kYXJ5KTtcbiAgdmFyIGNsaXBwaW5nUGFyZW50cyA9IFtdLmNvbmNhdChtYWluQ2xpcHBpbmdQYXJlbnRzLCBbcm9vdEJvdW5kYXJ5XSk7XG4gIHZhciBmaXJzdENsaXBwaW5nUGFyZW50ID0gY2xpcHBpbmdQYXJlbnRzWzBdO1xuICB2YXIgY2xpcHBpbmdSZWN0ID0gY2xpcHBpbmdQYXJlbnRzLnJlZHVjZShmdW5jdGlvbiAoYWNjUmVjdCwgY2xpcHBpbmdQYXJlbnQpIHtcbiAgICB2YXIgcmVjdCA9IGdldENsaWVudFJlY3RGcm9tTWl4ZWRUeXBlKGVsZW1lbnQsIGNsaXBwaW5nUGFyZW50KTtcbiAgICBhY2NSZWN0LnRvcCA9IG1heChyZWN0LnRvcCwgYWNjUmVjdC50b3ApO1xuICAgIGFjY1JlY3QucmlnaHQgPSBtaW4ocmVjdC5yaWdodCwgYWNjUmVjdC5yaWdodCk7XG4gICAgYWNjUmVjdC5ib3R0b20gPSBtaW4ocmVjdC5ib3R0b20sIGFjY1JlY3QuYm90dG9tKTtcbiAgICBhY2NSZWN0LmxlZnQgPSBtYXgocmVjdC5sZWZ0LCBhY2NSZWN0LmxlZnQpO1xuICAgIHJldHVybiBhY2NSZWN0O1xuICB9LCBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBmaXJzdENsaXBwaW5nUGFyZW50KSk7XG4gIGNsaXBwaW5nUmVjdC53aWR0aCA9IGNsaXBwaW5nUmVjdC5yaWdodCAtIGNsaXBwaW5nUmVjdC5sZWZ0O1xuICBjbGlwcGluZ1JlY3QuaGVpZ2h0ID0gY2xpcHBpbmdSZWN0LmJvdHRvbSAtIGNsaXBwaW5nUmVjdC50b3A7XG4gIGNsaXBwaW5nUmVjdC54ID0gY2xpcHBpbmdSZWN0LmxlZnQ7XG4gIGNsaXBwaW5nUmVjdC55ID0gY2xpcHBpbmdSZWN0LnRvcDtcbiAgcmV0dXJuIGNsaXBwaW5nUmVjdDtcbn0iLCAiaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4vZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi9nZXRWYXJpYXRpb24uanNcIjtcbmltcG9ydCBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQgZnJvbSBcIi4vZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB0b3AsIHJpZ2h0LCBib3R0b20sIGxlZnQsIHN0YXJ0LCBlbmQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbXB1dGVPZmZzZXRzKF9yZWYpIHtcbiAgdmFyIHJlZmVyZW5jZSA9IF9yZWYucmVmZXJlbmNlLFxuICAgICAgZWxlbWVudCA9IF9yZWYuZWxlbWVudCxcbiAgICAgIHBsYWNlbWVudCA9IF9yZWYucGxhY2VtZW50O1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IHBsYWNlbWVudCA/IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KSA6IG51bGw7XG4gIHZhciB2YXJpYXRpb24gPSBwbGFjZW1lbnQgPyBnZXRWYXJpYXRpb24ocGxhY2VtZW50KSA6IG51bGw7XG4gIHZhciBjb21tb25YID0gcmVmZXJlbmNlLnggKyByZWZlcmVuY2Uud2lkdGggLyAyIC0gZWxlbWVudC53aWR0aCAvIDI7XG4gIHZhciBjb21tb25ZID0gcmVmZXJlbmNlLnkgKyByZWZlcmVuY2UuaGVpZ2h0IC8gMiAtIGVsZW1lbnQuaGVpZ2h0IC8gMjtcbiAgdmFyIG9mZnNldHM7XG5cbiAgc3dpdGNoIChiYXNlUGxhY2VtZW50KSB7XG4gICAgY2FzZSB0b3A6XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiBjb21tb25YLFxuICAgICAgICB5OiByZWZlcmVuY2UueSAtIGVsZW1lbnQuaGVpZ2h0XG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIGJvdHRvbTpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IGNvbW1vblgsXG4gICAgICAgIHk6IHJlZmVyZW5jZS55ICsgcmVmZXJlbmNlLmhlaWdodFxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSByaWdodDpcbiAgICAgIG9mZnNldHMgPSB7XG4gICAgICAgIHg6IHJlZmVyZW5jZS54ICsgcmVmZXJlbmNlLndpZHRoLFxuICAgICAgICB5OiBjb21tb25ZXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIGxlZnQ6XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiByZWZlcmVuY2UueCAtIGVsZW1lbnQud2lkdGgsXG4gICAgICAgIHk6IGNvbW1vbllcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiByZWZlcmVuY2UueCxcbiAgICAgICAgeTogcmVmZXJlbmNlLnlcbiAgICAgIH07XG4gIH1cblxuICB2YXIgbWFpbkF4aXMgPSBiYXNlUGxhY2VtZW50ID8gZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50KGJhc2VQbGFjZW1lbnQpIDogbnVsbDtcblxuICBpZiAobWFpbkF4aXMgIT0gbnVsbCkge1xuICAgIHZhciBsZW4gPSBtYWluQXhpcyA9PT0gJ3knID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gICAgc3dpdGNoICh2YXJpYXRpb24pIHtcbiAgICAgIGNhc2Ugc3RhcnQ6XG4gICAgICAgIG9mZnNldHNbbWFpbkF4aXNdID0gb2Zmc2V0c1ttYWluQXhpc10gLSAocmVmZXJlbmNlW2xlbl0gLyAyIC0gZWxlbWVudFtsZW5dIC8gMik7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIGVuZDpcbiAgICAgICAgb2Zmc2V0c1ttYWluQXhpc10gPSBvZmZzZXRzW21haW5BeGlzXSArIChyZWZlcmVuY2VbbGVuXSAvIDIgLSBlbGVtZW50W2xlbl0gLyAyKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9mZnNldHM7XG59IiwgImltcG9ydCBnZXRDbGlwcGluZ1JlY3QgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRDbGlwcGluZ1JlY3QuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBjb21wdXRlT2Zmc2V0cyBmcm9tIFwiLi9jb21wdXRlT2Zmc2V0cy5qc1wiO1xuaW1wb3J0IHJlY3RUb0NsaWVudFJlY3QgZnJvbSBcIi4vcmVjdFRvQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IHsgY2xpcHBpbmdQYXJlbnRzLCByZWZlcmVuY2UsIHBvcHBlciwgYm90dG9tLCB0b3AsIHJpZ2h0LCBiYXNlUGxhY2VtZW50cywgdmlld3BvcnQgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCB7IGlzRWxlbWVudCB9IGZyb20gXCIuLi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IG1lcmdlUGFkZGluZ09iamVjdCBmcm9tIFwiLi9tZXJnZVBhZGRpbmdPYmplY3QuanNcIjtcbmltcG9ydCBleHBhbmRUb0hhc2hNYXAgZnJvbSBcIi4vZXhwYW5kVG9IYXNoTWFwLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuXG4gIHZhciBfb3B0aW9ucyA9IG9wdGlvbnMsXG4gICAgICBfb3B0aW9ucyRwbGFjZW1lbnQgPSBfb3B0aW9ucy5wbGFjZW1lbnQsXG4gICAgICBwbGFjZW1lbnQgPSBfb3B0aW9ucyRwbGFjZW1lbnQgPT09IHZvaWQgMCA/IHN0YXRlLnBsYWNlbWVudCA6IF9vcHRpb25zJHBsYWNlbWVudCxcbiAgICAgIF9vcHRpb25zJGJvdW5kYXJ5ID0gX29wdGlvbnMuYm91bmRhcnksXG4gICAgICBib3VuZGFyeSA9IF9vcHRpb25zJGJvdW5kYXJ5ID09PSB2b2lkIDAgPyBjbGlwcGluZ1BhcmVudHMgOiBfb3B0aW9ucyRib3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zJHJvb3RCb3VuZGFyeSA9PT0gdm9pZCAwID8gdmlld3BvcnQgOiBfb3B0aW9ucyRyb290Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRlbGVtZW50Q29udGUgPSBfb3B0aW9ucy5lbGVtZW50Q29udGV4dCxcbiAgICAgIGVsZW1lbnRDb250ZXh0ID0gX29wdGlvbnMkZWxlbWVudENvbnRlID09PSB2b2lkIDAgPyBwb3BwZXIgOiBfb3B0aW9ucyRlbGVtZW50Q29udGUsXG4gICAgICBfb3B0aW9ucyRhbHRCb3VuZGFyeSA9IF9vcHRpb25zLmFsdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnkgPSBfb3B0aW9ucyRhbHRCb3VuZGFyeSA9PT0gdm9pZCAwID8gZmFsc2UgOiBfb3B0aW9ucyRhbHRCb3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJHBhZGRpbmcgPSBfb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgcGFkZGluZyA9IF9vcHRpb25zJHBhZGRpbmcgPT09IHZvaWQgMCA/IDAgOiBfb3B0aW9ucyRwYWRkaW5nO1xuICB2YXIgcGFkZGluZ09iamVjdCA9IG1lcmdlUGFkZGluZ09iamVjdCh0eXBlb2YgcGFkZGluZyAhPT0gJ251bWJlcicgPyBwYWRkaW5nIDogZXhwYW5kVG9IYXNoTWFwKHBhZGRpbmcsIGJhc2VQbGFjZW1lbnRzKSk7XG4gIHZhciBhbHRDb250ZXh0ID0gZWxlbWVudENvbnRleHQgPT09IHBvcHBlciA/IHJlZmVyZW5jZSA6IHBvcHBlcjtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBlbGVtZW50ID0gc3RhdGUuZWxlbWVudHNbYWx0Qm91bmRhcnkgPyBhbHRDb250ZXh0IDogZWxlbWVudENvbnRleHRdO1xuICB2YXIgY2xpcHBpbmdDbGllbnRSZWN0ID0gZ2V0Q2xpcHBpbmdSZWN0KGlzRWxlbWVudChlbGVtZW50KSA/IGVsZW1lbnQgOiBlbGVtZW50LmNvbnRleHRFbGVtZW50IHx8IGdldERvY3VtZW50RWxlbWVudChzdGF0ZS5lbGVtZW50cy5wb3BwZXIpLCBib3VuZGFyeSwgcm9vdEJvdW5kYXJ5KTtcbiAgdmFyIHJlZmVyZW5jZUNsaWVudFJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3Qoc3RhdGUuZWxlbWVudHMucmVmZXJlbmNlKTtcbiAgdmFyIHBvcHBlck9mZnNldHMgPSBjb21wdXRlT2Zmc2V0cyh7XG4gICAgcmVmZXJlbmNlOiByZWZlcmVuY2VDbGllbnRSZWN0LFxuICAgIGVsZW1lbnQ6IHBvcHBlclJlY3QsXG4gICAgc3RyYXRlZ3k6ICdhYnNvbHV0ZScsXG4gICAgcGxhY2VtZW50OiBwbGFjZW1lbnRcbiAgfSk7XG4gIHZhciBwb3BwZXJDbGllbnRSZWN0ID0gcmVjdFRvQ2xpZW50UmVjdChPYmplY3QuYXNzaWduKHt9LCBwb3BwZXJSZWN0LCBwb3BwZXJPZmZzZXRzKSk7XG4gIHZhciBlbGVtZW50Q2xpZW50UmVjdCA9IGVsZW1lbnRDb250ZXh0ID09PSBwb3BwZXIgPyBwb3BwZXJDbGllbnRSZWN0IDogcmVmZXJlbmNlQ2xpZW50UmVjdDsgLy8gcG9zaXRpdmUgPSBvdmVyZmxvd2luZyB0aGUgY2xpcHBpbmcgcmVjdFxuICAvLyAwIG9yIG5lZ2F0aXZlID0gd2l0aGluIHRoZSBjbGlwcGluZyByZWN0XG5cbiAgdmFyIG92ZXJmbG93T2Zmc2V0cyA9IHtcbiAgICB0b3A6IGNsaXBwaW5nQ2xpZW50UmVjdC50b3AgLSBlbGVtZW50Q2xpZW50UmVjdC50b3AgKyBwYWRkaW5nT2JqZWN0LnRvcCxcbiAgICBib3R0b206IGVsZW1lbnRDbGllbnRSZWN0LmJvdHRvbSAtIGNsaXBwaW5nQ2xpZW50UmVjdC5ib3R0b20gKyBwYWRkaW5nT2JqZWN0LmJvdHRvbSxcbiAgICBsZWZ0OiBjbGlwcGluZ0NsaWVudFJlY3QubGVmdCAtIGVsZW1lbnRDbGllbnRSZWN0LmxlZnQgKyBwYWRkaW5nT2JqZWN0LmxlZnQsXG4gICAgcmlnaHQ6IGVsZW1lbnRDbGllbnRSZWN0LnJpZ2h0IC0gY2xpcHBpbmdDbGllbnRSZWN0LnJpZ2h0ICsgcGFkZGluZ09iamVjdC5yaWdodFxuICB9O1xuICB2YXIgb2Zmc2V0RGF0YSA9IHN0YXRlLm1vZGlmaWVyc0RhdGEub2Zmc2V0OyAvLyBPZmZzZXRzIGNhbiBiZSBhcHBsaWVkIG9ubHkgdG8gdGhlIHBvcHBlciBlbGVtZW50XG5cbiAgaWYgKGVsZW1lbnRDb250ZXh0ID09PSBwb3BwZXIgJiYgb2Zmc2V0RGF0YSkge1xuICAgIHZhciBvZmZzZXQgPSBvZmZzZXREYXRhW3BsYWNlbWVudF07XG4gICAgT2JqZWN0LmtleXMob3ZlcmZsb3dPZmZzZXRzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHZhciBtdWx0aXBseSA9IFtyaWdodCwgYm90dG9tXS5pbmRleE9mKGtleSkgPj0gMCA/IDEgOiAtMTtcbiAgICAgIHZhciBheGlzID0gW3RvcCwgYm90dG9tXS5pbmRleE9mKGtleSkgPj0gMCA/ICd5JyA6ICd4JztcbiAgICAgIG92ZXJmbG93T2Zmc2V0c1trZXldICs9IG9mZnNldFtheGlzXSAqIG11bHRpcGx5O1xuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIG92ZXJmbG93T2Zmc2V0cztcbn0iLCAiaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi9nZXRWYXJpYXRpb24uanNcIjtcbmltcG9ydCB7IHZhcmlhdGlvblBsYWNlbWVudHMsIGJhc2VQbGFjZW1lbnRzLCBwbGFjZW1lbnRzIGFzIGFsbFBsYWNlbWVudHMgfSBmcm9tIFwiLi4vZW51bXMuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4vZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY29tcHV0ZUF1dG9QbGFjZW1lbnQoc3RhdGUsIG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuXG4gIHZhciBfb3B0aW9ucyA9IG9wdGlvbnMsXG4gICAgICBwbGFjZW1lbnQgPSBfb3B0aW9ucy5wbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeSA9IF9vcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gX29wdGlvbnMucm9vdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZyA9IF9vcHRpb25zLnBhZGRpbmcsXG4gICAgICBmbGlwVmFyaWF0aW9ucyA9IF9vcHRpb25zLmZsaXBWYXJpYXRpb25zLFxuICAgICAgX29wdGlvbnMkYWxsb3dlZEF1dG9QID0gX29wdGlvbnMuYWxsb3dlZEF1dG9QbGFjZW1lbnRzLFxuICAgICAgYWxsb3dlZEF1dG9QbGFjZW1lbnRzID0gX29wdGlvbnMkYWxsb3dlZEF1dG9QID09PSB2b2lkIDAgPyBhbGxQbGFjZW1lbnRzIDogX29wdGlvbnMkYWxsb3dlZEF1dG9QO1xuICB2YXIgdmFyaWF0aW9uID0gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCk7XG4gIHZhciBwbGFjZW1lbnRzID0gdmFyaWF0aW9uID8gZmxpcFZhcmlhdGlvbnMgPyB2YXJpYXRpb25QbGFjZW1lbnRzIDogdmFyaWF0aW9uUGxhY2VtZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYWNlbWVudCkge1xuICAgIHJldHVybiBnZXRWYXJpYXRpb24ocGxhY2VtZW50KSA9PT0gdmFyaWF0aW9uO1xuICB9KSA6IGJhc2VQbGFjZW1lbnRzO1xuICB2YXIgYWxsb3dlZFBsYWNlbWVudHMgPSBwbGFjZW1lbnRzLmZpbHRlcihmdW5jdGlvbiAocGxhY2VtZW50KSB7XG4gICAgcmV0dXJuIGFsbG93ZWRBdXRvUGxhY2VtZW50cy5pbmRleE9mKHBsYWNlbWVudCkgPj0gMDtcbiAgfSk7XG5cbiAgaWYgKGFsbG93ZWRQbGFjZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIGFsbG93ZWRQbGFjZW1lbnRzID0gcGxhY2VtZW50cztcblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoWydQb3BwZXI6IFRoZSBgYWxsb3dlZEF1dG9QbGFjZW1lbnRzYCBvcHRpb24gZGlkIG5vdCBhbGxvdyBhbnknLCAncGxhY2VtZW50cy4gRW5zdXJlIHRoZSBgcGxhY2VtZW50YCBvcHRpb24gbWF0Y2hlcyB0aGUgdmFyaWF0aW9uJywgJ29mIHRoZSBhbGxvd2VkIHBsYWNlbWVudHMuJywgJ0ZvciBleGFtcGxlLCBcImF1dG9cIiBjYW5ub3QgYmUgdXNlZCB0byBhbGxvdyBcImJvdHRvbS1zdGFydFwiLicsICdVc2UgXCJhdXRvLXN0YXJ0XCIgaW5zdGVhZC4nXS5qb2luKCcgJykpO1xuICAgIH1cbiAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS10eXBlXTogRmxvdyBzZWVtcyB0byBoYXZlIHByb2JsZW1zIHdpdGggdHdvIGFycmF5IHVuaW9ucy4uLlxuXG5cbiAgdmFyIG92ZXJmbG93cyA9IGFsbG93ZWRQbGFjZW1lbnRzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgICBhY2NbcGxhY2VtZW50XSA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeTogcm9vdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZzogcGFkZGluZ1xuICAgIH0pW2dldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KV07XG4gICAgcmV0dXJuIGFjYztcbiAgfSwge30pO1xuICByZXR1cm4gT2JqZWN0LmtleXMob3ZlcmZsb3dzKS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgcmV0dXJuIG92ZXJmbG93c1thXSAtIG92ZXJmbG93c1tiXTtcbiAgfSk7XG59IiwgImltcG9ydCBnZXRPcHBvc2l0ZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0T3Bwb3NpdGVQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4uL3V0aWxzL2RldGVjdE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgY29tcHV0ZUF1dG9QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2NvbXB1dGVBdXRvUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyBib3R0b20sIHRvcCwgc3RhcnQsIHJpZ2h0LCBsZWZ0LCBhdXRvIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuLi91dGlscy9nZXRWYXJpYXRpb24uanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5mdW5jdGlvbiBnZXRFeHBhbmRlZEZhbGxiYWNrUGxhY2VtZW50cyhwbGFjZW1lbnQpIHtcbiAgaWYgKGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KSA9PT0gYXV0bykge1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIHZhciBvcHBvc2l0ZVBsYWNlbWVudCA9IGdldE9wcG9zaXRlUGxhY2VtZW50KHBsYWNlbWVudCk7XG4gIHJldHVybiBbZ2V0T3Bwb3NpdGVWYXJpYXRpb25QbGFjZW1lbnQocGxhY2VtZW50KSwgb3Bwb3NpdGVQbGFjZW1lbnQsIGdldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50KG9wcG9zaXRlUGxhY2VtZW50KV07XG59XG5cbmZ1bmN0aW9uIGZsaXAoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucyxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0uX3NraXApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgX29wdGlvbnMkbWFpbkF4aXMgPSBvcHRpb25zLm1haW5BeGlzLFxuICAgICAgY2hlY2tNYWluQXhpcyA9IF9vcHRpb25zJG1haW5BeGlzID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkbWFpbkF4aXMsXG4gICAgICBfb3B0aW9ucyRhbHRBeGlzID0gb3B0aW9ucy5hbHRBeGlzLFxuICAgICAgY2hlY2tBbHRBeGlzID0gX29wdGlvbnMkYWx0QXhpcyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJGFsdEF4aXMsXG4gICAgICBzcGVjaWZpZWRGYWxsYmFja1BsYWNlbWVudHMgPSBvcHRpb25zLmZhbGxiYWNrUGxhY2VtZW50cyxcbiAgICAgIHBhZGRpbmcgPSBvcHRpb25zLnBhZGRpbmcsXG4gICAgICBib3VuZGFyeSA9IG9wdGlvbnMuYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBvcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIF9vcHRpb25zJGZsaXBWYXJpYXRpbyA9IG9wdGlvbnMuZmxpcFZhcmlhdGlvbnMsXG4gICAgICBmbGlwVmFyaWF0aW9ucyA9IF9vcHRpb25zJGZsaXBWYXJpYXRpbyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJGZsaXBWYXJpYXRpbyxcbiAgICAgIGFsbG93ZWRBdXRvUGxhY2VtZW50cyA9IG9wdGlvbnMuYWxsb3dlZEF1dG9QbGFjZW1lbnRzO1xuICB2YXIgcHJlZmVycmVkUGxhY2VtZW50ID0gc3RhdGUub3B0aW9ucy5wbGFjZW1lbnQ7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gZ2V0QmFzZVBsYWNlbWVudChwcmVmZXJyZWRQbGFjZW1lbnQpO1xuICB2YXIgaXNCYXNlUGxhY2VtZW50ID0gYmFzZVBsYWNlbWVudCA9PT0gcHJlZmVycmVkUGxhY2VtZW50O1xuICB2YXIgZmFsbGJhY2tQbGFjZW1lbnRzID0gc3BlY2lmaWVkRmFsbGJhY2tQbGFjZW1lbnRzIHx8IChpc0Jhc2VQbGFjZW1lbnQgfHwgIWZsaXBWYXJpYXRpb25zID8gW2dldE9wcG9zaXRlUGxhY2VtZW50KHByZWZlcnJlZFBsYWNlbWVudCldIDogZ2V0RXhwYW5kZWRGYWxsYmFja1BsYWNlbWVudHMocHJlZmVycmVkUGxhY2VtZW50KSk7XG4gIHZhciBwbGFjZW1lbnRzID0gW3ByZWZlcnJlZFBsYWNlbWVudF0uY29uY2F0KGZhbGxiYWNrUGxhY2VtZW50cykucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICAgIHJldHVybiBhY2MuY29uY2F0KGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KSA9PT0gYXV0byA/IGNvbXB1dGVBdXRvUGxhY2VtZW50KHN0YXRlLCB7XG4gICAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeTogcm9vdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZzogcGFkZGluZyxcbiAgICAgIGZsaXBWYXJpYXRpb25zOiBmbGlwVmFyaWF0aW9ucyxcbiAgICAgIGFsbG93ZWRBdXRvUGxhY2VtZW50czogYWxsb3dlZEF1dG9QbGFjZW1lbnRzXG4gICAgfSkgOiBwbGFjZW1lbnQpO1xuICB9LCBbXSk7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIGNoZWNrc01hcCA9IG5ldyBNYXAoKTtcbiAgdmFyIG1ha2VGYWxsYmFja0NoZWNrcyA9IHRydWU7XG4gIHZhciBmaXJzdEZpdHRpbmdQbGFjZW1lbnQgPSBwbGFjZW1lbnRzWzBdO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcGxhY2VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBwbGFjZW1lbnQgPSBwbGFjZW1lbnRzW2ldO1xuXG4gICAgdmFyIF9iYXNlUGxhY2VtZW50ID0gZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpO1xuXG4gICAgdmFyIGlzU3RhcnRWYXJpYXRpb24gPSBnZXRWYXJpYXRpb24ocGxhY2VtZW50KSA9PT0gc3RhcnQ7XG4gICAgdmFyIGlzVmVydGljYWwgPSBbdG9wLCBib3R0b21dLmluZGV4T2YoX2Jhc2VQbGFjZW1lbnQpID49IDA7XG4gICAgdmFyIGxlbiA9IGlzVmVydGljYWwgPyAnd2lkdGgnIDogJ2hlaWdodCc7XG4gICAgdmFyIG92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICAgIHBsYWNlbWVudDogcGxhY2VtZW50LFxuICAgICAgYm91bmRhcnk6IGJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5OiByb290Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeTogYWx0Qm91bmRhcnksXG4gICAgICBwYWRkaW5nOiBwYWRkaW5nXG4gICAgfSk7XG4gICAgdmFyIG1haW5WYXJpYXRpb25TaWRlID0gaXNWZXJ0aWNhbCA/IGlzU3RhcnRWYXJpYXRpb24gPyByaWdodCA6IGxlZnQgOiBpc1N0YXJ0VmFyaWF0aW9uID8gYm90dG9tIDogdG9wO1xuXG4gICAgaWYgKHJlZmVyZW5jZVJlY3RbbGVuXSA+IHBvcHBlclJlY3RbbGVuXSkge1xuICAgICAgbWFpblZhcmlhdGlvblNpZGUgPSBnZXRPcHBvc2l0ZVBsYWNlbWVudChtYWluVmFyaWF0aW9uU2lkZSk7XG4gICAgfVxuXG4gICAgdmFyIGFsdFZhcmlhdGlvblNpZGUgPSBnZXRPcHBvc2l0ZVBsYWNlbWVudChtYWluVmFyaWF0aW9uU2lkZSk7XG4gICAgdmFyIGNoZWNrcyA9IFtdO1xuXG4gICAgaWYgKGNoZWNrTWFpbkF4aXMpIHtcbiAgICAgIGNoZWNrcy5wdXNoKG92ZXJmbG93W19iYXNlUGxhY2VtZW50XSA8PSAwKTtcbiAgICB9XG5cbiAgICBpZiAoY2hlY2tBbHRBeGlzKSB7XG4gICAgICBjaGVja3MucHVzaChvdmVyZmxvd1ttYWluVmFyaWF0aW9uU2lkZV0gPD0gMCwgb3ZlcmZsb3dbYWx0VmFyaWF0aW9uU2lkZV0gPD0gMCk7XG4gICAgfVxuXG4gICAgaWYgKGNoZWNrcy5ldmVyeShmdW5jdGlvbiAoY2hlY2spIHtcbiAgICAgIHJldHVybiBjaGVjaztcbiAgICB9KSkge1xuICAgICAgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gcGxhY2VtZW50O1xuICAgICAgbWFrZUZhbGxiYWNrQ2hlY2tzID0gZmFsc2U7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBjaGVja3NNYXAuc2V0KHBsYWNlbWVudCwgY2hlY2tzKTtcbiAgfVxuXG4gIGlmIChtYWtlRmFsbGJhY2tDaGVja3MpIHtcbiAgICAvLyBgMmAgbWF5IGJlIGRlc2lyZWQgaW4gc29tZSBjYXNlcyBcdTIwMTMgcmVzZWFyY2ggbGF0ZXJcbiAgICB2YXIgbnVtYmVyT2ZDaGVja3MgPSBmbGlwVmFyaWF0aW9ucyA/IDMgOiAxO1xuXG4gICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoX2kpIHtcbiAgICAgIHZhciBmaXR0aW5nUGxhY2VtZW50ID0gcGxhY2VtZW50cy5maW5kKGZ1bmN0aW9uIChwbGFjZW1lbnQpIHtcbiAgICAgICAgdmFyIGNoZWNrcyA9IGNoZWNrc01hcC5nZXQocGxhY2VtZW50KTtcblxuICAgICAgICBpZiAoY2hlY2tzKSB7XG4gICAgICAgICAgcmV0dXJuIGNoZWNrcy5zbGljZSgwLCBfaSkuZXZlcnkoZnVuY3Rpb24gKGNoZWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gY2hlY2s7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAoZml0dGluZ1BsYWNlbWVudCkge1xuICAgICAgICBmaXJzdEZpdHRpbmdQbGFjZW1lbnQgPSBmaXR0aW5nUGxhY2VtZW50O1xuICAgICAgICByZXR1cm4gXCJicmVha1wiO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmb3IgKHZhciBfaSA9IG51bWJlck9mQ2hlY2tzOyBfaSA+IDA7IF9pLS0pIHtcbiAgICAgIHZhciBfcmV0ID0gX2xvb3AoX2kpO1xuXG4gICAgICBpZiAoX3JldCA9PT0gXCJicmVha1wiKSBicmVhaztcbiAgICB9XG4gIH1cblxuICBpZiAoc3RhdGUucGxhY2VtZW50ICE9PSBmaXJzdEZpdHRpbmdQbGFjZW1lbnQpIHtcbiAgICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdLl9za2lwID0gdHJ1ZTtcbiAgICBzdGF0ZS5wbGFjZW1lbnQgPSBmaXJzdEZpdHRpbmdQbGFjZW1lbnQ7XG4gICAgc3RhdGUucmVzZXQgPSB0cnVlO1xuICB9XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdmbGlwJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgZm46IGZsaXAsXG4gIHJlcXVpcmVzSWZFeGlzdHM6IFsnb2Zmc2V0J10sXG4gIGRhdGE6IHtcbiAgICBfc2tpcDogZmFsc2VcbiAgfVxufTsiLCAiaW1wb3J0IHsgdG9wLCBib3R0b20sIGxlZnQsIHJpZ2h0IH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4uL3V0aWxzL2RldGVjdE92ZXJmbG93LmpzXCI7XG5cbmZ1bmN0aW9uIGdldFNpZGVPZmZzZXRzKG92ZXJmbG93LCByZWN0LCBwcmV2ZW50ZWRPZmZzZXRzKSB7XG4gIGlmIChwcmV2ZW50ZWRPZmZzZXRzID09PSB2b2lkIDApIHtcbiAgICBwcmV2ZW50ZWRPZmZzZXRzID0ge1xuICAgICAgeDogMCxcbiAgICAgIHk6IDBcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0b3A6IG92ZXJmbG93LnRvcCAtIHJlY3QuaGVpZ2h0IC0gcHJldmVudGVkT2Zmc2V0cy55LFxuICAgIHJpZ2h0OiBvdmVyZmxvdy5yaWdodCAtIHJlY3Qud2lkdGggKyBwcmV2ZW50ZWRPZmZzZXRzLngsXG4gICAgYm90dG9tOiBvdmVyZmxvdy5ib3R0b20gLSByZWN0LmhlaWdodCArIHByZXZlbnRlZE9mZnNldHMueSxcbiAgICBsZWZ0OiBvdmVyZmxvdy5sZWZ0IC0gcmVjdC53aWR0aCAtIHByZXZlbnRlZE9mZnNldHMueFxuICB9O1xufVxuXG5mdW5jdGlvbiBpc0FueVNpZGVGdWxseUNsaXBwZWQob3ZlcmZsb3cpIHtcbiAgcmV0dXJuIFt0b3AsIHJpZ2h0LCBib3R0b20sIGxlZnRdLnNvbWUoZnVuY3Rpb24gKHNpZGUpIHtcbiAgICByZXR1cm4gb3ZlcmZsb3dbc2lkZV0gPj0gMDtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhpZGUoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZTtcbiAgdmFyIHJlZmVyZW5jZVJlY3QgPSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2U7XG4gIHZhciBwb3BwZXJSZWN0ID0gc3RhdGUucmVjdHMucG9wcGVyO1xuICB2YXIgcHJldmVudGVkT2Zmc2V0cyA9IHN0YXRlLm1vZGlmaWVyc0RhdGEucHJldmVudE92ZXJmbG93O1xuICB2YXIgcmVmZXJlbmNlT3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgIGVsZW1lbnRDb250ZXh0OiAncmVmZXJlbmNlJ1xuICB9KTtcbiAgdmFyIHBvcHBlckFsdE92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICBhbHRCb3VuZGFyeTogdHJ1ZVxuICB9KTtcbiAgdmFyIHJlZmVyZW5jZUNsaXBwaW5nT2Zmc2V0cyA9IGdldFNpZGVPZmZzZXRzKHJlZmVyZW5jZU92ZXJmbG93LCByZWZlcmVuY2VSZWN0KTtcbiAgdmFyIHBvcHBlckVzY2FwZU9mZnNldHMgPSBnZXRTaWRlT2Zmc2V0cyhwb3BwZXJBbHRPdmVyZmxvdywgcG9wcGVyUmVjdCwgcHJldmVudGVkT2Zmc2V0cyk7XG4gIHZhciBpc1JlZmVyZW5jZUhpZGRlbiA9IGlzQW55U2lkZUZ1bGx5Q2xpcHBlZChyZWZlcmVuY2VDbGlwcGluZ09mZnNldHMpO1xuICB2YXIgaGFzUG9wcGVyRXNjYXBlZCA9IGlzQW55U2lkZUZ1bGx5Q2xpcHBlZChwb3BwZXJFc2NhcGVPZmZzZXRzKTtcbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IHtcbiAgICByZWZlcmVuY2VDbGlwcGluZ09mZnNldHM6IHJlZmVyZW5jZUNsaXBwaW5nT2Zmc2V0cyxcbiAgICBwb3BwZXJFc2NhcGVPZmZzZXRzOiBwb3BwZXJFc2NhcGVPZmZzZXRzLFxuICAgIGlzUmVmZXJlbmNlSGlkZGVuOiBpc1JlZmVyZW5jZUhpZGRlbixcbiAgICBoYXNQb3BwZXJFc2NhcGVkOiBoYXNQb3BwZXJFc2NhcGVkXG4gIH07XG4gIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIsIHtcbiAgICAnZGF0YS1wb3BwZXItcmVmZXJlbmNlLWhpZGRlbic6IGlzUmVmZXJlbmNlSGlkZGVuLFxuICAgICdkYXRhLXBvcHBlci1lc2NhcGVkJzogaGFzUG9wcGVyRXNjYXBlZFxuICB9KTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2hpZGUnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ3ByZXZlbnRPdmVyZmxvdyddLFxuICBmbjogaGlkZVxufTsiLCAiaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCB7IHRvcCwgbGVmdCwgcmlnaHQsIHBsYWNlbWVudHMgfSBmcm9tIFwiLi4vZW51bXMuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgZnVuY3Rpb24gZGlzdGFuY2VBbmRTa2lkZGluZ1RvWFkocGxhY2VtZW50LCByZWN0cywgb2Zmc2V0KSB7XG4gIHZhciBiYXNlUGxhY2VtZW50ID0gZ2V0QmFzZVBsYWNlbWVudChwbGFjZW1lbnQpO1xuICB2YXIgaW52ZXJ0RGlzdGFuY2UgPSBbbGVmdCwgdG9wXS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpID49IDAgPyAtMSA6IDE7XG5cbiAgdmFyIF9yZWYgPSB0eXBlb2Ygb2Zmc2V0ID09PSAnZnVuY3Rpb24nID8gb2Zmc2V0KE9iamVjdC5hc3NpZ24oe30sIHJlY3RzLCB7XG4gICAgcGxhY2VtZW50OiBwbGFjZW1lbnRcbiAgfSkpIDogb2Zmc2V0LFxuICAgICAgc2tpZGRpbmcgPSBfcmVmWzBdLFxuICAgICAgZGlzdGFuY2UgPSBfcmVmWzFdO1xuXG4gIHNraWRkaW5nID0gc2tpZGRpbmcgfHwgMDtcbiAgZGlzdGFuY2UgPSAoZGlzdGFuY2UgfHwgMCkgKiBpbnZlcnREaXN0YW5jZTtcbiAgcmV0dXJuIFtsZWZ0LCByaWdodF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwID8ge1xuICAgIHg6IGRpc3RhbmNlLFxuICAgIHk6IHNraWRkaW5nXG4gIH0gOiB7XG4gICAgeDogc2tpZGRpbmcsXG4gICAgeTogZGlzdGFuY2VcbiAgfTtcbn1cblxuZnVuY3Rpb24gb2Zmc2V0KF9yZWYyKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYyLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYyLm9wdGlvbnMsXG4gICAgICBuYW1lID0gX3JlZjIubmFtZTtcbiAgdmFyIF9vcHRpb25zJG9mZnNldCA9IG9wdGlvbnMub2Zmc2V0LFxuICAgICAgb2Zmc2V0ID0gX29wdGlvbnMkb2Zmc2V0ID09PSB2b2lkIDAgPyBbMCwgMF0gOiBfb3B0aW9ucyRvZmZzZXQ7XG4gIHZhciBkYXRhID0gcGxhY2VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gICAgYWNjW3BsYWNlbWVudF0gPSBkaXN0YW5jZUFuZFNraWRkaW5nVG9YWShwbGFjZW1lbnQsIHN0YXRlLnJlY3RzLCBvZmZzZXQpO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgdmFyIF9kYXRhJHN0YXRlJHBsYWNlbWVudCA9IGRhdGFbc3RhdGUucGxhY2VtZW50XSxcbiAgICAgIHggPSBfZGF0YSRzdGF0ZSRwbGFjZW1lbnQueCxcbiAgICAgIHkgPSBfZGF0YSRzdGF0ZSRwbGFjZW1lbnQueTtcblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzICE9IG51bGwpIHtcbiAgICBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMueCArPSB4O1xuICAgIHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cy55ICs9IHk7XG4gIH1cblxuICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdID0gZGF0YTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ29mZnNldCcsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIHJlcXVpcmVzOiBbJ3BvcHBlck9mZnNldHMnXSxcbiAgZm46IG9mZnNldFxufTsiLCAiaW1wb3J0IGNvbXB1dGVPZmZzZXRzIGZyb20gXCIuLi91dGlscy9jb21wdXRlT2Zmc2V0cy5qc1wiO1xuXG5mdW5jdGlvbiBwb3BwZXJPZmZzZXRzKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIC8vIE9mZnNldHMgYXJlIHRoZSBhY3R1YWwgcG9zaXRpb24gdGhlIHBvcHBlciBuZWVkcyB0byBoYXZlIHRvIGJlXG4gIC8vIHByb3Blcmx5IHBvc2l0aW9uZWQgbmVhciBpdHMgcmVmZXJlbmNlIGVsZW1lbnRcbiAgLy8gVGhpcyBpcyB0aGUgbW9zdCBiYXNpYyBwbGFjZW1lbnQsIGFuZCB3aWxsIGJlIGFkanVzdGVkIGJ5XG4gIC8vIHRoZSBtb2RpZmllcnMgaW4gdGhlIG5leHQgc3RlcFxuICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdID0gY29tcHV0ZU9mZnNldHMoe1xuICAgIHJlZmVyZW5jZTogc3RhdGUucmVjdHMucmVmZXJlbmNlLFxuICAgIGVsZW1lbnQ6IHN0YXRlLnJlY3RzLnBvcHBlcixcbiAgICBzdHJhdGVneTogJ2Fic29sdXRlJyxcbiAgICBwbGFjZW1lbnQ6IHN0YXRlLnBsYWNlbWVudFxuICB9KTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ3BvcHBlck9mZnNldHMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ3JlYWQnLFxuICBmbjogcG9wcGVyT2Zmc2V0cyxcbiAgZGF0YToge31cbn07IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEFsdEF4aXMoYXhpcykge1xuICByZXR1cm4gYXhpcyA9PT0gJ3gnID8gJ3knIDogJ3gnO1xufSIsICJpbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBib3R0b20sIHN0YXJ0IH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0QWx0QXhpcyBmcm9tIFwiLi4vdXRpbHMvZ2V0QWx0QXhpcy5qc1wiO1xuaW1wb3J0IHsgd2l0aGluLCB3aXRoaW5NYXhDbGFtcCB9IGZyb20gXCIuLi91dGlscy93aXRoaW4uanNcIjtcbmltcG9ydCBnZXRMYXlvdXRSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgZ2V0RnJlc2hTaWRlT2JqZWN0IGZyb20gXCIuLi91dGlscy9nZXRGcmVzaFNpZGVPYmplY3QuanNcIjtcbmltcG9ydCB7IG1pbiBhcyBtYXRoTWluLCBtYXggYXMgbWF0aE1heCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5cbmZ1bmN0aW9uIHByZXZlbnRPdmVyZmxvdyhfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBvcHRpb25zID0gX3JlZi5vcHRpb25zLFxuICAgICAgbmFtZSA9IF9yZWYubmFtZTtcbiAgdmFyIF9vcHRpb25zJG1haW5BeGlzID0gb3B0aW9ucy5tYWluQXhpcyxcbiAgICAgIGNoZWNrTWFpbkF4aXMgPSBfb3B0aW9ucyRtYWluQXhpcyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJG1haW5BeGlzLFxuICAgICAgX29wdGlvbnMkYWx0QXhpcyA9IG9wdGlvbnMuYWx0QXhpcyxcbiAgICAgIGNoZWNrQWx0QXhpcyA9IF9vcHRpb25zJGFsdEF4aXMgPT09IHZvaWQgMCA/IGZhbHNlIDogX29wdGlvbnMkYWx0QXhpcyxcbiAgICAgIGJvdW5kYXJ5ID0gb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IG9wdGlvbnMucm9vdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnkgPSBvcHRpb25zLmFsdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZyA9IG9wdGlvbnMucGFkZGluZyxcbiAgICAgIF9vcHRpb25zJHRldGhlciA9IG9wdGlvbnMudGV0aGVyLFxuICAgICAgdGV0aGVyID0gX29wdGlvbnMkdGV0aGVyID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkdGV0aGVyLFxuICAgICAgX29wdGlvbnMkdGV0aGVyT2Zmc2V0ID0gb3B0aW9ucy50ZXRoZXJPZmZzZXQsXG4gICAgICB0ZXRoZXJPZmZzZXQgPSBfb3B0aW9ucyR0ZXRoZXJPZmZzZXQgPT09IHZvaWQgMCA/IDAgOiBfb3B0aW9ucyR0ZXRoZXJPZmZzZXQ7XG4gIHZhciBvdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgYm91bmRhcnk6IGJvdW5kYXJ5LFxuICAgIHJvb3RCb3VuZGFyeTogcm9vdEJvdW5kYXJ5LFxuICAgIHBhZGRpbmc6IHBhZGRpbmcsXG4gICAgYWx0Qm91bmRhcnk6IGFsdEJvdW5kYXJ5XG4gIH0pO1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQoc3RhdGUucGxhY2VtZW50KTtcbiAgdmFyIHZhcmlhdGlvbiA9IGdldFZhcmlhdGlvbihzdGF0ZS5wbGFjZW1lbnQpO1xuICB2YXIgaXNCYXNlUGxhY2VtZW50ID0gIXZhcmlhdGlvbjtcbiAgdmFyIG1haW5BeGlzID0gZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50KGJhc2VQbGFjZW1lbnQpO1xuICB2YXIgYWx0QXhpcyA9IGdldEFsdEF4aXMobWFpbkF4aXMpO1xuICB2YXIgcG9wcGVyT2Zmc2V0cyA9IHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cztcbiAgdmFyIHJlZmVyZW5jZVJlY3QgPSBzdGF0ZS5yZWN0cy5yZWZlcmVuY2U7XG4gIHZhciBwb3BwZXJSZWN0ID0gc3RhdGUucmVjdHMucG9wcGVyO1xuICB2YXIgdGV0aGVyT2Zmc2V0VmFsdWUgPSB0eXBlb2YgdGV0aGVyT2Zmc2V0ID09PSAnZnVuY3Rpb24nID8gdGV0aGVyT2Zmc2V0KE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLnJlY3RzLCB7XG4gICAgcGxhY2VtZW50OiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSkpIDogdGV0aGVyT2Zmc2V0O1xuICB2YXIgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlID0gdHlwZW9mIHRldGhlck9mZnNldFZhbHVlID09PSAnbnVtYmVyJyA/IHtcbiAgICBtYWluQXhpczogdGV0aGVyT2Zmc2V0VmFsdWUsXG4gICAgYWx0QXhpczogdGV0aGVyT2Zmc2V0VmFsdWVcbiAgfSA6IE9iamVjdC5hc3NpZ24oe1xuICAgIG1haW5BeGlzOiAwLFxuICAgIGFsdEF4aXM6IDBcbiAgfSwgdGV0aGVyT2Zmc2V0VmFsdWUpO1xuICB2YXIgb2Zmc2V0TW9kaWZpZXJTdGF0ZSA9IHN0YXRlLm1vZGlmaWVyc0RhdGEub2Zmc2V0ID8gc3RhdGUubW9kaWZpZXJzRGF0YS5vZmZzZXRbc3RhdGUucGxhY2VtZW50XSA6IG51bGw7XG4gIHZhciBkYXRhID0ge1xuICAgIHg6IDAsXG4gICAgeTogMFxuICB9O1xuXG4gIGlmICghcG9wcGVyT2Zmc2V0cykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmIChjaGVja01haW5BeGlzKSB7XG4gICAgdmFyIF9vZmZzZXRNb2RpZmllclN0YXRlJDtcblxuICAgIHZhciBtYWluU2lkZSA9IG1haW5BeGlzID09PSAneScgPyB0b3AgOiBsZWZ0O1xuICAgIHZhciBhbHRTaWRlID0gbWFpbkF4aXMgPT09ICd5JyA/IGJvdHRvbSA6IHJpZ2h0O1xuICAgIHZhciBsZW4gPSBtYWluQXhpcyA9PT0gJ3knID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuICAgIHZhciBvZmZzZXQgPSBwb3BwZXJPZmZzZXRzW21haW5BeGlzXTtcbiAgICB2YXIgbWluID0gb2Zmc2V0ICsgb3ZlcmZsb3dbbWFpblNpZGVdO1xuICAgIHZhciBtYXggPSBvZmZzZXQgLSBvdmVyZmxvd1thbHRTaWRlXTtcbiAgICB2YXIgYWRkaXRpdmUgPSB0ZXRoZXIgPyAtcG9wcGVyUmVjdFtsZW5dIC8gMiA6IDA7XG4gICAgdmFyIG1pbkxlbiA9IHZhcmlhdGlvbiA9PT0gc3RhcnQgPyByZWZlcmVuY2VSZWN0W2xlbl0gOiBwb3BwZXJSZWN0W2xlbl07XG4gICAgdmFyIG1heExlbiA9IHZhcmlhdGlvbiA9PT0gc3RhcnQgPyAtcG9wcGVyUmVjdFtsZW5dIDogLXJlZmVyZW5jZVJlY3RbbGVuXTsgLy8gV2UgbmVlZCB0byBpbmNsdWRlIHRoZSBhcnJvdyBpbiB0aGUgY2FsY3VsYXRpb24gc28gdGhlIGFycm93IGRvZXNuJ3QgZ29cbiAgICAvLyBvdXRzaWRlIHRoZSByZWZlcmVuY2UgYm91bmRzXG5cbiAgICB2YXIgYXJyb3dFbGVtZW50ID0gc3RhdGUuZWxlbWVudHMuYXJyb3c7XG4gICAgdmFyIGFycm93UmVjdCA9IHRldGhlciAmJiBhcnJvd0VsZW1lbnQgPyBnZXRMYXlvdXRSZWN0KGFycm93RWxlbWVudCkgOiB7XG4gICAgICB3aWR0aDogMCxcbiAgICAgIGhlaWdodDogMFxuICAgIH07XG4gICAgdmFyIGFycm93UGFkZGluZ09iamVjdCA9IHN0YXRlLm1vZGlmaWVyc0RhdGFbJ2Fycm93I3BlcnNpc3RlbnQnXSA/IHN0YXRlLm1vZGlmaWVyc0RhdGFbJ2Fycm93I3BlcnNpc3RlbnQnXS5wYWRkaW5nIDogZ2V0RnJlc2hTaWRlT2JqZWN0KCk7XG4gICAgdmFyIGFycm93UGFkZGluZ01pbiA9IGFycm93UGFkZGluZ09iamVjdFttYWluU2lkZV07XG4gICAgdmFyIGFycm93UGFkZGluZ01heCA9IGFycm93UGFkZGluZ09iamVjdFthbHRTaWRlXTsgLy8gSWYgdGhlIHJlZmVyZW5jZSBsZW5ndGggaXMgc21hbGxlciB0aGFuIHRoZSBhcnJvdyBsZW5ndGgsIHdlIGRvbid0IHdhbnRcbiAgICAvLyB0byBpbmNsdWRlIGl0cyBmdWxsIHNpemUgaW4gdGhlIGNhbGN1bGF0aW9uLiBJZiB0aGUgcmVmZXJlbmNlIGlzIHNtYWxsXG4gICAgLy8gYW5kIG5lYXIgdGhlIGVkZ2Ugb2YgYSBib3VuZGFyeSwgdGhlIHBvcHBlciBjYW4gb3ZlcmZsb3cgZXZlbiBpZiB0aGVcbiAgICAvLyByZWZlcmVuY2UgaXMgbm90IG92ZXJmbG93aW5nIGFzIHdlbGwgKGUuZy4gdmlydHVhbCBlbGVtZW50cyB3aXRoIG5vXG4gICAgLy8gd2lkdGggb3IgaGVpZ2h0KVxuXG4gICAgdmFyIGFycm93TGVuID0gd2l0aGluKDAsIHJlZmVyZW5jZVJlY3RbbGVuXSwgYXJyb3dSZWN0W2xlbl0pO1xuICAgIHZhciBtaW5PZmZzZXQgPSBpc0Jhc2VQbGFjZW1lbnQgPyByZWZlcmVuY2VSZWN0W2xlbl0gLyAyIC0gYWRkaXRpdmUgLSBhcnJvd0xlbiAtIGFycm93UGFkZGluZ01pbiAtIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcyA6IG1pbkxlbiAtIGFycm93TGVuIC0gYXJyb3dQYWRkaW5nTWluIC0gbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzO1xuICAgIHZhciBtYXhPZmZzZXQgPSBpc0Jhc2VQbGFjZW1lbnQgPyAtcmVmZXJlbmNlUmVjdFtsZW5dIC8gMiArIGFkZGl0aXZlICsgYXJyb3dMZW4gKyBhcnJvd1BhZGRpbmdNYXggKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXMgOiBtYXhMZW4gKyBhcnJvd0xlbiArIGFycm93UGFkZGluZ01heCArIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcztcbiAgICB2YXIgYXJyb3dPZmZzZXRQYXJlbnQgPSBzdGF0ZS5lbGVtZW50cy5hcnJvdyAmJiBnZXRPZmZzZXRQYXJlbnQoc3RhdGUuZWxlbWVudHMuYXJyb3cpO1xuICAgIHZhciBjbGllbnRPZmZzZXQgPSBhcnJvd09mZnNldFBhcmVudCA/IG1haW5BeGlzID09PSAneScgPyBhcnJvd09mZnNldFBhcmVudC5jbGllbnRUb3AgfHwgMCA6IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudExlZnQgfHwgMCA6IDA7XG4gICAgdmFyIG9mZnNldE1vZGlmaWVyVmFsdWUgPSAoX29mZnNldE1vZGlmaWVyU3RhdGUkID0gb2Zmc2V0TW9kaWZpZXJTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogb2Zmc2V0TW9kaWZpZXJTdGF0ZVttYWluQXhpc10pICE9IG51bGwgPyBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQgOiAwO1xuICAgIHZhciB0ZXRoZXJNaW4gPSBvZmZzZXQgKyBtaW5PZmZzZXQgLSBvZmZzZXRNb2RpZmllclZhbHVlIC0gY2xpZW50T2Zmc2V0O1xuICAgIHZhciB0ZXRoZXJNYXggPSBvZmZzZXQgKyBtYXhPZmZzZXQgLSBvZmZzZXRNb2RpZmllclZhbHVlO1xuICAgIHZhciBwcmV2ZW50ZWRPZmZzZXQgPSB3aXRoaW4odGV0aGVyID8gbWF0aE1pbihtaW4sIHRldGhlck1pbikgOiBtaW4sIG9mZnNldCwgdGV0aGVyID8gbWF0aE1heChtYXgsIHRldGhlck1heCkgOiBtYXgpO1xuICAgIHBvcHBlck9mZnNldHNbbWFpbkF4aXNdID0gcHJldmVudGVkT2Zmc2V0O1xuICAgIGRhdGFbbWFpbkF4aXNdID0gcHJldmVudGVkT2Zmc2V0IC0gb2Zmc2V0O1xuICB9XG5cbiAgaWYgKGNoZWNrQWx0QXhpcykge1xuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQyO1xuXG4gICAgdmFyIF9tYWluU2lkZSA9IG1haW5BeGlzID09PSAneCcgPyB0b3AgOiBsZWZ0O1xuXG4gICAgdmFyIF9hbHRTaWRlID0gbWFpbkF4aXMgPT09ICd4JyA/IGJvdHRvbSA6IHJpZ2h0O1xuXG4gICAgdmFyIF9vZmZzZXQgPSBwb3BwZXJPZmZzZXRzW2FsdEF4aXNdO1xuXG4gICAgdmFyIF9sZW4gPSBhbHRBeGlzID09PSAneScgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG5cbiAgICB2YXIgX21pbiA9IF9vZmZzZXQgKyBvdmVyZmxvd1tfbWFpblNpZGVdO1xuXG4gICAgdmFyIF9tYXggPSBfb2Zmc2V0IC0gb3ZlcmZsb3dbX2FsdFNpZGVdO1xuXG4gICAgdmFyIGlzT3JpZ2luU2lkZSA9IFt0b3AsIGxlZnRdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgIT09IC0xO1xuXG4gICAgdmFyIF9vZmZzZXRNb2RpZmllclZhbHVlID0gKF9vZmZzZXRNb2RpZmllclN0YXRlJDIgPSBvZmZzZXRNb2RpZmllclN0YXRlID09IG51bGwgPyB2b2lkIDAgOiBvZmZzZXRNb2RpZmllclN0YXRlW2FsdEF4aXNdKSAhPSBudWxsID8gX29mZnNldE1vZGlmaWVyU3RhdGUkMiA6IDA7XG5cbiAgICB2YXIgX3RldGhlck1pbiA9IGlzT3JpZ2luU2lkZSA/IF9taW4gOiBfb2Zmc2V0IC0gcmVmZXJlbmNlUmVjdFtfbGVuXSAtIHBvcHBlclJlY3RbX2xlbl0gLSBfb2Zmc2V0TW9kaWZpZXJWYWx1ZSArIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5hbHRBeGlzO1xuXG4gICAgdmFyIF90ZXRoZXJNYXggPSBpc09yaWdpblNpZGUgPyBfb2Zmc2V0ICsgcmVmZXJlbmNlUmVjdFtfbGVuXSArIHBvcHBlclJlY3RbX2xlbl0gLSBfb2Zmc2V0TW9kaWZpZXJWYWx1ZSAtIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5hbHRBeGlzIDogX21heDtcblxuICAgIHZhciBfcHJldmVudGVkT2Zmc2V0ID0gdGV0aGVyICYmIGlzT3JpZ2luU2lkZSA/IHdpdGhpbk1heENsYW1wKF90ZXRoZXJNaW4sIF9vZmZzZXQsIF90ZXRoZXJNYXgpIDogd2l0aGluKHRldGhlciA/IF90ZXRoZXJNaW4gOiBfbWluLCBfb2Zmc2V0LCB0ZXRoZXIgPyBfdGV0aGVyTWF4IDogX21heCk7XG5cbiAgICBwb3BwZXJPZmZzZXRzW2FsdEF4aXNdID0gX3ByZXZlbnRlZE9mZnNldDtcbiAgICBkYXRhW2FsdEF4aXNdID0gX3ByZXZlbnRlZE9mZnNldCAtIF9vZmZzZXQ7XG4gIH1cblxuICBzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdID0gZGF0YTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ3ByZXZlbnRPdmVyZmxvdycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIGZuOiBwcmV2ZW50T3ZlcmZsb3csXG4gIHJlcXVpcmVzSWZFeGlzdHM6IFsnb2Zmc2V0J11cbn07IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldEhUTUxFbGVtZW50U2Nyb2xsKGVsZW1lbnQpIHtcbiAgcmV0dXJuIHtcbiAgICBzY3JvbGxMZWZ0OiBlbGVtZW50LnNjcm9sbExlZnQsXG4gICAgc2Nyb2xsVG9wOiBlbGVtZW50LnNjcm9sbFRvcFxuICB9O1xufSIsICJpbXBvcnQgZ2V0V2luZG93U2Nyb2xsIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgZ2V0SFRNTEVsZW1lbnRTY3JvbGwgZnJvbSBcIi4vZ2V0SFRNTEVsZW1lbnRTY3JvbGwuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldE5vZGVTY3JvbGwobm9kZSkge1xuICBpZiAobm9kZSA9PT0gZ2V0V2luZG93KG5vZGUpIHx8ICFpc0hUTUxFbGVtZW50KG5vZGUpKSB7XG4gICAgcmV0dXJuIGdldFdpbmRvd1Njcm9sbChub2RlKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZ2V0SFRNTEVsZW1lbnRTY3JvbGwobm9kZSk7XG4gIH1cbn0iLCAiaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBnZXROb2RlU2Nyb2xsIGZyb20gXCIuL2dldE5vZGVTY3JvbGwuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGxCYXJYIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbEJhclguanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgaXNTY3JvbGxQYXJlbnQgZnJvbSBcIi4vaXNTY3JvbGxQYXJlbnQuanNcIjtcbmltcG9ydCB7IHJvdW5kIH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjtcblxuZnVuY3Rpb24gaXNFbGVtZW50U2NhbGVkKGVsZW1lbnQpIHtcbiAgdmFyIHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICB2YXIgc2NhbGVYID0gcm91bmQocmVjdC53aWR0aCkgLyBlbGVtZW50Lm9mZnNldFdpZHRoIHx8IDE7XG4gIHZhciBzY2FsZVkgPSByb3VuZChyZWN0LmhlaWdodCkgLyBlbGVtZW50Lm9mZnNldEhlaWdodCB8fCAxO1xuICByZXR1cm4gc2NhbGVYICE9PSAxIHx8IHNjYWxlWSAhPT0gMTtcbn0gLy8gUmV0dXJucyB0aGUgY29tcG9zaXRlIHJlY3Qgb2YgYW4gZWxlbWVudCByZWxhdGl2ZSB0byBpdHMgb2Zmc2V0UGFyZW50LlxuLy8gQ29tcG9zaXRlIG1lYW5zIGl0IHRha2VzIGludG8gYWNjb3VudCB0cmFuc2Zvcm1zIGFzIHdlbGwgYXMgbGF5b3V0LlxuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldENvbXBvc2l0ZVJlY3QoZWxlbWVudE9yVmlydHVhbEVsZW1lbnQsIG9mZnNldFBhcmVudCwgaXNGaXhlZCkge1xuICBpZiAoaXNGaXhlZCA9PT0gdm9pZCAwKSB7XG4gICAgaXNGaXhlZCA9IGZhbHNlO1xuICB9XG5cbiAgdmFyIGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50ID0gaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpO1xuICB2YXIgb2Zmc2V0UGFyZW50SXNTY2FsZWQgPSBpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCkgJiYgaXNFbGVtZW50U2NhbGVkKG9mZnNldFBhcmVudCk7XG4gIHZhciBkb2N1bWVudEVsZW1lbnQgPSBnZXREb2N1bWVudEVsZW1lbnQob2Zmc2V0UGFyZW50KTtcbiAgdmFyIHJlY3QgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudE9yVmlydHVhbEVsZW1lbnQsIG9mZnNldFBhcmVudElzU2NhbGVkKTtcbiAgdmFyIHNjcm9sbCA9IHtcbiAgICBzY3JvbGxMZWZ0OiAwLFxuICAgIHNjcm9sbFRvcDogMFxuICB9O1xuICB2YXIgb2Zmc2V0cyA9IHtcbiAgICB4OiAwLFxuICAgIHk6IDBcbiAgfTtcblxuICBpZiAoaXNPZmZzZXRQYXJlbnRBbkVsZW1lbnQgfHwgIWlzT2Zmc2V0UGFyZW50QW5FbGVtZW50ICYmICFpc0ZpeGVkKSB7XG4gICAgaWYgKGdldE5vZGVOYW1lKG9mZnNldFBhcmVudCkgIT09ICdib2R5JyB8fCAvLyBodHRwczovL2dpdGh1Yi5jb20vcG9wcGVyanMvcG9wcGVyLWNvcmUvaXNzdWVzLzEwNzhcbiAgICBpc1Njcm9sbFBhcmVudChkb2N1bWVudEVsZW1lbnQpKSB7XG4gICAgICBzY3JvbGwgPSBnZXROb2RlU2Nyb2xsKG9mZnNldFBhcmVudCk7XG4gICAgfVxuXG4gICAgaWYgKGlzSFRNTEVsZW1lbnQob2Zmc2V0UGFyZW50KSkge1xuICAgICAgb2Zmc2V0cyA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChvZmZzZXRQYXJlbnQsIHRydWUpO1xuICAgICAgb2Zmc2V0cy54ICs9IG9mZnNldFBhcmVudC5jbGllbnRMZWZ0O1xuICAgICAgb2Zmc2V0cy55ICs9IG9mZnNldFBhcmVudC5jbGllbnRUb3A7XG4gICAgfSBlbHNlIGlmIChkb2N1bWVudEVsZW1lbnQpIHtcbiAgICAgIG9mZnNldHMueCA9IGdldFdpbmRvd1Njcm9sbEJhclgoZG9jdW1lbnRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHg6IHJlY3QubGVmdCArIHNjcm9sbC5zY3JvbGxMZWZ0IC0gb2Zmc2V0cy54LFxuICAgIHk6IHJlY3QudG9wICsgc2Nyb2xsLnNjcm9sbFRvcCAtIG9mZnNldHMueSxcbiAgICB3aWR0aDogcmVjdC53aWR0aCxcbiAgICBoZWlnaHQ6IHJlY3QuaGVpZ2h0XG4gIH07XG59IiwgImltcG9ydCB7IG1vZGlmaWVyUGhhc2VzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7IC8vIHNvdXJjZTogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDk4NzUyNTVcblxuZnVuY3Rpb24gb3JkZXIobW9kaWZpZXJzKSB7XG4gIHZhciBtYXAgPSBuZXcgTWFwKCk7XG4gIHZhciB2aXNpdGVkID0gbmV3IFNldCgpO1xuICB2YXIgcmVzdWx0ID0gW107XG4gIG1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChtb2RpZmllcikge1xuICAgIG1hcC5zZXQobW9kaWZpZXIubmFtZSwgbW9kaWZpZXIpO1xuICB9KTsgLy8gT24gdmlzaXRpbmcgb2JqZWN0LCBjaGVjayBmb3IgaXRzIGRlcGVuZGVuY2llcyBhbmQgdmlzaXQgdGhlbSByZWN1cnNpdmVseVxuXG4gIGZ1bmN0aW9uIHNvcnQobW9kaWZpZXIpIHtcbiAgICB2aXNpdGVkLmFkZChtb2RpZmllci5uYW1lKTtcbiAgICB2YXIgcmVxdWlyZXMgPSBbXS5jb25jYXQobW9kaWZpZXIucmVxdWlyZXMgfHwgW10sIG1vZGlmaWVyLnJlcXVpcmVzSWZFeGlzdHMgfHwgW10pO1xuICAgIHJlcXVpcmVzLmZvckVhY2goZnVuY3Rpb24gKGRlcCkge1xuICAgICAgaWYgKCF2aXNpdGVkLmhhcyhkZXApKSB7XG4gICAgICAgIHZhciBkZXBNb2RpZmllciA9IG1hcC5nZXQoZGVwKTtcblxuICAgICAgICBpZiAoZGVwTW9kaWZpZXIpIHtcbiAgICAgICAgICBzb3J0KGRlcE1vZGlmaWVyKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHJlc3VsdC5wdXNoKG1vZGlmaWVyKTtcbiAgfVxuXG4gIG1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChtb2RpZmllcikge1xuICAgIGlmICghdmlzaXRlZC5oYXMobW9kaWZpZXIubmFtZSkpIHtcbiAgICAgIC8vIGNoZWNrIGZvciB2aXNpdGVkIG9iamVjdFxuICAgICAgc29ydChtb2RpZmllcik7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gb3JkZXJNb2RpZmllcnMobW9kaWZpZXJzKSB7XG4gIC8vIG9yZGVyIGJhc2VkIG9uIGRlcGVuZGVuY2llc1xuICB2YXIgb3JkZXJlZE1vZGlmaWVycyA9IG9yZGVyKG1vZGlmaWVycyk7IC8vIG9yZGVyIGJhc2VkIG9uIHBoYXNlXG5cbiAgcmV0dXJuIG1vZGlmaWVyUGhhc2VzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwaGFzZSkge1xuICAgIHJldHVybiBhY2MuY29uY2F0KG9yZGVyZWRNb2RpZmllcnMuZmlsdGVyKGZ1bmN0aW9uIChtb2RpZmllcikge1xuICAgICAgcmV0dXJuIG1vZGlmaWVyLnBoYXNlID09PSBwaGFzZTtcbiAgICB9KSk7XG4gIH0sIFtdKTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZGVib3VuY2UoZm4pIHtcbiAgdmFyIHBlbmRpbmc7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCFwZW5kaW5nKSB7XG4gICAgICBwZW5kaW5nID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcGVuZGluZyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICByZXNvbHZlKGZuKCkpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwZW5kaW5nO1xuICB9O1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBmb3JtYXQoc3RyKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgfVxuXG4gIHJldHVybiBbXS5jb25jYXQoYXJncykucmVkdWNlKGZ1bmN0aW9uIChwLCBjKSB7XG4gICAgcmV0dXJuIHAucmVwbGFjZSgvJXMvLCBjKTtcbiAgfSwgc3RyKTtcbn0iLCAiaW1wb3J0IGZvcm1hdCBmcm9tIFwiLi9mb3JtYXQuanNcIjtcbmltcG9ydCB7IG1vZGlmaWVyUGhhc2VzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG52YXIgSU5WQUxJRF9NT0RJRklFUl9FUlJPUiA9ICdQb3BwZXI6IG1vZGlmaWVyIFwiJXNcIiBwcm92aWRlZCBhbiBpbnZhbGlkICVzIHByb3BlcnR5LCBleHBlY3RlZCAlcyBidXQgZ290ICVzJztcbnZhciBNSVNTSU5HX0RFUEVOREVOQ1lfRVJST1IgPSAnUG9wcGVyOiBtb2RpZmllciBcIiVzXCIgcmVxdWlyZXMgXCIlc1wiLCBidXQgXCIlc1wiIG1vZGlmaWVyIGlzIG5vdCBhdmFpbGFibGUnO1xudmFyIFZBTElEX1BST1BFUlRJRVMgPSBbJ25hbWUnLCAnZW5hYmxlZCcsICdwaGFzZScsICdmbicsICdlZmZlY3QnLCAncmVxdWlyZXMnLCAnb3B0aW9ucyddO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdmFsaWRhdGVNb2RpZmllcnMobW9kaWZpZXJzKSB7XG4gIG1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChtb2RpZmllcikge1xuICAgIFtdLmNvbmNhdChPYmplY3Qua2V5cyhtb2RpZmllciksIFZBTElEX1BST1BFUlRJRVMpIC8vIElFMTEtY29tcGF0aWJsZSByZXBsYWNlbWVudCBmb3IgYG5ldyBTZXQoaXRlcmFibGUpYFxuICAgIC5maWx0ZXIoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCwgc2VsZikge1xuICAgICAgcmV0dXJuIHNlbGYuaW5kZXhPZih2YWx1ZSkgPT09IGluZGV4O1xuICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgY2FzZSAnbmFtZSc6XG4gICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmllci5uYW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgU3RyaW5nKG1vZGlmaWVyLm5hbWUpLCAnXCJuYW1lXCInLCAnXCJzdHJpbmdcIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLm5hbWUpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdlbmFibGVkJzpcbiAgICAgICAgICBpZiAodHlwZW9mIG1vZGlmaWVyLmVuYWJsZWQgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wiZW5hYmxlZFwiJywgJ1wiYm9vbGVhblwiJywgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIuZW5hYmxlZCkgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3BoYXNlJzpcbiAgICAgICAgICBpZiAobW9kaWZpZXJQaGFzZXMuaW5kZXhPZihtb2RpZmllci5waGFzZSkgPCAwKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChJTlZBTElEX01PRElGSUVSX0VSUk9SLCBtb2RpZmllci5uYW1lLCAnXCJwaGFzZVwiJywgXCJlaXRoZXIgXCIgKyBtb2RpZmllclBoYXNlcy5qb2luKCcsICcpLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5waGFzZSkgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2ZuJzpcbiAgICAgICAgICBpZiAodHlwZW9mIG1vZGlmaWVyLmZuICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChJTlZBTElEX01PRElGSUVSX0VSUk9SLCBtb2RpZmllci5uYW1lLCAnXCJmblwiJywgJ1wiZnVuY3Rpb25cIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLmZuKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZWZmZWN0JzpcbiAgICAgICAgICBpZiAobW9kaWZpZXIuZWZmZWN0ICE9IG51bGwgJiYgdHlwZW9mIG1vZGlmaWVyLmVmZmVjdCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wiZWZmZWN0XCInLCAnXCJmdW5jdGlvblwiJywgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIuZm4pICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdyZXF1aXJlcyc6XG4gICAgICAgICAgaWYgKG1vZGlmaWVyLnJlcXVpcmVzICE9IG51bGwgJiYgIUFycmF5LmlzQXJyYXkobW9kaWZpZXIucmVxdWlyZXMpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChJTlZBTElEX01PRElGSUVSX0VSUk9SLCBtb2RpZmllci5uYW1lLCAnXCJyZXF1aXJlc1wiJywgJ1wiYXJyYXlcIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLnJlcXVpcmVzKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAncmVxdWlyZXNJZkV4aXN0cyc6XG4gICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG1vZGlmaWVyLnJlcXVpcmVzSWZFeGlzdHMpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChJTlZBTElEX01PRElGSUVSX0VSUk9SLCBtb2RpZmllci5uYW1lLCAnXCJyZXF1aXJlc0lmRXhpc3RzXCInLCAnXCJhcnJheVwiJywgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIucmVxdWlyZXNJZkV4aXN0cykgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ29wdGlvbnMnOlxuICAgICAgICBjYXNlICdkYXRhJzpcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJQb3BwZXJKUzogYW4gaW52YWxpZCBwcm9wZXJ0eSBoYXMgYmVlbiBwcm92aWRlZCB0byB0aGUgXFxcIlwiICsgbW9kaWZpZXIubmFtZSArIFwiXFxcIiBtb2RpZmllciwgdmFsaWQgcHJvcGVydGllcyBhcmUgXCIgKyBWQUxJRF9QUk9QRVJUSUVTLm1hcChmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgcmV0dXJuIFwiXFxcIlwiICsgcyArIFwiXFxcIlwiO1xuICAgICAgICAgIH0pLmpvaW4oJywgJykgKyBcIjsgYnV0IFxcXCJcIiArIGtleSArIFwiXFxcIiB3YXMgcHJvdmlkZWQuXCIpO1xuICAgICAgfVxuXG4gICAgICBtb2RpZmllci5yZXF1aXJlcyAmJiBtb2RpZmllci5yZXF1aXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChyZXF1aXJlbWVudCkge1xuICAgICAgICBpZiAobW9kaWZpZXJzLmZpbmQoZnVuY3Rpb24gKG1vZCkge1xuICAgICAgICAgIHJldHVybiBtb2QubmFtZSA9PT0gcmVxdWlyZW1lbnQ7XG4gICAgICAgIH0pID09IG51bGwpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGZvcm1hdChNSVNTSU5HX0RFUEVOREVOQ1lfRVJST1IsIFN0cmluZyhtb2RpZmllci5uYW1lKSwgcmVxdWlyZW1lbnQsIHJlcXVpcmVtZW50KSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdW5pcXVlQnkoYXJyLCBmbikge1xuICB2YXIgaWRlbnRpZmllcnMgPSBuZXcgU2V0KCk7XG4gIHJldHVybiBhcnIuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIGlkZW50aWZpZXIgPSBmbihpdGVtKTtcblxuICAgIGlmICghaWRlbnRpZmllcnMuaGFzKGlkZW50aWZpZXIpKSB7XG4gICAgICBpZGVudGlmaWVycy5hZGQoaWRlbnRpZmllcik7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH0pO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtZXJnZUJ5TmFtZShtb2RpZmllcnMpIHtcbiAgdmFyIG1lcmdlZCA9IG1vZGlmaWVycy5yZWR1Y2UoZnVuY3Rpb24gKG1lcmdlZCwgY3VycmVudCkge1xuICAgIHZhciBleGlzdGluZyA9IG1lcmdlZFtjdXJyZW50Lm5hbWVdO1xuICAgIG1lcmdlZFtjdXJyZW50Lm5hbWVdID0gZXhpc3RpbmcgPyBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZywgY3VycmVudCwge1xuICAgICAgb3B0aW9uczogT2JqZWN0LmFzc2lnbih7fSwgZXhpc3Rpbmcub3B0aW9ucywgY3VycmVudC5vcHRpb25zKSxcbiAgICAgIGRhdGE6IE9iamVjdC5hc3NpZ24oe30sIGV4aXN0aW5nLmRhdGEsIGN1cnJlbnQuZGF0YSlcbiAgICB9KSA6IGN1cnJlbnQ7XG4gICAgcmV0dXJuIG1lcmdlZDtcbiAgfSwge30pOyAvLyBJRTExIGRvZXMgbm90IHN1cHBvcnQgT2JqZWN0LnZhbHVlc1xuXG4gIHJldHVybiBPYmplY3Qua2V5cyhtZXJnZWQpLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgcmV0dXJuIG1lcmdlZFtrZXldO1xuICB9KTtcbn0iLCAiaW1wb3J0IGdldENvbXBvc2l0ZVJlY3QgZnJvbSBcIi4vZG9tLXV0aWxzL2dldENvbXBvc2l0ZVJlY3QuanNcIjtcbmltcG9ydCBnZXRMYXlvdXRSZWN0IGZyb20gXCIuL2RvbS11dGlscy9nZXRMYXlvdXRSZWN0LmpzXCI7XG5pbXBvcnQgbGlzdFNjcm9sbFBhcmVudHMgZnJvbSBcIi4vZG9tLXV0aWxzL2xpc3RTY3JvbGxQYXJlbnRzLmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgb3JkZXJNb2RpZmllcnMgZnJvbSBcIi4vdXRpbHMvb3JkZXJNb2RpZmllcnMuanNcIjtcbmltcG9ydCBkZWJvdW5jZSBmcm9tIFwiLi91dGlscy9kZWJvdW5jZS5qc1wiO1xuaW1wb3J0IHZhbGlkYXRlTW9kaWZpZXJzIGZyb20gXCIuL3V0aWxzL3ZhbGlkYXRlTW9kaWZpZXJzLmpzXCI7XG5pbXBvcnQgdW5pcXVlQnkgZnJvbSBcIi4vdXRpbHMvdW5pcXVlQnkuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBtZXJnZUJ5TmFtZSBmcm9tIFwiLi91dGlscy9tZXJnZUJ5TmFtZS5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuL3V0aWxzL2RldGVjdE92ZXJmbG93LmpzXCI7XG5pbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IHsgYXV0byB9IGZyb20gXCIuL2VudW1zLmpzXCI7XG52YXIgSU5WQUxJRF9FTEVNRU5UX0VSUk9SID0gJ1BvcHBlcjogSW52YWxpZCByZWZlcmVuY2Ugb3IgcG9wcGVyIGFyZ3VtZW50IHByb3ZpZGVkLiBUaGV5IG11c3QgYmUgZWl0aGVyIGEgRE9NIGVsZW1lbnQgb3IgdmlydHVhbCBlbGVtZW50Lic7XG52YXIgSU5GSU5JVEVfTE9PUF9FUlJPUiA9ICdQb3BwZXI6IEFuIGluZmluaXRlIGxvb3AgaW4gdGhlIG1vZGlmaWVycyBjeWNsZSBoYXMgYmVlbiBkZXRlY3RlZCEgVGhlIGN5Y2xlIGhhcyBiZWVuIGludGVycnVwdGVkIHRvIHByZXZlbnQgYSBicm93c2VyIGNyYXNoLic7XG52YXIgREVGQVVMVF9PUFRJT05TID0ge1xuICBwbGFjZW1lbnQ6ICdib3R0b20nLFxuICBtb2RpZmllcnM6IFtdLFxuICBzdHJhdGVneTogJ2Fic29sdXRlJ1xufTtcblxuZnVuY3Rpb24gYXJlVmFsaWRFbGVtZW50cygpIHtcbiAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgYXJnc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgfVxuXG4gIHJldHVybiAhYXJncy5zb21lKGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgcmV0dXJuICEoZWxlbWVudCAmJiB0eXBlb2YgZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QgPT09ICdmdW5jdGlvbicpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvcHBlckdlbmVyYXRvcihnZW5lcmF0b3JPcHRpb25zKSB7XG4gIGlmIChnZW5lcmF0b3JPcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBnZW5lcmF0b3JPcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX2dlbmVyYXRvck9wdGlvbnMgPSBnZW5lcmF0b3JPcHRpb25zLFxuICAgICAgX2dlbmVyYXRvck9wdGlvbnMkZGVmID0gX2dlbmVyYXRvck9wdGlvbnMuZGVmYXVsdE1vZGlmaWVycyxcbiAgICAgIGRlZmF1bHRNb2RpZmllcnMgPSBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYgPT09IHZvaWQgMCA/IFtdIDogX2dlbmVyYXRvck9wdGlvbnMkZGVmLFxuICAgICAgX2dlbmVyYXRvck9wdGlvbnMkZGVmMiA9IF9nZW5lcmF0b3JPcHRpb25zLmRlZmF1bHRPcHRpb25zLFxuICAgICAgZGVmYXVsdE9wdGlvbnMgPSBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYyID09PSB2b2lkIDAgPyBERUZBVUxUX09QVElPTlMgOiBfZ2VuZXJhdG9yT3B0aW9ucyRkZWYyO1xuICByZXR1cm4gZnVuY3Rpb24gY3JlYXRlUG9wcGVyKHJlZmVyZW5jZSwgcG9wcGVyLCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkge1xuICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgIH1cblxuICAgIHZhciBzdGF0ZSA9IHtcbiAgICAgIHBsYWNlbWVudDogJ2JvdHRvbScsXG4gICAgICBvcmRlcmVkTW9kaWZpZXJzOiBbXSxcbiAgICAgIG9wdGlvbnM6IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfT1BUSU9OUywgZGVmYXVsdE9wdGlvbnMpLFxuICAgICAgbW9kaWZpZXJzRGF0YToge30sXG4gICAgICBlbGVtZW50czoge1xuICAgICAgICByZWZlcmVuY2U6IHJlZmVyZW5jZSxcbiAgICAgICAgcG9wcGVyOiBwb3BwZXJcbiAgICAgIH0sXG4gICAgICBhdHRyaWJ1dGVzOiB7fSxcbiAgICAgIHN0eWxlczoge31cbiAgICB9O1xuICAgIHZhciBlZmZlY3RDbGVhbnVwRm5zID0gW107XG4gICAgdmFyIGlzRGVzdHJveWVkID0gZmFsc2U7XG4gICAgdmFyIGluc3RhbmNlID0ge1xuICAgICAgc3RhdGU6IHN0YXRlLFxuICAgICAgc2V0T3B0aW9uczogZnVuY3Rpb24gc2V0T3B0aW9ucyhzZXRPcHRpb25zQWN0aW9uKSB7XG4gICAgICAgIHZhciBvcHRpb25zID0gdHlwZW9mIHNldE9wdGlvbnNBY3Rpb24gPT09ICdmdW5jdGlvbicgPyBzZXRPcHRpb25zQWN0aW9uKHN0YXRlLm9wdGlvbnMpIDogc2V0T3B0aW9uc0FjdGlvbjtcbiAgICAgICAgY2xlYW51cE1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICBzdGF0ZS5vcHRpb25zID0gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdE9wdGlvbnMsIHN0YXRlLm9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICBzdGF0ZS5zY3JvbGxQYXJlbnRzID0ge1xuICAgICAgICAgIHJlZmVyZW5jZTogaXNFbGVtZW50KHJlZmVyZW5jZSkgPyBsaXN0U2Nyb2xsUGFyZW50cyhyZWZlcmVuY2UpIDogcmVmZXJlbmNlLmNvbnRleHRFbGVtZW50ID8gbGlzdFNjcm9sbFBhcmVudHMocmVmZXJlbmNlLmNvbnRleHRFbGVtZW50KSA6IFtdLFxuICAgICAgICAgIHBvcHBlcjogbGlzdFNjcm9sbFBhcmVudHMocG9wcGVyKVxuICAgICAgICB9OyAvLyBPcmRlcnMgdGhlIG1vZGlmaWVycyBiYXNlZCBvbiB0aGVpciBkZXBlbmRlbmNpZXMgYW5kIGBwaGFzZWBcbiAgICAgICAgLy8gcHJvcGVydGllc1xuXG4gICAgICAgIHZhciBvcmRlcmVkTW9kaWZpZXJzID0gb3JkZXJNb2RpZmllcnMobWVyZ2VCeU5hbWUoW10uY29uY2F0KGRlZmF1bHRNb2RpZmllcnMsIHN0YXRlLm9wdGlvbnMubW9kaWZpZXJzKSkpOyAvLyBTdHJpcCBvdXQgZGlzYWJsZWQgbW9kaWZpZXJzXG5cbiAgICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycyA9IG9yZGVyZWRNb2RpZmllcnMuZmlsdGVyKGZ1bmN0aW9uIChtKSB7XG4gICAgICAgICAgcmV0dXJuIG0uZW5hYmxlZDtcbiAgICAgICAgfSk7IC8vIFZhbGlkYXRlIHRoZSBwcm92aWRlZCBtb2RpZmllcnMgc28gdGhhdCB0aGUgY29uc3VtZXIgd2lsbCBnZXQgd2FybmVkXG4gICAgICAgIC8vIGlmIG9uZSBvZiB0aGUgbW9kaWZpZXJzIGlzIGludmFsaWQgZm9yIGFueSByZWFzb25cblxuICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICAgICAgdmFyIG1vZGlmaWVycyA9IHVuaXF1ZUJ5KFtdLmNvbmNhdChvcmRlcmVkTW9kaWZpZXJzLCBzdGF0ZS5vcHRpb25zLm1vZGlmaWVycyksIGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IF9yZWYubmFtZTtcbiAgICAgICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHZhbGlkYXRlTW9kaWZpZXJzKG1vZGlmaWVycyk7XG5cbiAgICAgICAgICBpZiAoZ2V0QmFzZVBsYWNlbWVudChzdGF0ZS5vcHRpb25zLnBsYWNlbWVudCkgPT09IGF1dG8pIHtcbiAgICAgICAgICAgIHZhciBmbGlwTW9kaWZpZXIgPSBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzLmZpbmQoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICAgICAgICAgIHZhciBuYW1lID0gX3JlZjIubmFtZTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5hbWUgPT09ICdmbGlwJztcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIWZsaXBNb2RpZmllcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBcImF1dG9cIiBwbGFjZW1lbnRzIHJlcXVpcmUgdGhlIFwiZmxpcFwiIG1vZGlmaWVyIGJlJywgJ3ByZXNlbnQgYW5kIGVuYWJsZWQgdG8gd29yay4nXS5qb2luKCcgJykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBfZ2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUocG9wcGVyKSxcbiAgICAgICAgICAgICAgbWFyZ2luVG9wID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luVG9wLFxuICAgICAgICAgICAgICBtYXJnaW5SaWdodCA9IF9nZXRDb21wdXRlZFN0eWxlLm1hcmdpblJpZ2h0LFxuICAgICAgICAgICAgICBtYXJnaW5Cb3R0b20gPSBfZ2V0Q29tcHV0ZWRTdHlsZS5tYXJnaW5Cb3R0b20sXG4gICAgICAgICAgICAgIG1hcmdpbkxlZnQgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5tYXJnaW5MZWZ0OyAvLyBXZSBubyBsb25nZXIgdGFrZSBpbnRvIGFjY291bnQgYG1hcmdpbnNgIG9uIHRoZSBwb3BwZXIsIGFuZCBpdCBjYW5cbiAgICAgICAgICAvLyBjYXVzZSBidWdzIHdpdGggcG9zaXRpb25pbmcsIHNvIHdlJ2xsIHdhcm4gdGhlIGNvbnN1bWVyXG5cblxuICAgICAgICAgIGlmIChbbWFyZ2luVG9wLCBtYXJnaW5SaWdodCwgbWFyZ2luQm90dG9tLCBtYXJnaW5MZWZ0XS5zb21lKGZ1bmN0aW9uIChtYXJnaW4pIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUZsb2F0KG1hcmdpbik7XG4gICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihbJ1BvcHBlcjogQ1NTIFwibWFyZ2luXCIgc3R5bGVzIGNhbm5vdCBiZSB1c2VkIHRvIGFwcGx5IHBhZGRpbmcnLCAnYmV0d2VlbiB0aGUgcG9wcGVyIGFuZCBpdHMgcmVmZXJlbmNlIGVsZW1lbnQgb3IgYm91bmRhcnkuJywgJ1RvIHJlcGxpY2F0ZSBtYXJnaW4sIHVzZSB0aGUgYG9mZnNldGAgbW9kaWZpZXIsIGFzIHdlbGwgYXMnLCAndGhlIGBwYWRkaW5nYCBvcHRpb24gaW4gdGhlIGBwcmV2ZW50T3ZlcmZsb3dgIGFuZCBgZmxpcGAnLCAnbW9kaWZpZXJzLiddLmpvaW4oJyAnKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcnVuTW9kaWZpZXJFZmZlY3RzKCk7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZS51cGRhdGUoKTtcbiAgICAgIH0sXG4gICAgICAvLyBTeW5jIHVwZGF0ZSBcdTIwMTMgaXQgd2lsbCBhbHdheXMgYmUgZXhlY3V0ZWQsIGV2ZW4gaWYgbm90IG5lY2Vzc2FyeS4gVGhpc1xuICAgICAgLy8gaXMgdXNlZnVsIGZvciBsb3cgZnJlcXVlbmN5IHVwZGF0ZXMgd2hlcmUgc3luYyBiZWhhdmlvciBzaW1wbGlmaWVzIHRoZVxuICAgICAgLy8gbG9naWMuXG4gICAgICAvLyBGb3IgaGlnaCBmcmVxdWVuY3kgdXBkYXRlcyAoZS5nLiBgcmVzaXplYCBhbmQgYHNjcm9sbGAgZXZlbnRzKSwgYWx3YXlzXG4gICAgICAvLyBwcmVmZXIgdGhlIGFzeW5jIFBvcHBlciN1cGRhdGUgbWV0aG9kXG4gICAgICBmb3JjZVVwZGF0ZTogZnVuY3Rpb24gZm9yY2VVcGRhdGUoKSB7XG4gICAgICAgIGlmIChpc0Rlc3Ryb3llZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBfc3RhdGUkZWxlbWVudHMgPSBzdGF0ZS5lbGVtZW50cyxcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IF9zdGF0ZSRlbGVtZW50cy5yZWZlcmVuY2UsXG4gICAgICAgICAgICBwb3BwZXIgPSBfc3RhdGUkZWxlbWVudHMucG9wcGVyOyAvLyBEb24ndCBwcm9jZWVkIGlmIGByZWZlcmVuY2VgIG9yIGBwb3BwZXJgIGFyZSBub3QgdmFsaWQgZWxlbWVudHNcbiAgICAgICAgLy8gYW55bW9yZVxuXG4gICAgICAgIGlmICghYXJlVmFsaWRFbGVtZW50cyhyZWZlcmVuY2UsIHBvcHBlcikpIHtcbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKElOVkFMSURfRUxFTUVOVF9FUlJPUik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIFN0b3JlIHRoZSByZWZlcmVuY2UgYW5kIHBvcHBlciByZWN0cyB0byBiZSByZWFkIGJ5IG1vZGlmaWVyc1xuXG5cbiAgICAgICAgc3RhdGUucmVjdHMgPSB7XG4gICAgICAgICAgcmVmZXJlbmNlOiBnZXRDb21wb3NpdGVSZWN0KHJlZmVyZW5jZSwgZ2V0T2Zmc2V0UGFyZW50KHBvcHBlciksIHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3kgPT09ICdmaXhlZCcpLFxuICAgICAgICAgIHBvcHBlcjogZ2V0TGF5b3V0UmVjdChwb3BwZXIpXG4gICAgICAgIH07IC8vIE1vZGlmaWVycyBoYXZlIHRoZSBhYmlsaXR5IHRvIHJlc2V0IHRoZSBjdXJyZW50IHVwZGF0ZSBjeWNsZS4gVGhlXG4gICAgICAgIC8vIG1vc3QgY29tbW9uIHVzZSBjYXNlIGZvciB0aGlzIGlzIHRoZSBgZmxpcGAgbW9kaWZpZXIgY2hhbmdpbmcgdGhlXG4gICAgICAgIC8vIHBsYWNlbWVudCwgd2hpY2ggdGhlbiBuZWVkcyB0byByZS1ydW4gYWxsIHRoZSBtb2RpZmllcnMsIGJlY2F1c2UgdGhlXG4gICAgICAgIC8vIGxvZ2ljIHdhcyBwcmV2aW91c2x5IHJhbiBmb3IgdGhlIHByZXZpb3VzIHBsYWNlbWVudCBhbmQgaXMgdGhlcmVmb3JlXG4gICAgICAgIC8vIHN0YWxlL2luY29ycmVjdFxuXG4gICAgICAgIHN0YXRlLnJlc2V0ID0gZmFsc2U7XG4gICAgICAgIHN0YXRlLnBsYWNlbWVudCA9IHN0YXRlLm9wdGlvbnMucGxhY2VtZW50OyAvLyBPbiBlYWNoIHVwZGF0ZSBjeWNsZSwgdGhlIGBtb2RpZmllcnNEYXRhYCBwcm9wZXJ0eSBmb3IgZWFjaCBtb2RpZmllclxuICAgICAgICAvLyBpcyBmaWxsZWQgd2l0aCB0aGUgaW5pdGlhbCBkYXRhIHNwZWNpZmllZCBieSB0aGUgbW9kaWZpZXIuIFRoaXMgbWVhbnNcbiAgICAgICAgLy8gaXQgZG9lc24ndCBwZXJzaXN0IGFuZCBpcyBmcmVzaCBvbiBlYWNoIHVwZGF0ZS5cbiAgICAgICAgLy8gVG8gZW5zdXJlIHBlcnNpc3RlbnQgZGF0YSwgdXNlIGAke25hbWV9I3BlcnNpc3RlbnRgXG5cbiAgICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChtb2RpZmllcikge1xuICAgICAgICAgIHJldHVybiBzdGF0ZS5tb2RpZmllcnNEYXRhW21vZGlmaWVyLm5hbWVdID0gT2JqZWN0LmFzc2lnbih7fSwgbW9kaWZpZXIuZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgX19kZWJ1Z19sb29wc19fID0gMDtcblxuICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICAgICAgICBfX2RlYnVnX2xvb3BzX18gKz0gMTtcblxuICAgICAgICAgICAgaWYgKF9fZGVidWdfbG9vcHNfXyA+IDEwMCkge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKElORklOSVRFX0xPT1BfRVJST1IpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoc3RhdGUucmVzZXQgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHN0YXRlLnJlc2V0ID0gZmFsc2U7XG4gICAgICAgICAgICBpbmRleCA9IC0xO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIF9zdGF0ZSRvcmRlcmVkTW9kaWZpZSA9IHN0YXRlLm9yZGVyZWRNb2RpZmllcnNbaW5kZXhdLFxuICAgICAgICAgICAgICBmbiA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZS5mbixcbiAgICAgICAgICAgICAgX3N0YXRlJG9yZGVyZWRNb2RpZmllMiA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZS5vcHRpb25zLFxuICAgICAgICAgICAgICBfb3B0aW9ucyA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIgPT09IHZvaWQgMCA/IHt9IDogX3N0YXRlJG9yZGVyZWRNb2RpZmllMixcbiAgICAgICAgICAgICAgbmFtZSA9IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZS5uYW1lO1xuXG4gICAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgc3RhdGUgPSBmbih7XG4gICAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgICAgb3B0aW9uczogX29wdGlvbnMsXG4gICAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZVxuICAgICAgICAgICAgfSkgfHwgc3RhdGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy8gQXN5bmMgYW5kIG9wdGltaXN0aWNhbGx5IG9wdGltaXplZCB1cGRhdGUgXHUyMDEzIGl0IHdpbGwgbm90IGJlIGV4ZWN1dGVkIGlmXG4gICAgICAvLyBub3QgbmVjZXNzYXJ5IChkZWJvdW5jZWQgdG8gcnVuIGF0IG1vc3Qgb25jZS1wZXItdGljaylcbiAgICAgIHVwZGF0ZTogZGVib3VuY2UoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICBpbnN0YW5jZS5mb3JjZVVwZGF0ZSgpO1xuICAgICAgICAgIHJlc29sdmUoc3RhdGUpO1xuICAgICAgICB9KTtcbiAgICAgIH0pLFxuICAgICAgZGVzdHJveTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgY2xlYW51cE1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICBpc0Rlc3Ryb3llZCA9IHRydWU7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmICghYXJlVmFsaWRFbGVtZW50cyhyZWZlcmVuY2UsIHBvcHBlcikpIHtcbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihJTlZBTElEX0VMRU1FTlRfRVJST1IpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgfVxuXG4gICAgaW5zdGFuY2Uuc2V0T3B0aW9ucyhvcHRpb25zKS50aGVuKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgaWYgKCFpc0Rlc3Ryb3llZCAmJiBvcHRpb25zLm9uRmlyc3RVcGRhdGUpIHtcbiAgICAgICAgb3B0aW9ucy5vbkZpcnN0VXBkYXRlKHN0YXRlKTtcbiAgICAgIH1cbiAgICB9KTsgLy8gTW9kaWZpZXJzIGhhdmUgdGhlIGFiaWxpdHkgdG8gZXhlY3V0ZSBhcmJpdHJhcnkgY29kZSBiZWZvcmUgdGhlIGZpcnN0XG4gICAgLy8gdXBkYXRlIGN5Y2xlIHJ1bnMuIFRoZXkgd2lsbCBiZSBleGVjdXRlZCBpbiB0aGUgc2FtZSBvcmRlciBhcyB0aGUgdXBkYXRlXG4gICAgLy8gY3ljbGUuIFRoaXMgaXMgdXNlZnVsIHdoZW4gYSBtb2RpZmllciBhZGRzIHNvbWUgcGVyc2lzdGVudCBkYXRhIHRoYXRcbiAgICAvLyBvdGhlciBtb2RpZmllcnMgbmVlZCB0byB1c2UsIGJ1dCB0aGUgbW9kaWZpZXIgaXMgcnVuIGFmdGVyIHRoZSBkZXBlbmRlbnRcbiAgICAvLyBvbmUuXG5cbiAgICBmdW5jdGlvbiBydW5Nb2RpZmllckVmZmVjdHMoKSB7XG4gICAgICBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzLmZvckVhY2goZnVuY3Rpb24gKF9yZWYzKSB7XG4gICAgICAgIHZhciBuYW1lID0gX3JlZjMubmFtZSxcbiAgICAgICAgICAgIF9yZWYzJG9wdGlvbnMgPSBfcmVmMy5vcHRpb25zLFxuICAgICAgICAgICAgb3B0aW9ucyA9IF9yZWYzJG9wdGlvbnMgPT09IHZvaWQgMCA/IHt9IDogX3JlZjMkb3B0aW9ucyxcbiAgICAgICAgICAgIGVmZmVjdCA9IF9yZWYzLmVmZmVjdDtcblxuICAgICAgICBpZiAodHlwZW9mIGVmZmVjdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIHZhciBjbGVhbnVwRm4gPSBlZmZlY3Qoe1xuICAgICAgICAgICAgc3RhdGU6IHN0YXRlLFxuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIGluc3RhbmNlOiBpbnN0YW5jZSxcbiAgICAgICAgICAgIG9wdGlvbnM6IG9wdGlvbnNcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIHZhciBub29wRm4gPSBmdW5jdGlvbiBub29wRm4oKSB7fTtcblxuICAgICAgICAgIGVmZmVjdENsZWFudXBGbnMucHVzaChjbGVhbnVwRm4gfHwgbm9vcEZuKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYW51cE1vZGlmaWVyRWZmZWN0cygpIHtcbiAgICAgIGVmZmVjdENsZWFudXBGbnMuZm9yRWFjaChmdW5jdGlvbiAoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZuKCk7XG4gICAgICB9KTtcbiAgICAgIGVmZmVjdENsZWFudXBGbnMgPSBbXTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zdGFuY2U7XG4gIH07XG59XG5leHBvcnQgdmFyIGNyZWF0ZVBvcHBlciA9IC8qI19fUFVSRV9fKi9wb3BwZXJHZW5lcmF0b3IoKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgeyBkZXRlY3RPdmVyZmxvdyB9OyIsICJpbXBvcnQgeyBwb3BwZXJHZW5lcmF0b3IsIGRldGVjdE92ZXJmbG93IH0gZnJvbSBcIi4vY3JlYXRlUG9wcGVyLmpzXCI7XG5pbXBvcnQgZXZlbnRMaXN0ZW5lcnMgZnJvbSBcIi4vbW9kaWZpZXJzL2V2ZW50TGlzdGVuZXJzLmpzXCI7XG5pbXBvcnQgcG9wcGVyT2Zmc2V0cyBmcm9tIFwiLi9tb2RpZmllcnMvcG9wcGVyT2Zmc2V0cy5qc1wiO1xuaW1wb3J0IGNvbXB1dGVTdHlsZXMgZnJvbSBcIi4vbW9kaWZpZXJzL2NvbXB1dGVTdHlsZXMuanNcIjtcbmltcG9ydCBhcHBseVN0eWxlcyBmcm9tIFwiLi9tb2RpZmllcnMvYXBwbHlTdHlsZXMuanNcIjtcbmltcG9ydCBvZmZzZXQgZnJvbSBcIi4vbW9kaWZpZXJzL29mZnNldC5qc1wiO1xuaW1wb3J0IGZsaXAgZnJvbSBcIi4vbW9kaWZpZXJzL2ZsaXAuanNcIjtcbmltcG9ydCBwcmV2ZW50T3ZlcmZsb3cgZnJvbSBcIi4vbW9kaWZpZXJzL3ByZXZlbnRPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGFycm93IGZyb20gXCIuL21vZGlmaWVycy9hcnJvdy5qc1wiO1xuaW1wb3J0IGhpZGUgZnJvbSBcIi4vbW9kaWZpZXJzL2hpZGUuanNcIjtcbnZhciBkZWZhdWx0TW9kaWZpZXJzID0gW2V2ZW50TGlzdGVuZXJzLCBwb3BwZXJPZmZzZXRzLCBjb21wdXRlU3R5bGVzLCBhcHBseVN0eWxlcywgb2Zmc2V0LCBmbGlwLCBwcmV2ZW50T3ZlcmZsb3csIGFycm93LCBoaWRlXTtcbnZhciBjcmVhdGVQb3BwZXIgPSAvKiNfX1BVUkVfXyovcG9wcGVyR2VuZXJhdG9yKHtcbiAgZGVmYXVsdE1vZGlmaWVyczogZGVmYXVsdE1vZGlmaWVyc1xufSk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgY3JlYXRlUG9wcGVyLCBwb3BwZXJHZW5lcmF0b3IsIGRlZmF1bHRNb2RpZmllcnMsIGRldGVjdE92ZXJmbG93IH07IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgY3JlYXRlUG9wcGVyIGFzIGNyZWF0ZVBvcHBlckxpdGUgfSBmcm9tIFwiLi9wb3BwZXItbGl0ZS5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCAqIGZyb20gXCIuL21vZGlmaWVycy9pbmRleC5qc1wiOyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQge1xuICAgIG5vcm1hbGl6ZVBhdGgsXG4gICAgVEFic3RyYWN0RmlsZSxcbiAgICBURmlsZSxcbiAgICBURm9sZGVyLFxuICAgIFZhdWx0LFxufSBmcm9tIFwib2JzaWRpYW5cIjtcblxuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZV90Zm9sZGVyKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmb2xkZXJfc3RyOiBzdHJpbmcpOiBURm9sZGVyIHtcbiAgICBmb2xkZXJfc3RyID0gbm9ybWFsaXplUGF0aChmb2xkZXJfc3RyKTtcblxuICAgIGNvbnN0IGZvbGRlciA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlcl9zdHIpO1xuICAgIGlmICghZm9sZGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRm9sZGVyIFwiJHtmb2xkZXJfc3RyfVwiIGRvZXNuJ3QgZXhpc3RgKTtcbiAgICB9XG4gICAgaWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke2ZvbGRlcl9zdHJ9IGlzIGEgZmlsZSwgbm90IGEgZm9sZGVyYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvbGRlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF90ZmlsZXNfZnJvbV9mb2xkZXIoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZm9sZGVyX3N0cjogc3RyaW5nXG4pOiBBcnJheTxURmlsZT4ge1xuICAgIGNvbnN0IGZvbGRlciA9IHJlc29sdmVfdGZvbGRlcihwbHVnaW4sIGZvbGRlcl9zdHIpO1xuXG4gICAgY29uc3QgZmlsZXM6IEFycmF5PFRGaWxlPiA9IFtdO1xuICAgIFZhdWx0LnJlY3Vyc2VDaGlsZHJlbihmb2xkZXIsIChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVzLnB1c2goZmlsZSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGZpbGVzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgcmV0dXJuIGEuYmFzZW5hbWUubG9jYWxlQ29tcGFyZShiLmJhc2VuYW1lKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBmaWxlcztcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgc2V0SWNvbiwgVGV4dENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IFNlbGVjdE1vZGFsIGZyb20gXCJzcmMvbW9kYWxzL2ZpZWxkcy9TZWxlY3RNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCIuL0Fic3RyYWN0TGlzdEJhc2VkRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkT3B0aW9ucyB9IGZyb20gXCJzcmMvY29tcG9uZW50cy9Ob3RlRmllbGRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEN5Y2xlRmllbGQgZXh0ZW5kcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIHtcblxuICAgIHZhbHVlc1Byb21wdENvbXBvbmVudHM6IEFycmF5PFRleHRDb21wb25lbnQ+ID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5DeWNsZSlcbiAgICAgICAgdGhpcy5zaG93TW9kYWxPcHRpb24gPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgbmV4dE9wdGlvbih2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IG5leHRPcHRpb246IHN0cmluZztcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5nZXRPcHRpb25zTGlzdCgpO1xuICAgICAgICBpZiAodmFsdWVzLmluZGV4T2YodmFsdWUpID09PSAtMSkge1xuICAgICAgICAgICAgbmV4dE9wdGlvbiA9IHZhbHVlc1swXSB8fCBcIlwiXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXh0T3B0aW9uID0gdmFsdWVzWyh2YWx1ZXMuaW5kZXhPZih2YWx1ZSkgKyAxKSAlIHZhbHVlcy5sZW5ndGhdXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5leHRPcHRpb25cbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFJhd09wdGlvbkZyb21EdXJhdGlvbihkdXJhdGlvbjogYW55KTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IG1hdGNoZWRWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZHZBcGkgJiYgZHZBcGkudmFsdWUuaXNEdXJhdGlvbihkdXJhdGlvbikpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0T3B0aW9uc0xpc3QoKS5mb3JFYWNoKG9wdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZHZPcHRpb24gPSBkdkFwaS5kdXJhdGlvbihvcHRpb24pO1xuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhkdXJhdGlvbi52YWx1ZXMpLmV2ZXJ5KGogPT5cbiAgICAgICAgICAgICAgICAgICAgKCFkdXJhdGlvbi52YWx1ZXNbal0gJiYgIWR2T3B0aW9uLnZhbHVlc1tqXSkgfHwgKGR1cmF0aW9uLnZhbHVlc1tqXSA9PT0gZHZPcHRpb24udmFsdWVzW2pdKVxuICAgICAgICAgICAgICAgICkpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZFZhbHVlID0gb3B0aW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWF0Y2hlZFZhbHVlXG4gICAgfVxuXG4gICAgcHVibGljIGRpc3BsYXlWYWx1ZShjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcsIG9uQ2xpY2tlZD86ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IHZhbHVlVGV4dDogc3RyaW5nO1xuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoZHZBcGkucGFnZShmaWxlLnBhdGgpW2ZpZWxkTmFtZV0pIHtcbiAgICAgICAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogdmFsdWVUZXh0ID0gXCJcIjsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBudWxsOiB2YWx1ZVRleHQgPSBcIlwiOyBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGZhbHNlOiB2YWx1ZVRleHQgPSBcImZhbHNlXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMDogdmFsdWVUZXh0ID0gXCIwXCI7IGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHZhbHVlVGV4dCA9IGR2QXBpLnBhZ2UoZmlsZS5wYXRoKVtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFsdWVUZXh0ID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdGhpcy5nZXRSYXdPcHRpb25Gcm9tRHVyYXRpb24odmFsdWVUZXh0KSB8fCB2YWx1ZVRleHQgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRmllbGRPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlOiBURmlsZSwgbG9jYXRpb246IE1lbnUgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBGaWVsZE9wdGlvbnMpOiB2b2lkIHtcbiAgICAgICAgLy8gZGF0YXZpZXcgaXMgY29udmVydGluZyBzdHJpbmdzIHRvIGR1cmF0aW9uLCBsZXQncyBmaW5kIGJhY2sgdGhlIHJhdyBzdHJpbmcgb3B0aW9uIGZyb20gZHVyYXRpb24gaWYgbmVlZGVkXG4gICAgICAgIGxldCBtYXRjaGVkVmFsdWUgPSB0aGlzLmdldFJhd09wdGlvbkZyb21EdXJhdGlvbih2YWx1ZSkgfHwgdmFsdWU7XG4gICAgICAgIGNvbnN0IGljb25OYW1lID0gRmllbGRJY29uW0ZpZWxkVHlwZS5DeWNsZV07XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9IGFzeW5jICgpID0+IGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZSwgbmFtZSwgdGhpcy5uZXh0T3B0aW9uKG1hdGNoZWRWYWx1ZSkudG9TdHJpbmcoKSkgfSk7XG4gICAgICAgIGlmIChDeWNsZUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGAke25hbWV9IDogJHttYXRjaGVkVmFsdWV9IFx1MjVCNyAke3RoaXMubmV4dE9wdGlvbihtYXRjaGVkVmFsdWUpfWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihpY29uTmFtZSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChDeWNsZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGAke25hbWV9XyR7bWF0Y2hlZFZhbHVlfV8ke3RoaXMubmV4dE9wdGlvbihtYXRjaGVkVmFsdWUpfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj48Yj4ke25hbWV9PC9iPiA6ICR7bWF0Y2hlZFZhbHVlfSBcdTI1QjcgJHt0aGlzLm5leHRPcHRpb24obWF0Y2hlZFZhbHVlKX08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBpY29uTmFtZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmIChDeWNsZUZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKGljb25OYW1lLCBhY3Rpb24sIGAke21hdGNoZWRWYWx1ZX0gXHUyNUI3ICR7dGhpcy5uZXh0T3B0aW9uKG1hdGNoZWRWYWx1ZSl9YCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdmFsdWUgfHwgXCJcIiwgdGhpcy5maWVsZCwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgYWZ0ZXIsIGFzTGlzdCwgYXNDb21tZW50KTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNlbGVjdCBvcHRpb24gZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM6IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT4gfSA9IHt9XG4gICAgKTogdm9pZCB7XG4gICAgICAgIGF0dHJzLmNscyA9IFwidmFsdWUtY29udGFpbmVyXCJcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKSlcbiAgICAgICAgY29uc3QgbmV4dE9wdGlvbiA9IHRoaXMubmV4dE9wdGlvbihwW3RoaXMuZmllbGQubmFtZV0pXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGN5Y2xlQnRuID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihjeWNsZUJ0biwgRmllbGRJY29uW0ZpZWxkVHlwZS5DeWNsZV0pXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBjeWNsZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY3ljbGVCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGN5Y2xlQnRuLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBzcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogYnV0dG9uIG9uIGNsaWNrIDogZ28gdG8gbmV4dCB2ZXJzaW9uKi9cbiAgICAgICAgY3ljbGVCdG4ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBDeWNsZUZpZWxkLnJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHAuZmlsZS5wYXRoLCB0aGlzLmZpZWxkLm5hbWUsIG5leHRPcHRpb24pO1xuICAgICAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgICAgICBjeWNsZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgc2V0SWNvbiwgVGV4dENvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IE11bHRpU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL011bHRpU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCBmcm9tIFwiLi9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUZpZWxkIGV4dGVuZHMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCB7XG5cbiAgICB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuTXVsdGkpXG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE11bHRpU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlc1wiKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChNdWx0aUZpZWxkLmlzTWVudShsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE11bHRpRmllbGQuaXNTdWdnZXN0KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChNdWx0aUZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkT3B0aW9uKEZpZWxkSWNvbltGaWVsZFR5cGUuTXVsdGldLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBNdWx0aVNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSB8fCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IG9wdGlvbnMgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM6IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSA9IHt9XG4gICAgKTogdm9pZCB7XG5cbiAgICAgICAgbGV0IHZhbHVlSG92ZXJlZCA9IGZhbHNlO1xuICAgICAgICBsZXQgY3VycmVudFZhbHVlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgaWYgKHBbdGhpcy5maWVsZC5uYW1lXSkge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHBbdGhpcy5maWVsZC5uYW1lXSkuaW5jbHVkZXMoXCJwYXRoXCIpKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlcyA9IFtgW1ske3BbdGhpcy5maWVsZC5uYW1lXS5wYXRoLnJlcGxhY2UoXCIubWRcIiwgXCJcIil9XV1gXVxuICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWVzLnB1c2goLi4ucFt0aGlzLmZpZWxkLm5hbWVdLm1hcCgodjogc3RyaW5nKSA9PiB2LnRyaW0oKSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWVzID0gcFt0aGlzLmZpZWxkLm5hbWVdLnNwbGl0KFwiLFwiKS5tYXAoKHY6IHN0cmluZykgPT4gdi50cmltKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogTXVsdGlTZWxlY3RNb2RhbDtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgTXVsdGlTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogY3VycmVudCB2YWx1ZXMgY29udGFpbmVyICovXG4gICAgICAgIGNvbnN0IHZhbHVlc0NvbnRhaW5lciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2YWx1ZXMtY29udGFpbmVyXCIgfSlcblxuICAgICAgICAvKiBjdXJyZW50IHZhbHVlcyAqL1xuICAgICAgICBjdXJyZW50VmFsdWVzLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZUNvbnRhaW5lciA9IHZhbHVlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbS1jb250YWluZXJcIiB9KTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlUmVtb3ZlQnRuID0gdmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIik7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZUxhYmVsID0gdmFsdWVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImxhYmVsXCIsIHRleHQ6IHYgfSlcbiAgICAgICAgICAgIHNldEljb24odmFsdWVSZW1vdmVCdG4sIFwiY3Jvc3NcIilcbiAgICAgICAgICAgIHZhbHVlUmVtb3ZlQnRuLmhpZGUoKTtcbiAgICAgICAgICAgIHZhbHVlUmVtb3ZlQnRuLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVtYWluaW5nVmFsdWVzID0gY3VycmVudFZhbHVlcy5maWx0ZXIoY1YgPT4gY1YgIT09IHYpLmpvaW4oXCIsIFwiKVxuICAgICAgICAgICAgICAgIE11bHRpRmllbGQucmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgcC5maWxlLnBhdGgsIHRoaXMuZmllbGQubmFtZSwgcmVtYWluaW5nVmFsdWVzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFsdWVIb3ZlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwuYWRkQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2YWx1ZUhvdmVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2luZ2xlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwucmVtb3ZlQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pXG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgYWRkQnRuID0gdmFsdWVzQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpO1xuICAgICAgICBzZXRJY29uKGFkZEJ0biwgXCJsaXN0LXBsdXNcIik7XG5cbiAgICAgICAgYWRkQnRuLm9uY2xpY2sgPSAoKSA9PiBmaWVsZE1vZGFsLm9wZW4oKTtcblxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNpbmdsZVNwYWNlciA9IHZhbHVlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyLTFcIiB9KTtcbiAgICAgICAgY29uc3QgZG91YmxlU3BhY2VyID0gdmFsdWVzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXItMlwiIH0pO1xuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYWRkQnRuLnNob3coKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGlmICghdmFsdWVIb3ZlcmVkKSBzaW5nbGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgZG91YmxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWwgc3RhdGUgKi9cbiAgICAgICAgaWYgKCFhdHRycz8ub3B0aW9ucz8uYWx3YXlzT24pIHtcbiAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICBkb3VibGVTcGFjZXIuc2hvdygpO1xuICAgICAgICAgICAgYWRkQnRuLmhpZGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNpbmdsZVNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgYWRkQnRuLnNob3coKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBURmlsZSwgQnV0dG9uQ29tcG9uZW50LCBTdWdnZXN0TW9kYWwsIHNldEljb24gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgKiBhcyBzZWxlY3RWYWx1ZXNTb3VyY2UgZnJvbSBcInNyYy90eXBlcy9zZWxlY3RWYWx1ZXNTb3VyY2VUeXBlc1wiXG5pbXBvcnQgRmlsZUZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRmlsZUZpZWxkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE11bHRpU3VnZ2VzdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZE9wdGlvbnM6IEFycmF5PHN0cmluZz47XG4gICAgcHJpdmF0ZSBhZGRCdXR0b246IEJ1dHRvbkNvbXBvbmVudDtcbiAgICBwcml2YXRlIHJlbG9hZEJ1dHRvbjogQnV0dG9uQ29tcG9uZW50O1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGUsXG4gICAgICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkLFxuICAgICAgICBpbml0aWFsT3B0aW9uczogc3RyaW5nLFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICBpZiAoaW5pdGlhbE9wdGlvbnMpIHtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGluaXRpYWxPcHRpb25zKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgICAgICAgICAgaWYgKGR2QXBpICYmIGluaXRpYWxPcHRpb25zLnNvbWUobyA9PiBkdkFwaS52YWx1ZS5pc0xpbmsobykpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayhpdGVtKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgaXRlbS5wYXRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS50b1N0cmluZygpXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMubWFwKGl0ZW0gPT4gaXRlbS50b1N0cmluZygpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoaW5pdGlhbE9wdGlvbnMudG9TdHJpbmcoKS5zdGFydHNXaXRoKFwiW1tcIikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IGluaXRpYWxPcHRpb25zLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zID0gaW5pdGlhbE9wdGlvbnMudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbKC4qKVxcXSQvLCBcIiQxXCIpLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpO1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwub25rZXlkb3duID0gYXN5bmMgKGUpID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleSA9PSBcIkVudGVyXCIgJiYgZS5hbHRLZXkpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlcGxhY2VWYWx1ZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgY29uc3QgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwidmFsdWUtYWRkLW5vdGljZVwiIH0pXG4gICAgICAgIGNvbnN0IG5vdGljZSA9IHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5maW5kKFwiLnByb21wdFwiKS5wcmVwZW5kKHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lcik7XG5cbiAgICAgICAgY29uc3QgaW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJzdWdnZXN0ZXItaW5wdXRcIiB9KVxuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmlucHV0RWwpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZmluZChcIi5wcm9tcHRcIikucHJlcGVuZChpbnB1dENvbnRhaW5lcilcblxuXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcImZvb3Rlci1hY3Rpb25zXCIgfSlcbiAgICAgICAgYnV0dG9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBpbmZvQ29udGFpbmVyID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJpbmZvXCIgfSlcbiAgICAgICAgaW5mb0NvbnRhaW5lci5zZXRUZXh0KFwiQWx0K0VudGVyIHRvIHNhdmVcIilcbiAgICAgICAgLy8gYWRkQnV0dG9uXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0SWNvbihcInBsdXNcIilcbiAgICAgICAgdGhpcy5hZGRCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFkZE5ld1ZhbHVlVG9TZXR0aW5ncygpO1xuICAgICAgICAgICAgbm90aWNlLnNldFRleHQoYCR7dGhpcy5pbnB1dEVsLnZhbHVlfSBhZGRlZCB0byB0aGUgZmllbGQgc2V0dGluZ3NcXG5jbGljayBvbiByZWxvYWRgKVxuICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuaGlkZSgpO1xuICAgICAgICAgICAgdXBkYXRlU2V0dGluZ3NJbmZvQ29udGFpbmVyLnNob3coKTtcbiAgICAgICAgfSlcbiAgICAgICAgdGhpcy5hZGRCdXR0b24uc2V0Q3RhKCk7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLnNldFRvb2x0aXAoXCJBZGQgdGhpcyB2YWx1ZSB0byB0aGlzIGZpZWxkIHNldHRpbmdzXCIpXG4gICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKTtcbiAgICAgICAgLy9yZWxvYWQgYnV0dG9uXG4gICAgICAgIHRoaXMucmVsb2FkQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh1cGRhdGVTZXR0aW5nc0luZm9Db250YWluZXIpXG4gICAgICAgIHRoaXMucmVsb2FkQnV0dG9uLnNldEljb24oXCJyZWZyZXNoLWN3XCIpXG4gICAgICAgIHRoaXMucmVsb2FkQnV0dG9uLnNldEN0YSgpXG4gICAgICAgIHRoaXMucmVsb2FkQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3VnZ2VzdGlvbnMoKTtcbiAgICAgICAgICAgIHVwZGF0ZVNldHRpbmdzSW5mb0NvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgICAgICB0aGlzLmFkZEJ1dHRvbi5idXR0b25FbC5oaWRlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC8vY29uZmlybSBidXR0b25cbiAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoYnV0dG9uQ29udGFpbmVyKVxuICAgICAgICBjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIilcbiAgICAgICAgY29uZmlybUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVwbGFjZVZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgIH0pXG4gICAgICAgIC8vY2FuY2VsIGJ1dHRvblxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKVxuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB7IHRoaXMuY2xvc2UoKTsgfSlcbiAgICAgICAgLy9jbGVhciB2YWx1ZSBidXR0b25cbiAgICAgICAgY29uc3QgY2xlYXJCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY2xlYXJCdXR0b24uc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgIGNsZWFyQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5jbGVhclZhbHVlcygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICBjbGVhckJ1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcImRhbmdlclwiKVxuICAgICAgICB0aGlzLm1vZGFsRWwuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKVxuICAgIH1cblxuICAgIGFzeW5jIGFkZE5ld1ZhbHVlVG9TZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSB0aGlzLmlucHV0RWwudmFsdWU7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldCh0aGlzLmZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKT8uZmlsZUNsYXNzTmFtZVxuICAgICAgICBpZiAoZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBmaWxlQ2xhc3M/LmF0dHJpYnV0ZXMuZmluZChhdHRyID0+IGF0dHIubmFtZSA9PT0gdGhpcy5maWVsZC5uYW1lKVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcyAmJiBmaWxlQ2xhc3NBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgbmV3T3B0aW9uczogc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zID0gWy4uLmZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zLCBuZXdWYWx1ZV1cbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnMgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy52YWx1ZXNMaXN0IGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gICAgICAgICAgICAgICAgICAgIG5ld09wdGlvbnNbYCR7T2JqZWN0LmtleXMoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdCkubGVuZ3RofWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUNsYXNzLnVwZGF0ZUF0dHJpYnV0ZShmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSwgZmlsZUNsYXNzQXR0cmlidXRlLm5hbWUsIG5ld09wdGlvbnMsIGZpbGVDbGFzc0F0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZUNsYXNzQXR0cmlidXRlLm9wdGlvbnMudmFsdWVzTGlzdE5vdGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlc0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB2YWx1ZXNGaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KHZhbHVlc0ZpbGUsIGAke3Jlc3VsdH1cXG4ke25ld1ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3T3B0aW9ucyA9IGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zO1xuICAgICAgICAgICAgICAgICAgICBuZXdPcHRpb25zW2Ake09iamVjdC5rZXlzKGZpbGVDbGFzc0F0dHJpYnV0ZS5vcHRpb25zKS5sZW5ndGh9YF0gPSBuZXdWYWx1ZVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlLCBmaWxlQ2xhc3NBdHRyaWJ1dGUubmFtZSwgbmV3T3B0aW9ucywgZmlsZUNsYXNzQXR0cmlidXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBwcmVzZXRGaWVsZCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IHRoaXMuZmllbGQubmFtZSlcbiAgICAgICAgICAgIGlmIChwcmVzZXRGaWVsZD8ub3B0aW9ucy5zb3VyY2VUeXBlID09PSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXNGaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwcmVzZXRGaWVsZC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aClcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHZhbHVlc0ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZCh2YWx1ZXNGaWxlKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KHZhbHVlc0ZpbGUsIGAke3Jlc3VsdH1cXG4ke25ld1ZhbHVlfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJlc2V0RmllbGQ/Lm9wdGlvbnMuc291cmNlVHlwZSA9PT0gc2VsZWN0VmFsdWVzU291cmNlLlR5cGUuVmFsdWVzTGlzdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpZWxkID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmluZChwID0+IHAuaWQgPT0gdGhpcy5maWVsZC5pZCk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBjdXJyZW50RXhpc3RpbmdGaWVsZC5vcHRpb25zLnZhbHVlc0xpc3RcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzTGlzdFtgJHtPYmplY3Qua2V5cyh2YWx1ZXNMaXN0KS5sZW5ndGggKyAxfWBdID0gbmV3VmFsdWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmllbGRJbmRleC5mdWxsSW5kZXgoXCJ2YWx1ZUFkZFwiKTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE9wdGlvbnMucHVzaChuZXdWYWx1ZSlcbiAgICB9XG5cbiAgICBhc3luYyByZXBsYWNlVmFsdWVzKCkge1xuICAgICAgICBjb25zdCBvcHRpb25zID0gdGhpcy5zZWxlY3RlZE9wdGlvbnM7XG4gICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBvcHRpb25zLmpvaW4oXCIsIFwiKSkgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByZW5kZXJlZFZhbHVlcyA9ICF0aGlzLmluRnJvbnRtYXR0ZXIgPyBvcHRpb25zLmpvaW4oXCIsIFwiKSA6IG9wdGlvbnMubGVuZ3RoID4gMSA/IGBbJHtvcHRpb25zLmpvaW4oXCIsIFwiKX1dYCA6IGAke29wdGlvbnNbMF19YFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgcmVuZGVyZWRWYWx1ZXMsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyLCB0aGlzLmFzTGlzdCwgdGhpcy5hc0NvbW1lbnQpIH0pO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2xlYXJWYWx1ZXMoKSB7XG4gICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBcIlwiKSB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IGluc2VydFZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyLCB0aGlzLmFzTGlzdCwgdGhpcy5hc0NvbW1lbnQpIH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJlbmRlclNlbGVjdGVkKCkge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgY2hvb3NlciA9IHRoaXMuY2hvb3NlclxuICAgICAgICBjb25zdCBzdWdnZXN0aW9uczogSFRNTERpdkVsZW1lbnRbXSA9IGNob29zZXIuc3VnZ2VzdGlvbnNcbiAgICAgICAgY29uc3QgdmFsdWVzOiBzdHJpbmdbXSA9IGNob29zZXIudmFsdWVzXG4gICAgICAgIHN1Z2dlc3Rpb25zLmZvckVhY2goKHMsIGkpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkT3B0aW9ucy5pbmNsdWRlcyh2YWx1ZXNbaV0udG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgICAgICBzLmFkZENsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgICAgIGlmIChzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaWNvbi1jb250YWluZXJcIikubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IHMuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihpY29uQ29udGFpbmVyLCBcImNoZWNrLWNpcmNsZVwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcy5yZW1vdmVDbGFzcyhcInZhbHVlLWNoZWNrZWRcIilcbiAgICAgICAgICAgICAgICBzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaWNvbi1jb250YWluZXJcIikuZm9yRWFjaChpY29uID0+IGljb24ucmVtb3ZlKCkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IGR2RmlsZTogYW55O1xuICAgICAgICBpZiAoZHZBcGkpIGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCkgYXMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZFxuICAgICAgICBjb25zdCB2YWx1ZXMgPSBmaWVsZE1hbmFnZXIuZ2V0T3B0aW9uc0xpc3QoZHZGaWxlKS5maWx0ZXIobyA9PiBvLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgIGlmICh0aGlzLmFkZEJ1dHRvbikge1xuICAgICAgICAgICAgKHZhbHVlcy5zb21lKHAgPT4gcCA9PT0gcXVlcnkpIHx8IHRoaXMuZmllbGQub3B0aW9ucy5zb3VyY2VUeXBlID09IHNlbGVjdFZhbHVlc1NvdXJjZS5UeXBlLlZhbHVlc0Zyb21EVlF1ZXJ5IHx8ICFxdWVyeSkgP1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQnV0dG9uLmJ1dHRvbkVsLmhpZGUoKSA6XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRCdXR0b24uYnV0dG9uRWwuc2hvdygpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdmFsdWVzXG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZSlcbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJ2YWx1ZS1jb250YWluZXJcIilcbiAgICAgICAgY29uc3Qgc3BhY2VyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE9wdGlvbnMuaW5jbHVkZXModmFsdWUudG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJpY29uLWNvbnRhaW5lclwiIH0pXG4gICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKClcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHZhbHVlOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRPcHRpb25zLmluY2x1ZGVzKHZhbHVlLnRvU3RyaW5nKCkpKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkT3B0aW9ucy5yZW1vdmUodmFsdWUudG9TdHJpbmcoKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRPcHRpb25zLnB1c2godmFsdWUudG9TdHJpbmcoKSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlbmRlclNlbGVjdGVkKClcbiAgICB9XG5cbiAgICBvbkNob29zZVN1Z2dlc3Rpb24oaXRlbTogc3RyaW5nLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG5cbiAgICB9XG5cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgTm90aWNlLCBzZXRJY29uLCBUZXh0QXJlYUNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IFNpbmdsZUZpbGVNb2RhbCBmcm9tIFwic3JjL21vZGFscy9maWVsZHMvU2luZ2xlRmlsZU1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgcHJpdmF0ZSBkdlF1ZXJ5U3RyaW5nOiBUZXh0QXJlYUNvbXBvbmVudFxuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuRmlsZSlcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0RmlsZXMgPSAoY3VycmVudEZpbGU/OiBURmlsZSk6IFRGaWxlW10gPT4ge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgZ2V0UmVzdWx0cyA9IChhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgXCJjdXJyZW50XCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZ31gKSkoYXBpLCBhcGkucGFnZShjdXJyZW50RmlsZT8ucGF0aCkpXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFdyb25nIHF1ZXJ5IGZvciBmaWVsZCA8JHt0aGlzLmZpZWxkLm5hbWV9PlxcbmNoZWNrIHlvdXIgc2V0dGluZ3NgLCAzMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYXRhdmlldyA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVEYXRhdmlld0pzICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVJbmxpbmVEYXRhdmlld0pzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzUGF0aCA9IGdldFJlc3VsdHMoZGF0YXZpZXcuYXBpKS52YWx1ZXMubWFwKCh2OiBhbnkpID0+IHYuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZpbHRlcihmID0+IGZpbGVzUGF0aC5pbmNsdWRlcyhmLnBhdGgpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFNpbmdsZUZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUpXG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlNlbGVjdCB2YWx1ZVwiKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChGaWxlRmllbGQuaXNNZW51KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSAke25hbWV9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbltGaWVsZFR5cGUuRmlsZV0pO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoRmlsZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChGaWxlRmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSwgYWN0aW9uLCBgVXBkYXRlICR7bmFtZX0ncyB2YWx1ZWApO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBTaW5nbGVGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWUoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgZmlsZTogVEZpbGUsIGZpZWxkTmFtZTogc3RyaW5nLCBvbkNsaWNrZWQ6ICgpID0+IHt9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClbZmllbGROYW1lXVxuICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLmNyZWF0ZUVsKCdhJywgeyB0ZXh0OiB2YWx1ZS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIikgfSk7XG4gICAgICAgICAgICAgICAgbGluay5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh2YWx1ZS5wYXRoLCBmaWxlLnBhdGgsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2tlZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHZhbHVlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzOiB7IGNscz86IHN0cmluZywgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0gPSB7fVxuICAgICk6IHZvaWQge1xuICAgICAgICBhdHRycy5jbHMgPSBcInZhbHVlLWNvbnRhaW5lclwiXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycykpXG5cbiAgICAgICAgY29uc3Qgc2VhcmNoQnRuID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgc2V0SWNvbihzZWFyY2hCdG4sIEZpZWxkSWNvbltGaWVsZFR5cGUuRmlsZV0pXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInNwYWNlclwiIH0pXG5cbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogU2luZ2xlRmlsZU1vZGFsO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBTaW5nbGVGaWxlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWF0dHJzPy5vcHRpb25zPy5hbHdheXNPbiB8fCB0cnVlKSB7XG4gICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uc2hvdygpXG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWxlQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IFF1ZXJ5IChvcHRpb25hbClcIiB9KTtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IGR2UXVlcnlTdHJpbmdUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5kdlF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgfSlcblxuXG4gICAgICAgIGNvbnN0IGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSlcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkFsaWFzXCIgfSk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJQZXJzb25hbGlzZSB0aGUgcmVuZGVyaW5nIG9mIHlvdXIgbGlua3MnIGFsaWFzZXMgd2l0aCBhIGZ1bmN0aW9uIHJldHVybmluZyBhIHN0cmluZyAoPHBhZ2U+IG9iamVjdCBpcyBhdmFpbGFibGUpXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcImNvZGVcIiwge1xuICAgICAgICAgICAgdGV4dDogYGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIDxmdW5jdGlvbiB1c2luZyBcInBhZ2VcIj47IH1gXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIgPSBjdXN0b21lUmVuZGVyaW5nVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgY29uc3QgY3VzdG9tUmVuZGVyaW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuc2V0UGxhY2Vob2xkZXIoXCJKYXZhc2NyaXB0IHN0cmluZywgXCIgK1xuICAgICAgICAgICAgXCJ0aGUgXFxcInBhZ2VcXFwiIChkYXRhdmlldyBwYWdlIHR5cGUpIHZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIilcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tUmVuZGVyaW5nKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2c3RhY2tlZFwiIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiU29ydGluZyBvcmRlclwiIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiUGVyc29uYWxpc2UgdGhlIHNvcnRpbmcgb3JkZXIgb2YgeW91ciBsaW5rcyB3aXRoIGEgaW5zdHJ1Y3Rpb24gdGFraW5nIDIgZmlsZXMgKGEsIGIpIGFuZCByZXR1cm5pbmcgLTEsIDAgb3IgMVwiLCBjbHM6ICdzdWItdGV4dCcgfSk7XG4gICAgICAgIGN1c3RvbVNvcnRpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IGAoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyYFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nQ29udGFpbmVyID0gY3VzdG9tU29ydGluZ1RvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgY3VzdG9tU29ydGluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChjdXN0b21Tb3J0aW5nQ29udGFpbmVyKTtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21Tb3J0aW5nLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21Tb3J0aW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFBsYWNlaG9sZGVyKFwiSmF2YXNjcmlwdCBpbnN0cnVjdGlvbiwgXCIgK1xuICAgICAgICAgICAgXCIoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyXFxuXCIgK1xuICAgICAgICAgICAgXCJleGFtcGxlIDEgKGFscGhhYmV0aWNhbCBvcmRlcik6IGEuYmFzZW5hbWUgPCBiLmJhc2VuYW1lID8gMSA6IC0xIFxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAyIChjcmVhdGlvbiB0aW1lIG5ld2VyIHRvIG9sZGVyKTogYi5zdGF0LmN0aW1lIC0gYi5zdGF0LmN0aW1lXCIpXG4gICAgICAgIGN1c3RvbVNvcnRpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tU29ydGluZyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlRmlsZUNvbnRhaW5lcihwYXJlbnRDb250YWluZXIpXG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nIHx8IFwiXCI7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICAgICAgICAvL3RvZG8gOiBtYW5hZ2UgYm90aCByYXcgbGlua3MgYW5kIGR2IExpbmsgb2JqZWN0c1xuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgVEZpbGUsIEZ1enp5U3VnZ2VzdE1vZGFsLCBGdXp6eU1hdGNoLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWxlRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9GaWxlRmllbGRcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZUZ1enp5U3VnZ2VzdGVyIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8VEZpbGU+IHtcblxuICAgIHByaXZhdGUgc2VsZWN0ZWRGaWxlPzogVEZpbGVcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIGZpbGU6IFRGaWxlLFxuICAgICAgICBwcml2YXRlIGZpZWxkOiBGaWVsZCxcbiAgICAgICAgaW5pdGlhbFZhbHVlT2JqZWN0OiBhbnksXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBpZiAoZHZBcGkudmFsdWUuaXNMaW5rKGluaXRpYWxWYWx1ZU9iamVjdCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChpbml0aWFsVmFsdWVPYmplY3QucGF0aClcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB0aGlzLnNlbGVjdGVkRmlsZSA9IGZpbGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKTtcbiAgICB9XG5cbiAgICBnZXRJdGVtcygpOiBURmlsZVtdIHtcbiAgICAgICAgY29uc3Qgc29ydGluZ01ldGhvZCA9IG5ldyBGdW5jdGlvbihcImFcIiwgXCJiXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU29ydGluZ31gKSB8fCBmdW5jdGlvbiAoYTogVEZpbGUsIGI6IFRGaWxlKSB7IHJldHVybiBhLmJhc2VuYW1lIDwgYi5iYXNlbmFtZSA/IC0xIDogMSB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICByZXR1cm4gZmlsZU1hbmFnZXIuZ2V0RmlsZXModGhpcy5maWxlKS5zb3J0KHNvcnRpbmdNZXRob2QpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEl0ZW1UZXh0KGl0ZW06IFRGaWxlKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uYmFzZW5hbWU7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogRnV6enlNYXRjaDxURmlsZT4sIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZykge1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJpdGVtLXdpdGgtYWRkLW9uXCIgfSk7XG4gICAgICAgICAgICBzdWdnZXN0aW9uQ29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICAgICAgICAgICAgdGV4dDogbmV3IEZ1bmN0aW9uKFwicGFnZVwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZ31gKShkdkFwaS5wYWdlKHZhbHVlLml0ZW0ucGF0aCkpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBzdWdnZXN0aW9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJhZGQtb25cIiB9KVxuICAgICAgICAgICAgZmlsZVBhdGguc2V0VGV4dCh2YWx1ZS5pdGVtLnBhdGgpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbC5zZXRUZXh0KHZhbHVlLml0ZW0uYmFzZW5hbWUpXG4gICAgICAgIH1cbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJ2YWx1ZS1jb250YWluZXJcIilcbiAgICAgICAgY29uc3Qgc3BhY2VyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGU/LnBhdGggPT09IHZhbHVlLml0ZW0ucGF0aCkge1xuICAgICAgICAgICAgZWwuYWRkQ2xhc3MoXCJ2YWx1ZS1jaGVja2VkXCIpXG4gICAgICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcImljb24tY29udGFpbmVyXCIgfSlcbiAgICAgICAgICAgIHNldEljb24oaWNvbkNvbnRhaW5lciwgXCJjaGVjay1jaXJjbGVcIilcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlucHV0RWwuZm9jdXMoKVxuICAgIH1cblxuXG4gICAgYXN5bmMgb25DaG9vc2VJdGVtKGl0ZW06IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGxldCBhbGlhczogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZykge1xuICAgICAgICAgICAgYWxpYXMgPSBuZXcgRnVuY3Rpb24oXCJwYWdlXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nfWApKGR2QXBpLnBhZ2UoaXRlbS5wYXRoKSlcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXBsYWNlVmFsdWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgaXRlbS5iYXNlbmFtZSwgYWxpYXMpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydFZhbHVlcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgRmlsZUZpZWxkLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGl0ZW0uYmFzZW5hbWUsIGFsaWFzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzTGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgbW9tZW50LCBzZXRJY29uLCBUZXh0Q29tcG9uZW50LCBURmlsZSwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBEYXRlTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL0RhdGVNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IEN5Y2xlRmllbGQgZnJvbSBcIi4vQ3ljbGVGaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEZNIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBjb21wYXJlRHVyYXRpb24gfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCB7IEZpZWxkT3B0aW9ucyB9IGZyb20gXCJzcmMvY29tcG9uZW50cy9Ob3RlRmllbGRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERhdGVGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIGRhdGVWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnRcbiAgICBwdWJsaWMgZGVmYXVsdERhdGVGb3JtYXQ6IHN0cmluZyA9IFwiWVlZWS1NTS1ERFwiXG4gICAgcHJpdmF0ZSBzaGlmdEJ0bjogSFRNTEJ1dHRvbkVsZW1lbnRcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLCBmaWVsZCwgRmllbGRUeXBlLkRhdGUpO1xuICAgICAgICB0aGlzLnNob3dNb2RhbE9wdGlvbiA9IGZhbHNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBEYXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KGBDaGFuZ2UgZGF0ZSBmb3IgPCR7bmFtZX0+YCk7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpO1xuICAgICAgICBjb25zdCBkYXRlSWNvbk5hbWUgPSBGaWVsZEljb25bRmllbGRUeXBlLkRhdGVdO1xuICAgICAgICBjb25zdCBkYXRlTW9kYWxBY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG4gICAgICAgIGNvbnN0IHAgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClcbiAgICAgICAgY29uc3Qgc2hpZnREYXRlQWN0aW9uID0gKCkgPT4gdGhpcy5zaGlmdERhdGUoZHZBcGksIHAsIGZpbGUpO1xuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXI6IERhdGVGaWVsZCA9IG5ldyBGTVt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgY29uc3QgW2N1cnJlbnRTaGlmdF06IFtzdHJpbmcgfCB1bmRlZmluZWQsIEZpZWxkIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdID0gZmllbGRNYW5hZ2VyLnNoaWZ0RHVyYXRpb24oZmlsZSk7XG4gICAgICAgIGlmIChEYXRlRmllbGQuaXNNZW51KGxvY2F0aW9uKSkge1xuICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSA8JHtuYW1lfT5gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oZGF0ZUljb25OYW1lKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soZGF0ZU1vZGFsQWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsIHx8IHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkICYmIGR2QXBpKSB7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBTaGlmdCA8JHtuYW1lfT4gJHtjdXJyZW50U2hpZnR9IGFoZWFkYCk7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcInNraXAtZm9yd2FyZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKHNoaWZ0RGF0ZUFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUuZmllbGRzXCIpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoRGF0ZUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICBhY3Rpb246IGRhdGVNb2RhbEFjdGlvbixcbiAgICAgICAgICAgICAgICBpY29uOiBkYXRlSWNvbk5hbWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsIHx8IHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkICYmIGR2QXBpKSB7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHtuYW1lfWAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+U2hpZnQgPGI+JHtuYW1lfTwvYj4gJHtjdXJyZW50U2hpZnR9IGFoZWFkPC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogc2hpZnREYXRlQWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBcInNraXAtZm9yd2FyZFwiXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChEYXRlRmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oXCJza2lwLWZvcndhcmRcIiwgc2hpZnREYXRlQWN0aW9uLCBgU2hpZnQgJHtuYW1lfSBhaGVhZCBieSAke2N1cnJlbnRTaGlmdH1gKTtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihkYXRlSWNvbk5hbWUsIGRhdGVNb2RhbEFjdGlvbiwgYFNldCAke25hbWV9J3MgZGF0ZWApO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBEYXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGUsIHRoaXMuZmllbGQsIHZhbHVlIHx8IFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciBkYXRlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZURhdGVDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0KSB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdCA9IHRoaXMuZGVmYXVsdERhdGVGb3JtYXRcbiAgICAgICAgaWYgKCF0aGlzLmZpZWxkLm9wdGlvbnMuZGVmYXVsdEluc2VydEFzTGluaykgdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmsgPSBcImZhbHNlXCJcbiAgICAgICAgY29uc3QgZGF0ZUZvcm1hdENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGRhdGVGb3JtYXRDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJEYXRlIGZvcm1hdFwiLCBjbHM6ICdsYWJlbCcgfSlcbiAgICAgICAgY29uc3QgZGF0ZUV4YW1wbGUgPSBkYXRlRm9ybWF0Q29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IGNsczogJ21vcmUtaW5mbycgfSlcbiAgICAgICAgZGF0ZUZvcm1hdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdzcGFjZXInIH0pXG4gICAgICAgIGNvbnN0IGRhdGVGb3JtYXRJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KGRhdGVGb3JtYXRDb250YWluZXIpXG4gICAgICAgIGRhdGVGb3JtYXRJbnB1dC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdClcbiAgICAgICAgZGF0ZUV4YW1wbGUuc2V0VGV4dChgJHttb21lbnQoKS5mb3JtYXQoZGF0ZUZvcm1hdElucHV0LmdldFZhbHVlKCkpfWApXG4gICAgICAgIGRhdGVGb3JtYXRJbnB1dC5vbkNoYW5nZSgodmFsdWU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQgPSB2YWx1ZVxuICAgICAgICAgICAgZGF0ZUV4YW1wbGUuc2V0VGV4dChgJHttb21lbnQoKS5mb3JtYXQodmFsdWUpfWApO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBpbnNlcnQgYXMgbGluayB0b2dnbGVyXG4gICAgICAgIGNvbnN0IGRlZmF1bHRJbnNlcnRBc0xpbmtDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBkZWZhdWx0SW5zZXJ0QXNMaW5rQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiSW5zZXJ0IGFzIGxpbmsgYnkgZGVmYXVsdFwiLCBjbHM6ICdsYWJlbCcgfSk7XG4gICAgICAgIGRlZmF1bHRJbnNlcnRBc0xpbmtDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGRlZmF1bHRJbnNlcnRBc0xpbmsgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGRlZmF1bHRJbnNlcnRBc0xpbmtDb250YWluZXIpO1xuICAgICAgICBkZWZhdWx0SW5zZXJ0QXNMaW5rLnNldFZhbHVlKERhdGVGaWVsZC5zdHJpbmdUb0Jvb2xlYW4odGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmspKVxuICAgICAgICBkZWZhdWx0SW5zZXJ0QXNMaW5rLm9uQ2hhbmdlKCh2YWx1ZTogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmRlZmF1bHRJbnNlcnRBc0xpbmsgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2ZvbGRlciBwYXRoIGZvciBsaW5rXG4gICAgICAgIGNvbnN0IGRhdGVMaW5rUGF0aENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGRhdGVMaW5rUGF0aENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkxpbmsgcGF0aCAob3B0aW9uYWwpXCIsIGNsczogJ2xhYmVsJyB9KVxuICAgICAgICBkYXRlTGlua1BhdGhDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGRhdGVMaW5rUGF0aElucHV0ID0gbmV3IFRleHRDb21wb25lbnQoZGF0ZUxpbmtQYXRoQ29udGFpbmVyKVxuICAgICAgICBkYXRlTGlua1BhdGhJbnB1dC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMubGlua1BhdGgpXG4gICAgICAgIGRhdGVMaW5rUGF0aElucHV0Lm9uQ2hhbmdlKCh2YWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMubGlua1BhdGggPSB2YWx1ZSArICgoIXZhbHVlLmVuZHNXaXRoKFwiL1wiKSAmJiAhIXZhbHVlLmxlbmd0aCkgPyBcIi9cIiA6IFwiXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBzaGlmdCBpbnRlcnZhbCAoc2hvdWxkIGJlIGEgbnVtYmVyIG9yIGEgbHV4b24gaHVtYW5pemVkIGR1cmF0aW9uIChyZXF1aXJlcyBkYXRhdmlldykgLT4gdG8gaW5jbHVkZSBpbiB2YWxpZGF0aW9uKVxuICAgICAgICBjb25zdCBkYXRlU2hpZnRJbnRlcnZhbENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIGRhdGVTaGlmdEludGVydmFsQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiRGVmaW5lIGEgc2hpZnQgaW50ZXJ2YWxcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBkYXRlU2hpZnRJbnRlcnZhbENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3QgZGF0ZVNoaWZ0SW50ZXJ2YWwgPSBuZXcgVGV4dENvbXBvbmVudChkYXRlU2hpZnRJbnRlcnZhbENvbnRhaW5lcik7XG4gICAgICAgIGRhdGVTaGlmdEludGVydmFsLnNldFBsYWNlaG9sZGVyKFwiZXg6IDEgbW9udGggMiBkYXlzXCIpXG4gICAgICAgIGRhdGVTaGlmdEludGVydmFsLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbClcbiAgICAgICAgZGF0ZVNoaWZ0SW50ZXJ2YWwub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZVNoaWZ0SW50ZXJ2YWwgPSB2YWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBpbnRlcnZhbHMgY3ljbGUgZmllbGQgbmFtZVxuICAgICAgICBjb25zdCBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgbmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwge1xuICAgICAgICAgICAgdGV4dDogXCJGaWVsZCBjb250YWluaW5nIHNoaWZ0IGludGVydmFsc1wiLFxuICAgICAgICAgICAgY2xzOiAnbGFiZWwnXG4gICAgICAgIH0pO1xuICAgICAgICBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBuZXh0U2hpZnRJbnRlcnZhbEZpZWxkID0gbmV3IFRleHRDb21wb25lbnQobmV4dFNoaWZ0SW50ZXJ2YWxGaWVsZENvbnRhaW5lcik7XG4gICAgICAgIG5leHRTaGlmdEludGVydmFsRmllbGQuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQpXG4gICAgICAgIG5leHRTaGlmdEludGVydmFsRmllbGQub25DaGFuZ2UoKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkID0gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlU2V0dGluZ0NvbnRhaW5lcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50LCBwbHVnaW46IE1ldGFkYXRhTWVudSwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jcmVhdGVEYXRlQ29udGFpbmVyKGNvbnRhaW5lcik7XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHNoaWZ0RGF0ZShkdjogYW55LCBwOiBhbnksIGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHsgZGF0ZUZvcm1hdCwgZGVmYXVsdEluc2VydEFzTGluaywgbGlua1BhdGggfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXI6IERhdGVGaWVsZCA9IG5ldyBGTVt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgY29uc3QgW2N1cnJlbnRTaGlmdCwgbmV4dEludGVydmFsRmllbGQsIG5leHRTaGlmdF06IFtzdHJpbmcgfCB1bmRlZmluZWQsIEZpZWxkIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdID0gZmllbGRNYW5hZ2VyLnNoaWZ0RHVyYXRpb24oZmlsZSk7XG4gICAgICAgIGNvbnN0IGR2RGF0ZSA9IHBbdGhpcy5maWVsZC5uYW1lXVxuICAgICAgICAvL2RhdGF2aWV3IGlzIGNvbnZlcnRpbmcgZGF0ZXMgdG8gbGlua3Mgb3IgZGF0ZXRpbWVzLCBsZXQncyBub3JtYWxpemVcbiAgICAgICAgY29uc3QgY3VycmVudERhdGVWYWx1ZSA9IGR2LnZhbHVlLmlzTGluayhkdkRhdGUpID9cbiAgICAgICAgICAgIGR2RGF0ZS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkgOlxuICAgICAgICAgICAgZHYudmFsdWUuaXNEYXRlKGR2RGF0ZSkgP1xuICAgICAgICAgICAgICAgIG1vbWVudChkdkRhdGUudG9KU0RhdGUoKSkuZm9ybWF0KGRhdGVGb3JtYXQpIDpcbiAgICAgICAgICAgICAgICBkdkRhdGVcbiAgICAgICAgY29uc3QgY3VycmVudER2RGF0ZSA9IGR2LmRhdGUobW9tZW50KGN1cnJlbnREYXRlVmFsdWUsIGRhdGVGb3JtYXQpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICBjb25zdCBuZXdEYXRlID0gY3VycmVudER2RGF0ZS5wbHVzKGR2LmR1cmF0aW9uKGN1cnJlbnRTaGlmdCB8fCBcIjEgZGF5XCIpKTtcbiAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBtb21lbnQobmV3RGF0ZS50b1N0cmluZygpKS5mb3JtYXQoZGF0ZUZvcm1hdClcbiAgICAgICAgaWYgKG5leHRJbnRlcnZhbEZpZWxkICYmIG5leHRTaGlmdCkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZS5wYXRoLCBuZXh0SW50ZXJ2YWxGaWVsZC5uYW1lLCBuZXh0U2hpZnQpIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxpbmtGaWxlID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGlua1BhdGggfHwgXCJcIiArIG5ld1ZhbHVlLmZvcm1hdChkYXRlRm9ybWF0KSwgZmlsZS5wYXRoKVxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRWYWx1ZSA9IERhdGVGaWVsZC5zdHJpbmdUb0Jvb2xlYW4oZGVmYXVsdEluc2VydEFzTGluaykgP1xuICAgICAgICAgICAgYFtbJHtsaW5rUGF0aCB8fCBcIlwifSR7bmV3VmFsdWV9JHtsaW5rRmlsZSA/IFwifFwiICsgbGlua0ZpbGUuYmFzZW5hbWUgOiBcIlwifV1dYCA6XG4gICAgICAgICAgICBuZXdWYWx1ZVxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGUucGF0aCwgdGhpcy5maWVsZC5uYW1lLCBmb3JtYXR0ZWRWYWx1ZSkgfSk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcgfCB1bmRlZmluZWQ7IGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHVuZGVmaW5lZDsgfVxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCBwW3RoaXMuZmllbGQubmFtZV0sIGF0dHJzKTtcbiAgICAgICAgY29uc3QgZGF0ZUJ0biA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpXG4gICAgICAgIHNldEljb24oZGF0ZUJ0biwgRmllbGRJY29uW0ZpZWxkVHlwZS5EYXRlXSlcbiAgICAgICAgLyogZW5kIHNwYWNlciAqL1xuICAgICAgICBjb25zdCBzcGFjZXIgPSBmaWVsZENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyLTFcIiB9KVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmRhdGVTaGlmdEludGVydmFsIHx8IHRoaXMuZmllbGQub3B0aW9ucy5uZXh0U2hpZnRJbnRlcnZhbEZpZWxkKSB7XG4gICAgICAgICAgICB0aGlzLnNoaWZ0QnRuID0gZmllbGRDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIilcbiAgICAgICAgICAgIHNldEljb24odGhpcy5zaGlmdEJ0biwgXCJza2lwLWZvcndhcmRcIilcbiAgICAgICAgICAgIHNwYWNlci5zZXRBdHRyKFwiY2xhc3NcIiwgXCJzcGFjZXItMlwiKVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwic3BhY2VyLTFcIilcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogRGF0ZU1vZGFsO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgaWYgKHBbdGhpcy5maWVsZC5uYW1lXSAmJiBwW3RoaXMuZmllbGQubmFtZV0uaGFzT3duUHJvcGVydHkoXCJwYXRoXCIpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZUZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBbdGhpcy5maWVsZC5uYW1lXSlcbiAgICAgICAgICAgICAgICBpZiAoZGF0ZUZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBkYXRlRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBkYXRlRmlsZS5uYW1lKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwgPSBuZXcgRGF0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCBwW3RoaXMuZmllbGQubmFtZV0ucGF0aC5zcGxpdChcIi9cIikubGFzdCgpLnJlcGxhY2UoXCIubWRcIiwgXCJcIikpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChwW3RoaXMuZmllbGQubmFtZV0pIHtcbiAgICAgICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IERhdGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmaWVsZE1vZGFsID0gbmV3IERhdGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgXCJcIilcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnNoaWZ0QnRuKSB0aGlzLnNoaWZ0QnRuLm9uY2xpY2sgPSAoKSA9PiB7IHRoaXMuc2hpZnREYXRlKGR2LCBwLCBmaWxlKSB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZmllbGRNb2RhbC5vbkNsb3NlID0gKCkgPT4geyBmaWVsZE1vZGFsLmNvbnRlbnRFbC5pbm5lckhUTUwgPSBcIlwiOyB9XG4gICAgICAgIGRhdGVCdG4ub25jbGljayA9ICgpID0+IHsgZmllbGRNb2RhbC5vcGVuKCkgfVxuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBkYXRlQnRuLmhpZGUoKVxuICAgICAgICAgICAgaWYgKHRoaXMuc2hpZnRCdG4pIHRoaXMuc2hpZnRCdG4uaGlkZSgpXG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBkYXRlQnRuLnNob3coKVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNoaWZ0QnRuKSB0aGlzLnNoaWZ0QnRuLnNob3coKVxuICAgICAgICAgICAgICAgIHNwYWNlci5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGF0ZUJ0bi5oaWRlKClcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaGlmdEJ0bikgdGhpcy5zaGlmdEJ0bi5oaWRlKClcbiAgICAgICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkYXRlQnRuKTtcbiAgICAgICAgaWYgKHRoaXMuc2hpZnRCdG4pIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc2hpZnRCdG4pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFjZXIpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdDtcbiAgICB9XG5cbiAgICBwdWJsaWMgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZGlzcGxheVZhbHVlKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZywgb25DbGlja2VkOiAoKSA9PiB7fSk6IHZvaWQge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpW2ZpZWxkTmFtZV1cbiAgICAgICAgICAgIGlmIChkdkFwaS52YWx1ZS5pc0RhdGUodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHZhbHVlLmRpc3BsYXkgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGR2QXBpLnZhbHVlLmlzTGluayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLmNyZWF0ZUVsKCdhJywgeyB0ZXh0OiB2YWx1ZS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIikgfSlcbiAgICAgICAgICAgICAgICBsaW5rLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHZhbHVlLnBhdGgsIGZpbGUucGF0aCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2tlZCgpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdmFsdWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7fSk7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAodmFsdWUpID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpLnNwbGl0KFwifFwiKS5maXJzdCgpPy5zcGxpdChcIi9cIikubGFzdCgpLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdFxuICAgICAgICAgICAgICAgICkuaXNWYWxpZCgpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb21lbnQoXG4gICAgICAgICAgICAgICAgICAgICh2YWx1ZSBhcyB7IHBhdGg6IHN0cmluZyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBhdGgucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpLnNwbGl0KFwifFwiKS5maXJzdCgpPy5zcGxpdChcIi9cIikubGFzdCgpLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuZGF0ZUZvcm1hdFxuICAgICAgICAgICAgICAgICkuaXNWYWxpZCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgc2hpZnREdXJhdGlvbihmaWxlOiBURmlsZSk6IFtzdHJpbmcgfCB1bmRlZmluZWQsIEZpZWxkIHwgdW5kZWZpbmVkLCBzdHJpbmcgfCB1bmRlZmluZWRdIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBjb25zdCBpbnRlcnZhbCA9IHRoaXMuZmllbGQub3B0aW9ucy5kYXRlU2hpZnRJbnRlcnZhbFxuICAgICAgICAgICAgY29uc3QgY3ljbGVJbnRlcnZhbEZpZWxkID0gdGhpcy5maWVsZC5vcHRpb25zLm5leHRTaGlmdEludGVydmFsRmllbGRcbiAgICAgICAgICAgIGNvbnN0IGN5Y2xlID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQoZmlsZS5wYXRoKT8uZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSBjeWNsZUludGVydmFsRmllbGQpXG4gICAgICAgICAgICBpZiAoY3ljbGUpIHtcbiAgICAgICAgICAgICAgICAvL2N5Y2xlIGZpZWxkIGV4aXN0c1xuICAgICAgICAgICAgICAgIGNvbnN0IGN5Y2xlTWFuYWdlcjogQ3ljbGVGaWVsZCA9IG5ldyBGTVtjeWNsZS50eXBlXSh0aGlzLnBsdWdpbiwgY3ljbGUpXG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IGN5Y2xlTWFuYWdlci5nZXRPcHRpb25zTGlzdChmaWxlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClbY3ljbGUubmFtZV1cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY3VycmVudCB2YWx1ZSBpcyBub3QgbnVsbFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VmFsdWVTdHJpbmcgPSBvcHRpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG8gPT4gZHZBcGkuZHVyYXRpb24obykgIT09IG51bGwpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZChvID0+IGNvbXBhcmVEdXJhdGlvbihkdkFwaS5kdXJhdGlvbihvKSwgY3VycmVudFZhbHVlKSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZVN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9jdXJyZW50IHZhbHVlIGhhcyBhIG1hdGNoIGluIGN5Y2xlIG9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRWYWx1ZSA9IGN5Y2xlTWFuYWdlci5uZXh0T3B0aW9uKGN1cnJlbnRWYWx1ZVN0cmluZylcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbY3VycmVudFZhbHVlU3RyaW5nLCBjeWNsZSwgbmV4dFZhbHVlXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY3VycmVudCB2YWx1ZSBpcyBub3QgZm91bmQgb3IgOiBmYWxsIGJhY2sgb24gZmlyc3QgdmFsdWVcbiAgICAgICAgICAgICAgICByZXR1cm4gW29wdGlvbnNbMF0sIGN5Y2xlLCBvcHRpb25zWzFdIHx8IG9wdGlvbnNbMF1dXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGludGVydmFsICYmIGR2QXBpLmR1cmF0aW9uKGludGVydmFsKSkge1xuICAgICAgICAgICAgICAgIC8vbm8gY3ljbGUgZmllbGQ6IGZhbGwgYmFjayBvbiBpbnRlcnZhbCBpZiBleGlzdHNcbiAgICAgICAgICAgICAgICByZXR1cm4gW2ludGVydmFsLCB1bmRlZmluZWQsIHVuZGVmaW5lZF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBkdiBub3QgYXZhaWxhYmxlID0+IHJldHVybiB1bmRlZmluZWQgY3ljbGUgdmFsdWVzXG4gICAgICAgIHJldHVybiBbdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZF1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgTW9kYWwsIFRleHRDb21wb25lbnQsIFRGaWxlLCBUb2dnbGVDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEZNIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBtb21lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBmbGF0cGlja3IgZnJvbSBcImZsYXRwaWNrclwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmllbGRJY29uLCBGaWVsZFR5cGUsIEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IERhdGVGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0RhdGVGaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEYXRlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIHZhbHVlOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBpbnNlcnRBc0xpbms6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBpbnB1dEVsOiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgZXJyb3JGaWVsZDogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBmb3JtYXQ6IHN0cmluZztcbiAgICBwcml2YXRlIG5leHRJbnRlcnZhbEZpZWxkPzogRmllbGQ7XG4gICAgcHJpdmF0ZSBwdXNoTmV4dEludGVydmFsOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjdXJyZW50U2hpZnQ/OiBzdHJpbmdcbiAgICBwcml2YXRlIG5leHRTaGlmdD86IHN0cmluZ1xuICAgIHByaXZhdGUgZGF0ZU1hbmFnZXI/OiBEYXRlRmllbGRcbiAgICBwcml2YXRlIGR2QXBpPzogYW55XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIHByaXZhdGUgaW5pdGlhbFZhbHVlOiBzdHJpbmcsXG4gICAgICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyID0gLTEsXG4gICAgICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIHByaXZhdGUgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2VcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbFZhbHVlID0gaW5pdGlhbFZhbHVlID8gaW5pdGlhbFZhbHVlLnRvU3RyaW5nKCkucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpLnNwbGl0KFwifFwiKS5maXJzdCgpPy5zcGxpdChcIi9cIikubGFzdCgpIHx8IFwiXCIgOiBcIlwiO1xuICAgICAgICB0aGlzLmluc2VydEFzTGluayA9IEZNLnN0cmluZ1RvQm9vbGVhbih0aGlzLmZpZWxkLm9wdGlvbnMuZGVmYXVsdEluc2VydEFzTGluayB8fCBcImZhbHNlXCIpIHx8IGZhbHNlO1xuICAgICAgICB0aGlzLmZvcm1hdCA9IHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0IHx8IHRoaXMuZmllbGQub3B0aW9ucy5kZWZhdWx0RGF0ZUZvcm1hdDtcbiAgICAgICAgdGhpcy5kdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXT8uYXBpXG4gICAgICAgIGlmICh0aGlzLmR2QXBpKSB0aGlzLmRhdGVNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuaW5pdGlhbFZhbHVlO1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuXG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgZmllbGRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHRoaXMuYnVpbGRGaWVsZHMoZmllbGRDb250YWluZXIpO1xuICAgICAgICB0aGlzLmVycm9yRmllbGQgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJmaWVsZC1lcnJvclwiIH0pO1xuICAgICAgICB0aGlzLmVycm9yRmllbGQuaGlkZSgpO1xuXG4gICAgfTtcblxuICAgIHByaXZhdGUgYnVpbGRGaWVsZHMoZGF0ZUZpZWxkc0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcblxuICAgICAgICB0aGlzLmJ1aWxkSW5wdXRFbChkYXRlRmllbGRzQ29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5idWlsZEluc2VydEFzTGlua0J1dHRvbihkYXRlRmllbGRzQ29udGFpbmVyKTtcbiAgICAgICAgZGF0ZUZpZWxkc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSlcbiAgICAgICAgY29uc3Qgc2F2ZUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZGF0ZUZpZWxkc0NvbnRhaW5lcilcbiAgICAgICAgc2F2ZUJ0bi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpXG5cbiAgICAgICAgc2F2ZUJ0bi5vbkNsaWNrKGFzeW5jIChlOiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgbGV0IG5ld1ZhbHVlOiBtb21lbnQuTW9tZW50O1xuICAgICAgICAgICAgLy90cnkgbmF0dXJhbCBsYW5ndWFnZSBkYXRlXG4gICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMuZW5hYmxlZFBsdWdpbnMuaGFzKCdubGRhdGVzLW9ic2lkaWFuJykpIHtcbiAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBubGRhdGVzID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1snbmxkYXRlcy1vYnNpZGlhbiddO1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IG5sZGF0ZXMucGFyc2VEYXRlKHRoaXMudmFsdWUpLm1vbWVudDtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IG1vbWVudCh0aGlzLnZhbHVlLCB0aGlzLmZvcm1hdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IG1vbWVudCh0aGlzLnZhbHVlLCB0aGlzLmZvcm1hdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobmV3VmFsdWUuaXNWYWxpZCgpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGlua1BhdGggPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdCh0aGlzLmZpZWxkLm9wdGlvbnMubGlua1BhdGggfHwgXCJcIiArIG5ld1ZhbHVlLmZvcm1hdCh0aGlzLmZvcm1hdCksIHRoaXMuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gdGhpcy5pbnNlcnRBc0xpbmsgPyBgW1ske3RoaXMuZmllbGQub3B0aW9ucy5saW5rUGF0aCB8fCBcIlwifSR7bmV3VmFsdWUuZm9ybWF0KHRoaXMuZm9ybWF0KX0ke2xpbmtQYXRoID8gXCJ8XCIgKyBsaW5rUGF0aC5iYXNlbmFtZSA6IFwiXCJ9XV1gIDogbmV3VmFsdWUuZm9ybWF0KHRoaXMuZm9ybWF0KVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgZm9ybWF0dGVkVmFsdWUpIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgZm9ybWF0dGVkVmFsdWUsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLmFmdGVyLCB0aGlzLmFzTGlzdCwgdGhpcy5hc0NvbW1lbnQpIH0pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubmV4dEludGVydmFsRmllbGQgJiYgdGhpcy5wdXNoTmV4dEludGVydmFsICYmIHRoaXMubmV4dFNoaWZ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLnBhdGgsIHRoaXMubmV4dEludGVydmFsRmllbGQhLm5hbWUsIHRoaXMubmV4dFNoaWZ0ISkgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgXCJcIiwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMuYWZ0ZXIsIHRoaXMuYXNMaXN0LCB0aGlzLmFzQ29tbWVudCkgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLnNob3coKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yRmllbGQuc2V0VGV4dChgdmFsdWUgbXVzdCBiZSBhIHZhbGlkIGRhdGVgKVxuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbC5pbnB1dEVsLmFkZENsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGJ1aWxkSW5zZXJ0QXNMaW5rQnV0dG9uKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgaW5zZXJ0QXNMaW5rQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBjb25zdCBzZXRMaW5rQnRuSWNvbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGluc2VydEFzTGlua0J0bi5zZXRJY29uKHRoaXMuaW5zZXJ0QXNMaW5rID8gXCJsaW5rXCIgOiBcInVubGlua1wiKTtcbiAgICAgICAgICAgIGluc2VydEFzTGlua0J0bi5zZXRUb29sdGlwKHRoaXMuaW5zZXJ0QXNMaW5rID9cbiAgICAgICAgICAgICAgICBcIkNsaWNrIHRvIGluc2VydCBkYXRlIGFzIHRleHRcIiA6XG4gICAgICAgICAgICAgICAgXCJDbGljayB0byBpbnNlcnQgZGF0ZSBhcyBsaW5rXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICBzZXRMaW5rQnRuSWNvbigpO1xuICAgICAgICBpbnNlcnRBc0xpbmtCdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluc2VydEFzTGluayA9ICF0aGlzLmluc2VydEFzTGluaztcbiAgICAgICAgICAgIHNldExpbmtCdG5JY29uKCk7XG4gICAgICAgIH0pXG5cbiAgICB9XG5cbiAgICBwcml2YXRlIHRvZ2dsZUJ1dHRvbihidXR0b246IEJ1dHRvbkNvbXBvbmVudCwgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBidXR0b24uc2V0RGlzYWJsZWQoISF2YWx1ZSlcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBidXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJkaXNhYmxlZFwiKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnV0dG9uLmJ1dHRvbkVsLnJlbW92ZUNsYXNzKFwiZGlzYWJsZWRcIilcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgLy9sZXQgY3VycmVudER2RHVyYXRpb246IGFueTtcblxuICAgICAgICBpZiAodGhpcy5kYXRlTWFuYWdlcikgW3RoaXMuY3VycmVudFNoaWZ0LCB0aGlzLm5leHRJbnRlcnZhbEZpZWxkLCB0aGlzLm5leHRTaGlmdF0gPSB0aGlzLmRhdGVNYW5hZ2VyLnNoaWZ0RHVyYXRpb24odGhpcy5maWxlKTtcblxuICAgICAgICB0aGlzLmlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICB0aGlzLmlucHV0RWwuaW5wdXRFbC5mb2N1cygpO1xuXG4gICAgICAgIHRoaXMuaW5wdXRFbC5zZXRQbGFjZWhvbGRlcihcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFZhbHVlID9cbiAgICAgICAgICAgICAgICBtb21lbnQodGhpcy5pbml0aWFsVmFsdWUsIHRoaXMuZmllbGQub3B0aW9ucy5kYXRlRm9ybWF0KS5mb3JtYXQodGhpcy5maWVsZC5vcHRpb25zLmRhdGVGb3JtYXQpXG4gICAgICAgICAgICAgICAgOiBcIlwiKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbC5pbnB1dEVsLnJlbW92ZUNsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgdGhpcy5lcnJvckZpZWxkLmhpZGUoKTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JGaWVsZC5zZXRUZXh0KFwiXCIpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbihzaGlmdEZyb21Ub2RheUJ0biwgdmFsdWUpXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYWxlbmRhckRpc3BsYXlCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcilcbiAgICAgICAgY2FsZW5kYXJEaXNwbGF5QnRuLnNldEljb24oRmllbGRJY29uW0ZpZWxkVHlwZS5EYXRlXSlcbiAgICAgICAgY2FsZW5kYXJEaXNwbGF5QnRuLnNldFRvb2x0aXAoXCJvcGVuIGRhdGUgcGlja2VyXCIpXG4gICAgICAgIGNvbnN0IHNoaWZ0RnJvbVRvZGF5QnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChjb250YWluZXIpXG4gICAgICAgIHNoaWZ0RnJvbVRvZGF5QnRuLnNldEljb24oXCJza2lwLWZvcndhcmRcIilcbiAgICAgICAgc2hpZnRGcm9tVG9kYXlCdG4uc2V0VG9vbHRpcChgU2hpZnQgJHt0aGlzLmZpZWxkLm5hbWV9ICR7dGhpcy5jdXJyZW50U2hpZnQgfHwgXCIxIGRheVwifSBhaGVhZGApXG5cbiAgICAgICAgY29uc3QgZGF0ZVBpY2tlckNvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgZGF0ZVBpY2tlciA9IGZsYXRwaWNrcihkYXRlUGlja2VyQ29udGFpbmVyLCB7XG4gICAgICAgICAgICBsb2NhbGU6IHtcbiAgICAgICAgICAgICAgICBmaXJzdERheU9mV2VlazogdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlyc3REYXlPZldlZWtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWZhdWx0RGF0ZTogbW9tZW50KERhdGUubm93KCkpLmZvcm1hdChcIllZWVktTU0tRERcIilcbiAgICAgICAgfSk7XG4gICAgICAgIGRhdGVQaWNrZXIuY29uZmlnLm9uQ2hhbmdlLnB1c2goKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdEYXRlID0gbW9tZW50KHZhbHVlLnRvU3RyaW5nKCkpLmZvcm1hdCh0aGlzLmZvcm1hdCk7XG4gICAgICAgICAgICB0aGlzLmlucHV0RWwuc2V0VmFsdWUobmV3RGF0ZSk7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbmV3RGF0ZTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKHNoaWZ0RnJvbVRvZGF5QnRuLCB0aGlzLnZhbHVlKVxuICAgICAgICB9KVxuXG4gICAgICAgIGNhbGVuZGFyRGlzcGxheUJ0bi5vbkNsaWNrKChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBkYXRlUGlja2VyLnNldERhdGUoZGF0ZVBpY2tlci5wYXJzZURhdGUodGhpcy5pbnB1dEVsLmdldFZhbHVlKCkpIHx8IG5ldyBEYXRlKCkpXG4gICAgICAgICAgICBkYXRlUGlja2VyLm9wZW4oKTtcbiAgICAgICAgfSlcblxuICAgICAgICBzaGlmdEZyb21Ub2RheUJ0bi5vbkNsaWNrKGFzeW5jIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50RHZEYXRlID0gdGhpcy5kdkFwaS5kYXRlKG1vbWVudCh0aGlzLmluaXRpYWxWYWx1ZSwgdGhpcy5mb3JtYXQpLnRvSVNPU3RyaW5nKCkpO1xuICAgICAgICAgICAgY29uc3QgbmV3RGF0ZSA9IGN1cnJlbnREdkRhdGUucGx1cyh0aGlzLmR2QXBpLmR1cmF0aW9uKHRoaXMuY3VycmVudFNoaWZ0IHx8IFwiMSBkYXlcIikpO1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBtb21lbnQobmV3RGF0ZS50b1N0cmluZygpKS5mb3JtYXQodGhpcy5mb3JtYXQpXG4gICAgICAgICAgICB0aGlzLmlucHV0RWwuc2V0VmFsdWUobmV3VmFsdWUpO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgdGhpcy5wdXNoTmV4dEludGVydmFsID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKHNoaWZ0RnJvbVRvZGF5QnRuLCB0aGlzLmlucHV0RWwuZ2V0VmFsdWUoKSlcbiAgICAgICAgfSlcblxuICAgICAgICBpZiAoIXRoaXMuZHZBcGkpIHtcbiAgICAgICAgICAgIHNoaWZ0RnJvbVRvZGF5QnRuLmJ1dHRvbkVsLmhpZGUoKTtcbiAgICAgICAgICAgIHNoaWZ0RnJvbVRvZGF5QnRuLnNldERpc2FibGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbn07XG4iLCAiZXhwb3J0IHZhciBIT09LUyA9IFtcbiAgICBcIm9uQ2hhbmdlXCIsXG4gICAgXCJvbkNsb3NlXCIsXG4gICAgXCJvbkRheUNyZWF0ZVwiLFxuICAgIFwib25EZXN0cm95XCIsXG4gICAgXCJvbktleURvd25cIixcbiAgICBcIm9uTW9udGhDaGFuZ2VcIixcbiAgICBcIm9uT3BlblwiLFxuICAgIFwib25QYXJzZUNvbmZpZ1wiLFxuICAgIFwib25SZWFkeVwiLFxuICAgIFwib25WYWx1ZVVwZGF0ZVwiLFxuICAgIFwib25ZZWFyQ2hhbmdlXCIsXG4gICAgXCJvblByZUNhbGVuZGFyUG9zaXRpb25cIixcbl07XG5leHBvcnQgdmFyIGRlZmF1bHRzID0ge1xuICAgIF9kaXNhYmxlOiBbXSxcbiAgICBhbGxvd0lucHV0OiBmYWxzZSxcbiAgICBhbGxvd0ludmFsaWRQcmVsb2FkOiBmYWxzZSxcbiAgICBhbHRGb3JtYXQ6IFwiRiBqLCBZXCIsXG4gICAgYWx0SW5wdXQ6IGZhbHNlLFxuICAgIGFsdElucHV0Q2xhc3M6IFwiZm9ybS1jb250cm9sIGlucHV0XCIsXG4gICAgYW5pbWF0ZTogdHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIiAmJlxuICAgICAgICB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRVwiKSA9PT0gLTEsXG4gICAgYXJpYURhdGVGb3JtYXQ6IFwiRiBqLCBZXCIsXG4gICAgYXV0b0ZpbGxEZWZhdWx0VGltZTogdHJ1ZSxcbiAgICBjbGlja09wZW5zOiB0cnVlLFxuICAgIGNsb3NlT25TZWxlY3Q6IHRydWUsXG4gICAgY29uanVuY3Rpb246IFwiLCBcIixcbiAgICBkYXRlRm9ybWF0OiBcIlktbS1kXCIsXG4gICAgZGVmYXVsdEhvdXI6IDEyLFxuICAgIGRlZmF1bHRNaW51dGU6IDAsXG4gICAgZGVmYXVsdFNlY29uZHM6IDAsXG4gICAgZGlzYWJsZTogW10sXG4gICAgZGlzYWJsZU1vYmlsZTogZmFsc2UsXG4gICAgZW5hYmxlU2Vjb25kczogZmFsc2UsXG4gICAgZW5hYmxlVGltZTogZmFsc2UsXG4gICAgZXJyb3JIYW5kbGVyOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgY29uc29sZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjb25zb2xlLndhcm4oZXJyKTtcbiAgICB9LFxuICAgIGdldFdlZWs6IGZ1bmN0aW9uIChnaXZlbkRhdGUpIHtcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShnaXZlbkRhdGUuZ2V0VGltZSgpKTtcbiAgICAgICAgZGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgICAgICAgZGF0ZS5zZXREYXRlKGRhdGUuZ2V0RGF0ZSgpICsgMyAtICgoZGF0ZS5nZXREYXkoKSArIDYpICUgNykpO1xuICAgICAgICB2YXIgd2VlazEgPSBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIDAsIDQpO1xuICAgICAgICByZXR1cm4gKDEgK1xuICAgICAgICAgICAgTWF0aC5yb3VuZCgoKGRhdGUuZ2V0VGltZSgpIC0gd2VlazEuZ2V0VGltZSgpKSAvIDg2NDAwMDAwIC1cbiAgICAgICAgICAgICAgICAzICtcbiAgICAgICAgICAgICAgICAoKHdlZWsxLmdldERheSgpICsgNikgJSA3KSkgL1xuICAgICAgICAgICAgICAgIDcpKTtcbiAgICB9LFxuICAgIGhvdXJJbmNyZW1lbnQ6IDEsXG4gICAgaWdub3JlZEZvY3VzRWxlbWVudHM6IFtdLFxuICAgIGlubGluZTogZmFsc2UsXG4gICAgbG9jYWxlOiBcImRlZmF1bHRcIixcbiAgICBtaW51dGVJbmNyZW1lbnQ6IDUsXG4gICAgbW9kZTogXCJzaW5nbGVcIixcbiAgICBtb250aFNlbGVjdG9yVHlwZTogXCJkcm9wZG93blwiLFxuICAgIG5leHRBcnJvdzogXCI8c3ZnIHZlcnNpb249JzEuMScgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgdmlld0JveD0nMCAwIDE3IDE3Jz48Zz48L2c+PHBhdGggZD0nTTEzLjIwNyA4LjQ3MmwtNy44NTQgNy44NTQtMC43MDctMC43MDcgNy4xNDYtNy4xNDYtNy4xNDYtNy4xNDggMC43MDctMC43MDcgNy44NTQgNy44NTR6JyAvPjwvc3ZnPlwiLFxuICAgIG5vQ2FsZW5kYXI6IGZhbHNlLFxuICAgIG5vdzogbmV3IERhdGUoKSxcbiAgICBvbkNoYW5nZTogW10sXG4gICAgb25DbG9zZTogW10sXG4gICAgb25EYXlDcmVhdGU6IFtdLFxuICAgIG9uRGVzdHJveTogW10sXG4gICAgb25LZXlEb3duOiBbXSxcbiAgICBvbk1vbnRoQ2hhbmdlOiBbXSxcbiAgICBvbk9wZW46IFtdLFxuICAgIG9uUGFyc2VDb25maWc6IFtdLFxuICAgIG9uUmVhZHk6IFtdLFxuICAgIG9uVmFsdWVVcGRhdGU6IFtdLFxuICAgIG9uWWVhckNoYW5nZTogW10sXG4gICAgb25QcmVDYWxlbmRhclBvc2l0aW9uOiBbXSxcbiAgICBwbHVnaW5zOiBbXSxcbiAgICBwb3NpdGlvbjogXCJhdXRvXCIsXG4gICAgcG9zaXRpb25FbGVtZW50OiB1bmRlZmluZWQsXG4gICAgcHJldkFycm93OiBcIjxzdmcgdmVyc2lvbj0nMS4xJyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHhtbG5zOnhsaW5rPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rJyB2aWV3Qm94PScwIDAgMTcgMTcnPjxnPjwvZz48cGF0aCBkPSdNNS4yMDcgOC40NzFsNy4xNDYgNy4xNDctMC43MDcgMC43MDctNy44NTMtNy44NTQgNy44NTQtNy44NTMgMC43MDcgMC43MDctNy4xNDcgNy4xNDZ6JyAvPjwvc3ZnPlwiLFxuICAgIHNob3J0aGFuZEN1cnJlbnRNb250aDogZmFsc2UsXG4gICAgc2hvd01vbnRoczogMSxcbiAgICBzdGF0aWM6IGZhbHNlLFxuICAgIHRpbWVfMjRocjogZmFsc2UsXG4gICAgd2Vla051bWJlcnM6IGZhbHNlLFxuICAgIHdyYXA6IGZhbHNlLFxufTtcbiIsICJleHBvcnQgdmFyIGVuZ2xpc2ggPSB7XG4gICAgd2Vla2RheXM6IHtcbiAgICAgICAgc2hvcnRoYW5kOiBbXCJTdW5cIiwgXCJNb25cIiwgXCJUdWVcIiwgXCJXZWRcIiwgXCJUaHVcIiwgXCJGcmlcIiwgXCJTYXRcIl0sXG4gICAgICAgIGxvbmdoYW5kOiBbXG4gICAgICAgICAgICBcIlN1bmRheVwiLFxuICAgICAgICAgICAgXCJNb25kYXlcIixcbiAgICAgICAgICAgIFwiVHVlc2RheVwiLFxuICAgICAgICAgICAgXCJXZWRuZXNkYXlcIixcbiAgICAgICAgICAgIFwiVGh1cnNkYXlcIixcbiAgICAgICAgICAgIFwiRnJpZGF5XCIsXG4gICAgICAgICAgICBcIlNhdHVyZGF5XCIsXG4gICAgICAgIF0sXG4gICAgfSxcbiAgICBtb250aHM6IHtcbiAgICAgICAgc2hvcnRoYW5kOiBbXG4gICAgICAgICAgICBcIkphblwiLFxuICAgICAgICAgICAgXCJGZWJcIixcbiAgICAgICAgICAgIFwiTWFyXCIsXG4gICAgICAgICAgICBcIkFwclwiLFxuICAgICAgICAgICAgXCJNYXlcIixcbiAgICAgICAgICAgIFwiSnVuXCIsXG4gICAgICAgICAgICBcIkp1bFwiLFxuICAgICAgICAgICAgXCJBdWdcIixcbiAgICAgICAgICAgIFwiU2VwXCIsXG4gICAgICAgICAgICBcIk9jdFwiLFxuICAgICAgICAgICAgXCJOb3ZcIixcbiAgICAgICAgICAgIFwiRGVjXCIsXG4gICAgICAgIF0sXG4gICAgICAgIGxvbmdoYW5kOiBbXG4gICAgICAgICAgICBcIkphbnVhcnlcIixcbiAgICAgICAgICAgIFwiRmVicnVhcnlcIixcbiAgICAgICAgICAgIFwiTWFyY2hcIixcbiAgICAgICAgICAgIFwiQXByaWxcIixcbiAgICAgICAgICAgIFwiTWF5XCIsXG4gICAgICAgICAgICBcIkp1bmVcIixcbiAgICAgICAgICAgIFwiSnVseVwiLFxuICAgICAgICAgICAgXCJBdWd1c3RcIixcbiAgICAgICAgICAgIFwiU2VwdGVtYmVyXCIsXG4gICAgICAgICAgICBcIk9jdG9iZXJcIixcbiAgICAgICAgICAgIFwiTm92ZW1iZXJcIixcbiAgICAgICAgICAgIFwiRGVjZW1iZXJcIixcbiAgICAgICAgXSxcbiAgICB9LFxuICAgIGRheXNJbk1vbnRoOiBbMzEsIDI4LCAzMSwgMzAsIDMxLCAzMCwgMzEsIDMxLCAzMCwgMzEsIDMwLCAzMV0sXG4gICAgZmlyc3REYXlPZldlZWs6IDAsXG4gICAgb3JkaW5hbDogZnVuY3Rpb24gKG50aCkge1xuICAgICAgICB2YXIgcyA9IG50aCAlIDEwMDtcbiAgICAgICAgaWYgKHMgPiAzICYmIHMgPCAyMSlcbiAgICAgICAgICAgIHJldHVybiBcInRoXCI7XG4gICAgICAgIHN3aXRjaCAocyAlIDEwKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwic3RcIjtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJuZFwiO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInJkXCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBcInRoXCI7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJhbmdlU2VwYXJhdG9yOiBcIiB0byBcIixcbiAgICB3ZWVrQWJicmV2aWF0aW9uOiBcIldrXCIsXG4gICAgc2Nyb2xsVGl0bGU6IFwiU2Nyb2xsIHRvIGluY3JlbWVudFwiLFxuICAgIHRvZ2dsZVRpdGxlOiBcIkNsaWNrIHRvIHRvZ2dsZVwiLFxuICAgIGFtUE06IFtcIkFNXCIsIFwiUE1cIl0sXG4gICAgeWVhckFyaWFMYWJlbDogXCJZZWFyXCIsXG4gICAgbW9udGhBcmlhTGFiZWw6IFwiTW9udGhcIixcbiAgICBob3VyQXJpYUxhYmVsOiBcIkhvdXJcIixcbiAgICBtaW51dGVBcmlhTGFiZWw6IFwiTWludXRlXCIsXG4gICAgdGltZV8yNGhyOiBmYWxzZSxcbn07XG5leHBvcnQgZGVmYXVsdCBlbmdsaXNoO1xuIiwgImV4cG9ydCB2YXIgcGFkID0gZnVuY3Rpb24gKG51bWJlciwgbGVuZ3RoKSB7XG4gICAgaWYgKGxlbmd0aCA9PT0gdm9pZCAwKSB7IGxlbmd0aCA9IDI7IH1cbiAgICByZXR1cm4gKFwiMDAwXCIgKyBudW1iZXIpLnNsaWNlKGxlbmd0aCAqIC0xKTtcbn07XG5leHBvcnQgdmFyIGludCA9IGZ1bmN0aW9uIChib29sKSB7IHJldHVybiAoYm9vbCA9PT0gdHJ1ZSA/IDEgOiAwKTsgfTtcbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZShmbiwgd2FpdCkge1xuICAgIHZhciB0O1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICBjbGVhclRpbWVvdXQodCk7XG4gICAgICAgIHQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZuLmFwcGx5KF90aGlzLCBhcmdzKTsgfSwgd2FpdCk7XG4gICAgfTtcbn1cbmV4cG9ydCB2YXIgYXJyYXlpZnkgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgcmV0dXJuIG9iaiBpbnN0YW5jZW9mIEFycmF5ID8gb2JqIDogW29ial07XG59O1xuIiwgImV4cG9ydCBmdW5jdGlvbiB0b2dnbGVDbGFzcyhlbGVtLCBjbGFzc05hbWUsIGJvb2wpIHtcbiAgICBpZiAoYm9vbCA9PT0gdHJ1ZSlcbiAgICAgICAgcmV0dXJuIGVsZW0uY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgIGVsZW0uY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodGFnLCBjbGFzc05hbWUsIGNvbnRlbnQpIHtcbiAgICB2YXIgZSA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZyk7XG4gICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lIHx8IFwiXCI7XG4gICAgY29udGVudCA9IGNvbnRlbnQgfHwgXCJcIjtcbiAgICBlLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcbiAgICBpZiAoY29udGVudCAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBlLnRleHRDb250ZW50ID0gY29udGVudDtcbiAgICByZXR1cm4gZTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBjbGVhck5vZGUobm9kZSkge1xuICAgIHdoaWxlIChub2RlLmZpcnN0Q2hpbGQpXG4gICAgICAgIG5vZGUucmVtb3ZlQ2hpbGQobm9kZS5maXJzdENoaWxkKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBmaW5kUGFyZW50KG5vZGUsIGNvbmRpdGlvbikge1xuICAgIGlmIChjb25kaXRpb24obm9kZSkpXG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIGVsc2UgaWYgKG5vZGUucGFyZW50Tm9kZSlcbiAgICAgICAgcmV0dXJuIGZpbmRQYXJlbnQobm9kZS5wYXJlbnROb2RlLCBjb25kaXRpb24pO1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTnVtYmVySW5wdXQoaW5wdXRDbGFzc05hbWUsIG9wdHMpIHtcbiAgICB2YXIgd3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJudW1JbnB1dFdyYXBwZXJcIiksIG51bUlucHV0ID0gY3JlYXRlRWxlbWVudChcImlucHV0XCIsIFwibnVtSW5wdXQgXCIgKyBpbnB1dENsYXNzTmFtZSksIGFycm93VXAgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImFycm93VXBcIiksIGFycm93RG93biA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiYXJyb3dEb3duXCIpO1xuICAgIGlmIChuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFIDkuMFwiKSA9PT0gLTEpIHtcbiAgICAgICAgbnVtSW5wdXQudHlwZSA9IFwibnVtYmVyXCI7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBudW1JbnB1dC50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgIG51bUlucHV0LnBhdHRlcm4gPSBcIlxcXFxkKlwiO1xuICAgIH1cbiAgICBpZiAob3B0cyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gb3B0cylcbiAgICAgICAgICAgIG51bUlucHV0LnNldEF0dHJpYnV0ZShrZXksIG9wdHNba2V5XSk7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChudW1JbnB1dCk7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZChhcnJvd1VwKTtcbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKGFycm93RG93bik7XG4gICAgcmV0dXJuIHdyYXBwZXI7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0RXZlbnRUYXJnZXQoZXZlbnQpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGV2ZW50LmNvbXBvc2VkUGF0aCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIgcGF0aCA9IGV2ZW50LmNvbXBvc2VkUGF0aCgpO1xuICAgICAgICAgICAgcmV0dXJuIHBhdGhbMF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV2ZW50LnRhcmdldDtcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBldmVudC50YXJnZXQ7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IGludCwgcGFkIH0gZnJvbSBcIi4uL3V0aWxzXCI7XG52YXIgZG9Ob3RoaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9O1xuZXhwb3J0IHZhciBtb250aFRvU3RyID0gZnVuY3Rpb24gKG1vbnRoTnVtYmVyLCBzaG9ydGhhbmQsIGxvY2FsZSkgeyByZXR1cm4gbG9jYWxlLm1vbnRoc1tzaG9ydGhhbmQgPyBcInNob3J0aGFuZFwiIDogXCJsb25naGFuZFwiXVttb250aE51bWJlcl07IH07XG5leHBvcnQgdmFyIHJldkZvcm1hdCA9IHtcbiAgICBEOiBkb05vdGhpbmcsXG4gICAgRjogZnVuY3Rpb24gKGRhdGVPYmosIG1vbnRoTmFtZSwgbG9jYWxlKSB7XG4gICAgICAgIGRhdGVPYmouc2V0TW9udGgobG9jYWxlLm1vbnRocy5sb25naGFuZC5pbmRleE9mKG1vbnRoTmFtZSkpO1xuICAgIH0sXG4gICAgRzogZnVuY3Rpb24gKGRhdGVPYmosIGhvdXIpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRIb3VycygoZGF0ZU9iai5nZXRIb3VycygpID49IDEyID8gMTIgOiAwKSArIHBhcnNlRmxvYXQoaG91cikpO1xuICAgIH0sXG4gICAgSDogZnVuY3Rpb24gKGRhdGVPYmosIGhvdXIpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRIb3VycyhwYXJzZUZsb2F0KGhvdXIpKTtcbiAgICB9LFxuICAgIEo6IGZ1bmN0aW9uIChkYXRlT2JqLCBkYXkpIHtcbiAgICAgICAgZGF0ZU9iai5zZXREYXRlKHBhcnNlRmxvYXQoZGF5KSk7XG4gICAgfSxcbiAgICBLOiBmdW5jdGlvbiAoZGF0ZU9iaiwgYW1QTSwgbG9jYWxlKSB7XG4gICAgICAgIGRhdGVPYmouc2V0SG91cnMoKGRhdGVPYmouZ2V0SG91cnMoKSAlIDEyKSArXG4gICAgICAgICAgICAxMiAqIGludChuZXcgUmVnRXhwKGxvY2FsZS5hbVBNWzFdLCBcImlcIikudGVzdChhbVBNKSkpO1xuICAgIH0sXG4gICAgTTogZnVuY3Rpb24gKGRhdGVPYmosIHNob3J0TW9udGgsIGxvY2FsZSkge1xuICAgICAgICBkYXRlT2JqLnNldE1vbnRoKGxvY2FsZS5tb250aHMuc2hvcnRoYW5kLmluZGV4T2Yoc2hvcnRNb250aCkpO1xuICAgIH0sXG4gICAgUzogZnVuY3Rpb24gKGRhdGVPYmosIHNlY29uZHMpIHtcbiAgICAgICAgZGF0ZU9iai5zZXRTZWNvbmRzKHBhcnNlRmxvYXQoc2Vjb25kcykpO1xuICAgIH0sXG4gICAgVTogZnVuY3Rpb24gKF8sIHVuaXhTZWNvbmRzKSB7IHJldHVybiBuZXcgRGF0ZShwYXJzZUZsb2F0KHVuaXhTZWNvbmRzKSAqIDEwMDApOyB9LFxuICAgIFc6IGZ1bmN0aW9uIChkYXRlT2JqLCB3ZWVrTnVtLCBsb2NhbGUpIHtcbiAgICAgICAgdmFyIHdlZWtOdW1iZXIgPSBwYXJzZUludCh3ZWVrTnVtKTtcbiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlT2JqLmdldEZ1bGxZZWFyKCksIDAsIDIgKyAod2Vla051bWJlciAtIDEpICogNywgMCwgMCwgMCwgMCk7XG4gICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSAtIGRhdGUuZ2V0RGF5KCkgKyBsb2NhbGUuZmlyc3REYXlPZldlZWspO1xuICAgICAgICByZXR1cm4gZGF0ZTtcbiAgICB9LFxuICAgIFk6IGZ1bmN0aW9uIChkYXRlT2JqLCB5ZWFyKSB7XG4gICAgICAgIGRhdGVPYmouc2V0RnVsbFllYXIocGFyc2VGbG9hdCh5ZWFyKSk7XG4gICAgfSxcbiAgICBaOiBmdW5jdGlvbiAoXywgSVNPRGF0ZSkgeyByZXR1cm4gbmV3IERhdGUoSVNPRGF0ZSk7IH0sXG4gICAgZDogZnVuY3Rpb24gKGRhdGVPYmosIGRheSkge1xuICAgICAgICBkYXRlT2JqLnNldERhdGUocGFyc2VGbG9hdChkYXkpKTtcbiAgICB9LFxuICAgIGg6IGZ1bmN0aW9uIChkYXRlT2JqLCBob3VyKSB7XG4gICAgICAgIGRhdGVPYmouc2V0SG91cnMoKGRhdGVPYmouZ2V0SG91cnMoKSA+PSAxMiA/IDEyIDogMCkgKyBwYXJzZUZsb2F0KGhvdXIpKTtcbiAgICB9LFxuICAgIGk6IGZ1bmN0aW9uIChkYXRlT2JqLCBtaW51dGVzKSB7XG4gICAgICAgIGRhdGVPYmouc2V0TWludXRlcyhwYXJzZUZsb2F0KG1pbnV0ZXMpKTtcbiAgICB9LFxuICAgIGo6IGZ1bmN0aW9uIChkYXRlT2JqLCBkYXkpIHtcbiAgICAgICAgZGF0ZU9iai5zZXREYXRlKHBhcnNlRmxvYXQoZGF5KSk7XG4gICAgfSxcbiAgICBsOiBkb05vdGhpbmcsXG4gICAgbTogZnVuY3Rpb24gKGRhdGVPYmosIG1vbnRoKSB7XG4gICAgICAgIGRhdGVPYmouc2V0TW9udGgocGFyc2VGbG9hdChtb250aCkgLSAxKTtcbiAgICB9LFxuICAgIG46IGZ1bmN0aW9uIChkYXRlT2JqLCBtb250aCkge1xuICAgICAgICBkYXRlT2JqLnNldE1vbnRoKHBhcnNlRmxvYXQobW9udGgpIC0gMSk7XG4gICAgfSxcbiAgICBzOiBmdW5jdGlvbiAoZGF0ZU9iaiwgc2Vjb25kcykge1xuICAgICAgICBkYXRlT2JqLnNldFNlY29uZHMocGFyc2VGbG9hdChzZWNvbmRzKSk7XG4gICAgfSxcbiAgICB1OiBmdW5jdGlvbiAoXywgdW5peE1pbGxTZWNvbmRzKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShwYXJzZUZsb2F0KHVuaXhNaWxsU2Vjb25kcykpO1xuICAgIH0sXG4gICAgdzogZG9Ob3RoaW5nLFxuICAgIHk6IGZ1bmN0aW9uIChkYXRlT2JqLCB5ZWFyKSB7XG4gICAgICAgIGRhdGVPYmouc2V0RnVsbFllYXIoMjAwMCArIHBhcnNlRmxvYXQoeWVhcikpO1xuICAgIH0sXG59O1xuZXhwb3J0IHZhciB0b2tlblJlZ2V4ID0ge1xuICAgIEQ6IFwiXCIsXG4gICAgRjogXCJcIixcbiAgICBHOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIEg6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgSjogXCIoXFxcXGRcXFxcZHxcXFxcZClcXFxcdytcIixcbiAgICBLOiBcIlwiLFxuICAgIE06IFwiXCIsXG4gICAgUzogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBVOiBcIiguKylcIixcbiAgICBXOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIFk6IFwiKFxcXFxkezR9KVwiLFxuICAgIFo6IFwiKC4rKVwiLFxuICAgIGQ6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgaDogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICBpOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIGo6IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgbDogXCJcIixcbiAgICBtOiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIG46IFwiKFxcXFxkXFxcXGR8XFxcXGQpXCIsXG4gICAgczogXCIoXFxcXGRcXFxcZHxcXFxcZClcIixcbiAgICB1OiBcIiguKylcIixcbiAgICB3OiBcIihcXFxcZFxcXFxkfFxcXFxkKVwiLFxuICAgIHk6IFwiKFxcXFxkezJ9KVwiLFxufTtcbmV4cG9ydCB2YXIgZm9ybWF0cyA9IHtcbiAgICBaOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS50b0lTT1N0cmluZygpOyB9LFxuICAgIEQ6IGZ1bmN0aW9uIChkYXRlLCBsb2NhbGUsIG9wdGlvbnMpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsZS53ZWVrZGF5cy5zaG9ydGhhbmRbZm9ybWF0cy53KGRhdGUsIGxvY2FsZSwgb3B0aW9ucyldO1xuICAgIH0sXG4gICAgRjogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gbW9udGhUb1N0cihmb3JtYXRzLm4oZGF0ZSwgbG9jYWxlLCBvcHRpb25zKSAtIDEsIGZhbHNlLCBsb2NhbGUpO1xuICAgIH0sXG4gICAgRzogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSwgb3B0aW9ucykge1xuICAgICAgICByZXR1cm4gcGFkKGZvcm1hdHMuaChkYXRlLCBsb2NhbGUsIG9wdGlvbnMpKTtcbiAgICB9LFxuICAgIEg6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBwYWQoZGF0ZS5nZXRIb3VycygpKTsgfSxcbiAgICBKOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlKSB7XG4gICAgICAgIHJldHVybiBsb2NhbGUub3JkaW5hbCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IGRhdGUuZ2V0RGF0ZSgpICsgbG9jYWxlLm9yZGluYWwoZGF0ZS5nZXREYXRlKCkpXG4gICAgICAgICAgICA6IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIH0sXG4gICAgSzogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSkgeyByZXR1cm4gbG9jYWxlLmFtUE1baW50KGRhdGUuZ2V0SG91cnMoKSA+IDExKV07IH0sXG4gICAgTTogZnVuY3Rpb24gKGRhdGUsIGxvY2FsZSkge1xuICAgICAgICByZXR1cm4gbW9udGhUb1N0cihkYXRlLmdldE1vbnRoKCksIHRydWUsIGxvY2FsZSk7XG4gICAgfSxcbiAgICBTOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0U2Vjb25kcygpKTsgfSxcbiAgICBVOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXRUaW1lKCkgLyAxMDAwOyB9LFxuICAgIFc6IGZ1bmN0aW9uIChkYXRlLCBfLCBvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFdlZWsoZGF0ZSk7XG4gICAgfSxcbiAgICBZOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0RnVsbFllYXIoKSwgNCk7IH0sXG4gICAgZDogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIHBhZChkYXRlLmdldERhdGUoKSk7IH0sXG4gICAgaDogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIChkYXRlLmdldEhvdXJzKCkgJSAxMiA/IGRhdGUuZ2V0SG91cnMoKSAlIDEyIDogMTIpOyB9LFxuICAgIGk6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBwYWQoZGF0ZS5nZXRNaW51dGVzKCkpOyB9LFxuICAgIGo6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLmdldERhdGUoKTsgfSxcbiAgICBsOiBmdW5jdGlvbiAoZGF0ZSwgbG9jYWxlKSB7XG4gICAgICAgIHJldHVybiBsb2NhbGUud2Vla2RheXMubG9uZ2hhbmRbZGF0ZS5nZXREYXkoKV07XG4gICAgfSxcbiAgICBtOiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gcGFkKGRhdGUuZ2V0TW9udGgoKSArIDEpOyB9LFxuICAgIG46IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLmdldE1vbnRoKCkgKyAxOyB9LFxuICAgIHM6IGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBkYXRlLmdldFNlY29uZHMoKTsgfSxcbiAgICB1OiBmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gZGF0ZS5nZXRUaW1lKCk7IH0sXG4gICAgdzogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIGRhdGUuZ2V0RGF5KCk7IH0sXG4gICAgeTogZnVuY3Rpb24gKGRhdGUpIHsgcmV0dXJuIFN0cmluZyhkYXRlLmdldEZ1bGxZZWFyKCkpLnN1YnN0cmluZygyKTsgfSxcbn07XG4iLCAiaW1wb3J0IHsgdG9rZW5SZWdleCwgcmV2Rm9ybWF0LCBmb3JtYXRzLCB9IGZyb20gXCIuL2Zvcm1hdHRpbmdcIjtcbmltcG9ydCB7IGRlZmF1bHRzIH0gZnJvbSBcIi4uL3R5cGVzL29wdGlvbnNcIjtcbmltcG9ydCB7IGVuZ2xpc2ggfSBmcm9tIFwiLi4vbDEwbi9kZWZhdWx0XCI7XG5leHBvcnQgdmFyIGNyZWF0ZURhdGVGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgX2IgPSBfYS5jb25maWcsIGNvbmZpZyA9IF9iID09PSB2b2lkIDAgPyBkZWZhdWx0cyA6IF9iLCBfYyA9IF9hLmwxMG4sIGwxMG4gPSBfYyA9PT0gdm9pZCAwID8gZW5nbGlzaCA6IF9jLCBfZCA9IF9hLmlzTW9iaWxlLCBpc01vYmlsZSA9IF9kID09PSB2b2lkIDAgPyBmYWxzZSA6IF9kO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZGF0ZU9iaiwgZnJtdCwgb3ZlcnJpZGVMb2NhbGUpIHtcbiAgICAgICAgdmFyIGxvY2FsZSA9IG92ZXJyaWRlTG9jYWxlIHx8IGwxMG47XG4gICAgICAgIGlmIChjb25maWcuZm9ybWF0RGF0ZSAhPT0gdW5kZWZpbmVkICYmICFpc01vYmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy5mb3JtYXREYXRlKGRhdGVPYmosIGZybXQsIGxvY2FsZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZybXRcbiAgICAgICAgICAgIC5zcGxpdChcIlwiKVxuICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoYywgaSwgYXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0c1tjXSAmJiBhcnJbaSAtIDFdICE9PSBcIlxcXFxcIlxuICAgICAgICAgICAgICAgID8gZm9ybWF0c1tjXShkYXRlT2JqLCBsb2NhbGUsIGNvbmZpZylcbiAgICAgICAgICAgICAgICA6IGMgIT09IFwiXFxcXFwiXG4gICAgICAgICAgICAgICAgICAgID8gY1xuICAgICAgICAgICAgICAgICAgICA6IFwiXCI7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuam9pbihcIlwiKTtcbiAgICB9O1xufTtcbmV4cG9ydCB2YXIgY3JlYXRlRGF0ZVBhcnNlciA9IGZ1bmN0aW9uIChfYSkge1xuICAgIHZhciBfYiA9IF9hLmNvbmZpZywgY29uZmlnID0gX2IgPT09IHZvaWQgMCA/IGRlZmF1bHRzIDogX2IsIF9jID0gX2EubDEwbiwgbDEwbiA9IF9jID09PSB2b2lkIDAgPyBlbmdsaXNoIDogX2M7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRlLCBnaXZlbkZvcm1hdCwgdGltZWxlc3MsIGN1c3RvbUxvY2FsZSkge1xuICAgICAgICBpZiAoZGF0ZSAhPT0gMCAmJiAhZGF0ZSlcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBsb2NhbGUgPSBjdXN0b21Mb2NhbGUgfHwgbDEwbjtcbiAgICAgICAgdmFyIHBhcnNlZERhdGU7XG4gICAgICAgIHZhciBkYXRlT3JpZyA9IGRhdGU7XG4gICAgICAgIGlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSlcbiAgICAgICAgICAgIHBhcnNlZERhdGUgPSBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSk7XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiBkYXRlICE9PSBcInN0cmluZ1wiICYmXG4gICAgICAgICAgICBkYXRlLnRvRml4ZWQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHBhcnNlZERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGRhdGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBmb3JtYXQgPSBnaXZlbkZvcm1hdCB8fCAoY29uZmlnIHx8IGRlZmF1bHRzKS5kYXRlRm9ybWF0O1xuICAgICAgICAgICAgdmFyIGRhdGVzdHIgPSBTdHJpbmcoZGF0ZSkudHJpbSgpO1xuICAgICAgICAgICAgaWYgKGRhdGVzdHIgPT09IFwidG9kYXlcIikge1xuICAgICAgICAgICAgICAgIHBhcnNlZERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgIHRpbWVsZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbmZpZyAmJiBjb25maWcucGFyc2VEYXRlKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkRGF0ZSA9IGNvbmZpZy5wYXJzZURhdGUoZGF0ZSwgZm9ybWF0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKC9aJC8udGVzdChkYXRlc3RyKSB8fFxuICAgICAgICAgICAgICAgIC9HTVQkLy50ZXN0KGRhdGVzdHIpKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkRGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIG1hdGNoZWQgPSB2b2lkIDAsIG9wcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXRjaEluZGV4ID0gMCwgcmVnZXhTdHIgPSBcIlwiOyBpIDwgZm9ybWF0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IGZvcm1hdFtpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlzQmFja1NsYXNoID0gdG9rZW4gPT09IFwiXFxcXFwiO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXNjYXBlZCA9IGZvcm1hdFtpIC0gMV0gPT09IFwiXFxcXFwiIHx8IGlzQmFja1NsYXNoO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5SZWdleFt0b2tlbl0gJiYgIWVzY2FwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4U3RyICs9IHRva2VuUmVnZXhbdG9rZW5dO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoID0gbmV3IFJlZ0V4cChyZWdleFN0cikuZXhlYyhkYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCAmJiAobWF0Y2hlZCA9IHRydWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BzW3Rva2VuICE9PSBcIllcIiA/IFwicHVzaFwiIDogXCJ1bnNoaWZ0XCJdKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm46IHJldkZvcm1hdFt0b2tlbl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbDogbWF0Y2hbKyttYXRjaEluZGV4XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghaXNCYWNrU2xhc2gpXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdleFN0ciArPSBcIi5cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcGFyc2VkRGF0ZSA9XG4gICAgICAgICAgICAgICAgICAgICFjb25maWcgfHwgIWNvbmZpZy5ub0NhbGVuZGFyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IG5ldyBEYXRlKG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSwgMCwgMSwgMCwgMCwgMCwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbmV3IERhdGUobmV3IERhdGUoKS5zZXRIb3VycygwLCAwLCAwLCAwKSk7XG4gICAgICAgICAgICAgICAgb3BzLmZvckVhY2goZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmbiA9IF9hLmZuLCB2YWwgPSBfYS52YWw7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAocGFyc2VkRGF0ZSA9IGZuKHBhcnNlZERhdGUsIHZhbCwgbG9jYWxlKSB8fCBwYXJzZWREYXRlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBwYXJzZWREYXRlID0gbWF0Y2hlZCA/IHBhcnNlZERhdGUgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEocGFyc2VkRGF0ZSBpbnN0YW5jZW9mIERhdGUgJiYgIWlzTmFOKHBhcnNlZERhdGUuZ2V0VGltZSgpKSkpIHtcbiAgICAgICAgICAgIGNvbmZpZy5lcnJvckhhbmRsZXIobmV3IEVycm9yKFwiSW52YWxpZCBkYXRlIHByb3ZpZGVkOiBcIiArIGRhdGVPcmlnKSk7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aW1lbGVzcyA9PT0gdHJ1ZSlcbiAgICAgICAgICAgIHBhcnNlZERhdGUuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gICAgICAgIHJldHVybiBwYXJzZWREYXRlO1xuICAgIH07XG59O1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVEYXRlcyhkYXRlMSwgZGF0ZTIsIHRpbWVsZXNzKSB7XG4gICAgaWYgKHRpbWVsZXNzID09PSB2b2lkIDApIHsgdGltZWxlc3MgPSB0cnVlOyB9XG4gICAgaWYgKHRpbWVsZXNzICE9PSBmYWxzZSkge1xuICAgICAgICByZXR1cm4gKG5ldyBEYXRlKGRhdGUxLmdldFRpbWUoKSkuc2V0SG91cnMoMCwgMCwgMCwgMCkgLVxuICAgICAgICAgICAgbmV3IERhdGUoZGF0ZTIuZ2V0VGltZSgpKS5zZXRIb3VycygwLCAwLCAwLCAwKSk7XG4gICAgfVxuICAgIHJldHVybiBkYXRlMS5nZXRUaW1lKCkgLSBkYXRlMi5nZXRUaW1lKCk7XG59XG5leHBvcnQgZnVuY3Rpb24gY29tcGFyZVRpbWVzKGRhdGUxLCBkYXRlMikge1xuICAgIHJldHVybiAoMzYwMCAqIChkYXRlMS5nZXRIb3VycygpIC0gZGF0ZTIuZ2V0SG91cnMoKSkgK1xuICAgICAgICA2MCAqIChkYXRlMS5nZXRNaW51dGVzKCkgLSBkYXRlMi5nZXRNaW51dGVzKCkpICtcbiAgICAgICAgZGF0ZTEuZ2V0U2Vjb25kcygpIC1cbiAgICAgICAgZGF0ZTIuZ2V0U2Vjb25kcygpKTtcbn1cbmV4cG9ydCB2YXIgaXNCZXR3ZWVuID0gZnVuY3Rpb24gKHRzLCB0czEsIHRzMikge1xuICAgIHJldHVybiB0cyA+IE1hdGgubWluKHRzMSwgdHMyKSAmJiB0cyA8IE1hdGgubWF4KHRzMSwgdHMyKTtcbn07XG5leHBvcnQgdmFyIGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0ID0gZnVuY3Rpb24gKGhvdXJzLCBtaW51dGVzLCBzZWNvbmRzKSB7XG4gICAgcmV0dXJuIGhvdXJzICogMzYwMCArIG1pbnV0ZXMgKiA2MCArIHNlY29uZHM7XG59O1xuZXhwb3J0IHZhciBwYXJzZVNlY29uZHMgPSBmdW5jdGlvbiAoc2Vjb25kc1NpbmNlTWlkbmlnaHQpIHtcbiAgICB2YXIgaG91cnMgPSBNYXRoLmZsb29yKHNlY29uZHNTaW5jZU1pZG5pZ2h0IC8gMzYwMCksIG1pbnV0ZXMgPSAoc2Vjb25kc1NpbmNlTWlkbmlnaHQgLSBob3VycyAqIDM2MDApIC8gNjA7XG4gICAgcmV0dXJuIFtob3VycywgbWludXRlcywgc2Vjb25kc1NpbmNlTWlkbmlnaHQgLSBob3VycyAqIDM2MDAgLSBtaW51dGVzICogNjBdO1xufTtcbmV4cG9ydCB2YXIgZHVyYXRpb24gPSB7XG4gICAgREFZOiA4NjQwMDAwMCxcbn07XG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdEhvdXJzKGNvbmZpZykge1xuICAgIHZhciBob3VycyA9IGNvbmZpZy5kZWZhdWx0SG91cjtcbiAgICB2YXIgbWludXRlcyA9IGNvbmZpZy5kZWZhdWx0TWludXRlO1xuICAgIHZhciBzZWNvbmRzID0gY29uZmlnLmRlZmF1bHRTZWNvbmRzO1xuICAgIGlmIChjb25maWcubWluRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBtaW5Ib3VyID0gY29uZmlnLm1pbkRhdGUuZ2V0SG91cnMoKTtcbiAgICAgICAgdmFyIG1pbk1pbnV0ZXMgPSBjb25maWcubWluRGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgIHZhciBtaW5TZWNvbmRzID0gY29uZmlnLm1pbkRhdGUuZ2V0U2Vjb25kcygpO1xuICAgICAgICBpZiAoaG91cnMgPCBtaW5Ib3VyKSB7XG4gICAgICAgICAgICBob3VycyA9IG1pbkhvdXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhvdXJzID09PSBtaW5Ib3VyICYmIG1pbnV0ZXMgPCBtaW5NaW51dGVzKSB7XG4gICAgICAgICAgICBtaW51dGVzID0gbWluTWludXRlcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoaG91cnMgPT09IG1pbkhvdXIgJiYgbWludXRlcyA9PT0gbWluTWludXRlcyAmJiBzZWNvbmRzIDwgbWluU2Vjb25kcylcbiAgICAgICAgICAgIHNlY29uZHMgPSBjb25maWcubWluRGF0ZS5nZXRTZWNvbmRzKCk7XG4gICAgfVxuICAgIGlmIChjb25maWcubWF4RGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHZhciBtYXhIciA9IGNvbmZpZy5tYXhEYXRlLmdldEhvdXJzKCk7XG4gICAgICAgIHZhciBtYXhNaW51dGVzID0gY29uZmlnLm1heERhdGUuZ2V0TWludXRlcygpO1xuICAgICAgICBob3VycyA9IE1hdGgubWluKGhvdXJzLCBtYXhIcik7XG4gICAgICAgIGlmIChob3VycyA9PT0gbWF4SHIpXG4gICAgICAgICAgICBtaW51dGVzID0gTWF0aC5taW4obWF4TWludXRlcywgbWludXRlcyk7XG4gICAgICAgIGlmIChob3VycyA9PT0gbWF4SHIgJiYgbWludXRlcyA9PT0gbWF4TWludXRlcylcbiAgICAgICAgICAgIHNlY29uZHMgPSBjb25maWcubWF4RGF0ZS5nZXRTZWNvbmRzKCk7XG4gICAgfVxuICAgIHJldHVybiB7IGhvdXJzOiBob3VycywgbWludXRlczogbWludXRlcywgc2Vjb25kczogc2Vjb25kcyB9O1xufVxuIiwgIlwidXNlIHN0cmljdFwiO1xuaWYgKHR5cGVvZiBPYmplY3QuYXNzaWduICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBPYmplY3QuYXNzaWduID0gZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICAgICAgdGhyb3cgVHlwZUVycm9yKFwiQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0XCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiAodGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XSk7IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKHZhciBfYSA9IDAsIGFyZ3NfMSA9IGFyZ3M7IF9hIDwgYXJnc18xLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3NfMVtfYV07XG4gICAgICAgICAgICBfbG9vcF8xKHNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9O1xufVxuIiwgInZhciBfX2Fzc2lnbiA9ICh0aGlzICYmIHRoaXMuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24odCkge1xuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpXG4gICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG52YXIgX19zcHJlYWRBcnJheXMgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXlzKSB8fCBmdW5jdGlvbiAoKSB7XG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XG4gICAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKVxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xuICAgIHJldHVybiByO1xufTtcbmltcG9ydCB7IGRlZmF1bHRzIGFzIGRlZmF1bHRPcHRpb25zLCBIT09LUywgfSBmcm9tIFwiLi90eXBlcy9vcHRpb25zXCI7XG5pbXBvcnQgRW5nbGlzaCBmcm9tIFwiLi9sMTBuL2RlZmF1bHRcIjtcbmltcG9ydCB7IGFycmF5aWZ5LCBkZWJvdW5jZSwgaW50LCBwYWQgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgY2xlYXJOb2RlLCBjcmVhdGVFbGVtZW50LCBjcmVhdGVOdW1iZXJJbnB1dCwgZmluZFBhcmVudCwgdG9nZ2xlQ2xhc3MsIGdldEV2ZW50VGFyZ2V0LCB9IGZyb20gXCIuL3V0aWxzL2RvbVwiO1xuaW1wb3J0IHsgY29tcGFyZURhdGVzLCBjcmVhdGVEYXRlUGFyc2VyLCBjcmVhdGVEYXRlRm9ybWF0dGVyLCBkdXJhdGlvbiwgaXNCZXR3ZWVuLCBnZXREZWZhdWx0SG91cnMsIGNhbGN1bGF0ZVNlY29uZHNTaW5jZU1pZG5pZ2h0LCBwYXJzZVNlY29uZHMsIH0gZnJvbSBcIi4vdXRpbHMvZGF0ZXNcIjtcbmltcG9ydCB7IHRva2VuUmVnZXgsIG1vbnRoVG9TdHIgfSBmcm9tIFwiLi91dGlscy9mb3JtYXR0aW5nXCI7XG5pbXBvcnQgXCIuL3V0aWxzL3BvbHlmaWxsc1wiO1xudmFyIERFQk9VTkNFRF9DSEFOR0VfTVMgPSAzMDA7XG5mdW5jdGlvbiBGbGF0cGlja3JJbnN0YW5jZShlbGVtZW50LCBpbnN0YW5jZUNvbmZpZykge1xuICAgIHZhciBzZWxmID0ge1xuICAgICAgICBjb25maWc6IF9fYXNzaWduKF9fYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucyksIGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnKSxcbiAgICAgICAgbDEwbjogRW5nbGlzaCxcbiAgICB9O1xuICAgIHNlbGYucGFyc2VEYXRlID0gY3JlYXRlRGF0ZVBhcnNlcih7IGNvbmZpZzogc2VsZi5jb25maWcsIGwxMG46IHNlbGYubDEwbiB9KTtcbiAgICBzZWxmLl9oYW5kbGVycyA9IFtdO1xuICAgIHNlbGYucGx1Z2luRWxlbWVudHMgPSBbXTtcbiAgICBzZWxmLmxvYWRlZFBsdWdpbnMgPSBbXTtcbiAgICBzZWxmLl9iaW5kID0gYmluZDtcbiAgICBzZWxmLl9zZXRIb3Vyc0Zyb21EYXRlID0gc2V0SG91cnNGcm9tRGF0ZTtcbiAgICBzZWxmLl9wb3NpdGlvbkNhbGVuZGFyID0gcG9zaXRpb25DYWxlbmRhcjtcbiAgICBzZWxmLmNoYW5nZU1vbnRoID0gY2hhbmdlTW9udGg7XG4gICAgc2VsZi5jaGFuZ2VZZWFyID0gY2hhbmdlWWVhcjtcbiAgICBzZWxmLmNsZWFyID0gY2xlYXI7XG4gICAgc2VsZi5jbG9zZSA9IGNsb3NlO1xuICAgIHNlbGYub25Nb3VzZU92ZXIgPSBvbk1vdXNlT3ZlcjtcbiAgICBzZWxmLl9jcmVhdGVFbGVtZW50ID0gY3JlYXRlRWxlbWVudDtcbiAgICBzZWxmLmNyZWF0ZURheSA9IGNyZWF0ZURheTtcbiAgICBzZWxmLmRlc3Ryb3kgPSBkZXN0cm95O1xuICAgIHNlbGYuaXNFbmFibGVkID0gaXNFbmFibGVkO1xuICAgIHNlbGYuanVtcFRvRGF0ZSA9IGp1bXBUb0RhdGU7XG4gICAgc2VsZi51cGRhdGVWYWx1ZSA9IHVwZGF0ZVZhbHVlO1xuICAgIHNlbGYub3BlbiA9IG9wZW47XG4gICAgc2VsZi5yZWRyYXcgPSByZWRyYXc7XG4gICAgc2VsZi5zZXQgPSBzZXQ7XG4gICAgc2VsZi5zZXREYXRlID0gc2V0RGF0ZTtcbiAgICBzZWxmLnRvZ2dsZSA9IHRvZ2dsZTtcbiAgICBmdW5jdGlvbiBzZXR1cEhlbHBlckZ1bmN0aW9ucygpIHtcbiAgICAgICAgc2VsZi51dGlscyA9IHtcbiAgICAgICAgICAgIGdldERheXNJbk1vbnRoOiBmdW5jdGlvbiAobW9udGgsIHlyKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1vbnRoID09PSB2b2lkIDApIHsgbW9udGggPSBzZWxmLmN1cnJlbnRNb250aDsgfVxuICAgICAgICAgICAgICAgIGlmICh5ciA9PT0gdm9pZCAwKSB7IHlyID0gc2VsZi5jdXJyZW50WWVhcjsgfVxuICAgICAgICAgICAgICAgIGlmIChtb250aCA9PT0gMSAmJiAoKHlyICUgNCA9PT0gMCAmJiB5ciAlIDEwMCAhPT0gMCkgfHwgeXIgJSA0MDAgPT09IDApKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMjk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYubDEwbi5kYXlzSW5Nb250aFttb250aF07XG4gICAgICAgICAgICB9LFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICBzZWxmLmVsZW1lbnQgPSBzZWxmLmlucHV0ID0gZWxlbWVudDtcbiAgICAgICAgc2VsZi5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgcGFyc2VDb25maWcoKTtcbiAgICAgICAgc2V0dXBMb2NhbGUoKTtcbiAgICAgICAgc2V0dXBJbnB1dHMoKTtcbiAgICAgICAgc2V0dXBEYXRlcygpO1xuICAgICAgICBzZXR1cEhlbHBlckZ1bmN0aW9ucygpO1xuICAgICAgICBpZiAoIXNlbGYuaXNNb2JpbGUpXG4gICAgICAgICAgICBidWlsZCgpO1xuICAgICAgICBiaW5kRXZlbnRzKCk7XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoIHx8IHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5lbmFibGVUaW1lKSB7XG4gICAgICAgICAgICAgICAgc2V0SG91cnNGcm9tRGF0ZShzZWxmLmNvbmZpZy5ub0NhbGVuZGFyID8gc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogOiB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdXBkYXRlVmFsdWUoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIHNldENhbGVuZGFyV2lkdGgoKTtcbiAgICAgICAgdmFyIGlzU2FmYXJpID0gL14oKD8hY2hyb21lfGFuZHJvaWQpLikqc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICAgICAgaWYgKCFzZWxmLmlzTW9iaWxlICYmIGlzU2FmYXJpKSB7XG4gICAgICAgICAgICBwb3NpdGlvbkNhbGVuZGFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdHJpZ2dlckV2ZW50KFwib25SZWFkeVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0Q2xvc2VzdEFjdGl2ZUVsZW1lbnQoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuICgoKF9hID0gc2VsZi5jYWxlbmRhckNvbnRhaW5lcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmdldFJvb3ROb2RlKCkpXG4gICAgICAgICAgICAuYWN0aXZlRWxlbWVudCB8fCBkb2N1bWVudC5hY3RpdmVFbGVtZW50KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gYmluZFRvSW5zdGFuY2UoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZuLmJpbmQoc2VsZik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldENhbGVuZGFyV2lkdGgoKSB7XG4gICAgICAgIHZhciBjb25maWcgPSBzZWxmLmNvbmZpZztcbiAgICAgICAgaWYgKGNvbmZpZy53ZWVrTnVtYmVycyA9PT0gZmFsc2UgJiYgY29uZmlnLnNob3dNb250aHMgPT09IDEpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjb25maWcubm9DYWxlbmRhciAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY2FsZW5kYXJDb250YWluZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF5c1dpZHRoID0gKHNlbGYuZGF5cy5vZmZzZXRXaWR0aCArIDEpICogY29uZmlnLnNob3dNb250aHM7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lci5zdHlsZS53aWR0aCA9IGRheXNXaWR0aCArIFwicHhcIjtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS53aWR0aCA9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXlzV2lkdGggK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLndlZWtXcmFwcGVyICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBzZWxmLndlZWtXcmFwcGVyLm9mZnNldFdpZHRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHhcIjtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5yZW1vdmVQcm9wZXJ0eShcInZpc2liaWxpdHlcIik7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUucmVtb3ZlUHJvcGVydHkoXCJkaXNwbGF5XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZVRpbWUoZSkge1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHREYXRlID0gc2VsZi5jb25maWcubWluRGF0ZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgICAgY29tcGFyZURhdGVzKG5ldyBEYXRlKCksIHNlbGYuY29uZmlnLm1pbkRhdGUpID49IDBcbiAgICAgICAgICAgICAgICA/IG5ldyBEYXRlKClcbiAgICAgICAgICAgICAgICA6IG5ldyBEYXRlKHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0VGltZSgpKTtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0cyA9IGdldERlZmF1bHRIb3VycyhzZWxmLmNvbmZpZyk7XG4gICAgICAgICAgICBkZWZhdWx0RGF0ZS5zZXRIb3VycyhkZWZhdWx0cy5ob3VycywgZGVmYXVsdHMubWludXRlcywgZGVmYXVsdHMuc2Vjb25kcywgZGVmYXVsdERhdGUuZ2V0TWlsbGlzZWNvbmRzKCkpO1xuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gW2RlZmF1bHREYXRlXTtcbiAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqID0gZGVmYXVsdERhdGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUgIT09IHVuZGVmaW5lZCAmJiBlLnR5cGUgIT09IFwiYmx1clwiKSB7XG4gICAgICAgICAgICB0aW1lV3JhcHBlcihlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJldlZhbHVlID0gc2VsZi5faW5wdXQudmFsdWU7XG4gICAgICAgIHNldEhvdXJzRnJvbUlucHV0cygpO1xuICAgICAgICB1cGRhdGVWYWx1ZSgpO1xuICAgICAgICBpZiAoc2VsZi5faW5wdXQudmFsdWUgIT09IHByZXZWYWx1ZSkge1xuICAgICAgICAgICAgc2VsZi5fZGVib3VuY2VkQ2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYW1wbTJtaWxpdGFyeShob3VyLCBhbVBNKSB7XG4gICAgICAgIHJldHVybiAoaG91ciAlIDEyKSArIDEyICogaW50KGFtUE0gPT09IHNlbGYubDEwbi5hbVBNWzFdKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gbWlsaXRhcnkyYW1wbShob3VyKSB7XG4gICAgICAgIHN3aXRjaCAoaG91ciAlIDI0KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICAgIHJldHVybiAxMjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXIgJSAxMjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBzZXRIb3Vyc0Zyb21JbnB1dHMoKSB7XG4gICAgICAgIGlmIChzZWxmLmhvdXJFbGVtZW50ID09PSB1bmRlZmluZWQgfHwgc2VsZi5taW51dGVFbGVtZW50ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBob3VycyA9IChwYXJzZUludChzZWxmLmhvdXJFbGVtZW50LnZhbHVlLnNsaWNlKC0yKSwgMTApIHx8IDApICUgMjQsIG1pbnV0ZXMgPSAocGFyc2VJbnQoc2VsZi5taW51dGVFbGVtZW50LnZhbHVlLCAxMCkgfHwgMCkgJSA2MCwgc2Vjb25kcyA9IHNlbGYuc2Vjb25kRWxlbWVudCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IChwYXJzZUludChzZWxmLnNlY29uZEVsZW1lbnQudmFsdWUsIDEwKSB8fCAwKSAlIDYwXG4gICAgICAgICAgICA6IDA7XG4gICAgICAgIGlmIChzZWxmLmFtUE0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgaG91cnMgPSBhbXBtMm1pbGl0YXJ5KGhvdXJzLCBzZWxmLmFtUE0udGV4dENvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaW1pdE1pbkhvdXJzID0gc2VsZi5jb25maWcubWluVGltZSAhPT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAoc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgICAgIHNlbGYubWluRGF0ZUhhc1RpbWUgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiAmJlxuICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiwgc2VsZi5jb25maWcubWluRGF0ZSwgdHJ1ZSkgPT09XG4gICAgICAgICAgICAgICAgICAgIDApO1xuICAgICAgICB2YXIgbGltaXRNYXhIb3VycyA9IHNlbGYuY29uZmlnLm1heFRpbWUgIT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1heERhdGUgJiZcbiAgICAgICAgICAgICAgICBzZWxmLm1heERhdGVIYXNUaW1lICYmXG4gICAgICAgICAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogJiZcbiAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmosIHNlbGYuY29uZmlnLm1heERhdGUsIHRydWUpID09PVxuICAgICAgICAgICAgICAgICAgICAwKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1heFRpbWUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcubWluVGltZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5UaW1lID4gc2VsZi5jb25maWcubWF4VGltZSkge1xuICAgICAgICAgICAgdmFyIG1pbkJvdW5kID0gY2FsY3VsYXRlU2Vjb25kc1NpbmNlTWlkbmlnaHQoc2VsZi5jb25maWcubWluVGltZS5nZXRIb3VycygpLCBzZWxmLmNvbmZpZy5taW5UaW1lLmdldE1pbnV0ZXMoKSwgc2VsZi5jb25maWcubWluVGltZS5nZXRTZWNvbmRzKCkpO1xuICAgICAgICAgICAgdmFyIG1heEJvdW5kID0gY2FsY3VsYXRlU2Vjb25kc1NpbmNlTWlkbmlnaHQoc2VsZi5jb25maWcubWF4VGltZS5nZXRIb3VycygpLCBzZWxmLmNvbmZpZy5tYXhUaW1lLmdldE1pbnV0ZXMoKSwgc2VsZi5jb25maWcubWF4VGltZS5nZXRTZWNvbmRzKCkpO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gY2FsY3VsYXRlU2Vjb25kc1NpbmNlTWlkbmlnaHQoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRUaW1lID4gbWF4Qm91bmQgJiYgY3VycmVudFRpbWUgPCBtaW5Cb3VuZCkge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBwYXJzZVNlY29uZHMobWluQm91bmQpO1xuICAgICAgICAgICAgICAgIGhvdXJzID0gcmVzdWx0WzBdO1xuICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSByZXN1bHRbMV07XG4gICAgICAgICAgICAgICAgc2Vjb25kcyA9IHJlc3VsdFsyXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChsaW1pdE1heEhvdXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1heFRpbWUgPSBzZWxmLmNvbmZpZy5tYXhUaW1lICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5tYXhUaW1lXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcubWF4RGF0ZTtcbiAgICAgICAgICAgICAgICBob3VycyA9IE1hdGgubWluKGhvdXJzLCBtYXhUaW1lLmdldEhvdXJzKCkpO1xuICAgICAgICAgICAgICAgIGlmIChob3VycyA9PT0gbWF4VGltZS5nZXRIb3VycygpKVxuICAgICAgICAgICAgICAgICAgICBtaW51dGVzID0gTWF0aC5taW4obWludXRlcywgbWF4VGltZS5nZXRNaW51dGVzKCkpO1xuICAgICAgICAgICAgICAgIGlmIChtaW51dGVzID09PSBtYXhUaW1lLmdldE1pbnV0ZXMoKSlcbiAgICAgICAgICAgICAgICAgICAgc2Vjb25kcyA9IE1hdGgubWluKHNlY29uZHMsIG1heFRpbWUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsaW1pdE1pbkhvdXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1pblRpbWUgPSBzZWxmLmNvbmZpZy5taW5UaW1lICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5taW5UaW1lXG4gICAgICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcubWluRGF0ZTtcbiAgICAgICAgICAgICAgICBob3VycyA9IE1hdGgubWF4KGhvdXJzLCBtaW5UaW1lLmdldEhvdXJzKCkpO1xuICAgICAgICAgICAgICAgIGlmIChob3VycyA9PT0gbWluVGltZS5nZXRIb3VycygpICYmIG1pbnV0ZXMgPCBtaW5UaW1lLmdldE1pbnV0ZXMoKSlcbiAgICAgICAgICAgICAgICAgICAgbWludXRlcyA9IG1pblRpbWUuZ2V0TWludXRlcygpO1xuICAgICAgICAgICAgICAgIGlmIChtaW51dGVzID09PSBtaW5UaW1lLmdldE1pbnV0ZXMoKSlcbiAgICAgICAgICAgICAgICAgICAgc2Vjb25kcyA9IE1hdGgubWF4KHNlY29uZHMsIG1pblRpbWUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZXRIb3Vycyhob3VycywgbWludXRlcywgc2Vjb25kcyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldEhvdXJzRnJvbURhdGUoZGF0ZU9iaikge1xuICAgICAgICB2YXIgZGF0ZSA9IGRhdGVPYmogfHwgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmo7XG4gICAgICAgIGlmIChkYXRlICYmIGRhdGUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICBzZXRIb3VycyhkYXRlLmdldEhvdXJzKCksIGRhdGUuZ2V0TWludXRlcygpLCBkYXRlLmdldFNlY29uZHMoKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0SG91cnMoaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMpIHtcbiAgICAgICAgaWYgKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLnNldEhvdXJzKGhvdXJzICUgMjQsIG1pbnV0ZXMsIHNlY29uZHMgfHwgMCwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmLmhvdXJFbGVtZW50IHx8ICFzZWxmLm1pbnV0ZUVsZW1lbnQgfHwgc2VsZi5pc01vYmlsZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudC52YWx1ZSA9IHBhZCghc2VsZi5jb25maWcudGltZV8yNGhyXG4gICAgICAgICAgICA/ICgoMTIgKyBob3VycykgJSAxMikgKyAxMiAqIGludChob3VycyAlIDEyID09PSAwKVxuICAgICAgICAgICAgOiBob3Vycyk7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC52YWx1ZSA9IHBhZChtaW51dGVzKTtcbiAgICAgICAgaWYgKHNlbGYuYW1QTSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgc2VsZi5hbVBNLnRleHRDb250ZW50ID0gc2VsZi5sMTBuLmFtUE1baW50KGhvdXJzID49IDEyKV07XG4gICAgICAgIGlmIChzZWxmLnNlY29uZEVsZW1lbnQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuc2Vjb25kRWxlbWVudC52YWx1ZSA9IHBhZChzZWNvbmRzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb25ZZWFySW5wdXQoZXZlbnQpIHtcbiAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZXZlbnQpO1xuICAgICAgICB2YXIgeWVhciA9IHBhcnNlSW50KGV2ZW50VGFyZ2V0LnZhbHVlKSArIChldmVudC5kZWx0YSB8fCAwKTtcbiAgICAgICAgaWYgKHllYXIgLyAxMDAwID4gMSB8fFxuICAgICAgICAgICAgKGV2ZW50LmtleSA9PT0gXCJFbnRlclwiICYmICEvW15cXGRdLy50ZXN0KHllYXIudG9TdHJpbmcoKSkpKSB7XG4gICAgICAgICAgICBjaGFuZ2VZZWFyKHllYXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJpbmQoZWxlbWVudCwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKGV2ZW50IGluc3RhbmNlb2YgQXJyYXkpXG4gICAgICAgICAgICByZXR1cm4gZXZlbnQuZm9yRWFjaChmdW5jdGlvbiAoZXYpIHsgcmV0dXJuIGJpbmQoZWxlbWVudCwgZXYsIGhhbmRsZXIsIG9wdGlvbnMpOyB9KTtcbiAgICAgICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBBcnJheSlcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmZvckVhY2goZnVuY3Rpb24gKGVsKSB7IHJldHVybiBiaW5kKGVsLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7IH0pO1xuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgICAgICBzZWxmLl9oYW5kbGVycy5wdXNoKHtcbiAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTsgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRyaWdnZXJDaGFuZ2UoKSB7XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uQ2hhbmdlXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBiaW5kRXZlbnRzKCkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcud3JhcCkge1xuICAgICAgICAgICAgW1wib3BlblwiLCBcImNsb3NlXCIsIFwidG9nZ2xlXCIsIFwiY2xlYXJcIl0uZm9yRWFjaChmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChzZWxmLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltkYXRhLVwiICsgZXZ0ICsgXCJdXCIpLCBmdW5jdGlvbiAoZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJpbmQoZWwsIFwiY2xpY2tcIiwgc2VsZltldnRdKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICBzZXR1cE1vYmlsZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZWJvdW5jZWRSZXNpemUgPSBkZWJvdW5jZShvblJlc2l6ZSwgNTApO1xuICAgICAgICBzZWxmLl9kZWJvdW5jZWRDaGFuZ2UgPSBkZWJvdW5jZSh0cmlnZ2VyQ2hhbmdlLCBERUJPVU5DRURfQ0hBTkdFX01TKTtcbiAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lciAmJiAhL2lQaG9uZXxpUGFkfGlQb2QvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKVxuICAgICAgICAgICAgYmluZChzZWxmLmRheXNDb250YWluZXIsIFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIilcbiAgICAgICAgICAgICAgICAgICAgb25Nb3VzZU92ZXIoZ2V0RXZlbnRUYXJnZXQoZSkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwia2V5ZG93blwiLCBvbktleURvd24pO1xuICAgICAgICBpZiAoc2VsZi5jYWxlbmRhckNvbnRhaW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBiaW5kKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwia2V5ZG93blwiLCBvbktleURvd24pO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2VsZi5jb25maWcuaW5saW5lICYmICFzZWxmLmNvbmZpZy5zdGF0aWMpXG4gICAgICAgICAgICBiaW5kKHdpbmRvdywgXCJyZXNpemVcIiwgZGVib3VuY2VkUmVzaXplKTtcbiAgICAgICAgaWYgKHdpbmRvdy5vbnRvdWNoc3RhcnQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIGJpbmQod2luZG93LmRvY3VtZW50LCBcInRvdWNoc3RhcnRcIiwgZG9jdW1lbnRDbGljayk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGJpbmQod2luZG93LmRvY3VtZW50LCBcIm1vdXNlZG93blwiLCBkb2N1bWVudENsaWNrKTtcbiAgICAgICAgYmluZCh3aW5kb3cuZG9jdW1lbnQsIFwiZm9jdXNcIiwgZG9jdW1lbnRDbGljaywgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuY2xpY2tPcGVucyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgYmluZChzZWxmLl9pbnB1dCwgXCJmb2N1c1wiLCBzZWxmLm9wZW4pO1xuICAgICAgICAgICAgYmluZChzZWxmLl9pbnB1dCwgXCJjbGlja1wiLCBzZWxmLm9wZW4pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmRheXNDb250YWluZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgYmluZChzZWxmLm1vbnRoTmF2LCBcImNsaWNrXCIsIG9uTW9udGhOYXZDbGljayk7XG4gICAgICAgICAgICBiaW5kKHNlbGYubW9udGhOYXYsIFtcImtleXVwXCIsIFwiaW5jcmVtZW50XCJdLCBvblllYXJJbnB1dCk7XG4gICAgICAgICAgICBiaW5kKHNlbGYuZGF5c0NvbnRhaW5lciwgXCJjbGlja1wiLCBzZWxlY3REYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi50aW1lQ29udGFpbmVyICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgIHNlbGYubWludXRlRWxlbWVudCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBzZWxUZXh0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0RXZlbnRUYXJnZXQoZSkuc2VsZWN0KCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYmluZChzZWxmLnRpbWVDb250YWluZXIsIFtcImluY3JlbWVudFwiXSwgdXBkYXRlVGltZSk7XG4gICAgICAgICAgICBiaW5kKHNlbGYudGltZUNvbnRhaW5lciwgXCJibHVyXCIsIHVwZGF0ZVRpbWUsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi50aW1lQ29udGFpbmVyLCBcImNsaWNrXCIsIHRpbWVJbmNyZW1lbnQpO1xuICAgICAgICAgICAgYmluZChbc2VsZi5ob3VyRWxlbWVudCwgc2VsZi5taW51dGVFbGVtZW50XSwgW1wiZm9jdXNcIiwgXCJjbGlja1wiXSwgc2VsVGV4dCk7XG4gICAgICAgICAgICBpZiAoc2VsZi5zZWNvbmRFbGVtZW50ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgYmluZChzZWxmLnNlY29uZEVsZW1lbnQsIFwiZm9jdXNcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5zZWNvbmRFbGVtZW50ICYmIHNlbGYuc2Vjb25kRWxlbWVudC5zZWxlY3QoKTsgfSk7XG4gICAgICAgICAgICBpZiAoc2VsZi5hbVBNICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBiaW5kKHNlbGYuYW1QTSwgXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaW1lKGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5hbGxvd0lucHV0KSB7XG4gICAgICAgICAgICBiaW5kKHNlbGYuX2lucHV0LCBcImJsdXJcIiwgb25CbHVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBqdW1wVG9EYXRlKGp1bXBEYXRlLCB0cmlnZ2VyQ2hhbmdlKSB7XG4gICAgICAgIHZhciBqdW1wVG8gPSBqdW1wRGF0ZSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IHNlbGYucGFyc2VEYXRlKGp1bXBEYXRlKVxuICAgICAgICAgICAgOiBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiB8fFxuICAgICAgICAgICAgICAgIChzZWxmLmNvbmZpZy5taW5EYXRlICYmIHNlbGYuY29uZmlnLm1pbkRhdGUgPiBzZWxmLm5vd1xuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLm1pbkRhdGVcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5tYXhEYXRlICYmIHNlbGYuY29uZmlnLm1heERhdGUgPCBzZWxmLm5vd1xuICAgICAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5tYXhEYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHNlbGYubm93KTtcbiAgICAgICAgdmFyIG9sZFllYXIgPSBzZWxmLmN1cnJlbnRZZWFyO1xuICAgICAgICB2YXIgb2xkTW9udGggPSBzZWxmLmN1cnJlbnRNb250aDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChqdW1wVG8gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPSBqdW1wVG8uZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IGp1bXBUby5nZXRNb250aCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBlLm1lc3NhZ2UgPSBcIkludmFsaWQgZGF0ZSBzdXBwbGllZDogXCIgKyBqdW1wVG87XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5lcnJvckhhbmRsZXIoZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2UgJiYgc2VsZi5jdXJyZW50WWVhciAhPT0gb2xkWWVhcikge1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25ZZWFyQ2hhbmdlXCIpO1xuICAgICAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlICYmXG4gICAgICAgICAgICAoc2VsZi5jdXJyZW50WWVhciAhPT0gb2xkWWVhciB8fCBzZWxmLmN1cnJlbnRNb250aCAhPT0gb2xkTW9udGgpKSB7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk1vbnRoQ2hhbmdlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYucmVkcmF3KCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHRpbWVJbmNyZW1lbnQoZSkge1xuICAgICAgICB2YXIgZXZlbnRUYXJnZXQgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgaWYgKH5ldmVudFRhcmdldC5jbGFzc05hbWUuaW5kZXhPZihcImFycm93XCIpKVxuICAgICAgICAgICAgaW5jcmVtZW50TnVtSW5wdXQoZSwgZXZlbnRUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYXJyb3dVcFwiKSA/IDEgOiAtMSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluY3JlbWVudE51bUlucHV0KGUsIGRlbHRhLCBpbnB1dEVsZW0pIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IGUgJiYgZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgIHZhciBpbnB1dCA9IGlucHV0RWxlbSB8fFxuICAgICAgICAgICAgKHRhcmdldCAmJiB0YXJnZXQucGFyZW50Tm9kZSAmJiB0YXJnZXQucGFyZW50Tm9kZS5maXJzdENoaWxkKTtcbiAgICAgICAgdmFyIGV2ZW50ID0gY3JlYXRlRXZlbnQoXCJpbmNyZW1lbnRcIik7XG4gICAgICAgIGV2ZW50LmRlbHRhID0gZGVsdGE7XG4gICAgICAgIGlucHV0ICYmIGlucHV0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZCgpIHtcbiAgICAgICAgdmFyIGZyYWdtZW50ID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItY2FsZW5kYXJcIik7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIudGFiSW5kZXggPSAtMTtcbiAgICAgICAgaWYgKCFzZWxmLmNvbmZpZy5ub0NhbGVuZGFyKSB7XG4gICAgICAgICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChidWlsZE1vbnRoTmF2KCkpO1xuICAgICAgICAgICAgc2VsZi5pbm5lckNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItaW5uZXJDb250YWluZXJcIik7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcud2Vla051bWJlcnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2EgPSBidWlsZFdlZWtzKCksIHdlZWtXcmFwcGVyID0gX2Eud2Vla1dyYXBwZXIsIHdlZWtOdW1iZXJzID0gX2Eud2Vla051bWJlcnM7XG4gICAgICAgICAgICAgICAgc2VsZi5pbm5lckNvbnRhaW5lci5hcHBlbmRDaGlsZCh3ZWVrV3JhcHBlcik7XG4gICAgICAgICAgICAgICAgc2VsZi53ZWVrTnVtYmVycyA9IHdlZWtOdW1iZXJzO1xuICAgICAgICAgICAgICAgIHNlbGYud2Vla1dyYXBwZXIgPSB3ZWVrV3JhcHBlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYuckNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3ItckNvbnRhaW5lclwiKTtcbiAgICAgICAgICAgIHNlbGYuckNvbnRhaW5lci5hcHBlbmRDaGlsZChidWlsZFdlZWtkYXlzKCkpO1xuICAgICAgICAgICAgaWYgKCFzZWxmLmRheXNDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLWRheXNcIik7XG4gICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyLnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBidWlsZERheXMoKTtcbiAgICAgICAgICAgIHNlbGYuckNvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxmLmRheXNDb250YWluZXIpO1xuICAgICAgICAgICAgc2VsZi5pbm5lckNvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxmLnJDb250YWluZXIpO1xuICAgICAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoc2VsZi5pbm5lckNvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmVuYWJsZVRpbWUpIHtcbiAgICAgICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGJ1aWxkVGltZSgpKTtcbiAgICAgICAgfVxuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcInJhbmdlTW9kZVwiLCBzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFuaW1hdGVcIiwgc2VsZi5jb25maWcuYW5pbWF0ZSA9PT0gdHJ1ZSk7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwibXVsdGlNb250aFwiLCBzZWxmLmNvbmZpZy5zaG93TW9udGhzID4gMSk7XG4gICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICAgICAgICB2YXIgY3VzdG9tQXBwZW5kID0gc2VsZi5jb25maWcuYXBwZW5kVG8gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcuYXBwZW5kVG8ubm9kZVR5cGUgIT09IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmlubGluZSB8fCBzZWxmLmNvbmZpZy5zdGF0aWMpIHtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChzZWxmLmNvbmZpZy5pbmxpbmUgPyBcImlubGluZVwiIDogXCJzdGF0aWNcIik7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuaW5saW5lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFjdXN0b21BcHBlbmQgJiYgc2VsZi5lbGVtZW50LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBzZWxmLl9pbnB1dC5uZXh0U2libGluZyk7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VsZi5jb25maWcuYXBwZW5kVG8gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcuYXBwZW5kVG8uYXBwZW5kQ2hpbGQoc2VsZi5jYWxlbmRhckNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuc3RhdGljKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXdyYXBwZXJcIik7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuZWxlbWVudC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUod3JhcHBlciwgc2VsZi5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHNlbGYuZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuYWx0SW5wdXQpXG4gICAgICAgICAgICAgICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoc2VsZi5hbHRJbnB1dCk7XG4gICAgICAgICAgICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChzZWxmLmNhbGVuZGFyQ29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLnN0YXRpYyAmJiAhc2VsZi5jb25maWcuaW5saW5lKVxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLmFwcGVuZFRvICE9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLmFwcGVuZFRvXG4gICAgICAgICAgICAgICAgOiB3aW5kb3cuZG9jdW1lbnQuYm9keSkuYXBwZW5kQ2hpbGQoc2VsZi5jYWxlbmRhckNvbnRhaW5lcik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNyZWF0ZURheShjbGFzc05hbWUsIGRhdGUsIF9kYXlOdW1iZXIsIGkpIHtcbiAgICAgICAgdmFyIGRhdGVJc0VuYWJsZWQgPSBpc0VuYWJsZWQoZGF0ZSwgdHJ1ZSksIGRheUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBjbGFzc05hbWUsIGRhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkpO1xuICAgICAgICBkYXlFbGVtZW50LmRhdGVPYmogPSBkYXRlO1xuICAgICAgICBkYXlFbGVtZW50LiRpID0gaTtcbiAgICAgICAgZGF5RWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHNlbGYuZm9ybWF0RGF0ZShkYXRlLCBzZWxmLmNvbmZpZy5hcmlhRGF0ZUZvcm1hdCkpO1xuICAgICAgICBpZiAoY2xhc3NOYW1lLmluZGV4T2YoXCJoaWRkZW5cIikgPT09IC0xICYmXG4gICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZSwgc2VsZi5ub3cpID09PSAwKSB7XG4gICAgICAgICAgICBzZWxmLnRvZGF5RGF0ZUVsZW0gPSBkYXlFbGVtZW50O1xuICAgICAgICAgICAgZGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidG9kYXlcIik7XG4gICAgICAgICAgICBkYXlFbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtY3VycmVudFwiLCBcImRhdGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGVJc0VuYWJsZWQpIHtcbiAgICAgICAgICAgIGRheUVsZW1lbnQudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgIGlmIChpc0RhdGVTZWxlY3RlZChkYXRlKSkge1xuICAgICAgICAgICAgICAgIGRheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInNlbGVjdGVkXCIpO1xuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlRWxlbSA9IGRheUVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIikge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGVDbGFzcyhkYXlFbGVtZW50LCBcInN0YXJ0UmFuZ2VcIiwgc2VsZi5zZWxlY3RlZERhdGVzWzBdICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzBdLCB0cnVlKSA9PT0gMCk7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZUNsYXNzKGRheUVsZW1lbnQsIFwiZW5kUmFuZ2VcIiwgc2VsZi5zZWxlY3RlZERhdGVzWzFdICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wYXJlRGF0ZXMoZGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzFdLCB0cnVlKSA9PT0gMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjbGFzc05hbWUgPT09IFwibmV4dE1vbnRoRGF5XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJpblJhbmdlXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRheUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImZsYXRwaWNrci1kaXNhYmxlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiKSB7XG4gICAgICAgICAgICBpZiAoaXNEYXRlSW5SYW5nZShkYXRlKSAmJiAhaXNEYXRlU2VsZWN0ZWQoZGF0ZSkpXG4gICAgICAgICAgICAgICAgZGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaW5SYW5nZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi53ZWVrTnVtYmVycyAmJlxuICAgICAgICAgICAgc2VsZi5jb25maWcuc2hvd01vbnRocyA9PT0gMSAmJlxuICAgICAgICAgICAgY2xhc3NOYW1lICE9PSBcInByZXZNb250aERheVwiICYmXG4gICAgICAgICAgICBpICUgNyA9PT0gNikge1xuICAgICAgICAgICAgc2VsZi53ZWVrTnVtYmVycy5pbnNlcnRBZGphY2VudEhUTUwoXCJiZWZvcmVlbmRcIiwgXCI8c3BhbiBjbGFzcz0nZmxhdHBpY2tyLWRheSc+XCIgKyBzZWxmLmNvbmZpZy5nZXRXZWVrKGRhdGUpICsgXCI8L3NwYW4+XCIpO1xuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uRGF5Q3JlYXRlXCIsIGRheUVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gZGF5RWxlbWVudDtcbiAgICB9XG4gICAgZnVuY3Rpb24gZm9jdXNPbkRheUVsZW0odGFyZ2V0Tm9kZSkge1xuICAgICAgICB0YXJnZXROb2RlLmZvY3VzKCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5tb2RlID09PSBcInJhbmdlXCIpXG4gICAgICAgICAgICBvbk1vdXNlT3Zlcih0YXJnZXROb2RlKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0Rmlyc3RBdmFpbGFibGVEYXkoZGVsdGEpIHtcbiAgICAgICAgdmFyIHN0YXJ0TW9udGggPSBkZWx0YSA+IDAgPyAwIDogc2VsZi5jb25maWcuc2hvd01vbnRocyAtIDE7XG4gICAgICAgIHZhciBlbmRNb250aCA9IGRlbHRhID4gMCA/IHNlbGYuY29uZmlnLnNob3dNb250aHMgOiAtMTtcbiAgICAgICAgZm9yICh2YXIgbSA9IHN0YXJ0TW9udGg7IG0gIT0gZW5kTW9udGg7IG0gKz0gZGVsdGEpIHtcbiAgICAgICAgICAgIHZhciBtb250aCA9IHNlbGYuZGF5c0NvbnRhaW5lci5jaGlsZHJlblttXTtcbiAgICAgICAgICAgIHZhciBzdGFydEluZGV4ID0gZGVsdGEgPiAwID8gMCA6IG1vbnRoLmNoaWxkcmVuLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgZW5kSW5kZXggPSBkZWx0YSA+IDAgPyBtb250aC5jaGlsZHJlbi5sZW5ndGggOiAtMTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydEluZGV4OyBpICE9IGVuZEluZGV4OyBpICs9IGRlbHRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSBtb250aC5jaGlsZHJlbltpXTtcbiAgICAgICAgICAgICAgICBpZiAoYy5jbGFzc05hbWUuaW5kZXhPZihcImhpZGRlblwiKSA9PT0gLTEgJiYgaXNFbmFibGVkKGMuZGF0ZU9iaikpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldE5leHRBdmFpbGFibGVEYXkoY3VycmVudCwgZGVsdGEpIHtcbiAgICAgICAgdmFyIGdpdmVuTW9udGggPSBjdXJyZW50LmNsYXNzTmFtZS5pbmRleE9mKFwiTW9udGhcIikgPT09IC0xXG4gICAgICAgICAgICA/IGN1cnJlbnQuZGF0ZU9iai5nZXRNb250aCgpXG4gICAgICAgICAgICA6IHNlbGYuY3VycmVudE1vbnRoO1xuICAgICAgICB2YXIgZW5kTW9udGggPSBkZWx0YSA+IDAgPyBzZWxmLmNvbmZpZy5zaG93TW9udGhzIDogLTE7XG4gICAgICAgIHZhciBsb29wRGVsdGEgPSBkZWx0YSA+IDAgPyAxIDogLTE7XG4gICAgICAgIGZvciAodmFyIG0gPSBnaXZlbk1vbnRoIC0gc2VsZi5jdXJyZW50TW9udGg7IG0gIT0gZW5kTW9udGg7IG0gKz0gbG9vcERlbHRhKSB7XG4gICAgICAgICAgICB2YXIgbW9udGggPSBzZWxmLmRheXNDb250YWluZXIuY2hpbGRyZW5bbV07XG4gICAgICAgICAgICB2YXIgc3RhcnRJbmRleCA9IGdpdmVuTW9udGggLSBzZWxmLmN1cnJlbnRNb250aCA9PT0gbVxuICAgICAgICAgICAgICAgID8gY3VycmVudC4kaSArIGRlbHRhXG4gICAgICAgICAgICAgICAgOiBkZWx0YSA8IDBcbiAgICAgICAgICAgICAgICAgICAgPyBtb250aC5jaGlsZHJlbi5sZW5ndGggLSAxXG4gICAgICAgICAgICAgICAgICAgIDogMDtcbiAgICAgICAgICAgIHZhciBudW1Nb250aERheXMgPSBtb250aC5jaGlsZHJlbi5sZW5ndGg7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnRJbmRleDsgaSA+PSAwICYmIGkgPCBudW1Nb250aERheXMgJiYgaSAhPSAoZGVsdGEgPiAwID8gbnVtTW9udGhEYXlzIDogLTEpOyBpICs9IGxvb3BEZWx0YSkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gbW9udGguY2hpbGRyZW5baV07XG4gICAgICAgICAgICAgICAgaWYgKGMuY2xhc3NOYW1lLmluZGV4T2YoXCJoaWRkZW5cIikgPT09IC0xICYmXG4gICAgICAgICAgICAgICAgICAgIGlzRW5hYmxlZChjLmRhdGVPYmopICYmXG4gICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKGN1cnJlbnQuJGkgLSBpKSA+PSBNYXRoLmFicyhkZWx0YSkpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb2N1c09uRGF5RWxlbShjKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZWxmLmNoYW5nZU1vbnRoKGxvb3BEZWx0YSk7XG4gICAgICAgIGZvY3VzT25EYXkoZ2V0Rmlyc3RBdmFpbGFibGVEYXkobG9vcERlbHRhKSwgMCk7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGZvY3VzT25EYXkoY3VycmVudCwgb2Zmc2V0KSB7XG4gICAgICAgIHZhciBhY3RpdmVFbGVtZW50ID0gZ2V0Q2xvc2VzdEFjdGl2ZUVsZW1lbnQoKTtcbiAgICAgICAgdmFyIGRheUZvY3VzZWQgPSBpc0luVmlldyhhY3RpdmVFbGVtZW50IHx8IGRvY3VtZW50LmJvZHkpO1xuICAgICAgICB2YXIgc3RhcnRFbGVtID0gY3VycmVudCAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICA/IGN1cnJlbnRcbiAgICAgICAgICAgIDogZGF5Rm9jdXNlZFxuICAgICAgICAgICAgICAgID8gYWN0aXZlRWxlbWVudFxuICAgICAgICAgICAgICAgIDogc2VsZi5zZWxlY3RlZERhdGVFbGVtICE9PSB1bmRlZmluZWQgJiYgaXNJblZpZXcoc2VsZi5zZWxlY3RlZERhdGVFbGVtKVxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuc2VsZWN0ZWREYXRlRWxlbVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYudG9kYXlEYXRlRWxlbSAhPT0gdW5kZWZpbmVkICYmIGlzSW5WaWV3KHNlbGYudG9kYXlEYXRlRWxlbSlcbiAgICAgICAgICAgICAgICAgICAgICAgID8gc2VsZi50b2RheURhdGVFbGVtXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGdldEZpcnN0QXZhaWxhYmxlRGF5KG9mZnNldCA+IDAgPyAxIDogLTEpO1xuICAgICAgICBpZiAoc3RhcnRFbGVtID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNlbGYuX2lucHV0LmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWRheUZvY3VzZWQpIHtcbiAgICAgICAgICAgIGZvY3VzT25EYXlFbGVtKHN0YXJ0RWxlbSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBnZXROZXh0QXZhaWxhYmxlRGF5KHN0YXJ0RWxlbSwgb2Zmc2V0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZE1vbnRoRGF5cyh5ZWFyLCBtb250aCkge1xuICAgICAgICB2YXIgZmlyc3RPZk1vbnRoID0gKG5ldyBEYXRlKHllYXIsIG1vbnRoLCAxKS5nZXREYXkoKSAtIHNlbGYubDEwbi5maXJzdERheU9mV2VlayArIDcpICUgNztcbiAgICAgICAgdmFyIHByZXZNb250aERheXMgPSBzZWxmLnV0aWxzLmdldERheXNJbk1vbnRoKChtb250aCAtIDEgKyAxMikgJSAxMiwgeWVhcik7XG4gICAgICAgIHZhciBkYXlzSW5Nb250aCA9IHNlbGYudXRpbHMuZ2V0RGF5c0luTW9udGgobW9udGgsIHllYXIpLCBkYXlzID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwgaXNNdWx0aU1vbnRoID0gc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEsIHByZXZNb250aERheUNsYXNzID0gaXNNdWx0aU1vbnRoID8gXCJwcmV2TW9udGhEYXkgaGlkZGVuXCIgOiBcInByZXZNb250aERheVwiLCBuZXh0TW9udGhEYXlDbGFzcyA9IGlzTXVsdGlNb250aCA/IFwibmV4dE1vbnRoRGF5IGhpZGRlblwiIDogXCJuZXh0TW9udGhEYXlcIjtcbiAgICAgICAgdmFyIGRheU51bWJlciA9IHByZXZNb250aERheXMgKyAxIC0gZmlyc3RPZk1vbnRoLCBkYXlJbmRleCA9IDA7XG4gICAgICAgIGZvciAoOyBkYXlOdW1iZXIgPD0gcHJldk1vbnRoRGF5czsgZGF5TnVtYmVyKyssIGRheUluZGV4KyspIHtcbiAgICAgICAgICAgIGRheXMuYXBwZW5kQ2hpbGQoY3JlYXRlRGF5KFwiZmxhdHBpY2tyLWRheSBcIiArIHByZXZNb250aERheUNsYXNzLCBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheU51bWJlciksIGRheU51bWJlciwgZGF5SW5kZXgpKTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGRheU51bWJlciA9IDE7IGRheU51bWJlciA8PSBkYXlzSW5Nb250aDsgZGF5TnVtYmVyKyssIGRheUluZGV4KyspIHtcbiAgICAgICAgICAgIGRheXMuYXBwZW5kQ2hpbGQoY3JlYXRlRGF5KFwiZmxhdHBpY2tyLWRheVwiLCBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5TnVtYmVyKSwgZGF5TnVtYmVyLCBkYXlJbmRleCkpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGRheU51bSA9IGRheXNJbk1vbnRoICsgMTsgZGF5TnVtIDw9IDQyIC0gZmlyc3RPZk1vbnRoICYmXG4gICAgICAgICAgICAoc2VsZi5jb25maWcuc2hvd01vbnRocyA9PT0gMSB8fCBkYXlJbmRleCAlIDcgIT09IDApOyBkYXlOdW0rKywgZGF5SW5kZXgrKykge1xuICAgICAgICAgICAgZGF5cy5hcHBlbmRDaGlsZChjcmVhdGVEYXkoXCJmbGF0cGlja3ItZGF5IFwiICsgbmV4dE1vbnRoRGF5Q2xhc3MsIG5ldyBEYXRlKHllYXIsIG1vbnRoICsgMSwgZGF5TnVtICUgZGF5c0luTW9udGgpLCBkYXlOdW0sIGRheUluZGV4KSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRheUNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJkYXlDb250YWluZXJcIik7XG4gICAgICAgIGRheUNvbnRhaW5lci5hcHBlbmRDaGlsZChkYXlzKTtcbiAgICAgICAgcmV0dXJuIGRheUNvbnRhaW5lcjtcbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGREYXlzKCkge1xuICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjbGVhck5vZGUoc2VsZi5kYXlzQ29udGFpbmVyKTtcbiAgICAgICAgaWYgKHNlbGYud2Vla051bWJlcnMpXG4gICAgICAgICAgICBjbGVhck5vZGUoc2VsZi53ZWVrTnVtYmVycyk7XG4gICAgICAgIHZhciBmcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuY29uZmlnLnNob3dNb250aHM7IGkrKykge1xuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZShzZWxmLmN1cnJlbnRZZWFyLCBzZWxmLmN1cnJlbnRNb250aCwgMSk7XG4gICAgICAgICAgICBkLnNldE1vbnRoKHNlbGYuY3VycmVudE1vbnRoICsgaSk7XG4gICAgICAgICAgICBmcmFnLmFwcGVuZENoaWxkKGJ1aWxkTW9udGhEYXlzKGQuZ2V0RnVsbFllYXIoKSwgZC5nZXRNb250aCgpKSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWcpO1xuICAgICAgICBzZWxmLmRheXMgPSBzZWxmLmRheXNDb250YWluZXIuZmlyc3RDaGlsZDtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIiAmJiBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBvbk1vdXNlT3ZlcigpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkTW9udGhTd2l0Y2goKSB7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5zaG93TW9udGhzID4gMSB8fFxuICAgICAgICAgICAgc2VsZi5jb25maWcubW9udGhTZWxlY3RvclR5cGUgIT09IFwiZHJvcGRvd25cIilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHNob3VsZEJ1aWxkTW9udGggPSBmdW5jdGlvbiAobW9udGgpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5taW5EYXRlICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID09PSBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkgJiZcbiAgICAgICAgICAgICAgICBtb250aCA8IHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0TW9udGgoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhKHNlbGYuY29uZmlnLm1heERhdGUgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPT09IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKSAmJlxuICAgICAgICAgICAgICAgIG1vbnRoID4gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRNb250aCgpKTtcbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lci50YWJJbmRleCA9IC0xO1xuICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTI7IGkrKykge1xuICAgICAgICAgICAgaWYgKCFzaG91bGRCdWlsZE1vbnRoKGkpKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgdmFyIG1vbnRoID0gY3JlYXRlRWxlbWVudChcIm9wdGlvblwiLCBcImZsYXRwaWNrci1tb250aERyb3Bkb3duLW1vbnRoXCIpO1xuICAgICAgICAgICAgbW9udGgudmFsdWUgPSBuZXcgRGF0ZShzZWxmLmN1cnJlbnRZZWFyLCBpKS5nZXRNb250aCgpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBtb250aC50ZXh0Q29udGVudCA9IG1vbnRoVG9TdHIoaSwgc2VsZi5jb25maWcuc2hvcnRoYW5kQ3VycmVudE1vbnRoLCBzZWxmLmwxMG4pO1xuICAgICAgICAgICAgbW9udGgudGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgIGlmIChzZWxmLmN1cnJlbnRNb250aCA9PT0gaSkge1xuICAgICAgICAgICAgICAgIG1vbnRoLnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIuYXBwZW5kQ2hpbGQobW9udGgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkTW9udGgoKSB7XG4gICAgICAgIHZhciBjb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLW1vbnRoXCIpO1xuICAgICAgICB2YXIgbW9udGhOYXZGcmFnbWVudCA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIHZhciBtb250aEVsZW1lbnQ7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5zaG93TW9udGhzID4gMSB8fFxuICAgICAgICAgICAgc2VsZi5jb25maWcubW9udGhTZWxlY3RvclR5cGUgPT09IFwic3RhdGljXCIpIHtcbiAgICAgICAgICAgIG1vbnRoRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiY3VyLW1vbnRoXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lciA9IGNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIiwgXCJmbGF0cGlja3ItbW9udGhEcm9wZG93bi1tb250aHNcIik7XG4gICAgICAgICAgICBzZWxmLm1vbnRoc0Ryb3Bkb3duQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgc2VsZi5sMTBuLm1vbnRoQXJpYUxhYmVsKTtcbiAgICAgICAgICAgIGJpbmQoc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lciwgXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkTW9udGggPSBwYXJzZUludCh0YXJnZXQudmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICBzZWxmLmNoYW5nZU1vbnRoKHNlbGVjdGVkTW9udGggLSBzZWxmLmN1cnJlbnRNb250aCk7XG4gICAgICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25Nb250aENoYW5nZVwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICAgICAgbW9udGhFbGVtZW50ID0gc2VsZi5tb250aHNEcm9wZG93bkNvbnRhaW5lcjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgeWVhcklucHV0ID0gY3JlYXRlTnVtYmVySW5wdXQoXCJjdXIteWVhclwiLCB7IHRhYmluZGV4OiBcIi0xXCIgfSk7XG4gICAgICAgIHZhciB5ZWFyRWxlbWVudCA9IHllYXJJbnB1dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuICAgICAgICB5ZWFyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHNlbGYubDEwbi55ZWFyQXJpYUxhYmVsKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1pbkRhdGUpIHtcbiAgICAgICAgICAgIHllYXJFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1pblwiLCBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1heERhdGUpIHtcbiAgICAgICAgICAgIHllYXJFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heFwiLCBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB5ZWFyRWxlbWVudC5kaXNhYmxlZCA9XG4gICAgICAgICAgICAgICAgISFzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0RnVsbFllYXIoKSA9PT0gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjdXJyZW50TW9udGggPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLWN1cnJlbnQtbW9udGhcIik7XG4gICAgICAgIGN1cnJlbnRNb250aC5hcHBlbmRDaGlsZChtb250aEVsZW1lbnQpO1xuICAgICAgICBjdXJyZW50TW9udGguYXBwZW5kQ2hpbGQoeWVhcklucHV0KTtcbiAgICAgICAgbW9udGhOYXZGcmFnbWVudC5hcHBlbmRDaGlsZChjdXJyZW50TW9udGgpO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobW9udGhOYXZGcmFnbWVudCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb250YWluZXI6IGNvbnRhaW5lcixcbiAgICAgICAgICAgIHllYXJFbGVtZW50OiB5ZWFyRWxlbWVudCxcbiAgICAgICAgICAgIG1vbnRoRWxlbWVudDogbW9udGhFbGVtZW50LFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZE1vbnRocygpIHtcbiAgICAgICAgY2xlYXJOb2RlKHNlbGYubW9udGhOYXYpO1xuICAgICAgICBzZWxmLm1vbnRoTmF2LmFwcGVuZENoaWxkKHNlbGYucHJldk1vbnRoTmF2KTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLnNob3dNb250aHMpIHtcbiAgICAgICAgICAgIHNlbGYueWVhckVsZW1lbnRzID0gW107XG4gICAgICAgICAgICBzZWxmLm1vbnRoRWxlbWVudHMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBtID0gc2VsZi5jb25maWcuc2hvd01vbnRoczsgbS0tOykge1xuICAgICAgICAgICAgdmFyIG1vbnRoID0gYnVpbGRNb250aCgpO1xuICAgICAgICAgICAgc2VsZi55ZWFyRWxlbWVudHMucHVzaChtb250aC55ZWFyRWxlbWVudCk7XG4gICAgICAgICAgICBzZWxmLm1vbnRoRWxlbWVudHMucHVzaChtb250aC5tb250aEVsZW1lbnQpO1xuICAgICAgICAgICAgc2VsZi5tb250aE5hdi5hcHBlbmRDaGlsZChtb250aC5jb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYubW9udGhOYXYuYXBwZW5kQ2hpbGQoc2VsZi5uZXh0TW9udGhOYXYpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBidWlsZE1vbnRoTmF2KCkge1xuICAgICAgICBzZWxmLm1vbnRoTmF2ID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci1tb250aHNcIik7XG4gICAgICAgIHNlbGYueWVhckVsZW1lbnRzID0gW107XG4gICAgICAgIHNlbGYubW9udGhFbGVtZW50cyA9IFtdO1xuICAgICAgICBzZWxmLnByZXZNb250aE5hdiA9IGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLXByZXYtbW9udGhcIik7XG4gICAgICAgIHNlbGYucHJldk1vbnRoTmF2LmlubmVySFRNTCA9IHNlbGYuY29uZmlnLnByZXZBcnJvdztcbiAgICAgICAgc2VsZi5uZXh0TW9udGhOYXYgPSBjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci1uZXh0LW1vbnRoXCIpO1xuICAgICAgICBzZWxmLm5leHRNb250aE5hdi5pbm5lckhUTUwgPSBzZWxmLmNvbmZpZy5uZXh0QXJyb3c7XG4gICAgICAgIGJ1aWxkTW9udGhzKCk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLCBcIl9oaWRlUHJldk1vbnRoQXJyb3dcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLl9faGlkZVByZXZNb250aEFycm93OyB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoYm9vbCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLl9faGlkZVByZXZNb250aEFycm93ICE9PSBib29sKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYucHJldk1vbnRoTmF2LCBcImZsYXRwaWNrci1kaXNhYmxlZFwiLCBib29sKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fX2hpZGVQcmV2TW9udGhBcnJvdyA9IGJvb2w7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLCBcIl9oaWRlTmV4dE1vbnRoQXJyb3dcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLl9faGlkZU5leHRNb250aEFycm93OyB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoYm9vbCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLl9faGlkZU5leHRNb250aEFycm93ICE9PSBib29sKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYubmV4dE1vbnRoTmF2LCBcImZsYXRwaWNrci1kaXNhYmxlZFwiLCBib29sKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fX2hpZGVOZXh0TW9udGhBcnJvdyA9IGJvb2w7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYuY3VycmVudFllYXJFbGVtZW50ID0gc2VsZi55ZWFyRWxlbWVudHNbMF07XG4gICAgICAgIHVwZGF0ZU5hdmlnYXRpb25DdXJyZW50TW9udGgoKTtcbiAgICAgICAgcmV0dXJuIHNlbGYubW9udGhOYXY7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkVGltZSgpIHtcbiAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaGFzVGltZVwiKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIpXG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJub0NhbGVuZGFyXCIpO1xuICAgICAgICB2YXIgZGVmYXVsdHMgPSBnZXREZWZhdWx0SG91cnMoc2VsZi5jb25maWcpO1xuICAgICAgICBzZWxmLnRpbWVDb250YWluZXIgPSBjcmVhdGVFbGVtZW50KFwiZGl2XCIsIFwiZmxhdHBpY2tyLXRpbWVcIik7XG4gICAgICAgIHNlbGYudGltZUNvbnRhaW5lci50YWJJbmRleCA9IC0xO1xuICAgICAgICB2YXIgc2VwYXJhdG9yID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3ItdGltZS1zZXBhcmF0b3JcIiwgXCI6XCIpO1xuICAgICAgICB2YXIgaG91cklucHV0ID0gY3JlYXRlTnVtYmVySW5wdXQoXCJmbGF0cGlja3ItaG91clwiLCB7XG4gICAgICAgICAgICBcImFyaWEtbGFiZWxcIjogc2VsZi5sMTBuLmhvdXJBcmlhTGFiZWwsXG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLmhvdXJFbGVtZW50ID0gaG91cklucHV0LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF07XG4gICAgICAgIHZhciBtaW51dGVJbnB1dCA9IGNyZWF0ZU51bWJlcklucHV0KFwiZmxhdHBpY2tyLW1pbnV0ZVwiLCB7XG4gICAgICAgICAgICBcImFyaWEtbGFiZWxcIjogc2VsZi5sMTBuLm1pbnV0ZUFyaWFMYWJlbCxcbiAgICAgICAgfSk7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudCA9IG1pbnV0ZUlucHV0LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIilbMF07XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQudGFiSW5kZXggPSBzZWxmLm1pbnV0ZUVsZW1lbnQudGFiSW5kZXggPSAtMTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudC52YWx1ZSA9IHBhZChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9ialxuICAgICAgICAgICAgPyBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iai5nZXRIb3VycygpXG4gICAgICAgICAgICA6IHNlbGYuY29uZmlnLnRpbWVfMjRoclxuICAgICAgICAgICAgICAgID8gZGVmYXVsdHMuaG91cnNcbiAgICAgICAgICAgICAgICA6IG1pbGl0YXJ5MmFtcG0oZGVmYXVsdHMuaG91cnMpKTtcbiAgICAgICAgc2VsZi5taW51dGVFbGVtZW50LnZhbHVlID0gcGFkKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqXG4gICAgICAgICAgICA/IHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLmdldE1pbnV0ZXMoKVxuICAgICAgICAgICAgOiBkZWZhdWx0cy5taW51dGVzKTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzdGVwXCIsIHNlbGYuY29uZmlnLmhvdXJJbmNyZW1lbnQudG9TdHJpbmcoKSk7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzdGVwXCIsIHNlbGYuY29uZmlnLm1pbnV0ZUluY3JlbWVudC50b1N0cmluZygpKTtcbiAgICAgICAgc2VsZi5ob3VyRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtaW5cIiwgc2VsZi5jb25maWcudGltZV8yNGhyID8gXCIwXCIgOiBcIjFcIik7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4XCIsIHNlbGYuY29uZmlnLnRpbWVfMjRociA/IFwiMjNcIiA6IFwiMTJcIik7XG4gICAgICAgIHNlbGYuaG91ckVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4bGVuZ3RoXCIsIFwiMlwiKTtcbiAgICAgICAgc2VsZi5taW51dGVFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1pblwiLCBcIjBcIik7XG4gICAgICAgIHNlbGYubWludXRlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtYXhcIiwgXCI1OVwiKTtcbiAgICAgICAgc2VsZi5taW51dGVFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1heGxlbmd0aFwiLCBcIjJcIik7XG4gICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChob3VySW5wdXQpO1xuICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VwYXJhdG9yKTtcbiAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKG1pbnV0ZUlucHV0KTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLnRpbWVfMjRocilcbiAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidGltZTI0aHJcIik7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5lbmFibGVTZWNvbmRzKSB7XG4gICAgICAgICAgICBzZWxmLnRpbWVDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImhhc1NlY29uZHNcIik7XG4gICAgICAgICAgICB2YXIgc2Vjb25kSW5wdXQgPSBjcmVhdGVOdW1iZXJJbnB1dChcImZsYXRwaWNrci1zZWNvbmRcIik7XG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQgPSBzZWNvbmRJbnB1dC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnZhbHVlID0gcGFkKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqXG4gICAgICAgICAgICAgICAgPyBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iai5nZXRTZWNvbmRzKClcbiAgICAgICAgICAgICAgICA6IGRlZmF1bHRzLnNlY29uZHMpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnNldEF0dHJpYnV0ZShcInN0ZXBcIiwgc2VsZi5taW51dGVFbGVtZW50LmdldEF0dHJpYnV0ZShcInN0ZXBcIikpO1xuICAgICAgICAgICAgc2VsZi5zZWNvbmRFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1pblwiLCBcIjBcIik7XG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4XCIsIFwiNTlcIik7XG4gICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWF4bGVuZ3RoXCIsIFwiMlwiKTtcbiAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVFbGVtZW50KFwic3BhblwiLCBcImZsYXRwaWNrci10aW1lLXNlcGFyYXRvclwiLCBcIjpcIikpO1xuICAgICAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKHNlY29uZElucHV0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXNlbGYuY29uZmlnLnRpbWVfMjRocikge1xuICAgICAgICAgICAgc2VsZi5hbVBNID0gY3JlYXRlRWxlbWVudChcInNwYW5cIiwgXCJmbGF0cGlja3ItYW0tcG1cIiwgc2VsZi5sMTBuLmFtUE1baW50KChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9ialxuICAgICAgICAgICAgICAgID8gc2VsZi5ob3VyRWxlbWVudC52YWx1ZVxuICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcuZGVmYXVsdEhvdXIpID4gMTEpXSk7XG4gICAgICAgICAgICBzZWxmLmFtUE0udGl0bGUgPSBzZWxmLmwxMG4udG9nZ2xlVGl0bGU7XG4gICAgICAgICAgICBzZWxmLmFtUE0udGFiSW5kZXggPSAtMTtcbiAgICAgICAgICAgIHNlbGYudGltZUNvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxmLmFtUE0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZWxmLnRpbWVDb250YWluZXI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGJ1aWxkV2Vla2RheXMoKSB7XG4gICAgICAgIGlmICghc2VsZi53ZWVrZGF5Q29udGFpbmVyKVxuICAgICAgICAgICAgc2VsZi53ZWVrZGF5Q29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci13ZWVrZGF5c1wiKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgY2xlYXJOb2RlKHNlbGYud2Vla2RheUNvbnRhaW5lcik7XG4gICAgICAgIGZvciAodmFyIGkgPSBzZWxmLmNvbmZpZy5zaG93TW9udGhzOyBpLS07KSB7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci13ZWVrZGF5Y29udGFpbmVyXCIpO1xuICAgICAgICAgICAgc2VsZi53ZWVrZGF5Q29udGFpbmVyLmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICAgICAgdXBkYXRlV2Vla2RheXMoKTtcbiAgICAgICAgcmV0dXJuIHNlbGYud2Vla2RheUNvbnRhaW5lcjtcbiAgICB9XG4gICAgZnVuY3Rpb24gdXBkYXRlV2Vla2RheXMoKSB7XG4gICAgICAgIGlmICghc2VsZi53ZWVrZGF5Q29udGFpbmVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpcnN0RGF5T2ZXZWVrID0gc2VsZi5sMTBuLmZpcnN0RGF5T2ZXZWVrO1xuICAgICAgICB2YXIgd2Vla2RheXMgPSBfX3NwcmVhZEFycmF5cyhzZWxmLmwxMG4ud2Vla2RheXMuc2hvcnRoYW5kKTtcbiAgICAgICAgaWYgKGZpcnN0RGF5T2ZXZWVrID4gMCAmJiBmaXJzdERheU9mV2VlayA8IHdlZWtkYXlzLmxlbmd0aCkge1xuICAgICAgICAgICAgd2Vla2RheXMgPSBfX3NwcmVhZEFycmF5cyh3ZWVrZGF5cy5zcGxpY2UoZmlyc3REYXlPZldlZWssIHdlZWtkYXlzLmxlbmd0aCksIHdlZWtkYXlzLnNwbGljZSgwLCBmaXJzdERheU9mV2VlaykpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSBzZWxmLmNvbmZpZy5zaG93TW9udGhzOyBpLS07KSB7XG4gICAgICAgICAgICBzZWxmLndlZWtkYXlDb250YWluZXIuY2hpbGRyZW5baV0uaW5uZXJIVE1MID0gXCJcXG4gICAgICA8c3BhbiBjbGFzcz0nZmxhdHBpY2tyLXdlZWtkYXknPlxcbiAgICAgICAgXCIgKyB3ZWVrZGF5cy5qb2luKFwiPC9zcGFuPjxzcGFuIGNsYXNzPSdmbGF0cGlja3Itd2Vla2RheSc+XCIpICsgXCJcXG4gICAgICA8L3NwYW4+XFxuICAgICAgXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gYnVpbGRXZWVrcygpIHtcbiAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaGFzV2Vla3NcIik7XG4gICAgICAgIHZhciB3ZWVrV3JhcHBlciA9IGNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgXCJmbGF0cGlja3Itd2Vla3dyYXBwZXJcIik7XG4gICAgICAgIHdlZWtXcmFwcGVyLmFwcGVuZENoaWxkKGNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIFwiZmxhdHBpY2tyLXdlZWtkYXlcIiwgc2VsZi5sMTBuLndlZWtBYmJyZXZpYXRpb24pKTtcbiAgICAgICAgdmFyIHdlZWtOdW1iZXJzID0gY3JlYXRlRWxlbWVudChcImRpdlwiLCBcImZsYXRwaWNrci13ZWVrc1wiKTtcbiAgICAgICAgd2Vla1dyYXBwZXIuYXBwZW5kQ2hpbGQod2Vla051bWJlcnMpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2Vla1dyYXBwZXI6IHdlZWtXcmFwcGVyLFxuICAgICAgICAgICAgd2Vla051bWJlcnM6IHdlZWtOdW1iZXJzLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmdW5jdGlvbiBjaGFuZ2VNb250aCh2YWx1ZSwgaXNPZmZzZXQpIHtcbiAgICAgICAgaWYgKGlzT2Zmc2V0ID09PSB2b2lkIDApIHsgaXNPZmZzZXQgPSB0cnVlOyB9XG4gICAgICAgIHZhciBkZWx0YSA9IGlzT2Zmc2V0ID8gdmFsdWUgOiB2YWx1ZSAtIHNlbGYuY3VycmVudE1vbnRoO1xuICAgICAgICBpZiAoKGRlbHRhIDwgMCAmJiBzZWxmLl9oaWRlUHJldk1vbnRoQXJyb3cgPT09IHRydWUpIHx8XG4gICAgICAgICAgICAoZGVsdGEgPiAwICYmIHNlbGYuX2hpZGVOZXh0TW9udGhBcnJvdyA9PT0gdHJ1ZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNlbGYuY3VycmVudE1vbnRoICs9IGRlbHRhO1xuICAgICAgICBpZiAoc2VsZi5jdXJyZW50TW9udGggPCAwIHx8IHNlbGYuY3VycmVudE1vbnRoID4gMTEpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgKz0gc2VsZi5jdXJyZW50TW9udGggPiAxMSA/IDEgOiAtMTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoID0gKHNlbGYuY3VycmVudE1vbnRoICsgMTIpICUgMTI7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblllYXJDaGFuZ2VcIik7XG4gICAgICAgICAgICBidWlsZE1vbnRoU3dpdGNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnVpbGREYXlzKCk7XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uTW9udGhDaGFuZ2VcIik7XG4gICAgICAgIHVwZGF0ZU5hdmlnYXRpb25DdXJyZW50TW9udGgoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2xlYXIodHJpZ2dlckNoYW5nZUV2ZW50LCB0b0luaXRpYWwpIHtcbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2VFdmVudCA9PT0gdm9pZCAwKSB7IHRyaWdnZXJDaGFuZ2VFdmVudCA9IHRydWU7IH1cbiAgICAgICAgaWYgKHRvSW5pdGlhbCA9PT0gdm9pZCAwKSB7IHRvSW5pdGlhbCA9IHRydWU7IH1cbiAgICAgICAgc2VsZi5pbnB1dC52YWx1ZSA9IFwiXCI7XG4gICAgICAgIGlmIChzZWxmLmFsdElucHV0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnZhbHVlID0gXCJcIjtcbiAgICAgICAgaWYgKHNlbGYubW9iaWxlSW5wdXQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQudmFsdWUgPSBcIlwiO1xuICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMgPSBbXTtcbiAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICh0b0luaXRpYWwgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPSBzZWxmLl9pbml0aWFsRGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBzZWxmLl9pbml0aWFsRGF0ZS5nZXRNb250aCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5lbmFibGVUaW1lID09PSB0cnVlKSB7XG4gICAgICAgICAgICB2YXIgX2EgPSBnZXREZWZhdWx0SG91cnMoc2VsZi5jb25maWcpLCBob3VycyA9IF9hLmhvdXJzLCBtaW51dGVzID0gX2EubWludXRlcywgc2Vjb25kcyA9IF9hLnNlY29uZHM7XG4gICAgICAgICAgICBzZXRIb3Vycyhob3VycywgbWludXRlcywgc2Vjb25kcyk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5yZWRyYXcoKTtcbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2VFdmVudClcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uQ2hhbmdlXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICAgc2VsZi5pc09wZW4gPSBmYWxzZTtcbiAgICAgICAgaWYgKCFzZWxmLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5jYWxlbmRhckNvbnRhaW5lciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxmLl9pbnB1dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5faW5wdXQuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNsb3NlXCIpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uRGVzdHJveVwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IHNlbGYuX2hhbmRsZXJzLmxlbmd0aDsgaS0tOykge1xuICAgICAgICAgICAgc2VsZi5faGFuZGxlcnNbaV0ucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5faGFuZGxlcnMgPSBbXTtcbiAgICAgICAgaWYgKHNlbGYubW9iaWxlSW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChzZWxmLm1vYmlsZUlucHV0LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNlbGYubW9iaWxlSW5wdXQpO1xuICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLmNhbGVuZGFyQ29udGFpbmVyICYmIHNlbGYuY2FsZW5kYXJDb250YWluZXIucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLnN0YXRpYyAmJiBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgd3JhcHBlciA9IHNlbGYuY2FsZW5kYXJDb250YWluZXIucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICB3cmFwcGVyLmxhc3RDaGlsZCAmJiB3cmFwcGVyLnJlbW92ZUNoaWxkKHdyYXBwZXIubGFzdENoaWxkKTtcbiAgICAgICAgICAgICAgICBpZiAod3JhcHBlci5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICh3cmFwcGVyLmZpcnN0Q2hpbGQpXG4gICAgICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHdyYXBwZXIuZmlyc3RDaGlsZCwgd3JhcHBlcik7XG4gICAgICAgICAgICAgICAgICAgIHdyYXBwZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh3cmFwcGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNlbGYuY2FsZW5kYXJDb250YWluZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZWxmLmFsdElucHV0KSB7XG4gICAgICAgICAgICBzZWxmLmlucHV0LnR5cGUgPSBcInRleHRcIjtcbiAgICAgICAgICAgIGlmIChzZWxmLmFsdElucHV0LnBhcmVudE5vZGUpXG4gICAgICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNlbGYuYWx0SW5wdXQpO1xuICAgICAgICAgICAgZGVsZXRlIHNlbGYuYWx0SW5wdXQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuaW5wdXQpIHtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQudHlwZSA9IHNlbGYuaW5wdXQuX3R5cGU7XG4gICAgICAgICAgICBzZWxmLmlucHV0LmNsYXNzTGlzdC5yZW1vdmUoXCJmbGF0cGlja3ItaW5wdXRcIik7XG4gICAgICAgICAgICBzZWxmLmlucHV0LnJlbW92ZUF0dHJpYnV0ZShcInJlYWRvbmx5XCIpO1xuICAgICAgICB9XG4gICAgICAgIFtcbiAgICAgICAgICAgIFwiX3Nob3dUaW1lSW5wdXRcIixcbiAgICAgICAgICAgIFwibGF0ZXN0U2VsZWN0ZWREYXRlT2JqXCIsXG4gICAgICAgICAgICBcIl9oaWRlTmV4dE1vbnRoQXJyb3dcIixcbiAgICAgICAgICAgIFwiX2hpZGVQcmV2TW9udGhBcnJvd1wiLFxuICAgICAgICAgICAgXCJfX2hpZGVOZXh0TW9udGhBcnJvd1wiLFxuICAgICAgICAgICAgXCJfX2hpZGVQcmV2TW9udGhBcnJvd1wiLFxuICAgICAgICAgICAgXCJpc01vYmlsZVwiLFxuICAgICAgICAgICAgXCJpc09wZW5cIixcbiAgICAgICAgICAgIFwic2VsZWN0ZWREYXRlRWxlbVwiLFxuICAgICAgICAgICAgXCJtaW5EYXRlSGFzVGltZVwiLFxuICAgICAgICAgICAgXCJtYXhEYXRlSGFzVGltZVwiLFxuICAgICAgICAgICAgXCJkYXlzXCIsXG4gICAgICAgICAgICBcImRheXNDb250YWluZXJcIixcbiAgICAgICAgICAgIFwiX2lucHV0XCIsXG4gICAgICAgICAgICBcIl9wb3NpdGlvbkVsZW1lbnRcIixcbiAgICAgICAgICAgIFwiaW5uZXJDb250YWluZXJcIixcbiAgICAgICAgICAgIFwickNvbnRhaW5lclwiLFxuICAgICAgICAgICAgXCJtb250aE5hdlwiLFxuICAgICAgICAgICAgXCJ0b2RheURhdGVFbGVtXCIsXG4gICAgICAgICAgICBcImNhbGVuZGFyQ29udGFpbmVyXCIsXG4gICAgICAgICAgICBcIndlZWtkYXlDb250YWluZXJcIixcbiAgICAgICAgICAgIFwicHJldk1vbnRoTmF2XCIsXG4gICAgICAgICAgICBcIm5leHRNb250aE5hdlwiLFxuICAgICAgICAgICAgXCJtb250aHNEcm9wZG93bkNvbnRhaW5lclwiLFxuICAgICAgICAgICAgXCJjdXJyZW50TW9udGhFbGVtZW50XCIsXG4gICAgICAgICAgICBcImN1cnJlbnRZZWFyRWxlbWVudFwiLFxuICAgICAgICAgICAgXCJuYXZpZ2F0aW9uQ3VycmVudE1vbnRoXCIsXG4gICAgICAgICAgICBcInNlbGVjdGVkRGF0ZUVsZW1cIixcbiAgICAgICAgICAgIFwiY29uZmlnXCIsXG4gICAgICAgIF0uZm9yRWFjaChmdW5jdGlvbiAoaykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBkZWxldGUgc2VsZltrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChfKSB7IH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzQ2FsZW5kYXJFbGVtKGVsZW0pIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuY2FsZW5kYXJDb250YWluZXIuY29udGFpbnMoZWxlbSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGRvY3VtZW50Q2xpY2soZSkge1xuICAgICAgICBpZiAoc2VsZi5pc09wZW4gJiYgIXNlbGYuY29uZmlnLmlubGluZSkge1xuICAgICAgICAgICAgdmFyIGV2ZW50VGFyZ2V0XzEgPSBnZXRFdmVudFRhcmdldChlKTtcbiAgICAgICAgICAgIHZhciBpc0NhbGVuZGFyRWxlbWVudCA9IGlzQ2FsZW5kYXJFbGVtKGV2ZW50VGFyZ2V0XzEpO1xuICAgICAgICAgICAgdmFyIGlzSW5wdXQgPSBldmVudFRhcmdldF8xID09PSBzZWxmLmlucHV0IHx8XG4gICAgICAgICAgICAgICAgZXZlbnRUYXJnZXRfMSA9PT0gc2VsZi5hbHRJbnB1dCB8fFxuICAgICAgICAgICAgICAgIHNlbGYuZWxlbWVudC5jb250YWlucyhldmVudFRhcmdldF8xKSB8fFxuICAgICAgICAgICAgICAgIChlLnBhdGggJiZcbiAgICAgICAgICAgICAgICAgICAgZS5wYXRoLmluZGV4T2YgJiZcbiAgICAgICAgICAgICAgICAgICAgKH5lLnBhdGguaW5kZXhPZihzZWxmLmlucHV0KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgfmUucGF0aC5pbmRleE9mKHNlbGYuYWx0SW5wdXQpKSk7XG4gICAgICAgICAgICB2YXIgbG9zdEZvY3VzID0gIWlzSW5wdXQgJiZcbiAgICAgICAgICAgICAgICAhaXNDYWxlbmRhckVsZW1lbnQgJiZcbiAgICAgICAgICAgICAgICAhaXNDYWxlbmRhckVsZW0oZS5yZWxhdGVkVGFyZ2V0KTtcbiAgICAgICAgICAgIHZhciBpc0lnbm9yZWQgPSAhc2VsZi5jb25maWcuaWdub3JlZEZvY3VzRWxlbWVudHMuc29tZShmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtLmNvbnRhaW5zKGV2ZW50VGFyZ2V0XzEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAobG9zdEZvY3VzICYmIGlzSWdub3JlZCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5hbGxvd0lucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2V0RGF0ZShzZWxmLl9pbnB1dC52YWx1ZSwgZmFsc2UsIHNlbGYuY29uZmlnLmFsdElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLmFsdEZvcm1hdFxuICAgICAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYudGltZUNvbnRhaW5lciAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubWludXRlRWxlbWVudCAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnZhbHVlICE9PSBcIlwiICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQudmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaW1lKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICBpZiAoc2VsZi5jb25maWcgJiZcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubW9kZSA9PT0gXCJyYW5nZVwiICYmXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPT09IDEpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2xlYXIoZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNoYW5nZVllYXIobmV3WWVhcikge1xuICAgICAgICBpZiAoIW5ld1llYXIgfHxcbiAgICAgICAgICAgIChzZWxmLmNvbmZpZy5taW5EYXRlICYmIG5ld1llYXIgPCBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkpIHx8XG4gICAgICAgICAgICAoc2VsZi5jb25maWcubWF4RGF0ZSAmJiBuZXdZZWFyID4gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIG5ld1llYXJOdW0gPSBuZXdZZWFyLCBpc05ld1llYXIgPSBzZWxmLmN1cnJlbnRZZWFyICE9PSBuZXdZZWFyTnVtO1xuICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID0gbmV3WWVhck51bSB8fCBzZWxmLmN1cnJlbnRZZWFyO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubWF4RGF0ZSAmJlxuICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9PT0gc2VsZi5jb25maWcubWF4RGF0ZS5nZXRGdWxsWWVhcigpKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRNb250aCA9IE1hdGgubWluKHNlbGYuY29uZmlnLm1heERhdGUuZ2V0TW9udGgoKSwgc2VsZi5jdXJyZW50TW9udGgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXIgPT09IHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0RnVsbFllYXIoKSkge1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBNYXRoLm1heChzZWxmLmNvbmZpZy5taW5EYXRlLmdldE1vbnRoKCksIHNlbGYuY3VycmVudE1vbnRoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNOZXdZZWFyKSB7XG4gICAgICAgICAgICBzZWxmLnJlZHJhdygpO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25ZZWFyQ2hhbmdlXCIpO1xuICAgICAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzRW5hYmxlZChkYXRlLCB0aW1lbGVzcykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmICh0aW1lbGVzcyA9PT0gdm9pZCAwKSB7IHRpbWVsZXNzID0gdHJ1ZTsgfVxuICAgICAgICB2YXIgZGF0ZVRvQ2hlY2sgPSBzZWxmLnBhcnNlRGF0ZShkYXRlLCB1bmRlZmluZWQsIHRpbWVsZXNzKTtcbiAgICAgICAgaWYgKChzZWxmLmNvbmZpZy5taW5EYXRlICYmXG4gICAgICAgICAgICBkYXRlVG9DaGVjayAmJlxuICAgICAgICAgICAgY29tcGFyZURhdGVzKGRhdGVUb0NoZWNrLCBzZWxmLmNvbmZpZy5taW5EYXRlLCB0aW1lbGVzcyAhPT0gdW5kZWZpbmVkID8gdGltZWxlc3MgOiAhc2VsZi5taW5EYXRlSGFzVGltZSkgPCAwKSB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLm1heERhdGUgJiZcbiAgICAgICAgICAgICAgICBkYXRlVG9DaGVjayAmJlxuICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhkYXRlVG9DaGVjaywgc2VsZi5jb25maWcubWF4RGF0ZSwgdGltZWxlc3MgIT09IHVuZGVmaW5lZCA/IHRpbWVsZXNzIDogIXNlbGYubWF4RGF0ZUhhc1RpbWUpID4gMCkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICghc2VsZi5jb25maWcuZW5hYmxlICYmIHNlbGYuY29uZmlnLmRpc2FibGUubGVuZ3RoID09PSAwKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIGlmIChkYXRlVG9DaGVjayA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB2YXIgYm9vbCA9ICEhc2VsZi5jb25maWcuZW5hYmxlLCBhcnJheSA9IChfYSA9IHNlbGYuY29uZmlnLmVuYWJsZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogc2VsZi5jb25maWcuZGlzYWJsZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGQgPSB2b2lkIDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZCA9IGFycmF5W2ldO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkID09PSBcImZ1bmN0aW9uXCIgJiZcbiAgICAgICAgICAgICAgICBkKGRhdGVUb0NoZWNrKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gYm9vbDtcbiAgICAgICAgICAgIGVsc2UgaWYgKGQgaW5zdGFuY2VvZiBEYXRlICYmXG4gICAgICAgICAgICAgICAgZGF0ZVRvQ2hlY2sgIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgIGQuZ2V0VGltZSgpID09PSBkYXRlVG9DaGVjay5nZXRUaW1lKCkpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvb2w7XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgZCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHZhciBwYXJzZWQgPSBzZWxmLnBhcnNlRGF0ZShkLCB1bmRlZmluZWQsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZWQgJiYgcGFyc2VkLmdldFRpbWUoKSA9PT0gZGF0ZVRvQ2hlY2suZ2V0VGltZSgpXG4gICAgICAgICAgICAgICAgICAgID8gYm9vbFxuICAgICAgICAgICAgICAgICAgICA6ICFib29sO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGQgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgICAgICBkYXRlVG9DaGVjayAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgZC5mcm9tICYmXG4gICAgICAgICAgICAgICAgZC50byAmJlxuICAgICAgICAgICAgICAgIGRhdGVUb0NoZWNrLmdldFRpbWUoKSA+PSBkLmZyb20uZ2V0VGltZSgpICYmXG4gICAgICAgICAgICAgICAgZGF0ZVRvQ2hlY2suZ2V0VGltZSgpIDw9IGQudG8uZ2V0VGltZSgpKVxuICAgICAgICAgICAgICAgIHJldHVybiBib29sO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhYm9vbDtcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNJblZpZXcoZWxlbSkge1xuICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm4gKGVsZW0uY2xhc3NOYW1lLmluZGV4T2YoXCJoaWRkZW5cIikgPT09IC0xICYmXG4gICAgICAgICAgICAgICAgZWxlbS5jbGFzc05hbWUuaW5kZXhPZihcImZsYXRwaWNrci1kaXNhYmxlZFwiKSA9PT0gLTEgJiZcbiAgICAgICAgICAgICAgICBzZWxmLmRheXNDb250YWluZXIuY29udGFpbnMoZWxlbSkpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uQmx1cihlKSB7XG4gICAgICAgIHZhciBpc0lucHV0ID0gZS50YXJnZXQgPT09IHNlbGYuX2lucHV0O1xuICAgICAgICB2YXIgdmFsdWVDaGFuZ2VkID0gc2VsZi5faW5wdXQudmFsdWUudHJpbUVuZCgpICE9PSBnZXREYXRlU3RyKCk7XG4gICAgICAgIGlmIChpc0lucHV0ICYmXG4gICAgICAgICAgICB2YWx1ZUNoYW5nZWQgJiZcbiAgICAgICAgICAgICEoZS5yZWxhdGVkVGFyZ2V0ICYmIGlzQ2FsZW5kYXJFbGVtKGUucmVsYXRlZFRhcmdldCkpKSB7XG4gICAgICAgICAgICBzZWxmLnNldERhdGUoc2VsZi5faW5wdXQudmFsdWUsIHRydWUsIGUudGFyZ2V0ID09PSBzZWxmLmFsdElucHV0XG4gICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5hbHRGb3JtYXRcbiAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uS2V5RG93bihlKSB7XG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICB2YXIgaXNJbnB1dCA9IHNlbGYuY29uZmlnLndyYXBcbiAgICAgICAgICAgID8gZWxlbWVudC5jb250YWlucyhldmVudFRhcmdldClcbiAgICAgICAgICAgIDogZXZlbnRUYXJnZXQgPT09IHNlbGYuX2lucHV0O1xuICAgICAgICB2YXIgYWxsb3dJbnB1dCA9IHNlbGYuY29uZmlnLmFsbG93SW5wdXQ7XG4gICAgICAgIHZhciBhbGxvd0tleWRvd24gPSBzZWxmLmlzT3BlbiAmJiAoIWFsbG93SW5wdXQgfHwgIWlzSW5wdXQpO1xuICAgICAgICB2YXIgYWxsb3dJbmxpbmVLZXlkb3duID0gc2VsZi5jb25maWcuaW5saW5lICYmIGlzSW5wdXQgJiYgIWFsbG93SW5wdXQ7XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT09IDEzICYmIGlzSW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChhbGxvd0lucHV0KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zZXREYXRlKHNlbGYuX2lucHV0LnZhbHVlLCB0cnVlLCBldmVudFRhcmdldCA9PT0gc2VsZi5hbHRJbnB1dFxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLmFsdEZvcm1hdFxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpO1xuICAgICAgICAgICAgICAgIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXZlbnRUYXJnZXQuYmx1cigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vcGVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNDYWxlbmRhckVsZW0oZXZlbnRUYXJnZXQpIHx8XG4gICAgICAgICAgICBhbGxvd0tleWRvd24gfHxcbiAgICAgICAgICAgIGFsbG93SW5saW5lS2V5ZG93bikge1xuICAgICAgICAgICAgdmFyIGlzVGltZU9iaiA9ICEhc2VsZi50aW1lQ29udGFpbmVyICYmXG4gICAgICAgICAgICAgICAgc2VsZi50aW1lQ29udGFpbmVyLmNvbnRhaW5zKGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzVGltZU9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGltZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNBbmRDbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdERhdGUoZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjc6XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNBbmRDbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgY2FzZSA0NjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSW5wdXQgJiYgIXNlbGYuY29uZmlnLmFsbG93SW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNUaW1lT2JqICYmICFpc0lucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlRWxlbWVudCA9IGdldENsb3Nlc3RBY3RpdmVFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5kYXlzQ29udGFpbmVyICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYWxsb3dJbnB1dCA9PT0gZmFsc2UgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGFjdGl2ZUVsZW1lbnQgJiYgaXNJblZpZXcoYWN0aXZlRWxlbWVudCkpKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWx0YV8xID0gZS5rZXlDb2RlID09PSAzOSA/IDEgOiAtMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWUuY3RybEtleSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPbkRheSh1bmRlZmluZWQsIGRlbHRhXzEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VNb250aChkZWx0YV8xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPbkRheShnZXRGaXJzdEF2YWlsYWJsZURheSgxKSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlbGYuaG91ckVsZW1lbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMzg6XG4gICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGEgPSBlLmtleUNvZGUgPT09IDQwID8gMSA6IC0xO1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHNlbGYuZGF5c0NvbnRhaW5lciAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRUYXJnZXQuJGkgIT09IHVuZGVmaW5lZCkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VGFyZ2V0ID09PSBzZWxmLmlucHV0IHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudFRhcmdldCA9PT0gc2VsZi5hbHRJbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuY3RybEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlWWVhcihzZWxmLmN1cnJlbnRZZWFyIC0gZGVsdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzT25EYXkoZ2V0Rmlyc3RBdmFpbGFibGVEYXkoMSksIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWlzVGltZU9iailcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c09uRGF5KHVuZGVmaW5lZCwgZGVsdGEgKiA3KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudFRhcmdldCA9PT0gc2VsZi5jdXJyZW50WWVhckVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVllYXIoc2VsZi5jdXJyZW50WWVhciAtIGRlbHRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzZWxmLmNvbmZpZy5lbmFibGVUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzVGltZU9iaiAmJiBzZWxmLmhvdXJFbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRpbWUoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9kZWJvdW5jZWRDaGFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgIGlmIChpc1RpbWVPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtcyA9IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmhvdXJFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubWludXRlRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnNlY29uZEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hbVBNLFxuICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb25jYXQoc2VsZi5wbHVnaW5FbGVtZW50cylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gZWxlbXMuaW5kZXhPZihldmVudFRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZWxlbXNbaSArIChlLnNoaWZ0S2V5ID8gLTEgOiAxKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0YXJnZXQgfHwgc2VsZi5faW5wdXQpLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIXNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZGF5c0NvbnRhaW5lciAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kYXlzQ29udGFpbmVyLmNvbnRhaW5zKGV2ZW50VGFyZ2V0KSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5faW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5hbVBNICE9PSB1bmRlZmluZWQgJiYgZXZlbnRUYXJnZXQgPT09IHNlbGYuYW1QTSkge1xuICAgICAgICAgICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZi5sMTBuLmFtUE1bMF0uY2hhckF0KDApOlxuICAgICAgICAgICAgICAgIGNhc2Ugc2VsZi5sMTBuLmFtUE1bMF0uY2hhckF0KDApLnRvTG93ZXJDYXNlKCk6XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYW1QTS50ZXh0Q29udGVudCA9IHNlbGYubDEwbi5hbVBNWzBdO1xuICAgICAgICAgICAgICAgICAgICBzZXRIb3Vyc0Zyb21JbnB1dHMoKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBzZWxmLmwxMG4uYW1QTVsxXS5jaGFyQXQoMCk6XG4gICAgICAgICAgICAgICAgY2FzZSBzZWxmLmwxMG4uYW1QTVsxXS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKTpcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hbVBNLnRleHRDb250ZW50ID0gc2VsZi5sMTBuLmFtUE1bMV07XG4gICAgICAgICAgICAgICAgICAgIHNldEhvdXJzRnJvbUlucHV0cygpO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNJbnB1dCB8fCBpc0NhbGVuZGFyRWxlbShldmVudFRhcmdldCkpIHtcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uS2V5RG93blwiLCBlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmdW5jdGlvbiBvbk1vdXNlT3ZlcihlbGVtLCBjZWxsQ2xhc3MpIHtcbiAgICAgICAgaWYgKGNlbGxDbGFzcyA9PT0gdm9pZCAwKSB7IGNlbGxDbGFzcyA9IFwiZmxhdHBpY2tyLWRheVwiOyB9XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoICE9PSAxIHx8XG4gICAgICAgICAgICAoZWxlbSAmJlxuICAgICAgICAgICAgICAgICghZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoY2VsbENsYXNzKSB8fFxuICAgICAgICAgICAgICAgICAgICBlbGVtLmNsYXNzTGlzdC5jb250YWlucyhcImZsYXRwaWNrci1kaXNhYmxlZFwiKSkpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgaG92ZXJEYXRlID0gZWxlbVxuICAgICAgICAgICAgPyBlbGVtLmRhdGVPYmouZ2V0VGltZSgpXG4gICAgICAgICAgICA6IHNlbGYuZGF5cy5maXJzdEVsZW1lbnRDaGlsZC5kYXRlT2JqLmdldFRpbWUoKSwgaW5pdGlhbERhdGUgPSBzZWxmLnBhcnNlRGF0ZShzZWxmLnNlbGVjdGVkRGF0ZXNbMF0sIHVuZGVmaW5lZCwgdHJ1ZSkuZ2V0VGltZSgpLCByYW5nZVN0YXJ0RGF0ZSA9IE1hdGgubWluKGhvdmVyRGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzBdLmdldFRpbWUoKSksIHJhbmdlRW5kRGF0ZSA9IE1hdGgubWF4KGhvdmVyRGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzBdLmdldFRpbWUoKSk7XG4gICAgICAgIHZhciBjb250YWluc0Rpc2FibGVkID0gZmFsc2U7XG4gICAgICAgIHZhciBtaW5SYW5nZSA9IDAsIG1heFJhbmdlID0gMDtcbiAgICAgICAgZm9yICh2YXIgdCA9IHJhbmdlU3RhcnREYXRlOyB0IDwgcmFuZ2VFbmREYXRlOyB0ICs9IGR1cmF0aW9uLkRBWSkge1xuICAgICAgICAgICAgaWYgKCFpc0VuYWJsZWQobmV3IERhdGUodCksIHRydWUpKSB7XG4gICAgICAgICAgICAgICAgY29udGFpbnNEaXNhYmxlZCA9XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5zRGlzYWJsZWQgfHwgKHQgPiByYW5nZVN0YXJ0RGF0ZSAmJiB0IDwgcmFuZ2VFbmREYXRlKTtcbiAgICAgICAgICAgICAgICBpZiAodCA8IGluaXRpYWxEYXRlICYmICghbWluUmFuZ2UgfHwgdCA+IG1pblJhbmdlKSlcbiAgICAgICAgICAgICAgICAgICAgbWluUmFuZ2UgPSB0O1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHQgPiBpbml0aWFsRGF0ZSAmJiAoIW1heFJhbmdlIHx8IHQgPCBtYXhSYW5nZSkpXG4gICAgICAgICAgICAgICAgICAgIG1heFJhbmdlID0gdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgaG92ZXJhYmxlQ2VsbHMgPSBBcnJheS5mcm9tKHNlbGYuckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiKjpudGgtY2hpbGQoLW4rXCIgKyBzZWxmLmNvbmZpZy5zaG93TW9udGhzICsgXCIpID4gLlwiICsgY2VsbENsYXNzKSk7XG4gICAgICAgIGhvdmVyYWJsZUNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGRheUVsZW0pIHtcbiAgICAgICAgICAgIHZhciBkYXRlID0gZGF5RWxlbS5kYXRlT2JqO1xuICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IGRhdGUuZ2V0VGltZSgpO1xuICAgICAgICAgICAgdmFyIG91dE9mUmFuZ2UgPSAobWluUmFuZ2UgPiAwICYmIHRpbWVzdGFtcCA8IG1pblJhbmdlKSB8fFxuICAgICAgICAgICAgICAgIChtYXhSYW5nZSA+IDAgJiYgdGltZXN0YW1wID4gbWF4UmFuZ2UpO1xuICAgICAgICAgICAgaWYgKG91dE9mUmFuZ2UpIHtcbiAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5hZGQoXCJub3RBbGxvd2VkXCIpO1xuICAgICAgICAgICAgICAgIFtcImluUmFuZ2VcIiwgXCJzdGFydFJhbmdlXCIsIFwiZW5kUmFuZ2VcIl0uZm9yRWFjaChmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5yZW1vdmUoYyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY29udGFpbnNEaXNhYmxlZCAmJiAhb3V0T2ZSYW5nZSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBbXCJzdGFydFJhbmdlXCIsIFwiaW5SYW5nZVwiLCBcImVuZFJhbmdlXCIsIFwibm90QWxsb3dlZFwiXS5mb3JFYWNoKGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICAgICAgZGF5RWxlbS5jbGFzc0xpc3QucmVtb3ZlKGMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoZWxlbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgZWxlbS5jbGFzc0xpc3QuYWRkKGhvdmVyRGF0ZSA8PSBzZWxmLnNlbGVjdGVkRGF0ZXNbMF0uZ2V0VGltZSgpXG4gICAgICAgICAgICAgICAgICAgID8gXCJzdGFydFJhbmdlXCJcbiAgICAgICAgICAgICAgICAgICAgOiBcImVuZFJhbmdlXCIpO1xuICAgICAgICAgICAgICAgIGlmIChpbml0aWFsRGF0ZSA8IGhvdmVyRGF0ZSAmJiB0aW1lc3RhbXAgPT09IGluaXRpYWxEYXRlKVxuICAgICAgICAgICAgICAgICAgICBkYXlFbGVtLmNsYXNzTGlzdC5hZGQoXCJzdGFydFJhbmdlXCIpO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGluaXRpYWxEYXRlID4gaG92ZXJEYXRlICYmIHRpbWVzdGFtcCA9PT0gaW5pdGlhbERhdGUpXG4gICAgICAgICAgICAgICAgICAgIGRheUVsZW0uY2xhc3NMaXN0LmFkZChcImVuZFJhbmdlXCIpO1xuICAgICAgICAgICAgICAgIGlmICh0aW1lc3RhbXAgPj0gbWluUmFuZ2UgJiZcbiAgICAgICAgICAgICAgICAgICAgKG1heFJhbmdlID09PSAwIHx8IHRpbWVzdGFtcCA8PSBtYXhSYW5nZSkgJiZcbiAgICAgICAgICAgICAgICAgICAgaXNCZXR3ZWVuKHRpbWVzdGFtcCwgaW5pdGlhbERhdGUsIGhvdmVyRGF0ZSkpXG4gICAgICAgICAgICAgICAgICAgIGRheUVsZW0uY2xhc3NMaXN0LmFkZChcImluUmFuZ2VcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvblJlc2l6ZSgpIHtcbiAgICAgICAgaWYgKHNlbGYuaXNPcGVuICYmICFzZWxmLmNvbmZpZy5zdGF0aWMgJiYgIXNlbGYuY29uZmlnLmlubGluZSlcbiAgICAgICAgICAgIHBvc2l0aW9uQ2FsZW5kYXIoKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gb3BlbihlLCBwb3NpdGlvbkVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHBvc2l0aW9uRWxlbWVudCA9PT0gdm9pZCAwKSB7IHBvc2l0aW9uRWxlbWVudCA9IHNlbGYuX3Bvc2l0aW9uRWxlbWVudDsgfVxuICAgICAgICBpZiAoc2VsZi5pc01vYmlsZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50VGFyZ2V0ID0gZ2V0RXZlbnRUYXJnZXQoZSk7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50VGFyZ2V0LmJsdXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5tb2JpbGVJbnB1dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQuY2xpY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uT3BlblwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzZWxmLl9pbnB1dC5kaXNhYmxlZCB8fCBzZWxmLmNvbmZpZy5pbmxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd2FzT3BlbiA9IHNlbGYuaXNPcGVuO1xuICAgICAgICBzZWxmLmlzT3BlbiA9IHRydWU7XG4gICAgICAgIGlmICghd2FzT3Blbikge1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcbiAgICAgICAgICAgIHNlbGYuX2lucHV0LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbk9wZW5cIik7XG4gICAgICAgICAgICBwb3NpdGlvbkNhbGVuZGFyKHBvc2l0aW9uRWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLmVuYWJsZVRpbWUgPT09IHRydWUgJiYgc2VsZi5jb25maWcubm9DYWxlbmRhciA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgaWYgKHNlbGYuY29uZmlnLmFsbG93SW5wdXQgPT09IGZhbHNlICYmXG4gICAgICAgICAgICAgICAgKGUgPT09IHVuZGVmaW5lZCB8fFxuICAgICAgICAgICAgICAgICAgICAhc2VsZi50aW1lQ29udGFpbmVyLmNvbnRhaW5zKGUucmVsYXRlZFRhcmdldCkpKSB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmhvdXJFbGVtZW50LnNlbGVjdCgpOyB9LCA1MCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gbWluTWF4RGF0ZVNldHRlcih0eXBlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZGF0ZSkge1xuICAgICAgICAgICAgdmFyIGRhdGVPYmogPSAoc2VsZi5jb25maWdbXCJfXCIgKyB0eXBlICsgXCJEYXRlXCJdID0gc2VsZi5wYXJzZURhdGUoZGF0ZSwgc2VsZi5jb25maWcuZGF0ZUZvcm1hdCkpO1xuICAgICAgICAgICAgdmFyIGludmVyc2VEYXRlT2JqID0gc2VsZi5jb25maWdbXCJfXCIgKyAodHlwZSA9PT0gXCJtaW5cIiA/IFwibWF4XCIgOiBcIm1pblwiKSArIFwiRGF0ZVwiXTtcbiAgICAgICAgICAgIGlmIChkYXRlT2JqICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzZWxmW3R5cGUgPT09IFwibWluXCIgPyBcIm1pbkRhdGVIYXNUaW1lXCIgOiBcIm1heERhdGVIYXNUaW1lXCJdID1cbiAgICAgICAgICAgICAgICAgICAgZGF0ZU9iai5nZXRIb3VycygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZU9iai5nZXRNaW51dGVzKCkgPiAwIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlT2JqLmdldFNlY29uZHMoKSA+IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzID0gc2VsZi5zZWxlY3RlZERhdGVzLmZpbHRlcihmdW5jdGlvbiAoZCkgeyByZXR1cm4gaXNFbmFibGVkKGQpOyB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIXNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggJiYgdHlwZSA9PT0gXCJtaW5cIilcbiAgICAgICAgICAgICAgICAgICAgc2V0SG91cnNGcm9tRGF0ZShkYXRlT2JqKTtcbiAgICAgICAgICAgICAgICB1cGRhdGVWYWx1ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbGYuZGF5c0NvbnRhaW5lcikge1xuICAgICAgICAgICAgICAgIHJlZHJhdygpO1xuICAgICAgICAgICAgICAgIGlmIChkYXRlT2JqICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudFllYXJFbGVtZW50W3R5cGVdID0gZGF0ZU9iai5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRZZWFyRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUodHlwZSk7XG4gICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhckVsZW1lbnQuZGlzYWJsZWQgPVxuICAgICAgICAgICAgICAgICAgICAhIWludmVyc2VEYXRlT2JqICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlT2JqICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGludmVyc2VEYXRlT2JqLmdldEZ1bGxZZWFyKCkgPT09IGRhdGVPYmouZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcGFyc2VDb25maWcoKSB7XG4gICAgICAgIHZhciBib29sT3B0cyA9IFtcbiAgICAgICAgICAgIFwid3JhcFwiLFxuICAgICAgICAgICAgXCJ3ZWVrTnVtYmVyc1wiLFxuICAgICAgICAgICAgXCJhbGxvd0lucHV0XCIsXG4gICAgICAgICAgICBcImFsbG93SW52YWxpZFByZWxvYWRcIixcbiAgICAgICAgICAgIFwiY2xpY2tPcGVuc1wiLFxuICAgICAgICAgICAgXCJ0aW1lXzI0aHJcIixcbiAgICAgICAgICAgIFwiZW5hYmxlVGltZVwiLFxuICAgICAgICAgICAgXCJub0NhbGVuZGFyXCIsXG4gICAgICAgICAgICBcImFsdElucHV0XCIsXG4gICAgICAgICAgICBcInNob3J0aGFuZEN1cnJlbnRNb250aFwiLFxuICAgICAgICAgICAgXCJpbmxpbmVcIixcbiAgICAgICAgICAgIFwic3RhdGljXCIsXG4gICAgICAgICAgICBcImVuYWJsZVNlY29uZHNcIixcbiAgICAgICAgICAgIFwiZGlzYWJsZU1vYmlsZVwiLFxuICAgICAgICBdO1xuICAgICAgICB2YXIgdXNlckNvbmZpZyA9IF9fYXNzaWduKF9fYXNzaWduKHt9LCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGVsZW1lbnQuZGF0YXNldCB8fCB7fSkpKSwgaW5zdGFuY2VDb25maWcpO1xuICAgICAgICB2YXIgZm9ybWF0cyA9IHt9O1xuICAgICAgICBzZWxmLmNvbmZpZy5wYXJzZURhdGUgPSB1c2VyQ29uZmlnLnBhcnNlRGF0ZTtcbiAgICAgICAgc2VsZi5jb25maWcuZm9ybWF0RGF0ZSA9IHVzZXJDb25maWcuZm9ybWF0RGF0ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcImVuYWJsZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9lbmFibGU7IH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChkYXRlcykge1xuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLl9lbmFibGUgPSBwYXJzZURhdGVSdWxlcyhkYXRlcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYuY29uZmlnLCBcImRpc2FibGVcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxmLmNvbmZpZy5fZGlzYWJsZTsgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWcuX2Rpc2FibGUgPSBwYXJzZURhdGVSdWxlcyhkYXRlcyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHRpbWVNb2RlID0gdXNlckNvbmZpZy5tb2RlID09PSBcInRpbWVcIjtcbiAgICAgICAgaWYgKCF1c2VyQ29uZmlnLmRhdGVGb3JtYXQgJiYgKHVzZXJDb25maWcuZW5hYmxlVGltZSB8fCB0aW1lTW9kZSkpIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0RGF0ZUZvcm1hdCA9IGZsYXRwaWNrci5kZWZhdWx0Q29uZmlnLmRhdGVGb3JtYXQgfHwgZGVmYXVsdE9wdGlvbnMuZGF0ZUZvcm1hdDtcbiAgICAgICAgICAgIGZvcm1hdHMuZGF0ZUZvcm1hdCA9XG4gICAgICAgICAgICAgICAgdXNlckNvbmZpZy5ub0NhbGVuZGFyIHx8IHRpbWVNb2RlXG4gICAgICAgICAgICAgICAgICAgID8gXCJIOmlcIiArICh1c2VyQ29uZmlnLmVuYWJsZVNlY29uZHMgPyBcIjpTXCIgOiBcIlwiKVxuICAgICAgICAgICAgICAgICAgICA6IGRlZmF1bHREYXRlRm9ybWF0ICsgXCIgSDppXCIgKyAodXNlckNvbmZpZy5lbmFibGVTZWNvbmRzID8gXCI6U1wiIDogXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHVzZXJDb25maWcuYWx0SW5wdXQgJiZcbiAgICAgICAgICAgICh1c2VyQ29uZmlnLmVuYWJsZVRpbWUgfHwgdGltZU1vZGUpICYmXG4gICAgICAgICAgICAhdXNlckNvbmZpZy5hbHRGb3JtYXQpIHtcbiAgICAgICAgICAgIHZhciBkZWZhdWx0QWx0Rm9ybWF0ID0gZmxhdHBpY2tyLmRlZmF1bHRDb25maWcuYWx0Rm9ybWF0IHx8IGRlZmF1bHRPcHRpb25zLmFsdEZvcm1hdDtcbiAgICAgICAgICAgIGZvcm1hdHMuYWx0Rm9ybWF0ID1cbiAgICAgICAgICAgICAgICB1c2VyQ29uZmlnLm5vQ2FsZW5kYXIgfHwgdGltZU1vZGVcbiAgICAgICAgICAgICAgICAgICAgPyBcImg6aVwiICsgKHVzZXJDb25maWcuZW5hYmxlU2Vjb25kcyA/IFwiOlMgS1wiIDogXCIgS1wiKVxuICAgICAgICAgICAgICAgICAgICA6IGRlZmF1bHRBbHRGb3JtYXQgKyAoXCIgaDppXCIgKyAodXNlckNvbmZpZy5lbmFibGVTZWNvbmRzID8gXCI6U1wiIDogXCJcIikgKyBcIiBLXCIpO1xuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJtaW5EYXRlXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5jb25maWcuX21pbkRhdGU7IH0sXG4gICAgICAgICAgICBzZXQ6IG1pbk1heERhdGVTZXR0ZXIoXCJtaW5cIiksXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwibWF4RGF0ZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9tYXhEYXRlOyB9LFxuICAgICAgICAgICAgc2V0OiBtaW5NYXhEYXRlU2V0dGVyKFwibWF4XCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIG1pbk1heFRpbWVTZXR0ZXIgPSBmdW5jdGlvbiAodHlwZSkgeyByZXR1cm4gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgc2VsZi5jb25maWdbdHlwZSA9PT0gXCJtaW5cIiA/IFwiX21pblRpbWVcIiA6IFwiX21heFRpbWVcIl0gPSBzZWxmLnBhcnNlRGF0ZSh2YWwsIFwiSDppOlNcIik7XG4gICAgICAgIH07IH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmNvbmZpZywgXCJtaW5UaW1lXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZi5jb25maWcuX21pblRpbWU7IH0sXG4gICAgICAgICAgICBzZXQ6IG1pbk1heFRpbWVTZXR0ZXIoXCJtaW5cIiksXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5jb25maWcsIFwibWF4VGltZVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGYuY29uZmlnLl9tYXhUaW1lOyB9LFxuICAgICAgICAgICAgc2V0OiBtaW5NYXhUaW1lU2V0dGVyKFwibWF4XCIpLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHVzZXJDb25maWcubW9kZSA9PT0gXCJ0aW1lXCIpIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm5vQ2FsZW5kYXIgPSB0cnVlO1xuICAgICAgICAgICAgc2VsZi5jb25maWcuZW5hYmxlVGltZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmFzc2lnbihzZWxmLmNvbmZpZywgZm9ybWF0cywgdXNlckNvbmZpZyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm9vbE9wdHMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICBzZWxmLmNvbmZpZ1tib29sT3B0c1tpXV0gPVxuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnW2Jvb2xPcHRzW2ldXSA9PT0gdHJ1ZSB8fFxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZ1tib29sT3B0c1tpXV0gPT09IFwidHJ1ZVwiO1xuICAgICAgICBIT09LUy5maWx0ZXIoZnVuY3Rpb24gKGhvb2spIHsgcmV0dXJuIHNlbGYuY29uZmlnW2hvb2tdICE9PSB1bmRlZmluZWQ7IH0pLmZvckVhY2goZnVuY3Rpb24gKGhvb2spIHtcbiAgICAgICAgICAgIHNlbGYuY29uZmlnW2hvb2tdID0gYXJyYXlpZnkoc2VsZi5jb25maWdbaG9va10gfHwgW10pLm1hcChiaW5kVG9JbnN0YW5jZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLmlzTW9iaWxlID1cbiAgICAgICAgICAgICFzZWxmLmNvbmZpZy5kaXNhYmxlTW9iaWxlICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLmlubGluZSAmJlxuICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnLm1vZGUgPT09IFwic2luZ2xlXCIgJiZcbiAgICAgICAgICAgICAgICAhc2VsZi5jb25maWcuZGlzYWJsZS5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICAhc2VsZi5jb25maWcuZW5hYmxlICYmXG4gICAgICAgICAgICAgICAgIXNlbGYuY29uZmlnLndlZWtOdW1iZXJzICYmXG4gICAgICAgICAgICAgICAgL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYuY29uZmlnLnBsdWdpbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBwbHVnaW5Db25mID0gc2VsZi5jb25maWcucGx1Z2luc1tpXShzZWxmKSB8fCB7fTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwbHVnaW5Db25mKSB7XG4gICAgICAgICAgICAgICAgaWYgKEhPT0tTLmluZGV4T2Yoa2V5KSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY29uZmlnW2tleV0gPSBhcnJheWlmeShwbHVnaW5Db25mW2tleV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGJpbmRUb0luc3RhbmNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNvbmNhdChzZWxmLmNvbmZpZ1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHVzZXJDb25maWdba2V5XSA9PT0gXCJ1bmRlZmluZWRcIilcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWdba2V5XSA9IHBsdWdpbkNvbmZba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXVzZXJDb25maWcuYWx0SW5wdXRDbGFzcykge1xuICAgICAgICAgICAgc2VsZi5jb25maWcuYWx0SW5wdXRDbGFzcyA9XG4gICAgICAgICAgICAgICAgZ2V0SW5wdXRFbGVtKCkuY2xhc3NOYW1lICsgXCIgXCIgKyBzZWxmLmNvbmZpZy5hbHRJbnB1dENsYXNzO1xuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXJFdmVudChcIm9uUGFyc2VDb25maWdcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldElucHV0RWxlbSgpIHtcbiAgICAgICAgcmV0dXJuIHNlbGYuY29uZmlnLndyYXBcbiAgICAgICAgICAgID8gZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiW2RhdGEtaW5wdXRdXCIpXG4gICAgICAgICAgICA6IGVsZW1lbnQ7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwTG9jYWxlKCkge1xuICAgICAgICBpZiAodHlwZW9mIHNlbGYuY29uZmlnLmxvY2FsZSAhPT0gXCJvYmplY3RcIiAmJlxuICAgICAgICAgICAgdHlwZW9mIGZsYXRwaWNrci5sMTBuc1tzZWxmLmNvbmZpZy5sb2NhbGVdID09PSBcInVuZGVmaW5lZFwiKVxuICAgICAgICAgICAgc2VsZi5jb25maWcuZXJyb3JIYW5kbGVyKG5ldyBFcnJvcihcImZsYXRwaWNrcjogaW52YWxpZCBsb2NhbGUgXCIgKyBzZWxmLmNvbmZpZy5sb2NhbGUpKTtcbiAgICAgICAgc2VsZi5sMTBuID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGZsYXRwaWNrci5sMTBucy5kZWZhdWx0KSwgKHR5cGVvZiBzZWxmLmNvbmZpZy5sb2NhbGUgPT09IFwib2JqZWN0XCJcbiAgICAgICAgICAgID8gc2VsZi5jb25maWcubG9jYWxlXG4gICAgICAgICAgICA6IHNlbGYuY29uZmlnLmxvY2FsZSAhPT0gXCJkZWZhdWx0XCJcbiAgICAgICAgICAgICAgICA/IGZsYXRwaWNrci5sMTBuc1tzZWxmLmNvbmZpZy5sb2NhbGVdXG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQpKTtcbiAgICAgICAgdG9rZW5SZWdleC5EID0gXCIoXCIgKyBzZWxmLmwxMG4ud2Vla2RheXMuc2hvcnRoYW5kLmpvaW4oXCJ8XCIpICsgXCIpXCI7XG4gICAgICAgIHRva2VuUmVnZXgubCA9IFwiKFwiICsgc2VsZi5sMTBuLndlZWtkYXlzLmxvbmdoYW5kLmpvaW4oXCJ8XCIpICsgXCIpXCI7XG4gICAgICAgIHRva2VuUmVnZXguTSA9IFwiKFwiICsgc2VsZi5sMTBuLm1vbnRocy5zaG9ydGhhbmQuam9pbihcInxcIikgKyBcIilcIjtcbiAgICAgICAgdG9rZW5SZWdleC5GID0gXCIoXCIgKyBzZWxmLmwxMG4ubW9udGhzLmxvbmdoYW5kLmpvaW4oXCJ8XCIpICsgXCIpXCI7XG4gICAgICAgIHRva2VuUmVnZXguSyA9IFwiKFwiICsgc2VsZi5sMTBuLmFtUE1bMF0gKyBcInxcIiArIHNlbGYubDEwbi5hbVBNWzFdICsgXCJ8XCIgKyBzZWxmLmwxMG4uYW1QTVswXS50b0xvd2VyQ2FzZSgpICsgXCJ8XCIgKyBzZWxmLmwxMG4uYW1QTVsxXS50b0xvd2VyQ2FzZSgpICsgXCIpXCI7XG4gICAgICAgIHZhciB1c2VyQ29uZmlnID0gX19hc3NpZ24oX19hc3NpZ24oe30sIGluc3RhbmNlQ29uZmlnKSwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShlbGVtZW50LmRhdGFzZXQgfHwge30pKSk7XG4gICAgICAgIGlmICh1c2VyQ29uZmlnLnRpbWVfMjRociA9PT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICBmbGF0cGlja3IuZGVmYXVsdENvbmZpZy50aW1lXzI0aHIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2VsZi5jb25maWcudGltZV8yNGhyID0gc2VsZi5sMTBuLnRpbWVfMjRocjtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLmZvcm1hdERhdGUgPSBjcmVhdGVEYXRlRm9ybWF0dGVyKHNlbGYpO1xuICAgICAgICBzZWxmLnBhcnNlRGF0ZSA9IGNyZWF0ZURhdGVQYXJzZXIoeyBjb25maWc6IHNlbGYuY29uZmlnLCBsMTBuOiBzZWxmLmwxMG4gfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBvc2l0aW9uQ2FsZW5kYXIoY3VzdG9tUG9zaXRpb25FbGVtZW50KSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZi5jb25maWcucG9zaXRpb24gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIHZvaWQgc2VsZi5jb25maWcucG9zaXRpb24oc2VsZiwgY3VzdG9tUG9zaXRpb25FbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZi5jYWxlbmRhckNvbnRhaW5lciA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblByZUNhbGVuZGFyUG9zaXRpb25cIik7XG4gICAgICAgIHZhciBwb3NpdGlvbkVsZW1lbnQgPSBjdXN0b21Qb3NpdGlvbkVsZW1lbnQgfHwgc2VsZi5fcG9zaXRpb25FbGVtZW50O1xuICAgICAgICB2YXIgY2FsZW5kYXJIZWlnaHQgPSBBcnJheS5wcm90b3R5cGUucmVkdWNlLmNhbGwoc2VsZi5jYWxlbmRhckNvbnRhaW5lci5jaGlsZHJlbiwgKGZ1bmN0aW9uIChhY2MsIGNoaWxkKSB7IHJldHVybiBhY2MgKyBjaGlsZC5vZmZzZXRIZWlnaHQ7IH0pLCAwKSwgY2FsZW5kYXJXaWR0aCA9IHNlbGYuY2FsZW5kYXJDb250YWluZXIub2Zmc2V0V2lkdGgsIGNvbmZpZ1BvcyA9IHNlbGYuY29uZmlnLnBvc2l0aW9uLnNwbGl0KFwiIFwiKSwgY29uZmlnUG9zVmVydGljYWwgPSBjb25maWdQb3NbMF0sIGNvbmZpZ1Bvc0hvcml6b250YWwgPSBjb25maWdQb3MubGVuZ3RoID4gMSA/IGNvbmZpZ1Bvc1sxXSA6IG51bGwsIGlucHV0Qm91bmRzID0gcG9zaXRpb25FbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBkaXN0YW5jZUZyb21Cb3R0b20gPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBpbnB1dEJvdW5kcy5ib3R0b20sIHNob3dPblRvcCA9IGNvbmZpZ1Bvc1ZlcnRpY2FsID09PSBcImFib3ZlXCIgfHxcbiAgICAgICAgICAgIChjb25maWdQb3NWZXJ0aWNhbCAhPT0gXCJiZWxvd1wiICYmXG4gICAgICAgICAgICAgICAgZGlzdGFuY2VGcm9tQm90dG9tIDwgY2FsZW5kYXJIZWlnaHQgJiZcbiAgICAgICAgICAgICAgICBpbnB1dEJvdW5kcy50b3AgPiBjYWxlbmRhckhlaWdodCk7XG4gICAgICAgIHZhciB0b3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgK1xuICAgICAgICAgICAgaW5wdXRCb3VuZHMudG9wICtcbiAgICAgICAgICAgICghc2hvd09uVG9wID8gcG9zaXRpb25FbGVtZW50Lm9mZnNldEhlaWdodCArIDIgOiAtY2FsZW5kYXJIZWlnaHQgLSAyKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhcnJvd1RvcFwiLCAhc2hvd09uVG9wKTtcbiAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJhcnJvd0JvdHRvbVwiLCBzaG93T25Ub3ApO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuaW5saW5lKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgbGVmdCA9IHdpbmRvdy5wYWdlWE9mZnNldCArIGlucHV0Qm91bmRzLmxlZnQ7XG4gICAgICAgIHZhciBpc0NlbnRlciA9IGZhbHNlO1xuICAgICAgICB2YXIgaXNSaWdodCA9IGZhbHNlO1xuICAgICAgICBpZiAoY29uZmlnUG9zSG9yaXpvbnRhbCA9PT0gXCJjZW50ZXJcIikge1xuICAgICAgICAgICAgbGVmdCAtPSAoY2FsZW5kYXJXaWR0aCAtIGlucHV0Qm91bmRzLndpZHRoKSAvIDI7XG4gICAgICAgICAgICBpc0NlbnRlciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29uZmlnUG9zSG9yaXpvbnRhbCA9PT0gXCJyaWdodFwiKSB7XG4gICAgICAgICAgICBsZWZ0IC09IGNhbGVuZGFyV2lkdGggLSBpbnB1dEJvdW5kcy53aWR0aDtcbiAgICAgICAgICAgIGlzUmlnaHQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYXJyb3dMZWZ0XCIsICFpc0NlbnRlciAmJiAhaXNSaWdodCk7XG4gICAgICAgIHRvZ2dsZUNsYXNzKHNlbGYuY2FsZW5kYXJDb250YWluZXIsIFwiYXJyb3dDZW50ZXJcIiwgaXNDZW50ZXIpO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcImFycm93UmlnaHRcIiwgaXNSaWdodCk7XG4gICAgICAgIHZhciByaWdodCA9IHdpbmRvdy5kb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoIC1cbiAgICAgICAgICAgICh3aW5kb3cucGFnZVhPZmZzZXQgKyBpbnB1dEJvdW5kcy5yaWdodCk7XG4gICAgICAgIHZhciByaWdodE1vc3QgPSBsZWZ0ICsgY2FsZW5kYXJXaWR0aCA+IHdpbmRvdy5kb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoO1xuICAgICAgICB2YXIgY2VudGVyTW9zdCA9IHJpZ2h0ICsgY2FsZW5kYXJXaWR0aCA+IHdpbmRvdy5kb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoO1xuICAgICAgICB0b2dnbGVDbGFzcyhzZWxmLmNhbGVuZGFyQ29udGFpbmVyLCBcInJpZ2h0TW9zdFwiLCByaWdodE1vc3QpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuc3RhdGljKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnRvcCA9IHRvcCArIFwicHhcIjtcbiAgICAgICAgaWYgKCFyaWdodE1vc3QpIHtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUubGVmdCA9IGxlZnQgKyBcInB4XCI7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLnJpZ2h0ID0gXCJhdXRvXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWNlbnRlck1vc3QpIHtcbiAgICAgICAgICAgIHNlbGYuY2FsZW5kYXJDb250YWluZXIuc3R5bGUubGVmdCA9IFwiYXV0b1wiO1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5yaWdodCA9IHJpZ2h0ICsgXCJweFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGRvYyA9IGdldERvY3VtZW50U3R5bGVTaGVldCgpO1xuICAgICAgICAgICAgaWYgKGRvYyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIHZhciBib2R5V2lkdGggPSB3aW5kb3cuZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aDtcbiAgICAgICAgICAgIHZhciBjZW50ZXJMZWZ0ID0gTWF0aC5tYXgoMCwgYm9keVdpZHRoIC8gMiAtIGNhbGVuZGFyV2lkdGggLyAyKTtcbiAgICAgICAgICAgIHZhciBjZW50ZXJCZWZvcmUgPSBcIi5mbGF0cGlja3ItY2FsZW5kYXIuY2VudGVyTW9zdDpiZWZvcmVcIjtcbiAgICAgICAgICAgIHZhciBjZW50ZXJBZnRlciA9IFwiLmZsYXRwaWNrci1jYWxlbmRhci5jZW50ZXJNb3N0OmFmdGVyXCI7XG4gICAgICAgICAgICB2YXIgY2VudGVySW5kZXggPSBkb2MuY3NzUnVsZXMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGNlbnRlclN0eWxlID0gXCJ7bGVmdDpcIiArIGlucHV0Qm91bmRzLmxlZnQgKyBcInB4O3JpZ2h0OmF1dG87fVwiO1xuICAgICAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJyaWdodE1vc3RcIiwgZmFsc2UpO1xuICAgICAgICAgICAgdG9nZ2xlQ2xhc3Moc2VsZi5jYWxlbmRhckNvbnRhaW5lciwgXCJjZW50ZXJNb3N0XCIsIHRydWUpO1xuICAgICAgICAgICAgZG9jLmluc2VydFJ1bGUoY2VudGVyQmVmb3JlICsgXCIsXCIgKyBjZW50ZXJBZnRlciArIGNlbnRlclN0eWxlLCBjZW50ZXJJbmRleCk7XG4gICAgICAgICAgICBzZWxmLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmxlZnQgPSBjZW50ZXJMZWZ0ICsgXCJweFwiO1xuICAgICAgICAgICAgc2VsZi5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5yaWdodCA9IFwiYXV0b1wiO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldERvY3VtZW50U3R5bGVTaGVldCgpIHtcbiAgICAgICAgdmFyIGVkaXRhYmxlU2hlZXQgPSBudWxsO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvY3VtZW50LnN0eWxlU2hlZXRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc2hlZXQgPSBkb2N1bWVudC5zdHlsZVNoZWV0c1tpXTtcbiAgICAgICAgICAgIGlmICghc2hlZXQuY3NzUnVsZXMpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHNoZWV0LmNzc1J1bGVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRpdGFibGVTaGVldCA9IHNoZWV0O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVkaXRhYmxlU2hlZXQgIT0gbnVsbCA/IGVkaXRhYmxlU2hlZXQgOiBjcmVhdGVTdHlsZVNoZWV0KCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNyZWF0ZVN0eWxlU2hlZXQoKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4gICAgICAgIHJldHVybiBzdHlsZS5zaGVldDtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVkcmF3KCkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubm9DYWxlbmRhciB8fCBzZWxmLmlzTW9iaWxlKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBidWlsZE1vbnRoU3dpdGNoKCk7XG4gICAgICAgIHVwZGF0ZU5hdmlnYXRpb25DdXJyZW50TW9udGgoKTtcbiAgICAgICAgYnVpbGREYXlzKCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGZvY3VzQW5kQ2xvc2UoKSB7XG4gICAgICAgIHNlbGYuX2lucHV0LmZvY3VzKCk7XG4gICAgICAgIGlmICh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRVwiKSAhPT0gLTEgfHxcbiAgICAgICAgICAgIG5hdmlnYXRvci5tc01heFRvdWNoUG9pbnRzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoc2VsZi5jbG9zZSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc2VsZWN0RGF0ZShlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdmFyIGlzU2VsZWN0YWJsZSA9IGZ1bmN0aW9uIChkYXkpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXkuY2xhc3NMaXN0ICYmXG4gICAgICAgICAgICAgICAgZGF5LmNsYXNzTGlzdC5jb250YWlucyhcImZsYXRwaWNrci1kYXlcIikgJiZcbiAgICAgICAgICAgICAgICAhZGF5LmNsYXNzTGlzdC5jb250YWlucyhcImZsYXRwaWNrci1kaXNhYmxlZFwiKSAmJlxuICAgICAgICAgICAgICAgICFkYXkuY2xhc3NMaXN0LmNvbnRhaW5zKFwibm90QWxsb3dlZFwiKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHQgPSBmaW5kUGFyZW50KGdldEV2ZW50VGFyZ2V0KGUpLCBpc1NlbGVjdGFibGUpO1xuICAgICAgICBpZiAodCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgdGFyZ2V0ID0gdDtcbiAgICAgICAgdmFyIHNlbGVjdGVkRGF0ZSA9IChzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA9IG5ldyBEYXRlKHRhcmdldC5kYXRlT2JqLmdldFRpbWUoKSkpO1xuICAgICAgICB2YXIgc2hvdWxkQ2hhbmdlTW9udGggPSAoc2VsZWN0ZWREYXRlLmdldE1vbnRoKCkgPCBzZWxmLmN1cnJlbnRNb250aCB8fFxuICAgICAgICAgICAgc2VsZWN0ZWREYXRlLmdldE1vbnRoKCkgPlxuICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudE1vbnRoICsgc2VsZi5jb25maWcuc2hvd01vbnRocyAtIDEpICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5tb2RlICE9PSBcInJhbmdlXCI7XG4gICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlRWxlbSA9IHRhcmdldDtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwic2luZ2xlXCIpXG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMgPSBbc2VsZWN0ZWREYXRlXTtcbiAgICAgICAgZWxzZSBpZiAoc2VsZi5jb25maWcubW9kZSA9PT0gXCJtdWx0aXBsZVwiKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRJbmRleCA9IGlzRGF0ZVNlbGVjdGVkKHNlbGVjdGVkRGF0ZSk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRJbmRleClcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMuc3BsaWNlKHBhcnNlSW50KHNlbGVjdGVkSW5kZXgpLCAxKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMucHVzaChzZWxlY3RlZERhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIikge1xuICAgICAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNsZWFyKGZhbHNlLCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA9IHNlbGVjdGVkRGF0ZTtcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5wdXNoKHNlbGVjdGVkRGF0ZSk7XG4gICAgICAgICAgICBpZiAoY29tcGFyZURhdGVzKHNlbGVjdGVkRGF0ZSwgc2VsZi5zZWxlY3RlZERhdGVzWzBdLCB0cnVlKSAhPT0gMClcbiAgICAgICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMuc29ydChmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS5nZXRUaW1lKCkgLSBiLmdldFRpbWUoKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0SG91cnNGcm9tSW5wdXRzKCk7XG4gICAgICAgIGlmIChzaG91bGRDaGFuZ2VNb250aCkge1xuICAgICAgICAgICAgdmFyIGlzTmV3WWVhciA9IHNlbGYuY3VycmVudFllYXIgIT09IHNlbGVjdGVkRGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50WWVhciA9IHNlbGVjdGVkRGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBzZWxlY3RlZERhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgICAgIGlmIChpc05ld1llYXIpIHtcbiAgICAgICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvblllYXJDaGFuZ2VcIik7XG4gICAgICAgICAgICAgICAgYnVpbGRNb250aFN3aXRjaCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25Nb250aENoYW5nZVwiKTtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCk7XG4gICAgICAgIGJ1aWxkRGF5cygpO1xuICAgICAgICB1cGRhdGVWYWx1ZSgpO1xuICAgICAgICBpZiAoIXNob3VsZENoYW5nZU1vbnRoICYmXG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5tb2RlICE9PSBcInJhbmdlXCIgJiZcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLnNob3dNb250aHMgPT09IDEpXG4gICAgICAgICAgICBmb2N1c09uRGF5RWxlbSh0YXJnZXQpO1xuICAgICAgICBlbHNlIGlmIChzZWxmLnNlbGVjdGVkRGF0ZUVsZW0gIT09IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgc2VsZi5ob3VyRWxlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZUVsZW0gJiYgc2VsZi5zZWxlY3RlZERhdGVFbGVtLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuaG91ckVsZW1lbnQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuaG91ckVsZW1lbnQgIT09IHVuZGVmaW5lZCAmJiBzZWxmLmhvdXJFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIGlmIChzZWxmLmNvbmZpZy5jbG9zZU9uU2VsZWN0KSB7XG4gICAgICAgICAgICB2YXIgc2luZ2xlID0gc2VsZi5jb25maWcubW9kZSA9PT0gXCJzaW5nbGVcIiAmJiAhc2VsZi5jb25maWcuZW5hYmxlVGltZTtcbiAgICAgICAgICAgIHZhciByYW5nZSA9IHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIiAmJlxuICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPT09IDIgJiZcbiAgICAgICAgICAgICAgICAhc2VsZi5jb25maWcuZW5hYmxlVGltZTtcbiAgICAgICAgICAgIGlmIChzaW5nbGUgfHwgcmFuZ2UpIHtcbiAgICAgICAgICAgICAgICBmb2N1c0FuZENsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdHJpZ2dlckNoYW5nZSgpO1xuICAgIH1cbiAgICB2YXIgQ0FMTEJBQ0tTID0ge1xuICAgICAgICBsb2NhbGU6IFtzZXR1cExvY2FsZSwgdXBkYXRlV2Vla2RheXNdLFxuICAgICAgICBzaG93TW9udGhzOiBbYnVpbGRNb250aHMsIHNldENhbGVuZGFyV2lkdGgsIGJ1aWxkV2Vla2RheXNdLFxuICAgICAgICBtaW5EYXRlOiBbanVtcFRvRGF0ZV0sXG4gICAgICAgIG1heERhdGU6IFtqdW1wVG9EYXRlXSxcbiAgICAgICAgcG9zaXRpb25FbGVtZW50OiBbdXBkYXRlUG9zaXRpb25FbGVtZW50XSxcbiAgICAgICAgY2xpY2tPcGVuczogW1xuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvbmZpZy5jbGlja09wZW5zID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGJpbmQoc2VsZi5faW5wdXQsIFwiZm9jdXNcIiwgc2VsZi5vcGVuKTtcbiAgICAgICAgICAgICAgICAgICAgYmluZChzZWxmLl9pbnB1dCwgXCJjbGlja1wiLCBzZWxmLm9wZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5faW5wdXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIHNlbGYub3Blbik7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX2lucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBzZWxmLm9wZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfTtcbiAgICBmdW5jdGlvbiBzZXQob3B0aW9uLCB2YWx1ZSkge1xuICAgICAgICBpZiAob3B0aW9uICE9PSBudWxsICYmIHR5cGVvZiBvcHRpb24gPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oc2VsZi5jb25maWcsIG9wdGlvbik7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gb3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKENBTExCQUNLU1trZXldICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIENBTExCQUNLU1trZXldLmZvckVhY2goZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgoKTsgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZ1tvcHRpb25dID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAoQ0FMTEJBQ0tTW29wdGlvbl0gIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBDQUxMQkFDS1Nbb3B0aW9uXS5mb3JFYWNoKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4KCk7IH0pO1xuICAgICAgICAgICAgZWxzZSBpZiAoSE9PS1MuaW5kZXhPZihvcHRpb24pID4gLTEpXG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWdbb3B0aW9uXSA9IGFycmF5aWZ5KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBzZWxmLnJlZHJhdygpO1xuICAgICAgICB1cGRhdGVWYWx1ZSh0cnVlKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0U2VsZWN0ZWREYXRlKGlucHV0RGF0ZSwgZm9ybWF0KSB7XG4gICAgICAgIHZhciBkYXRlcyA9IFtdO1xuICAgICAgICBpZiAoaW5wdXREYXRlIGluc3RhbmNlb2YgQXJyYXkpXG4gICAgICAgICAgICBkYXRlcyA9IGlucHV0RGF0ZS5tYXAoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIHNlbGYucGFyc2VEYXRlKGQsIGZvcm1hdCk7IH0pO1xuICAgICAgICBlbHNlIGlmIChpbnB1dERhdGUgaW5zdGFuY2VvZiBEYXRlIHx8IHR5cGVvZiBpbnB1dERhdGUgPT09IFwibnVtYmVyXCIpXG4gICAgICAgICAgICBkYXRlcyA9IFtzZWxmLnBhcnNlRGF0ZShpbnB1dERhdGUsIGZvcm1hdCldO1xuICAgICAgICBlbHNlIGlmICh0eXBlb2YgaW5wdXREYXRlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHNlbGYuY29uZmlnLm1vZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwic2luZ2xlXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcInRpbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgZGF0ZXMgPSBbc2VsZi5wYXJzZURhdGUoaW5wdXREYXRlLCBmb3JtYXQpXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm11bHRpcGxlXCI6XG4gICAgICAgICAgICAgICAgICAgIGRhdGVzID0gaW5wdXREYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoc2VsZi5jb25maWcuY29uanVuY3Rpb24pXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChkYXRlKSB7IHJldHVybiBzZWxmLnBhcnNlRGF0ZShkYXRlLCBmb3JtYXQpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcInJhbmdlXCI6XG4gICAgICAgICAgICAgICAgICAgIGRhdGVzID0gaW5wdXREYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3BsaXQoc2VsZi5sMTBuLnJhbmdlU2VwYXJhdG9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbiAoZGF0ZSkgeyByZXR1cm4gc2VsZi5wYXJzZURhdGUoZGF0ZSwgZm9ybWF0KTsgfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLmVycm9ySGFuZGxlcihuZXcgRXJyb3IoXCJJbnZhbGlkIGRhdGUgc3VwcGxpZWQ6IFwiICsgSlNPTi5zdHJpbmdpZnkoaW5wdXREYXRlKSkpO1xuICAgICAgICBzZWxmLnNlbGVjdGVkRGF0ZXMgPSAoc2VsZi5jb25maWcuYWxsb3dJbnZhbGlkUHJlbG9hZFxuICAgICAgICAgICAgPyBkYXRlc1xuICAgICAgICAgICAgOiBkYXRlcy5maWx0ZXIoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQgaW5zdGFuY2VvZiBEYXRlICYmIGlzRW5hYmxlZChkLCBmYWxzZSk7IH0pKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1vZGUgPT09IFwicmFuZ2VcIilcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLmdldFRpbWUoKSAtIGIuZ2V0VGltZSgpOyB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0RGF0ZShkYXRlLCB0cmlnZ2VyQ2hhbmdlLCBmb3JtYXQpIHtcbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2UgPT09IHZvaWQgMCkgeyB0cmlnZ2VyQ2hhbmdlID0gZmFsc2U7IH1cbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gdm9pZCAwKSB7IGZvcm1hdCA9IHNlbGYuY29uZmlnLmRhdGVGb3JtYXQ7IH1cbiAgICAgICAgaWYgKChkYXRlICE9PSAwICYmICFkYXRlKSB8fCAoZGF0ZSBpbnN0YW5jZW9mIEFycmF5ICYmIGRhdGUubGVuZ3RoID09PSAwKSlcbiAgICAgICAgICAgIHJldHVybiBzZWxmLmNsZWFyKHRyaWdnZXJDaGFuZ2UpO1xuICAgICAgICBzZXRTZWxlY3RlZERhdGUoZGF0ZSwgZm9ybWF0KTtcbiAgICAgICAgc2VsZi5sYXRlc3RTZWxlY3RlZERhdGVPYmogPVxuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzW3NlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgc2VsZi5yZWRyYXcoKTtcbiAgICAgICAganVtcFRvRGF0ZSh1bmRlZmluZWQsIHRyaWdnZXJDaGFuZ2UpO1xuICAgICAgICBzZXRIb3Vyc0Zyb21EYXRlKCk7XG4gICAgICAgIGlmIChzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBzZWxmLmNsZWFyKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICB1cGRhdGVWYWx1ZSh0cmlnZ2VyQ2hhbmdlKTtcbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2UpXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNoYW5nZVwiKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcGFyc2VEYXRlUnVsZXMoYXJyKSB7XG4gICAgICAgIHJldHVybiBhcnJcbiAgICAgICAgICAgIC5zbGljZSgpXG4gICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHJ1bGUgPT09IFwic3RyaW5nXCIgfHxcbiAgICAgICAgICAgICAgICB0eXBlb2YgcnVsZSA9PT0gXCJudW1iZXJcIiB8fFxuICAgICAgICAgICAgICAgIHJ1bGUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYucGFyc2VEYXRlKHJ1bGUsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChydWxlICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIHJ1bGUgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgICAgICBydWxlLmZyb20gJiZcbiAgICAgICAgICAgICAgICBydWxlLnRvKVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IHNlbGYucGFyc2VEYXRlKHJ1bGUuZnJvbSwgdW5kZWZpbmVkKSxcbiAgICAgICAgICAgICAgICAgICAgdG86IHNlbGYucGFyc2VEYXRlKHJ1bGUudG8sIHVuZGVmaW5lZCksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBydWxlO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHNldHVwRGF0ZXMoKSB7XG4gICAgICAgIHNlbGYuc2VsZWN0ZWREYXRlcyA9IFtdO1xuICAgICAgICBzZWxmLm5vdyA9IHNlbGYucGFyc2VEYXRlKHNlbGYuY29uZmlnLm5vdykgfHwgbmV3IERhdGUoKTtcbiAgICAgICAgdmFyIHByZWxvYWRlZERhdGUgPSBzZWxmLmNvbmZpZy5kZWZhdWx0RGF0ZSB8fFxuICAgICAgICAgICAgKChzZWxmLmlucHV0Lm5vZGVOYW1lID09PSBcIklOUFVUXCIgfHxcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0Lm5vZGVOYW1lID09PSBcIlRFWFRBUkVBXCIpICYmXG4gICAgICAgICAgICAgICAgc2VsZi5pbnB1dC5wbGFjZWhvbGRlciAmJlxuICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQudmFsdWUgPT09IHNlbGYuaW5wdXQucGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICA/IG51bGxcbiAgICAgICAgICAgICAgICA6IHNlbGYuaW5wdXQudmFsdWUpO1xuICAgICAgICBpZiAocHJlbG9hZGVkRGF0ZSlcbiAgICAgICAgICAgIHNldFNlbGVjdGVkRGF0ZShwcmVsb2FkZWREYXRlLCBzZWxmLmNvbmZpZy5kYXRlRm9ybWF0KTtcbiAgICAgICAgc2VsZi5faW5pdGlhbERhdGUgPVxuICAgICAgICAgICAgc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgICA/IHNlbGYuc2VsZWN0ZWREYXRlc1swXVxuICAgICAgICAgICAgICAgIDogc2VsZi5jb25maWcubWluRGF0ZSAmJlxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5EYXRlLmdldFRpbWUoKSA+IHNlbGYubm93LmdldFRpbWUoKVxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY29uZmlnLm1pbkRhdGVcbiAgICAgICAgICAgICAgICAgICAgOiBzZWxmLmNvbmZpZy5tYXhEYXRlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldFRpbWUoKSA8IHNlbGYubm93LmdldFRpbWUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgPyBzZWxmLmNvbmZpZy5tYXhEYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICA6IHNlbGYubm93O1xuICAgICAgICBzZWxmLmN1cnJlbnRZZWFyID0gc2VsZi5faW5pdGlhbERhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgc2VsZi5jdXJyZW50TW9udGggPSBzZWxmLl9pbml0aWFsRGF0ZS5nZXRNb250aCgpO1xuICAgICAgICBpZiAoc2VsZi5zZWxlY3RlZERhdGVzLmxlbmd0aCA+IDApXG4gICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiA9IHNlbGYuc2VsZWN0ZWREYXRlc1swXTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1pblRpbWUgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1pblRpbWUgPSBzZWxmLnBhcnNlRGF0ZShzZWxmLmNvbmZpZy5taW5UaW1lLCBcIkg6aVwiKTtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1heFRpbWUgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuY29uZmlnLm1heFRpbWUgPSBzZWxmLnBhcnNlRGF0ZShzZWxmLmNvbmZpZy5tYXhUaW1lLCBcIkg6aVwiKTtcbiAgICAgICAgc2VsZi5taW5EYXRlSGFzVGltZSA9XG4gICAgICAgICAgICAhIXNlbGYuY29uZmlnLm1pbkRhdGUgJiZcbiAgICAgICAgICAgICAgICAoc2VsZi5jb25maWcubWluRGF0ZS5nZXRIb3VycygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5taW5EYXRlLmdldE1pbnV0ZXMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWluRGF0ZS5nZXRTZWNvbmRzKCkgPiAwKTtcbiAgICAgICAgc2VsZi5tYXhEYXRlSGFzVGltZSA9XG4gICAgICAgICAgICAhIXNlbGYuY29uZmlnLm1heERhdGUgJiZcbiAgICAgICAgICAgICAgICAoc2VsZi5jb25maWcubWF4RGF0ZS5nZXRIb3VycygpID4gMCB8fFxuICAgICAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldE1pbnV0ZXMoKSA+IDAgfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb25maWcubWF4RGF0ZS5nZXRTZWNvbmRzKCkgPiAwKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0dXBJbnB1dHMoKSB7XG4gICAgICAgIHNlbGYuaW5wdXQgPSBnZXRJbnB1dEVsZW0oKTtcbiAgICAgICAgaWYgKCFzZWxmLmlucHV0KSB7XG4gICAgICAgICAgICBzZWxmLmNvbmZpZy5lcnJvckhhbmRsZXIobmV3IEVycm9yKFwiSW52YWxpZCBpbnB1dCBlbGVtZW50IHNwZWNpZmllZFwiKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5pbnB1dC5fdHlwZSA9IHNlbGYuaW5wdXQudHlwZTtcbiAgICAgICAgc2VsZi5pbnB1dC50eXBlID0gXCJ0ZXh0XCI7XG4gICAgICAgIHNlbGYuaW5wdXQuY2xhc3NMaXN0LmFkZChcImZsYXRwaWNrci1pbnB1dFwiKTtcbiAgICAgICAgc2VsZi5faW5wdXQgPSBzZWxmLmlucHV0O1xuICAgICAgICBpZiAoc2VsZi5jb25maWcuYWx0SW5wdXQpIHtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQgPSBjcmVhdGVFbGVtZW50KHNlbGYuaW5wdXQubm9kZU5hbWUsIHNlbGYuY29uZmlnLmFsdElucHV0Q2xhc3MpO1xuICAgICAgICAgICAgc2VsZi5faW5wdXQgPSBzZWxmLmFsdElucHV0O1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC5wbGFjZWhvbGRlciA9IHNlbGYuaW5wdXQucGxhY2Vob2xkZXI7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LmRpc2FibGVkID0gc2VsZi5pbnB1dC5kaXNhYmxlZDtcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQucmVxdWlyZWQgPSBzZWxmLmlucHV0LnJlcXVpcmVkO1xuICAgICAgICAgICAgc2VsZi5hbHRJbnB1dC50YWJJbmRleCA9IHNlbGYuaW5wdXQudGFiSW5kZXg7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnR5cGUgPSBcInRleHRcIjtcbiAgICAgICAgICAgIHNlbGYuaW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImhpZGRlblwiKTtcbiAgICAgICAgICAgIGlmICghc2VsZi5jb25maWcuc3RhdGljICYmIHNlbGYuaW5wdXQucGFyZW50Tm9kZSlcbiAgICAgICAgICAgICAgICBzZWxmLmlucHV0LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYuYWx0SW5wdXQsIHNlbGYuaW5wdXQubmV4dFNpYmxpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc2VsZi5jb25maWcuYWxsb3dJbnB1dClcbiAgICAgICAgICAgIHNlbGYuX2lucHV0LnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIFwicmVhZG9ubHlcIik7XG4gICAgICAgIHVwZGF0ZVBvc2l0aW9uRWxlbWVudCgpO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVQb3NpdGlvbkVsZW1lbnQoKSB7XG4gICAgICAgIHNlbGYuX3Bvc2l0aW9uRWxlbWVudCA9IHNlbGYuY29uZmlnLnBvc2l0aW9uRWxlbWVudCB8fCBzZWxmLl9pbnB1dDtcbiAgICB9XG4gICAgZnVuY3Rpb24gc2V0dXBNb2JpbGUoKSB7XG4gICAgICAgIHZhciBpbnB1dFR5cGUgPSBzZWxmLmNvbmZpZy5lbmFibGVUaW1lXG4gICAgICAgICAgICA/IHNlbGYuY29uZmlnLm5vQ2FsZW5kYXJcbiAgICAgICAgICAgICAgICA/IFwidGltZVwiXG4gICAgICAgICAgICAgICAgOiBcImRhdGV0aW1lLWxvY2FsXCJcbiAgICAgICAgICAgIDogXCJkYXRlXCI7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQgPSBjcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgc2VsZi5pbnB1dC5jbGFzc05hbWUgKyBcIiBmbGF0cGlja3ItbW9iaWxlXCIpO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnRhYkluZGV4ID0gMTtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC50eXBlID0gaW5wdXRUeXBlO1xuICAgICAgICBzZWxmLm1vYmlsZUlucHV0LmRpc2FibGVkID0gc2VsZi5pbnB1dC5kaXNhYmxlZDtcbiAgICAgICAgc2VsZi5tb2JpbGVJbnB1dC5yZXF1aXJlZCA9IHNlbGYuaW5wdXQucmVxdWlyZWQ7XG4gICAgICAgIHNlbGYubW9iaWxlSW5wdXQucGxhY2Vob2xkZXIgPSBzZWxmLmlucHV0LnBsYWNlaG9sZGVyO1xuICAgICAgICBzZWxmLm1vYmlsZUZvcm1hdFN0ciA9XG4gICAgICAgICAgICBpbnB1dFR5cGUgPT09IFwiZGF0ZXRpbWUtbG9jYWxcIlxuICAgICAgICAgICAgICAgID8gXCJZLW0tZFxcXFxUSDppOlNcIlxuICAgICAgICAgICAgICAgIDogaW5wdXRUeXBlID09PSBcImRhdGVcIlxuICAgICAgICAgICAgICAgICAgICA/IFwiWS1tLWRcIlxuICAgICAgICAgICAgICAgICAgICA6IFwiSDppOlNcIjtcbiAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LmRlZmF1bHRWYWx1ZSA9IHNlbGYubW9iaWxlSW5wdXQudmFsdWUgPSBzZWxmLmZvcm1hdERhdGUoc2VsZi5zZWxlY3RlZERhdGVzWzBdLCBzZWxmLm1vYmlsZUZvcm1hdFN0cik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGYuY29uZmlnLm1pbkRhdGUpXG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0Lm1pbiA9IHNlbGYuZm9ybWF0RGF0ZShzZWxmLmNvbmZpZy5taW5EYXRlLCBcIlktbS1kXCIpO1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubWF4RGF0ZSlcbiAgICAgICAgICAgIHNlbGYubW9iaWxlSW5wdXQubWF4ID0gc2VsZi5mb3JtYXREYXRlKHNlbGYuY29uZmlnLm1heERhdGUsIFwiWS1tLWRcIik7XG4gICAgICAgIGlmIChzZWxmLmlucHV0LmdldEF0dHJpYnV0ZShcInN0ZXBcIikpXG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnN0ZXAgPSBTdHJpbmcoc2VsZi5pbnB1dC5nZXRBdHRyaWJ1dGUoXCJzdGVwXCIpKTtcbiAgICAgICAgc2VsZi5pbnB1dC50eXBlID0gXCJoaWRkZW5cIjtcbiAgICAgICAgaWYgKHNlbGYuYWx0SW5wdXQgIT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIHNlbGYuYWx0SW5wdXQudHlwZSA9IFwiaGlkZGVuXCI7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoc2VsZi5pbnB1dC5wYXJlbnROb2RlKVxuICAgICAgICAgICAgICAgIHNlbGYuaW5wdXQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5tb2JpbGVJbnB1dCwgc2VsZi5pbnB1dC5uZXh0U2libGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKF9hKSB7IH1cbiAgICAgICAgYmluZChzZWxmLm1vYmlsZUlucHV0LCBcImNoYW5nZVwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgc2VsZi5zZXREYXRlKGdldEV2ZW50VGFyZ2V0KGUpLnZhbHVlLCBmYWxzZSwgc2VsZi5tb2JpbGVGb3JtYXRTdHIpO1xuICAgICAgICAgICAgdHJpZ2dlckV2ZW50KFwib25DaGFuZ2VcIik7XG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQoXCJvbkNsb3NlXCIpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gdG9nZ2xlKGUpIHtcbiAgICAgICAgaWYgKHNlbGYuaXNPcGVuID09PSB0cnVlKVxuICAgICAgICAgICAgcmV0dXJuIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgc2VsZi5vcGVuKGUpO1xuICAgIH1cbiAgICBmdW5jdGlvbiB0cmlnZ2VyRXZlbnQoZXZlbnQsIGRhdGEpIHtcbiAgICAgICAgaWYgKHNlbGYuY29uZmlnID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBob29rcyA9IHNlbGYuY29uZmlnW2V2ZW50XTtcbiAgICAgICAgaWYgKGhvb2tzICE9PSB1bmRlZmluZWQgJiYgaG9va3MubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGhvb2tzW2ldICYmIGkgPCBob29rcy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICBob29rc1tpXShzZWxmLnNlbGVjdGVkRGF0ZXMsIHNlbGYuaW5wdXQudmFsdWUsIHNlbGYsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudCA9PT0gXCJvbkNoYW5nZVwiKSB7XG4gICAgICAgICAgICBzZWxmLmlucHV0LmRpc3BhdGNoRXZlbnQoY3JlYXRlRXZlbnQoXCJjaGFuZ2VcIikpO1xuICAgICAgICAgICAgc2VsZi5pbnB1dC5kaXNwYXRjaEV2ZW50KGNyZWF0ZUV2ZW50KFwiaW5wdXRcIikpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50KG5hbWUpIHtcbiAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIkV2ZW50XCIpO1xuICAgICAgICBlLmluaXRFdmVudChuYW1lLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzRGF0ZVNlbGVjdGVkKGRhdGUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLnNlbGVjdGVkRGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZERhdGUgPSBzZWxmLnNlbGVjdGVkRGF0ZXNbaV07XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWREYXRlIGluc3RhbmNlb2YgRGF0ZSAmJlxuICAgICAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhzZWxlY3RlZERhdGUsIGRhdGUpID09PSAwKVxuICAgICAgICAgICAgICAgIHJldHVybiBcIlwiICsgaTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGlzRGF0ZUluUmFuZ2UoZGF0ZSkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubW9kZSAhPT0gXCJyYW5nZVwiIHx8IHNlbGYuc2VsZWN0ZWREYXRlcy5sZW5ndGggPCAyKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKGNvbXBhcmVEYXRlcyhkYXRlLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMF0pID49IDAgJiZcbiAgICAgICAgICAgIGNvbXBhcmVEYXRlcyhkYXRlLCBzZWxmLnNlbGVjdGVkRGF0ZXNbMV0pIDw9IDApO1xuICAgIH1cbiAgICBmdW5jdGlvbiB1cGRhdGVOYXZpZ2F0aW9uQ3VycmVudE1vbnRoKCkge1xuICAgICAgICBpZiAoc2VsZi5jb25maWcubm9DYWxlbmRhciB8fCBzZWxmLmlzTW9iaWxlIHx8ICFzZWxmLm1vbnRoTmF2KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBzZWxmLnllYXJFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uICh5ZWFyRWxlbWVudCwgaSkge1xuICAgICAgICAgICAgdmFyIGQgPSBuZXcgRGF0ZShzZWxmLmN1cnJlbnRZZWFyLCBzZWxmLmN1cnJlbnRNb250aCwgMSk7XG4gICAgICAgICAgICBkLnNldE1vbnRoKHNlbGYuY3VycmVudE1vbnRoICsgaSk7XG4gICAgICAgICAgICBpZiAoc2VsZi5jb25maWcuc2hvd01vbnRocyA+IDEgfHxcbiAgICAgICAgICAgICAgICBzZWxmLmNvbmZpZy5tb250aFNlbGVjdG9yVHlwZSA9PT0gXCJzdGF0aWNcIikge1xuICAgICAgICAgICAgICAgIHNlbGYubW9udGhFbGVtZW50c1tpXS50ZXh0Q29udGVudCA9XG4gICAgICAgICAgICAgICAgICAgIG1vbnRoVG9TdHIoZC5nZXRNb250aCgpLCBzZWxmLmNvbmZpZy5zaG9ydGhhbmRDdXJyZW50TW9udGgsIHNlbGYubDEwbikgKyBcIiBcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlbGYubW9udGhzRHJvcGRvd25Db250YWluZXIudmFsdWUgPSBkLmdldE1vbnRoKCkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHllYXJFbGVtZW50LnZhbHVlID0gZC5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBzZWxmLl9oaWRlUHJldk1vbnRoQXJyb3cgPVxuICAgICAgICAgICAgc2VsZi5jb25maWcubWluRGF0ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgKHNlbGYuY3VycmVudFllYXIgPT09IHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0RnVsbFllYXIoKVxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY3VycmVudE1vbnRoIDw9IHNlbGYuY29uZmlnLm1pbkRhdGUuZ2V0TW9udGgoKVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY3VycmVudFllYXIgPCBzZWxmLmNvbmZpZy5taW5EYXRlLmdldEZ1bGxZZWFyKCkpO1xuICAgICAgICBzZWxmLl9oaWRlTmV4dE1vbnRoQXJyb3cgPVxuICAgICAgICAgICAgc2VsZi5jb25maWcubWF4RGF0ZSAhPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgKHNlbGYuY3VycmVudFllYXIgPT09IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0RnVsbFllYXIoKVxuICAgICAgICAgICAgICAgICAgICA/IHNlbGYuY3VycmVudE1vbnRoICsgMSA+IHNlbGYuY29uZmlnLm1heERhdGUuZ2V0TW9udGgoKVxuICAgICAgICAgICAgICAgICAgICA6IHNlbGYuY3VycmVudFllYXIgPiBzZWxmLmNvbmZpZy5tYXhEYXRlLmdldEZ1bGxZZWFyKCkpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBnZXREYXRlU3RyKHNwZWNpZmljRm9ybWF0KSB7XG4gICAgICAgIHZhciBmb3JtYXQgPSBzcGVjaWZpY0Zvcm1hdCB8fFxuICAgICAgICAgICAgKHNlbGYuY29uZmlnLmFsdElucHV0ID8gc2VsZi5jb25maWcuYWx0Rm9ybWF0IDogc2VsZi5jb25maWcuZGF0ZUZvcm1hdCk7XG4gICAgICAgIHJldHVybiBzZWxmLnNlbGVjdGVkRGF0ZXNcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGRPYmopIHsgcmV0dXJuIHNlbGYuZm9ybWF0RGF0ZShkT2JqLCBmb3JtYXQpOyB9KVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoZCwgaSwgYXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZi5jb25maWcubW9kZSAhPT0gXCJyYW5nZVwiIHx8XG4gICAgICAgICAgICAgICAgc2VsZi5jb25maWcuZW5hYmxlVGltZSB8fFxuICAgICAgICAgICAgICAgIGFyci5pbmRleE9mKGQpID09PSBpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmpvaW4oc2VsZi5jb25maWcubW9kZSAhPT0gXCJyYW5nZVwiXG4gICAgICAgICAgICA/IHNlbGYuY29uZmlnLmNvbmp1bmN0aW9uXG4gICAgICAgICAgICA6IHNlbGYubDEwbi5yYW5nZVNlcGFyYXRvcik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHVwZGF0ZVZhbHVlKHRyaWdnZXJDaGFuZ2UpIHtcbiAgICAgICAgaWYgKHRyaWdnZXJDaGFuZ2UgPT09IHZvaWQgMCkgeyB0cmlnZ2VyQ2hhbmdlID0gdHJ1ZTsgfVxuICAgICAgICBpZiAoc2VsZi5tb2JpbGVJbnB1dCAhPT0gdW5kZWZpbmVkICYmIHNlbGYubW9iaWxlRm9ybWF0U3RyKSB7XG4gICAgICAgICAgICBzZWxmLm1vYmlsZUlucHV0LnZhbHVlID1cbiAgICAgICAgICAgICAgICBzZWxmLmxhdGVzdFNlbGVjdGVkRGF0ZU9iaiAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgID8gc2VsZi5mb3JtYXREYXRlKHNlbGYubGF0ZXN0U2VsZWN0ZWREYXRlT2JqLCBzZWxmLm1vYmlsZUZvcm1hdFN0cilcbiAgICAgICAgICAgICAgICAgICAgOiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuaW5wdXQudmFsdWUgPSBnZXREYXRlU3RyKHNlbGYuY29uZmlnLmRhdGVGb3JtYXQpO1xuICAgICAgICBpZiAoc2VsZi5hbHRJbnB1dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzZWxmLmFsdElucHV0LnZhbHVlID0gZ2V0RGF0ZVN0cihzZWxmLmNvbmZpZy5hbHRGb3JtYXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmlnZ2VyQ2hhbmdlICE9PSBmYWxzZSlcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudChcIm9uVmFsdWVVcGRhdGVcIik7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uTW9udGhOYXZDbGljayhlKSB7XG4gICAgICAgIHZhciBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpO1xuICAgICAgICB2YXIgaXNQcmV2TW9udGggPSBzZWxmLnByZXZNb250aE5hdi5jb250YWlucyhldmVudFRhcmdldCk7XG4gICAgICAgIHZhciBpc05leHRNb250aCA9IHNlbGYubmV4dE1vbnRoTmF2LmNvbnRhaW5zKGV2ZW50VGFyZ2V0KTtcbiAgICAgICAgaWYgKGlzUHJldk1vbnRoIHx8IGlzTmV4dE1vbnRoKSB7XG4gICAgICAgICAgICBjaGFuZ2VNb250aChpc1ByZXZNb250aCA/IC0xIDogMSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc2VsZi55ZWFyRWxlbWVudHMuaW5kZXhPZihldmVudFRhcmdldCkgPj0gMCkge1xuICAgICAgICAgICAgZXZlbnRUYXJnZXQuc2VsZWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXZlbnRUYXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYXJyb3dVcFwiKSkge1xuICAgICAgICAgICAgc2VsZi5jaGFuZ2VZZWFyKHNlbGYuY3VycmVudFllYXIgKyAxKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChldmVudFRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJhcnJvd0Rvd25cIikpIHtcbiAgICAgICAgICAgIHNlbGYuY2hhbmdlWWVhcihzZWxmLmN1cnJlbnRZZWFyIC0gMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gdGltZVdyYXBwZXIoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciBpc0tleURvd24gPSBlLnR5cGUgPT09IFwia2V5ZG93blwiLCBldmVudFRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGUpLCBpbnB1dCA9IGV2ZW50VGFyZ2V0O1xuICAgICAgICBpZiAoc2VsZi5hbVBNICE9PSB1bmRlZmluZWQgJiYgZXZlbnRUYXJnZXQgPT09IHNlbGYuYW1QTSkge1xuICAgICAgICAgICAgc2VsZi5hbVBNLnRleHRDb250ZW50ID1cbiAgICAgICAgICAgICAgICBzZWxmLmwxMG4uYW1QTVtpbnQoc2VsZi5hbVBNLnRleHRDb250ZW50ID09PSBzZWxmLmwxMG4uYW1QTVswXSldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBtaW4gPSBwYXJzZUZsb2F0KGlucHV0LmdldEF0dHJpYnV0ZShcIm1pblwiKSksIG1heCA9IHBhcnNlRmxvYXQoaW5wdXQuZ2V0QXR0cmlidXRlKFwibWF4XCIpKSwgc3RlcCA9IHBhcnNlRmxvYXQoaW5wdXQuZ2V0QXR0cmlidXRlKFwic3RlcFwiKSksIGN1clZhbHVlID0gcGFyc2VJbnQoaW5wdXQudmFsdWUsIDEwKSwgZGVsdGEgPSBlLmRlbHRhIHx8XG4gICAgICAgICAgICAoaXNLZXlEb3duID8gKGUud2hpY2ggPT09IDM4ID8gMSA6IC0xKSA6IDApO1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSBjdXJWYWx1ZSArIHN0ZXAgKiBkZWx0YTtcbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dC52YWx1ZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpbnB1dC52YWx1ZS5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHZhciBpc0hvdXJFbGVtID0gaW5wdXQgPT09IHNlbGYuaG91ckVsZW1lbnQsIGlzTWludXRlRWxlbSA9IGlucHV0ID09PSBzZWxmLm1pbnV0ZUVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAobmV3VmFsdWUgPCBtaW4pIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9XG4gICAgICAgICAgICAgICAgICAgIG1heCArXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSArXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnQoIWlzSG91ckVsZW0pICtcbiAgICAgICAgICAgICAgICAgICAgICAgIChpbnQoaXNIb3VyRWxlbSkgJiYgaW50KCFzZWxmLmFtUE0pKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNNaW51dGVFbGVtKVxuICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnROdW1JbnB1dCh1bmRlZmluZWQsIC0xLCBzZWxmLmhvdXJFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5ld1ZhbHVlID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPVxuICAgICAgICAgICAgICAgICAgICBpbnB1dCA9PT0gc2VsZi5ob3VyRWxlbWVudCA/IG5ld1ZhbHVlIC0gbWF4IC0gaW50KCFzZWxmLmFtUE0pIDogbWluO1xuICAgICAgICAgICAgICAgIGlmIChpc01pbnV0ZUVsZW0pXG4gICAgICAgICAgICAgICAgICAgIGluY3JlbWVudE51bUlucHV0KHVuZGVmaW5lZCwgMSwgc2VsZi5ob3VyRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2VsZi5hbVBNICYmXG4gICAgICAgICAgICAgICAgaXNIb3VyRWxlbSAmJlxuICAgICAgICAgICAgICAgIChzdGVwID09PSAxXG4gICAgICAgICAgICAgICAgICAgID8gbmV3VmFsdWUgKyBjdXJWYWx1ZSA9PT0gMjNcbiAgICAgICAgICAgICAgICAgICAgOiBNYXRoLmFicyhuZXdWYWx1ZSAtIGN1clZhbHVlKSA+IHN0ZXApKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5hbVBNLnRleHRDb250ZW50ID1cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5sMTBuLmFtUE1baW50KHNlbGYuYW1QTS50ZXh0Q29udGVudCA9PT0gc2VsZi5sMTBuLmFtUE1bMF0pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gcGFkKG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpbml0KCk7XG4gICAgcmV0dXJuIHNlbGY7XG59XG5mdW5jdGlvbiBfZmxhdHBpY2tyKG5vZGVMaXN0LCBjb25maWcpIHtcbiAgICB2YXIgbm9kZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2VcbiAgICAgICAgLmNhbGwobm9kZUxpc3QpXG4gICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHggaW5zdGFuY2VvZiBIVE1MRWxlbWVudDsgfSk7XG4gICAgdmFyIGluc3RhbmNlcyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChub2RlLmdldEF0dHJpYnV0ZShcImRhdGEtZnAtb21pdFwiKSAhPT0gbnVsbClcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIGlmIChub2RlLl9mbGF0cGlja3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG5vZGUuX2ZsYXRwaWNrci5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgbm9kZS5fZmxhdHBpY2tyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZS5fZmxhdHBpY2tyID0gRmxhdHBpY2tySW5zdGFuY2Uobm9kZSwgY29uZmlnIHx8IHt9KTtcbiAgICAgICAgICAgIGluc3RhbmNlcy5wdXNoKG5vZGUuX2ZsYXRwaWNrcik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluc3RhbmNlcy5sZW5ndGggPT09IDEgPyBpbnN0YW5jZXNbMF0gOiBpbnN0YW5jZXM7XG59XG5pZiAodHlwZW9mIEhUTUxFbGVtZW50ICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgdHlwZW9mIEhUTUxDb2xsZWN0aW9uICE9PSBcInVuZGVmaW5lZFwiICYmXG4gICAgdHlwZW9mIE5vZGVMaXN0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgSFRNTENvbGxlY3Rpb24ucHJvdG90eXBlLmZsYXRwaWNrciA9IE5vZGVMaXN0LnByb3RvdHlwZS5mbGF0cGlja3IgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKHRoaXMsIGNvbmZpZyk7XG4gICAgfTtcbiAgICBIVE1MRWxlbWVudC5wcm90b3R5cGUuZmxhdHBpY2tyID0gZnVuY3Rpb24gKGNvbmZpZykge1xuICAgICAgICByZXR1cm4gX2ZsYXRwaWNrcihbdGhpc10sIGNvbmZpZyk7XG4gICAgfTtcbn1cbnZhciBmbGF0cGlja3IgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGNvbmZpZykge1xuICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIF9mbGF0cGlja3Iod2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpLCBjb25maWcpO1xuICAgIH1cbiAgICBlbHNlIGlmIChzZWxlY3RvciBpbnN0YW5jZW9mIE5vZGUpIHtcbiAgICAgICAgcmV0dXJuIF9mbGF0cGlja3IoW3NlbGVjdG9yXSwgY29uZmlnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKHNlbGVjdG9yLCBjb25maWcpO1xuICAgIH1cbn07XG5mbGF0cGlja3IuZGVmYXVsdENvbmZpZyA9IHt9O1xuZmxhdHBpY2tyLmwxMG5zID0ge1xuICAgIGVuOiBfX2Fzc2lnbih7fSwgRW5nbGlzaCksXG4gICAgZGVmYXVsdDogX19hc3NpZ24oe30sIEVuZ2xpc2gpLFxufTtcbmZsYXRwaWNrci5sb2NhbGl6ZSA9IGZ1bmN0aW9uIChsMTBuKSB7XG4gICAgZmxhdHBpY2tyLmwxMG5zLmRlZmF1bHQgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZmxhdHBpY2tyLmwxMG5zLmRlZmF1bHQpLCBsMTBuKTtcbn07XG5mbGF0cGlja3Iuc2V0RGVmYXVsdHMgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgZmxhdHBpY2tyLmRlZmF1bHRDb25maWcgPSBfX2Fzc2lnbihfX2Fzc2lnbih7fSwgZmxhdHBpY2tyLmRlZmF1bHRDb25maWcpLCBjb25maWcpO1xufTtcbmZsYXRwaWNrci5wYXJzZURhdGUgPSBjcmVhdGVEYXRlUGFyc2VyKHt9KTtcbmZsYXRwaWNrci5mb3JtYXREYXRlID0gY3JlYXRlRGF0ZUZvcm1hdHRlcih7fSk7XG5mbGF0cGlja3IuY29tcGFyZURhdGVzID0gY29tcGFyZURhdGVzO1xuaWYgKHR5cGVvZiBqUXVlcnkgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIGpRdWVyeS5mbiAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGpRdWVyeS5mbi5mbGF0cGlja3IgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG4gICAgICAgIHJldHVybiBfZmxhdHBpY2tyKHRoaXMsIGNvbmZpZyk7XG4gICAgfTtcbn1cbkRhdGUucHJvdG90eXBlLmZwX2luY3IgPSBmdW5jdGlvbiAoZGF5cykge1xuICAgIHJldHVybiBuZXcgRGF0ZSh0aGlzLmdldEZ1bGxZZWFyKCksIHRoaXMuZ2V0TW9udGgoKSwgdGhpcy5nZXREYXRlKCkgKyAodHlwZW9mIGRheXMgPT09IFwic3RyaW5nXCIgPyBwYXJzZUludChkYXlzLCAxMCkgOiBkYXlzKSk7XG59O1xuaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICB3aW5kb3cuZmxhdHBpY2tyID0gZmxhdHBpY2tyO1xufVxuZXhwb3J0IGRlZmF1bHQgZmxhdHBpY2tyO1xuIiwgImV4cG9ydCBmdW5jdGlvbiBnZW51aW5lS2V5cyhkdkZpbGU6IGFueSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBnZW51aW5lS2V5czogc3RyaW5nW10gPSBbXVxuICAgIE9iamVjdC5rZXlzKGR2RmlsZSkuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICBpZiAoIWdlbnVpbmVLZXlzLm1hcChrID0+IGsudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKS5pbmNsdWRlcyhrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKSkge1xuICAgICAgICAgICAgZ2VudWluZUtleXMucHVzaChrZXkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoa2V5ICE9PSBrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKSB7XG4gICAgICAgICAgICAgICAgZ2VudWluZUtleXNbZ2VudWluZUtleXMuaW5kZXhPZihrZXkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgXCItXCIpKV0gPSBrZXlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIGdlbnVpbmVLZXlzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlRHVyYXRpb24oZHZEdXJBOiBhbnksIGR2RHVyQjogYW55KTogYm9vbGVhbiB7XG4gICAgY29uc3Qgbm9ybWFsaXplZEEgPSBkdkR1ckEuc2hpZnRUbyhcInllYXJzXCIsIFwibW9udGhzXCIsIFwid2Vla3NcIiwgXCJkYXlzXCIsIFwiaG91cnNcIiwgXCJtaW51dGVzXCIsIFwic2Vjb25kc1wiLCBcIm1pbGxpc2Vjb25kc1wiKS5ub3JtYWxpemUoKVxuICAgIGNvbnN0IG5vcm1hbGl6ZWRCID0gZHZEdXJCLnNoaWZ0VG8oXCJ5ZWFyc1wiLCBcIm1vbnRoc1wiLCBcIndlZWtzXCIsIFwiZGF5c1wiLCBcImhvdXJzXCIsIFwibWludXRlc1wiLCBcInNlY29uZHNcIiwgXCJtaWxsaXNlY29uZHNcIikubm9ybWFsaXplKClcbiAgICByZXR1cm4gbm9ybWFsaXplZEEuZXF1YWxzKG5vcm1hbGl6ZWRCKVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBNZW51LCBOb3RpY2UsIHNldEljb24sIFRleHRBcmVhQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgTXVsdGlGaWxlTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL011bHRpRmlsZU1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyBGaWVsZEljb24sIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBTZXR0aW5nTG9jYXRpb24gfSBmcm9tIFwiLi4vRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNdWx0aUZpbGVGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIGR2UXVlcnlTdHJpbmc6IFRleHRBcmVhQ29tcG9uZW50XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5NdWx0aUZpbGUpXG4gICAgfVxuXG4gICAgc3RhdGljIGJ1aWxkTWFya0Rvd25MaW5rKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgcGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZGVzdEZpbGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocGF0aCwgZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZGVzdEZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBwbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKFxuICAgICAgICAgICAgICAgIGRlc3RGaWxlLFxuICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgZGVzdEZpbGUuYmFzZW5hbWVcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIlxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0RmlsZXMgPSAoY3VycmVudEZpbGU/OiBURmlsZSk6IFRGaWxlW10gPT4ge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgZ2V0UmVzdWx0cyA9IChhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKSA9PiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgXCJjdXJyZW50XCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZ31gKSkoYXBpLCBhcGkucGFnZShjdXJyZW50RmlsZT8ucGF0aCkpXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFdyb25nIHF1ZXJ5IGZvciBmaWVsZCA8JHt0aGlzLmZpZWxkLm5hbWV9PlxcbmNoZWNrIHlvdXIgc2V0dGluZ3NgLCAzMDAwKVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkYXRhdmlldyA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVEYXRhdmlld0pzICYmIGRhdGF2aWV3Py5zZXR0aW5ncy5lbmFibGVJbmxpbmVEYXRhdmlld0pzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzUGF0aCA9IGdldFJlc3VsdHMoZGF0YXZpZXcuYXBpKS52YWx1ZXMubWFwKCh2OiBhbnkpID0+IHYuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZpbHRlcihmID0+IGZpbGVzUGF0aC5pbmNsdWRlcyhmLnBhdGgpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSwgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE11bHRpRmlsZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSlcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpXG4gICAgICAgIGlmIChNdWx0aUZpbGVGaWVsZC5pc01lbnUobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlICR7bmFtZX1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudS5maWVsZHNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChNdWx0aUZpbGVGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBgdXBkYXRlXyR7bmFtZX1gLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7bmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoTXVsdGlGaWxlRmllbGQuaXNGaWVsZE9wdGlvbnMobG9jYXRpb24pKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5hZGRPcHRpb24oRmllbGRJY29uW0ZpZWxkVHlwZS5GaWxlXSwgYWN0aW9uLCBgVXBkYXRlICR7bmFtZX0ncyB2YWx1ZWApO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBNdWx0aUZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciB2YWx1ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRyczogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9ID0ge31cbiAgICApOiB2b2lkIHtcbiAgICAgICAgYXR0cnMuY2xzID0gXCJ2YWx1ZS1jb250YWluZXJcIlxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpKVxuXG4gICAgICAgIGNvbnN0IHNlYXJjaEJ0biA9IGZpZWxkQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIpXG4gICAgICAgIHNldEljb24oc2VhcmNoQnRuLCBGaWVsZEljb25bRmllbGRUeXBlLkZpbGVdKVxuICAgICAgICBjb25zdCBzcGFjZXIgPSBmaWVsZENvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJzcGFjZXJcIiB9KVxuXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBbXCJmaWxlXCJdW1wicGF0aFwiXSlcbiAgICAgICAgbGV0IGZpZWxkTW9kYWw6IE11bHRpRmlsZU1vZGFsO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBNdWx0aUZpbGVNb2RhbCh0aGlzLnBsdWdpbiwgZmlsZSwgdGhpcy5maWVsZCwgcFt0aGlzLmZpZWxkLm5hbWVdKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHNlYXJjaEJ0bi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKClcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LmFsd2F5c09uKSB7XG4gICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uc2hvdygpXG4gICAgICAgICAgICAgICAgc3BhY2VyLmhpZGUoKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBzZWFyY2hCdG4uaGlkZSgpXG4gICAgICAgICAgICAgICAgc3BhY2VyLnNob3coKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWxlQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IFF1ZXJ5IChvcHRpb25hbClcIiwgY2xzOiAnZmllbGQtb3B0aW9uJyB9KTtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IGR2UXVlcnlTdHJpbmdUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5kdlF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgfSlcblxuXG4gICAgICAgIGNvbnN0IGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSlcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkFsaWFzXCIgfSk7XG4gICAgICAgIGN1c3RvbWVSZW5kZXJpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJQZXJzb25hbGlzZSB0aGUgcmVuZGVyaW5nIG9mIHlvdXIgbGlua3MnIGFsaWFzZXMgd2l0aCBhIGZ1bmN0aW9uIHJldHVybmluZyBhIHN0cmluZyAoPHBhZ2U+IG9iamVjdCBpcyBhdmFpbGFibGUpXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgY3VzdG9tZVJlbmRlcmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcImNvZGVcIiwge1xuICAgICAgICAgICAgdGV4dDogYGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIDxmdW5jdGlvbiB1c2luZyBcInBhZ2VcIj47IH1gXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIgPSBjdXN0b21lUmVuZGVyaW5nVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KTtcbiAgICAgICAgY29uc3QgY3VzdG9tUmVuZGVyaW5nID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGN1c3RvbWVSZW5kZXJpbmdDb250YWluZXIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGN1c3RvbVJlbmRlcmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21SZW5kZXJpbmcuc2V0UGxhY2Vob2xkZXIoXCJKYXZhc2NyaXB0IHN0cmluZywgXCIgK1xuICAgICAgICAgICAgXCJ0aGUgXFxcInBhZ2VcXFwiIChkYXRhdmlldyBwYWdlIHR5cGUpIHZhcmlhYmxlIGlzIGF2YWlsYWJsZVxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAxOiBwYWdlLmZpbGUubmFtZVxcbmV4YW1wbGUgMjogYCR7cGFnZS5maWxlLm5hbWV9IG9mIGdlbmRlciAke3BhZ2UuZ2VuZGVyfWBcIilcbiAgICAgICAgY3VzdG9tUmVuZGVyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tUmVuZGVyaW5nKTtcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2c3RhY2tlZFwiIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiU29ydGluZyBvcmRlclwiIH0pO1xuICAgICAgICBjdXN0b21Tb3J0aW5nVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiUGVyc29uYWxpc2UgdGhlIHNvcnRpbmcgb3JkZXIgb2YgeW91ciBsaW5rcyB3aXRoIGEgaW5zdHJ1Y3Rpb24gdGFraW5nIDIgZmlsZXMgKGEsIGIpIGFuZCByZXR1cm5pbmcgLTEsIDAgb3IgMVwiLCBjbHM6ICdzdWItdGV4dCcgfSk7XG4gICAgICAgIGN1c3RvbVNvcnRpbmdUb3BDb250YWluZXIuY3JlYXRlRWwoXCJjb2RlXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IGAoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyYFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBjdXN0b21Tb3J0aW5nQ29udGFpbmVyID0gY3VzdG9tU29ydGluZ1RvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgY3VzdG9tU29ydGluZyA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChjdXN0b21Tb3J0aW5nQ29udGFpbmVyKTtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLmNvbHMgPSA1MDtcbiAgICAgICAgY3VzdG9tU29ydGluZy5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBjdXN0b21Tb3J0aW5nLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21Tb3J0aW5nIHx8IFwiXCIpO1xuICAgICAgICBjdXN0b21Tb3J0aW5nLnNldFBsYWNlaG9sZGVyKFwiSmF2YXNjcmlwdCBpbnN0cnVjdGlvbiwgXCIgK1xuICAgICAgICAgICAgXCIoYTogVEZpbGUsIGI6IFRGaWxlKTogbnVtYmVyXFxuXCIgK1xuICAgICAgICAgICAgXCJleGFtcGxlIDEgKGFscGhhYmV0aWNhbCBvcmRlcik6IGEuYmFzZW5hbWUgPCBiLmJhc2VuYW1lID8gMSA6IC0xIFxcblwiICtcbiAgICAgICAgICAgIFwiZXhhbXBsZSAyIChjcmVhdGlvbiB0aW1lIG5ld2VyIHRvIG9sZGVyKTogYi5zdGF0LmN0aW1lIC0gYi5zdGF0LmN0aW1lXCIpXG4gICAgICAgIGN1c3RvbVNvcnRpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVNvcnRpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoY3VzdG9tU29ydGluZyk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlRmlsZUNvbnRhaW5lcihwYXJlbnRDb250YWluZXIpXG4gICAgfVxuXG4gICAgcHVibGljIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nIHx8IFwiXCI7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHVibGljIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyB8IHsgcGF0aDogc3RyaW5nIH0gfCB7IHBhdGg6IHN0cmluZyB9W10pOiBib29sZWFuIHtcbiAgICAgICAgLy90b2RvIDogbWFuYWdlIGJvdGggcmF3IGxpbmtzIGFuZCBkdiBMaW5rIG9iamVjdHNcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBwdWJsaWMgZGlzcGxheVZhbHVlKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZywgb25DbGljazogKCkgPT4ge30pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBjb25zdCBkdlZhbHVlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpW2ZpZWxkTmFtZV1cbiAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IEFycmF5LmlzQXJyYXkoZHZWYWx1ZSkgPyBkdlZhbHVlIDogW2R2VmFsdWVdXG4gICAgICAgICAgICB2YWx1ZXMuZm9yRWFjaCgodmFsdWUsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZHZBcGkudmFsdWUuaXNMaW5rKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLmNyZWF0ZUVsKCdhJywgeyB0ZXh0OiB2YWx1ZS5wYXRoLnNwbGl0KFwiL1wiKS5sYXN0KCkucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIikgfSk7XG4gICAgICAgICAgICAgICAgICAgIGxpbmsub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHZhbHVlLnBhdGgsIGZpbGUucGF0aCwgdHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2soKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IHZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaSA8IHZhbHVlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jcmVhdGVFbCgnc3BhbicsIHsgdGV4dDogXCIgfCBcIiB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdigpXG4gICAgfVxufSIsICJpbXBvcnQgeyBURmlsZSwgRnV6enlTdWdnZXN0TW9kYWwsIEZ1enp5TWF0Y2gsIEJ1dHRvbkNvbXBvbmVudCwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0gfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXVsdGlGaWxlRnV6enlTdWdnZXN0ZXIgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuXG4gICAgcHJpdmF0ZSBzZWxlY3RlZEZpbGVzOiBURmlsZVtdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBmaWVsZDogRmllbGQsXG4gICAgICAgIGluaXRpYWxWYWx1ZU9iamVjdDogYW55LFxuICAgICAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLFxuICAgICAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgcHJpdmF0ZSBhZnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzTGlzdDogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBwcml2YXRlIGFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJkYXRhdmlld1wiXT8uYXBpXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRWYWx1ZXM6IEFycmF5PGFueT4gPSBBcnJheS5pc0FycmF5KGluaXRpYWxWYWx1ZU9iamVjdCkgPyBpbml0aWFsVmFsdWVPYmplY3QgOiBbaW5pdGlhbFZhbHVlT2JqZWN0XVxuICAgICAgICAgICAgc2VsZWN0ZWRWYWx1ZXMuZm9yRWFjaCh2YWx1ZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGR2QXBpLnZhbHVlLmlzTGluayh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodmFsdWUucGF0aClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkgdGhpcy5zZWxlY3RlZEZpbGVzLnB1c2goZmlsZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBzdXBlci5vbk9wZW4oKVxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLm9ua2V5ZG93biA9IGFzeW5jIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT0gXCJFbnRlclwiICYmIGUuYWx0S2V5KSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXBsYWNlVmFsdWVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KVxuICAgICAgICBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGNvbnN0IGluZm9Db250YWluZXIgPSBidXR0b25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImluZm9cIiB9KVxuICAgICAgICBpbmZvQ29udGFpbmVyLnNldFRleHQoXCJBbHQrRW50ZXIgdG8gc2F2ZVwiKVxuICAgICAgICAvL2NvbmZpcm0gYnV0dG9uXG4gICAgICAgIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGJ1dHRvbkNvbnRhaW5lcilcbiAgICAgICAgY29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpXG4gICAgICAgIGNvbmZpcm1CdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlcGxhY2VWYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICB9KVxuICAgICAgICAvL2NhbmNlbCBidXR0b25cbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4geyB0aGlzLmNsb3NlKCk7IH0pXG4gICAgICAgIC8vY2xlYXIgdmFsdWUgYnV0dG9uXG4gICAgICAgIGNvbnN0IGNsZWFyQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChidXR0b25Db250YWluZXIpXG4gICAgICAgIGNsZWFyQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICBjbGVhckJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY2xlYXJWYWx1ZXMoKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICAgICAgY2xlYXJCdXR0b24uYnV0dG9uRWwuYWRkQ2xhc3MoXCJkYW5nZXJcIilcblxuICAgICAgICB0aGlzLm1vZGFsRWwuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKVxuICAgIH1cblxuICAgIGdldEl0ZW1zKCk6IFRGaWxlW10ge1xuICAgICAgICBjb25zdCBzb3J0aW5nTWV0aG9kID0gbmV3IEZ1bmN0aW9uKFwiYVwiLCBcImJcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21Tb3J0aW5nfWApIHx8IGZ1bmN0aW9uIChhOiBURmlsZSwgYjogVEZpbGUpIHsgcmV0dXJuIGEuYmFzZW5hbWUgPCBiLmJhc2VuYW1lID8gLTEgOiAxIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMucGx1Z2luLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgICAgIHJldHVybiBmaWxlTWFuYWdlci5nZXRGaWxlcyh0aGlzLmZpbGUpLnNvcnQoc29ydGluZ01ldGhvZCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQoaXRlbTogVEZpbGUpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gaXRlbS5iYXNlbmFtZTtcbiAgICB9XG5cbiAgICBhc3luYyByZXBsYWNlVmFsdWVzKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnNlbGVjdGVkRmlsZXMubWFwKGZpbGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgICAgIGxldCBhbGlhczogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgICAgICBhbGlhcyA9IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZShmaWxlLnBhdGgpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIEZNLmJ1aWxkTWFya0Rvd25MaW5rKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIGZpbGUuYmFzZW5hbWUsIGFsaWFzKVxuICAgICAgICB9KVxuICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXBsYWNlVmFsdWVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuam9pbihcIiwgXCIpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlclxuICAgICAgICAgICAgICAgIC5wdXNoVGFzaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydFZhbHVlcyhcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmpvaW4oXCIsIFwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWZ0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFzTGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXNDb21tZW50XG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBhc3luYyBjbGVhclZhbHVlcygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAucHVzaFRhc2soKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXMoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGUsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgXCJcIlxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IEZ1enp5TWF0Y2g8VEZpbGU+LCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250YWluZXIgPSBlbC5jcmVhdGVEaXYoeyBjbHM6IFwiaXRlbS13aXRoLWFkZC1vblwiIH0pO1xuICAgICAgICAgICAgc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgICAgIHRleHQ6IG5ldyBGdW5jdGlvbihcInBhZ2VcIiwgYHJldHVybiAke3RoaXMuZmllbGQub3B0aW9ucy5jdXN0b21SZW5kZXJpbmd9YCkoZHZBcGkucGFnZSh2YWx1ZS5pdGVtLnBhdGgpKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gc3VnZ2VzdGlvbkNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiYWRkLW9uXCIgfSlcbiAgICAgICAgICAgIGZpbGVQYXRoLnNldFRleHQodmFsdWUuaXRlbS5wYXRoKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZS5pdGVtLmJhc2VuYW1lKVxuICAgICAgICB9XG4gICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY29udGFpbmVyXCIpXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInNwYWNlclwiIH0pXG4gICAgICAgIGVsLmFwcGVuZENoaWxkKHNwYWNlcilcblxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGVzLnNvbWUoZmlsZSA9PiBmaWxlLnBhdGggPT09IHZhbHVlLml0ZW0ucGF0aCkpIHtcbiAgICAgICAgICAgIGVsLmFkZENsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJpY29uLWNvbnRhaW5lclwiIH0pXG4gICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXJTZWxlY3RlZCgpIHtcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGNob29zZXIgPSB0aGlzLmNob29zZXJcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IEhUTUxEaXZFbGVtZW50W10gPSBjaG9vc2VyLnN1Z2dlc3Rpb25zXG4gICAgICAgIGNvbnN0IHZhbHVlczogRnV6enlNYXRjaDxURmlsZT5bXSA9IGNob29zZXIudmFsdWVzXG5cbiAgICAgICAgc3VnZ2VzdGlvbnMuZm9yRWFjaCgocywgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGaWxlcy5zb21lKGZpbGUgPT4gZmlsZS5wYXRoID09PSB2YWx1ZXNbaV0uaXRlbS5wYXRoKSkge1xuICAgICAgICAgICAgICAgIHMuYWRkQ2xhc3MoXCJ2YWx1ZS1jaGVja2VkXCIpXG4gICAgICAgICAgICAgICAgaWYgKHMucXVlcnlTZWxlY3RvckFsbChcIi5pY29uLWNvbnRhaW5lclwiKS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpY29uQ29udGFpbmVyID0gcy5jcmVhdGVEaXYoeyBjbHM6IFwiaWNvbi1jb250YWluZXJcIiB9KVxuICAgICAgICAgICAgICAgICAgICBzZXRJY29uKGljb25Db250YWluZXIsIFwiY2hlY2stY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzLnJlbW92ZUNsYXNzKFwidmFsdWUtY2hlY2tlZFwiKVxuICAgICAgICAgICAgICAgIHMucXVlcnlTZWxlY3RvckFsbChcIi5pY29uLWNvbnRhaW5lclwiKS5mb3JFYWNoKGljb24gPT4gaWNvbi5yZW1vdmUoKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKHZhbHVlOiBGdXp6eU1hdGNoPFRGaWxlPiwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZpbGVzLmluY2x1ZGVzKHZhbHVlLml0ZW0pKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmlsZXMucmVtb3ZlKHZhbHVlLml0ZW0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkRmlsZXMucHVzaCh2YWx1ZS5pdGVtKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyU2VsZWN0ZWQoKVxuICAgIH1cblxuICAgIGFzeW5jIG9uQ2hvb3NlSXRlbShpdGVtOiBURmlsZSk6IFByb21pc2U8dm9pZD4geyB9XG5cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUsIE1lbnUsIFRleHRBcmVhQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0ICogYXMgTG9va3VwIGZyb20gXCJzcmMvdHlwZXMvbG9va3VwVHlwZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyBTdGF0dXMgfSBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuaW1wb3J0IHsgdXBkYXRlTG9va3VwcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvdXBkYXRlTG9va3Vwc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMb29rdXBGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbiwgZmllbGQsIEZpZWxkVHlwZS5Mb29rdXApXG4gICAgICAgIHRoaXMuc2hvd01vZGFsT3B0aW9uID0gZmFsc2VcbiAgICB9XG5cbiAgICBhZGRGaWVsZE9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGZpbGU6IFRGaWxlLCBsb2NhdGlvbjogTWVudSB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCB8IEZpZWxkT3B0aW9ucyk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlICYmIHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGYgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4O1xuICAgICAgICAgICAgY29uc3QgaWQgPSBgJHtmaWxlLnBhdGh9X18ke3RoaXMuZmllbGQubmFtZX1gO1xuICAgICAgICAgICAgbGV0IHN0YXR1czogU3RhdHVzO1xuICAgICAgICAgICAgc3RhdHVzID0gZi5maWxlTG9va3VwRmllbGRzU3RhdHVzLmdldChpZCkgfHwgU3RhdHVzLmNoYW5nZWRcbiAgICAgICAgICAgIC8vZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUgaXMgdXBkYXRlZCBhZnRlciBmaWxlQ2xhc3MgY2hhbmdlIGNhY2hlIHJlc29sdXRpb24gc28gd29uJ3QgYmUgdHJpZ2dlcmVkIHByb3Blcmx5LiBcbiAgICAgICAgICAgIC8vd2UgYW50aWNpcGF0ZSB0aGlzIGNoYW5nZSBzbyB0aGF0IHRoZSB1cGRhdGUgYnV0dG9uIGFwcGVhcnNcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmdldChgJHtmaWxlLnBhdGh9X19yZWxhdGVkX18ke3RoaXMuZmllbGQuZmlsZUNsYXNzTmFtZX1fX18ke3RoaXMuZmllbGQubmFtZX1gKSAhPT1cbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZVxuICAgICAgICAgICAgKSBzdGF0dXMgPSBTdGF0dXMuY2hhbmdlZFxuICAgICAgICAgICAgY29uc3QgaWNvbiA9IHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQgPyBcInJlZnJlc2gtY2N3XCIgOiBcImZpbGUtY2hlY2tcIlxuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4geyB1cGRhdGVMb29rdXBzKHRoaXMucGx1Z2luLCBcInNpbmdsZV9jb21tYW5kXCIsIHsgZmlsZTogZmlsZSwgZmllbGROYW1lOiB0aGlzLmZpZWxkLm5hbWUgfSkgfVxuICAgICAgICAgICAgaWYgKExvb2t1cEZpZWxkLmlzTWVudShsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oaWNvbik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc1N1Z2dlc3QobG9jYXRpb24pICYmIHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5VcGRhdGUgPGI+JHtuYW1lfTwvYj48L3NwYW4+YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGljb246IGljb25cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihpY29uLCBhY3Rpb24sIGBVcGRhdGUgJHtuYW1lfSdzIHZhbHVlYCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKExvb2t1cEZpZWxkLmlzRmllbGRPcHRpb25zKGxvY2F0aW9uKSAmJiBzdGF0dXMgPT09IFN0YXR1cy51cFRvRGF0ZSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihpY29uLCAoKSA9PiB7IH0sIGAke25hbWV9IGlzIHVwIHRvIGRhdGVgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChMb29rdXBGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihcInNlcnZlci1jb2dcIiwgKCkgPT4geyB9LCBgJHtuYW1lfSBpcyBhdXRvLXVwZGF0ZWRgLCBcImRpc2FibGVkXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vbm8gZmllbGQgbW9kYWwsIHdlIGluY2x1ZGUgdGhlIGZpZWxkIGRpcmVjdGx5XG4gICAgICAgIGlmIChsaW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY3JlYXRlRHZGaWVsZChkdjogYW55LCBwOiBhbnksIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyB9KTogdm9pZCB7XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIGRpc3BsYXlTZWxlY3RlZE91dHB1dE9wdGlvbkNvbnRhaW5lcihvcHRpb25Db250YWluZXJzOiBbQXJyYXk8a2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlPiwgSFRNTEVsZW1lbnQgfCB1bmRlZmluZWRdW10sIHZhbHVlOiBrZXlvZiB0eXBlb2YgTG9va3VwLlR5cGUpIHtcbiAgICAgICAgb3B0aW9uQ29udGFpbmVycy5mb3JFYWNoKG9wdGlvbnNfc2V0ID0+IHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zX3NldFswXS5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBvcHRpb25zX3NldFsxXT8uc2hvdygpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNfc2V0WzFdPy5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwdWJsaWMgZGlzcGxheVZhbHVlKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZywgb25DbGlja2VkID0gKCkgPT4geyB9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpPy5maWxlQ2xhc3NOYW1lIHx8IFwicHJlc2V0RmllbGRcIlxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUuZ2V0KGAke2ZpbGUucGF0aH1fX3JlbGF0ZWRfXyR7ZmlsZUNsYXNzTmFtZX1fX18ke2ZpZWxkTmFtZX1gKSB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgZGlzcGxheVNlbGVjdGVkT3V0cHV0V2FybmluZ0NvbnRhaW5lcihvcHRpb25XYXJuaW5nQ29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgdmFsdWU6IGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSkge1xuICAgICAgICBbTG9va3VwLlR5cGUuTGlua3NCdWxsZXRMaXN0LnRvU3RyaW5nKCksIExvb2t1cC5UeXBlLkN1c3RvbUJ1bGxldExpc3QudG9TdHJpbmcoKV0uaW5jbHVkZXModmFsdWUpID9cbiAgICAgICAgICAgIG9wdGlvbldhcm5pbmdDb250YWluZXIuc2hvdygpIDogb3B0aW9uV2FybmluZ0NvbnRhaW5lci5oaWRlKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVMb29rdXBDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuXG4gICAgICAgIGNvbnN0IGF1dG9VcGRhdGVUb3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIGNvbnN0IGF1dG9VcGRhdGVDb250YWluZXIgPSBhdXRvVXBkYXRlVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICBhdXRvVXBkYXRlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiQXV0byB1cGRhdGUgdGhpcyBmaWVsZCBcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBhdXRvVXBkYXRlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgYXV0b1VwZGF0ZSA9IG5ldyBUb2dnbGVDb21wb25lbnQoYXV0b1VwZGF0ZUNvbnRhaW5lcik7XG4gICAgICAgIGF1dG9VcGRhdGVUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJUaGlzIGNvdWxkIGxlYWQgdG8gbGF0ZW5jaWVzIGRlcGVuZGluZyBvbiB0aGUgcXVlcmllc1wiLCBjbHM6ICdzdWItdGV4dCB3YXJuaW5nJyB9KTtcblxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgPT09IHVuZGVmaW5lZCkgdGhpcy5maWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgPSB0cnVlXG4gICAgICAgIGF1dG9VcGRhdGUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmF1dG9VcGRhdGUpO1xuICAgICAgICBhdXRvVXBkYXRlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlID0gdmFsdWVcbiAgICAgICAgfSlcblxuXG5cbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIlBhZ2VzIHRvIGxvb2sgZm9yIGluIHlvdXIgdmF1bHQgKERhdGF2aWV3SlMgUXVlcnkpXCIsIGNsczogJ2xhYmVsJyB9KTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ1RvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3SlMgcXVlcnkgb2YgdGhlIGZvcm0gYGR2LnBhZ2VzKC4uLilgXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IGR2UXVlcnlTdHJpbmdUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnN0IGR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuaW5wdXRFbC5jb2xzID0gNTA7XG4gICAgICAgIGR2UXVlcnlTdHJpbmcuaW5wdXRFbC5yb3dzID0gNDtcbiAgICAgICAgZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcbiAgICAgICAgZHZRdWVyeVN0cmluZy5zZXRQbGFjZWhvbGRlcihcImV4YW1wZTogZHYucGFnZXMoJyNzdHVkZW50JylcIilcblxuICAgICAgICBkdlF1ZXJ5U3RyaW5nLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGR2UXVlcnlTdHJpbmcpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IHRhcmdldEZpZWxkVG9wQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJ2c3RhY2tlZFwiIH0pO1xuICAgICAgICBjb25zdCB0YXJnZXRGaWVsZENvbnRhaW5lciA9IHRhcmdldEZpZWxkVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICB0YXJnZXRGaWVsZENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIk5hbWUgb2YgdGhlIHJlbGF0ZWQgZmllbGRcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBjb25zdCB0YXJnZXRGaWVsZE5hbWUgPSBuZXcgVGV4dENvbXBvbmVudCh0YXJnZXRGaWVsZENvbnRhaW5lcik7XG4gICAgICAgIHRhcmdldEZpZWxkTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKVxuICAgICAgICB0YXJnZXRGaWVsZE5hbWUuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIilcbiAgICAgICAgdGFyZ2V0RmllbGRUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJmaWVsZCBpbiB0aGUgdGFyZ2V0IHBhZ2VzIHRoYXQgY29udGFpbnMgYSBsaW5rIHRvIHRoZSBwYWdlIHdoZXJlIHRoaXMgbG9va3VwIGZpZWxkIGlzXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgdGFyZ2V0RmllbGROYW1lLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy50YXJnZXRGaWVsZE5hbWUgfHwgXCJcIik7XG4gICAgICAgIHRhcmdldEZpZWxkTmFtZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMudGFyZ2V0RmllbGROYW1lID0gdmFsdWU7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKHRhcmdldEZpZWxkTmFtZSlcbiAgICAgICAgfSlcblxuICAgICAgICAvL2xvb2t1cCB0eXBlIHNlbGVjdG9yXG4gICAgICAgIGNvbnN0IG91dHB1dFR5cGVDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSA9IHRoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlIHx8IExvb2t1cC5UeXBlLkxpbmtzTGlzdFxuICAgICAgICBvdXRwdXRUeXBlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiVHlwZSBvZiBvdXRwdXRcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBvdXRwdXRUeXBlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBvdXRwdXRUeXBlTGlzdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChvdXRwdXRUeXBlQ29udGFpbmVyKTtcbiAgICAgICAgT2JqZWN0LmtleXMoTG9va3VwLlR5cGUpLmZvckVhY2goKG91dHB1dFR5cGU6IGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSkgPT4ge1xuICAgICAgICAgICAgb3V0cHV0VHlwZUxpc3QuYWRkT3B0aW9uKG91dHB1dFR5cGUsIExvb2t1cC5EZXNjcmlwdGlvbltvdXRwdXRUeXBlXSlcbiAgICAgICAgfSlcbiAgICAgICAgb3V0cHV0VHlwZUxpc3Quc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLm91dHB1dFR5cGUpXG5cbiAgICAgICAgY29uc3Qgb3V0cHV0V2FybmluZ0NvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgb3V0cHV0V2FybmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDpcbiAgICAgICAgICAgICAgICBcIldhcm5pbmc6IHRoaXMgbWF5IG92ZXJyaWRlIHNvbWUgbGluZXMgdW5kZXIgeW91ciBsaXN0LiBcIiArXG4gICAgICAgICAgICAgICAgXCJUaGVyZSBzaG91bGRuJ3QgYmUgYW4gZXh0cmEgbWFudWFsIGl0ZW0gaW4gdGhlIGxpc3QgdGhhdCBpcyBhdXRvbWF0aWNhbGx5IFwiICtcbiAgICAgICAgICAgICAgICBcInJlbmRlcmVkIGJ5IHRoaXMgZmllbGQ6IGl0IHdvdWxkIGJlIG92ZXJyaWRlbiBhZnRlciBlYWNoIGZpZWxkIGluZGV4aW5nXCIsXG4gICAgICAgICAgICBjbHM6IFwiZmllbGQtd2FybmluZ1wiXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vQnVpbHQgaW4gc3VtbWFyaXpuZyBmdW5jdGlvbiBvcHRpb25zXG4gICAgICAgIGNvbnN0IGJ1aWx0aW5PcHRpb25zQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Ub3BDb250YWluZXIgPSBidWlsdGluT3B0aW9uc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KVxuICAgICAgICBjb25zdCBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Db250YWluZXIgPSBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Ub3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gPSB0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24gfHwgTG9va3VwLkRlZmF1bHQuQnVpbHRpblN1bW1hcml6aW5nXG4gICAgICAgIGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkNvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uTGFiZWwuQnVpbHRpblN1bW1hcml6aW5nLCBjbHM6IFwibGFiZWxcIiB9KTtcbiAgICAgICAgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KTtcbiAgICAgICAgY29uc3QgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uTGlzdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChidWlsdGluU3VtbWFyaXplRnVuY3Rpb25Db250YWluZXIpO1xuICAgICAgICBPYmplY3Qua2V5cyhMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nKS5mb3JFYWNoKChidWlsdGluRnVuY3Rpb246IGtleW9mIHR5cGVvZiBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nKSA9PiB7XG4gICAgICAgICAgICBidWlsdGluU3VtbWFyaXplRnVuY3Rpb25MaXN0LmFkZE9wdGlvbihidWlsdGluRnVuY3Rpb24sIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdbYnVpbHRpbkZ1bmN0aW9uXSlcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgYnVpbHRpbk9wdGlvbnNEZXNjcmlwdGlvbkNvbnRhaW5lciA9IGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvblRvcENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3ViLXRleHRcIiB9KTtcbiAgICAgICAgY29uc3QgYnVpbHRpbkZ1bmN0aW9uID0gdGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uIGFzIGtleW9mIHR5cGVvZiBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nXG4gICAgICAgIGJ1aWx0aW5PcHRpb25zRGVzY3JpcHRpb25Db250YWluZXIuc2V0VGV4dChMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb25EZXNjcmlwdGlvbltidWlsdGluRnVuY3Rpb25dLnJlcGxhY2UoXCJ7e3N1bW1hcml6ZWRGaWVsZE5hbWV9fVwiLCB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSkpXG5cbiAgICAgICAgYnVpbHRpblN1bW1hcml6ZUZ1bmN0aW9uTGlzdC5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuYnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb24pXG4gICAgICAgIGJ1aWx0aW5TdW1tYXJpemVGdW5jdGlvbkxpc3Qub25DaGFuZ2UoKHZhbHVlOiBrZXlvZiB0eXBlb2YgTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uID0gdmFsdWVcbiAgICAgICAgICAgIGJ1aWx0aW5PcHRpb25zRGVzY3JpcHRpb25Db250YWluZXIuc2V0VGV4dChMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nRnVuY3Rpb25EZXNjcmlwdGlvblt2YWx1ZV0ucmVwbGFjZShcInt7c3VtbWFyaXplZEZpZWxkTmFtZX19XCIsIHRoaXMuZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lKSlcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBzdW1tYXJpemVkRmllbGROYW1lVG9wQ29udGFpbmVyID0gYnVpbHRpbk9wdGlvbnNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lID0gdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWVcbiAgICAgICAgY29uc3Qgc3VtbWFyaXplZEZpZWxkTmFtZUNvbnRhaW5lciA9IHN1bW1hcml6ZWRGaWVsZE5hbWVUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIHN1bW1hcml6ZWRGaWVsZE5hbWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJTdW1tYXJpemVkIGZpZWxkIG5hbWVcIiwgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIGNvbnN0IHN1bW1hcml6ZWRGaWVsZE5hbWUgPSBuZXcgVGV4dENvbXBvbmVudChzdW1tYXJpemVkRmllbGROYW1lQ29udGFpbmVyKTtcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZVRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIk5hbWUgb2YgdGhlIGZpZWxkIGNvbnRhaW5pbmcgc3VtbWFyaXplZCB2YWx1ZSB1c2VkIGZvciB0aGUgc3VtbWFyaXppbmcgZnVuY3Rpb25cIiwgY2xzOiBcInN1Yi10ZXh0XCIgfSk7XG5cbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSlcbiAgICAgICAgc3VtbWFyaXplZEZpZWxkTmFtZS5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuc3VtbWFyaXplZEZpZWxkTmFtZSA9IHZhbHVlXG4gICAgICAgIH0pXG5cbiAgICAgICAgLy8gQ3VzdG9tIGxpc3QgZnVuY3Rpb24gb3B0aW9uc1xuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvblRvcENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwidnN0YWNrZWRcIiB9KTtcbiAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbUxpc3RGdW5jdGlvbiA9IHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21MaXN0RnVuY3Rpb24gfHwgTG9va3VwLkRlZmF1bHQuQ3VzdG9tTGlzdFxuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvblRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uTGFiZWwuQ3VzdG9tTGlzdCwgY2xzOiBcImxhYmVsXCIgfSk7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7IHRleHQ6IExvb2t1cC5PcHRpb25TdWJMYWJlbC5DdXN0b21MaXN0IH0pO1xuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lciA9IG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uVG9wQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1jb250YWluZXJcIiB9KVxuICAgICAgICBjb25zdCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbiA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5zZXRQbGFjZWhvbGRlcihMb29rdXAuSGVscGVyLkN1c3RvbUxpc3QpXG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21MaXN0RnVuY3Rpb24pXG4gICAgICAgIG91dHB1dFJlbmRlcmluZ0Z1bmN0aW9uLmlucHV0RWwuY29scyA9IDY1O1xuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5pbnB1dEVsLnJvd3MgPSA0O1xuICAgICAgICBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvbi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tTGlzdEZ1bmN0aW9uID0gdmFsdWVcbiAgICAgICAgfSlcblxuXG4gICAgICAgIGNvbnN0IG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Ub3BDb250YWluZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uID0gdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVN1bW1hcml6aW5nRnVuY3Rpb24gfHwgTG9va3VwLkRlZmF1bHQuQ3VzdG9tU3VtbWFyaXppbmdcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvblRvcENvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBMb29rdXAuT3B0aW9uTGFiZWwuQ3VzdG9tU3VtbWFyaXppbmcsIGNsczogXCJsYWJlbFwiIH0pO1xuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwiY29kZVwiLCB7IHRleHQ6IExvb2t1cC5PcHRpb25TdWJMYWJlbC5DdXN0b21TdW1tYXJpemluZyB9KTtcbiAgICAgICAgY29uc3Qgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lciA9IG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Ub3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGNvbnN0IG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24gPSBuZXcgVGV4dEFyZWFDb21wb25lbnQob3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbkNvbnRhaW5lcik7XG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24uaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb24uc2V0UGxhY2Vob2xkZXIoTG9va3VwLkhlbHBlci5DdXN0b21TdW1tYXJpemluZylcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU3VtbWFyaXppbmdGdW5jdGlvbilcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5pbnB1dEVsLmNvbHMgPSA2NTtcbiAgICAgICAgb3V0cHV0U3VtbWFyaXppbmdGdW5jdGlvbi5pbnB1dEVsLnJvd3MgPSA4O1xuICAgICAgICBvdXRwdXRTdW1tYXJpemluZ0Z1bmN0aW9uLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uID0gdmFsdWVcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBvcHRpb25Db250YWluZXJzOiBbQXJyYXk8a2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlPiwgSFRNTEVsZW1lbnQgfCB1bmRlZmluZWRdW10gPSBbXG4gICAgICAgICAgICBbW1wiTGlua3NMaXN0XCIsIFwiTGlua3NCdWxsZXRMaXN0XCJdLCB1bmRlZmluZWRdLFxuICAgICAgICAgICAgW1tcIkJ1aWx0aW5TdW1tYXJpemluZ1wiXSwgYnVpbHRpbk9wdGlvbnNDb250YWluZXJdLFxuICAgICAgICAgICAgW1tcIkN1c3RvbUxpc3RcIiwgXCJDdXN0b21CdWxsZXRMaXN0XCJdLCBvdXRwdXRSZW5kZXJpbmdGdW5jdGlvblRvcENvbnRhaW5lcl0sXG4gICAgICAgICAgICBbW1wiQ3VzdG9tU3VtbWFyaXppbmdcIl0sIG91dHB1dFN1bW1hcml6aW5nRnVuY3Rpb25Ub3BDb250YWluZXJdXG4gICAgICAgIF1cblxuICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dE9wdGlvbkNvbnRhaW5lcihvcHRpb25Db250YWluZXJzLCBvdXRwdXRUeXBlTGlzdC5nZXRWYWx1ZSgpIGFzIGtleW9mIHR5cGVvZiBMb29rdXAuVHlwZSlcbiAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRPdXRwdXRXYXJuaW5nQ29udGFpbmVyKG91dHB1dFdhcm5pbmdDb250YWluZXIsIG91dHB1dFR5cGVMaXN0LmdldFZhbHVlKCkgYXMga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKVxuXG4gICAgICAgIG91dHB1dFR5cGVMaXN0Lm9uQ2hhbmdlKCh2YWx1ZToga2V5b2YgdHlwZW9mIExvb2t1cC5UeXBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5U2VsZWN0ZWRPdXRwdXRPcHRpb25Db250YWluZXIob3B0aW9uQ29udGFpbmVycywgdmFsdWUpXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlTZWxlY3RlZE91dHB1dFdhcm5pbmdDb250YWluZXIob3V0cHV0V2FybmluZ0NvbnRhaW5lciwgdmFsdWUpXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlTG9va3VwQ29udGFpbmVyKGNvbnRhaW5lcilcbiAgICB9XG5cbiAgICBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHNob3J0RGVzY3JpcHRpb24gPSBMb29rdXAuU2hvcnREZXNjcmlwdGlvblt0aGlzLmZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZSBhcyBMb29rdXAuVHlwZV1cbiAgICAgICAgbGV0IGNvbXBsZW1lbnQ6IHN0cmluZyA9IFwiXCJcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5vdXRwdXRUeXBlID09PSBMb29rdXAuVHlwZS5CdWlsdGluU3VtbWFyaXppbmcpIHtcbiAgICAgICAgICAgIGNvbXBsZW1lbnQgPSBgICR7dGhpcy5maWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9ufWAgK1xuICAgICAgICAgICAgICAgIGAke3RoaXMuZmllbGQub3B0aW9ucy5idWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbiAhPT0gTG9va3VwLkJ1aWx0aW5TdW1tYXJpemluZy5Db3VudEFsbCA/IFwiIFwiICsgdGhpcy5maWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUgOiBcIlwifWBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hvcnREZXNjcmlwdGlvbiArIGNvbXBsZW1lbnRcbiAgICB9XG5cbiAgICB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBOb3RpY2UsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCAqIGFzIExvb2t1cCBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBnZXRWYWx1ZXMgfSBmcm9tIFwiLi9nZXRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwiLi9yZXBsYWNlVmFsdWVzXCI7XG5cbmZ1bmN0aW9uIGFycmF5c0FzU3RyaW5nQXJlRXF1YWwoYTogc3RyaW5nLCBiOiBzdHJpbmcpIHtcbiAgICBjb25zdCBhQXNBcnJheSA9IGEuc3BsaXQoXCIsXCIpLm1hcCh2ID0+IHYudHJpbSgpKVxuICAgIGNvbnN0IGJBc0FycmF5ID0gYi5zcGxpdChcIixcIikubWFwKHYgPT4gdi50cmltKCkpXG4gICAgcmV0dXJuIGFBc0FycmF5LmV2ZXJ5KGl0ZW0gPT4gYkFzQXJyYXkuaW5jbHVkZXMoaXRlbSkpICYmIGJBc0FycmF5LmV2ZXJ5KGl0ZW0gPT4gYUFzQXJyYXkuaW5jbHVkZXMoaXRlbSkpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHBhcnNlRmllbGRWYWx1ZXMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IHJhd1ZhbHVlID0gKGF3YWl0IGdldFZhbHVlcyhwbHVnaW4sIGZpbGUsIGZpZWxkTmFtZSkpPy5bMF1cbiAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYDxkaXYgaGlkZGVuIGlkPVxcXCIke2ZpZWxkTmFtZX1fdmFsdWVzXFxcIj4oPzx2YWx1ZXM+LiopPC9kaXY+YClcbiAgICBjb25zdCBmUiA9IHJhd1ZhbHVlLm1hdGNoKHJlZ2V4KVxuICAgIHJldHVybiBmUj8uZ3JvdXBzPy52YWx1ZXMgfHwgcmF3VmFsdWVcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUxvb2t1cHMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgc291cmNlOiBzdHJpbmcgPSBcIlwiLFxuICAgIGZvcmNlVXBkYXRlT25lPzogeyBmaWxlOiBURmlsZSwgZmllbGROYW1lOiBzdHJpbmcgfVxuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpXG4gICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0IHVwZGF0ZSBsb29rdXBzIFtcIiwgc291cmNlLCBcIl1cIiwgcGx1Z2luLmZpZWxkSW5kZXgubGFzdFJldmlzaW9uLCBcIi0+XCIsIHBsdWdpbi5maWVsZEluZGV4LmR2Py5hcGkuaW5kZXgucmV2aXNpb24pXG4gICAgY29uc3QgZiA9IHBsdWdpbi5maWVsZEluZGV4O1xuICAgIGxldCByZW5kZXJpbmdFcnJvcnM6IHN0cmluZ1tdID0gW11cbiAgICBmb3IgKGxldCBpZCBvZiBmLmZpbGVMb29rdXBGaWxlcy5rZXlzKCkpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hSZWdleCA9IC8oPzxmaWxlUGF0aD4uKilfX3JlbGF0ZWRfXyg/PGZpbGVDbGFzc05hbWU+LiopX19fKD88ZmllbGROYW1lPi4qKS9cbiAgICAgICAgY29uc3QgeyBmaWxlUGF0aCwgZmlsZUNsYXNzTmFtZSwgZmllbGROYW1lIH0gPSBpZC5tYXRjaChtYXRjaFJlZ2V4KT8uZ3JvdXBzIHx8IHt9XG4gICAgICAgIGNvbnN0IHRGaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpIGFzIFRGaWxlXG4gICAgICAgIGNvbnN0IGR2QXBpID0gcGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICBjb25zdCBkdkZpbGUgPSBkdkFwaSAmJiBkdkFwaS5wYWdlKHRGaWxlLnBhdGgpXG4gICAgICAgIGlmICh0RmlsZSAmJiBkdkZpbGUpIHtcbiAgICAgICAgICAgIGxldCBuZXdWYWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICBjb25zdCBwYWdlcyA9IGYuZmlsZUxvb2t1cEZpbGVzLmdldChpZClcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZi5maWxlc0ZpZWxkcy5nZXQoZmlsZVBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT0gZmllbGROYW1lKVxuICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0VHlwZSA9IGZpZWxkLm9wdGlvbnMub3V0cHV0VHlwZVxuICAgICAgICAgICAgICAgIGlmICghZi5maWxlTG9va3VwRmllbGRMYXN0T3V0cHV0VHlwZS5nZXQoaWQpKSBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLnNldChpZCwgb3V0cHV0VHlwZSlcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG91dHB1dFR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb29rdXAuVHlwZS5MaW5rc0xpc3Q6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgTG9va3VwLlR5cGUuTGlua3NCdWxsZXRMaXN0OlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlc0FycmF5ID0gcGFnZXM/Lm1hcCgoZHZGaWxlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZpZWxkTWFuYWdlci5idWlsZE1hcmtEb3duTGluayhwbHVnaW4sIHRGaWxlLCBkdkZpbGUuZmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IChuZXdWYWx1ZXNBcnJheSB8fCBbXSkuam9pbihcIiwgXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb29rdXAuVHlwZS5DdXN0b21MaXN0OlxuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkN1c3RvbUJ1bGxldExpc3Q6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVuZGVyaW5nRnVuY3Rpb24gPSBuZXcgRnVuY3Rpb24oXCJwYWdlXCIsIGByZXR1cm4gJHtmaWVsZC5vcHRpb25zLmN1c3RvbUxpc3RGdW5jdGlvbn1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlc0FycmF5ID0gcGFnZXM/Lm1hcCgoZHZGaWxlOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZW5kZXJpbmdGdW5jdGlvbihkdkZpbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IChuZXdWYWx1ZXNBcnJheSB8fCBbXSkuam9pbihcIiwgXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBMb29rdXAuVHlwZS5DdXN0b21TdW1tYXJpemluZzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uID0gZmllbGQub3B0aW9ucy5jdXN0b21TdW1tYXJpemluZ0Z1bmN0aW9uXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJpemluZ0Z1bmN0aW9uID0gbmV3IEZ1bmN0aW9uKFwicGFnZXNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU3VtbWFyaXppbmdGdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xce1xce3N1bW1hcml6ZWRGaWVsZE5hbWVcXH1cXH0vZywgZmllbGQub3B0aW9ucy5zdW1tYXJpemVkRmllbGROYW1lKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IHN1bW1hcml6aW5nRnVuY3Rpb24ocGFnZXMpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVuZGVyaW5nRXJyb3JzLmluY2x1ZGVzKGZpZWxkLm5hbWUpKSByZW5kZXJpbmdFcnJvcnMucHVzaChmaWVsZC5uYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgICAgICBjYXNlIExvb2t1cC5UeXBlLkJ1aWx0aW5TdW1tYXJpemluZzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBidWlsdGluRnVuY3Rpb24gPSBmaWVsZC5vcHRpb25zLmJ1aWx0aW5TdW1tYXJpemluZ0Z1bmN0aW9uIGFzIGtleW9mIHR5cGVvZiBMb29rdXAuQnVpbHRpblN1bW1hcml6aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VtbWFyaXppbmdGdW5jdGlvbiA9IG5ldyBGdW5jdGlvbihcInBhZ2VzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvb2t1cC5CdWlsdGluU3VtbWFyaXppbmdGdW5jdGlvbltidWlsdGluRnVuY3Rpb25dXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFx7XFx7c3VtbWFyaXplZEZpZWxkTmFtZVxcfVxcfS9nLCBmaWVsZC5vcHRpb25zLnN1bW1hcml6ZWRGaWVsZE5hbWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gc3VtbWFyaXppbmdGdW5jdGlvbihwYWdlcykudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZW5kZXJpbmdFcnJvcnMuaW5jbHVkZXMoZmllbGQubmFtZSkpIHJlbmRlcmluZ0Vycm9ycy5wdXNoKGZpZWxkLm5hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2NoZWNrIGlmIHZhbHVlIGhhcyBjaGFuZ2VkIGluIG9yZGVyIG5vdCB0byBjcmVhdGUgYW4gaW5maW5pdGUgbG9vcFxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IGYuZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlLmdldChpZCkgfHwgYXdhaXQgcGFyc2VGaWVsZFZhbHVlcyhwbHVnaW4sIHRGaWxlLCBmaWVsZC5uYW1lKSB8fCBcIlwiXG4gICAgICAgICAgICAgICAgY29uc3Qgc2hvdWxkQ2hlY2tGb3JVcGRhdGUgPVxuICAgICAgICAgICAgICAgICAgICBmaWVsZC5vcHRpb25zLmF1dG9VcGRhdGUgfHxcbiAgICAgICAgICAgICAgICAgICAgZmllbGQub3B0aW9ucy5hdXRvVXBkYXRlID09PSB1bmRlZmluZWQgfHwgLy9maWVsZCBpcyBhdXRvVXBkYXRlZCBPUlxuICAgICAgICAgICAgICAgICAgICAoIC8vZmllbGQgaXMgbm90IGF1dG91cGRhdGVkIGFuZCB3ZSBoYXZlIHRvIGNoZWNrIGZvciByZXF1ZXN0IHRvIHVwZGF0ZSB0aGlzIG9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VVcGRhdGVPbmU/LmZpbGUucGF0aCA9PT0gdEZpbGUucGF0aCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VVcGRhdGVPbmU/LmZpZWxkTmFtZSA9PT0gZmllbGQubmFtZVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgY29uc3QgdmFsdWVIYXNDaGFuZ2VkID0gKCFjdXJyZW50VmFsdWUgJiYgbmV3VmFsdWUgIT09IFwiXCIpIHx8ICFhcnJheXNBc1N0cmluZ0FyZUVxdWFsKGN1cnJlbnRWYWx1ZSwgbmV3VmFsdWUpXG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0SGFzQ2hhbmdlZCA9IG91dHB1dFR5cGUgIT09IGYuZmlsZUxvb2t1cEZpZWxkTGFzdE91dHB1dFR5cGUuZ2V0KGlkKVxuXG4gICAgICAgICAgICAgICAgaWYgKHNob3VsZENoZWNrRm9yVXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlLnNldChpZCwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLnNldChpZCwgb3V0cHV0VHlwZSk7XG4gICAgICAgICAgICAgICAgfS8vIG1ha2Ugc3VyZSB0aGF0IHRoaXMgaXMgc2V0IGF0IGZpcnN0IGluZGV4aW5nfVxuICAgICAgICAgICAgICAgIGlmIChzaG91bGRDaGVja0ZvclVwZGF0ZSAmJiAodmFsdWVIYXNDaGFuZ2VkIHx8IGZvcm1hdEhhc0NoYW5nZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzVmFsdWVzQ291bnQgPSBwbHVnaW4uZmllbGRJbmRleC5wcmV2aW91c0ZpbGVMb29rdXBGaWxlc1ZhbHVlcy5nZXQoaWQpIHx8IDBcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcGx1Z2luLmZpbGVUYXNrTWFuYWdlci5wdXNoVGFzaygoKSA9PiByZXBsYWNlVmFsdWVzKHBsdWdpbiwgdEZpbGUsIGZpZWxkTmFtZSwgbmV3VmFsdWUsIHByZXZpb3VzVmFsdWVzQ291bnQpKTtcbiAgICAgICAgICAgICAgICAgICAgZi5maWxlTG9va3VwRmllbGRzU3RhdHVzLnNldChgJHtmaWxlUGF0aH1fXyR7ZmllbGROYW1lfWAsIExvb2t1cC5TdGF0dXMudXBUb0RhdGUpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzb3VyY2UgIT09IFwiZnVsbCBJbmRleFwiKSB7IC8vIHRoaXMgY2FzZSBpcyBmb3IgZmlsZUNsYXNzIGNoYW5nZXMsIG5vIG5lZWQgZm9yIHJld3JpdGUgb3RoZXIgbG9va3VwcyBhZnRlciBjYWNoZSB1cGRhdGVcbiAgICAgICAgICAgICAgICAgICAgcGx1Z2luLmZpZWxkSW5kZXguZmlsZUNoYW5nZWQgPSBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlSGFzQ2hhbmdlZCAmJiAhZm9ybWF0SGFzQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuc2V0KGAke2ZpbGVQYXRofV9fJHtmaWVsZE5hbWV9YCwgTG9va3VwLlN0YXR1cy51cFRvRGF0ZSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHJlbmRlcmluZ0Vycm9ycy5sZW5ndGgpIG5ldyBOb3RpY2UoYFRob3NlIGZpZWxkcyBoYXZlIGluY29ycmVjdCBvdXRwdXQgcmVuZGVyaW5nIGZ1bmN0aW9uczpcXG4ke3JlbmRlcmluZ0Vycm9ycy5qb2luKFwiLFxcblwiKX1gKVxuICAgIC8vY29uc29sZS5sb2coXCJmaW5pc2hlZCB1cGRhdGUgbG9va3VwcyBbXCIsIHNvdXJjZSwgXCJdXCIsIHBsdWdpbi5maWVsZEluZGV4Lmxhc3RSZXZpc2lvbiwgXCItPlwiLCBwbHVnaW4uZmllbGRJbmRleC5kdj8uYXBpLmluZGV4LnJldmlzaW9uLCBgJHsoRGF0ZS5ub3coKSAtIHN0YXJ0KX1tc2ApXG59XG4iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IHsgaW5saW5lRmllbGRSZWdleCwgZW5jb2RlTGluaywgZGVjb2RlTGluayB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRWYWx1ZXMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGVPcmZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JmaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JmaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPcmZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY29udGVudCA9IChhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSkpLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyO1xuICAgIGNvbnN0IHsgcG9zaXRpb246IHsgc3RhcnQsIGVuZCB9IH0gPSBmcm9udG1hdHRlciA/IGZyb250bWF0dGVyIDogeyBwb3NpdGlvbjogeyBzdGFydDogdW5kZWZpbmVkLCBlbmQ6IHVuZGVmaW5lZCB9IH07XG4gICAgY29uc3QgcmVzdWx0OiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnRlbnQubWFwKChsaW5lLCBpKSA9PiB7XG4gICAgICAgIGlmIChzdGFydCAmJiBlbmQgJiYgaSA+PSBzdGFydC5saW5lICYmIGkgPD0gZW5kLmxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgJHthdHRyaWJ1dGV9OiguKilgLCAndScpO1xuICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHIgJiYgci5sZW5ndGggPiAwKSByZXN1bHQucHVzaChyWzFdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxMaW5lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXF1dKilgLCBcInVcIik7XG4gICAgICAgICAgICBjb25zdCBmUiA9IGVuY29kZUxpbmsobGluZSkubWF0Y2goZnVsbExpbmVSZWdleCk7XG4gICAgICAgICAgICBpZiAoZlI/Lmdyb3VwcykgeyByZXN1bHQucHVzaChkZWNvZGVMaW5rKGZSLmdyb3Vwcy52YWx1ZXMpKSB9O1xuICAgICAgICAgICAgY29uc3QgaW5TZW50ZW5jZVJlZ2V4QnJhY2tldHMgPSBuZXcgUmVnRXhwKGBcXFxcWyR7aW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpfSg/PHZhbHVlcz5bXlxcXFxdXSspP1xcXFxdYCwgXCJndVwiKTtcbiAgICAgICAgICAgIGNvbnN0IHNSQiA9IGVuY29kZUxpbmsobGluZSkubWF0Y2hBbGwoaW5TZW50ZW5jZVJlZ2V4QnJhY2tldHMpO1xuICAgICAgICAgICAgbGV0IG5leHQgPSBzUkIubmV4dCgpO1xuICAgICAgICAgICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV4dC52YWx1ZS5ncm91cHMpIHsgcmVzdWx0LnB1c2goZGVjb2RlTGluayhuZXh0LnZhbHVlLmdyb3Vwcy52YWx1ZXMpKSB9XG4gICAgICAgICAgICAgICAgbmV4dCA9IHNSQi5uZXh0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGluU2VudGVuY2VSZWdleFBhciA9IG5ldyBSZWdFeHAoYFxcXFwoJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9KD88dmFsdWVzPlteXFxcXCldKyk/XFxcXClgLCBcImd1XCIpO1xuICAgICAgICAgICAgY29uc3Qgc1JQID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhQYXIpO1xuICAgICAgICAgICAgbmV4dCA9IHNSUC5uZXh0KCk7XG4gICAgICAgICAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICAgICAgICAgIGlmIChuZXh0LnZhbHVlLmdyb3VwcykgeyByZXN1bHQucHVzaChkZWNvZGVMaW5rKG5leHQudmFsdWUuZ3JvdXBzLnZhbHVlcykpIH1cbiAgICAgICAgICAgICAgICBuZXh0ID0gc1JQLm5leHQoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICByZXR1cm4gcmVzdWx0O1xufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSwgTWVudSwgVGV4dEFyZWFDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25zL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRUeXBlLCBGaWVsZEljb24gfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyBTdGF0dXMgfSBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE9wdGlvbnMgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtdWxhRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihwbHVnaW4sIGZpZWxkLCBGaWVsZFR5cGUuRm9ybXVsYSlcbiAgICAgICAgdGhpcy5zaG93TW9kYWxPcHRpb24gPSBmYWxzZVxuICAgIH1cblxuICAgIGFkZEZpZWxkT3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgZmlsZTogVEZpbGUsIGxvY2F0aW9uOiBNZW51IHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgRmllbGRPcHRpb25zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGFjdGlvbiA9ICgpID0+IHsgfTtcbiAgICAgICAgaWYgKEZvcm11bGFGaWVsZC5pc01lbnUobG9jYXRpb24pICYmIHN0YXR1cyA9PT0gU3RhdHVzLmNoYW5nZWQpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKEZpZWxkSWNvbi5Gb3JtdWxhKTtcbiAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soYWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoRm9ybXVsYUZpZWxkLmlzU3VnZ2VzdChsb2NhdGlvbikgJiYgc3RhdHVzID09PSBTdGF0dXMuY2hhbmdlZCkge1xuICAgICAgICAgICAgbG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogYHVwZGF0ZV8ke25hbWV9YCxcbiAgICAgICAgICAgICAgICBhY3Rpb25MYWJlbDogYDxzcGFuPlVwZGF0ZSA8Yj4ke25hbWV9PC9iPjwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgIGFjdGlvbjogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGljb246IEZpZWxkSWNvbi5Gb3JtdWxhXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2UgaWYgKEZvcm11bGFGaWVsZC5pc0ZpZWxkT3B0aW9ucyhsb2NhdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmFkZE9wdGlvbihGaWVsZEljb24uRm9ybXVsYSwgKCkgPT4geyB9LCBgJHtuYW1lfSBpcyBhdXRvbWF0aWNhbGx5IGNhbGN1bGF0ZWRgLCBcImRpc2FibGVkXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIHZhbHVlPzogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIC8vbm8gZmllbGQgbW9kYWwsIHdlIGluY2x1ZGUgdGhlIGZpZWxkIGRpcmVjdGx5XG4gICAgICAgIGlmIChsaW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXJcbiAgICAgICAgICAgICAgICAucHVzaFRhc2soKCkgPT4geyByZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIpIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZmlsZVRhc2tNYW5hZ2VyXG4gICAgICAgICAgICAgICAgLnB1c2hUYXNrKCgpID0+IHsgaW5zZXJ0VmFsdWVzKHRoaXMucGx1Z2luLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCkgfSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgY3JlYXRlRHZGaWVsZChkdjogYW55LCBwOiBhbnksIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXR0cnM/OiB7IGNscz86IHN0cmluZyB8IHVuZGVmaW5lZDsgYXR0cj86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQ7IG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHwgdW5kZWZpbmVkOyB9KTogdm9pZCB7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgZGlzcGxheVZhbHVlKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIGZpbGU6IFRGaWxlLCBmaWVsZE5hbWU6IHN0cmluZywgb25DbGlja2VkID0gKCkgPT4geyB9KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGYgPT4gZi5uYW1lID09PSBmaWVsZE5hbWUpPy5maWxlQ2xhc3NOYW1lIHx8IFwicHJlc2V0RmllbGRcIlxuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlRm9ybXVsYUZpZWxkTGFzdFZhbHVlLmdldChgJHtmaWxlLnBhdGh9X19jYWxjdWxhdGVkX18ke2ZpbGVDbGFzc05hbWV9X19fJHtmaWVsZE5hbWV9YCkgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUZvcm11bGFDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuXG4gICAgICAgIGNvbnN0IGZvcm11bGFUb3BDb250YWluZXIgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIGZvcm11bGFUb3BDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJqYXZhc2NyaXB0IGZvcm11bGFcIiwgY2xzOiAnbGFiZWwnIH0pO1xuICAgICAgICBmb3JtdWxhVG9wQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiY3VycmVudCBhbmQgcGFnZXMgdmFyaWFibGVzIGFyZSBhdmFpbGFibGVgXCIsIGNsczogJ3N1Yi10ZXh0JyB9KTtcbiAgICAgICAgY29uc3QgZm9ybXVsYUNvbnRhaW5lciA9IGZvcm11bGFUb3BDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBjb25zdCBmb3JtdWxhID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KGZvcm11bGFDb250YWluZXIpO1xuICAgICAgICBmb3JtdWxhLmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBmb3JtdWxhLmlucHV0RWwuY29scyA9IDUwO1xuICAgICAgICBmb3JtdWxhLmlucHV0RWwucm93cyA9IDQ7XG4gICAgICAgIGZvcm11bGEuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLmZvcm11bGEgfHwgXCJcIik7XG4gICAgICAgIGZvcm11bGEuc2V0UGxhY2Vob2xkZXIoXCJleGFtcGU6IGN1cnJlbnQuYXBwbGUgKyBjdXJyZW50LmJhbmFuYXMgLSAzXCIpO1xuXG4gICAgICAgIGZvcm11bGEub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmZvcm11bGEgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoZm9ybXVsYSk7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVNldHRpbmdDb250YWluZXIocGFyZW50Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxvY2F0aW9uPzogU2V0dGluZ0xvY2F0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3JlYXRlRm9ybXVsYUNvbnRhaW5lcihwYXJlbnRDb250YWluZXIpXG4gICAgfVxuXG4gICAgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5vcHRpb25zLmZvcm11bGFcbiAgICB9XG5cbiAgICB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxufSIsICJpbXBvcnQgSW5wdXQgZnJvbSAnLi9JbnB1dEZpZWxkJ1xuaW1wb3J0IEJvb2xlYW4gZnJvbSAnLi9Cb29sZWFuRmllbGQnXG5pbXBvcnQgTnVtYmVyIGZyb20gJy4vTnVtYmVyRmllbGQnXG5pbXBvcnQgU2VsZWN0IGZyb20gJy4vU2VsZWN0RmllbGQnXG5pbXBvcnQgQ3ljbGUgZnJvbSAnLi9DeWNsZUZpZWxkJ1xuaW1wb3J0IE11bHRpIGZyb20gJy4vTXVsdGlGaWVsZCdcbmltcG9ydCBGaWxlIGZyb20gJy4vRmlsZUZpZWxkJ1xuaW1wb3J0IERhdGUgZnJvbSAnLi9EYXRlRmllbGQnXG5pbXBvcnQgTXVsdGlGaWxlIGZyb20gJy4vTXVsdGlGaWxlRmllbGQnXG5pbXBvcnQgTG9va3VwIGZyb20gJy4vTG9va3VwRmllbGQnXG5pbXBvcnQgRm9ybXVsYSBmcm9tICcuL0Zvcm11bGFGaWVsZCdcblxuY29uc3QgTWFuYWdlcnMgPSB7XG4gICAgSW5wdXQsXG4gICAgQm9vbGVhbixcbiAgICBOdW1iZXIsXG4gICAgU2VsZWN0LFxuICAgIEN5Y2xlLFxuICAgIE11bHRpLFxuICAgIEZpbGUsXG4gICAgRGF0ZSxcbiAgICBNdWx0aUZpbGUsXG4gICAgTG9va3VwLFxuICAgIEZvcm11bGFcbn1cblxuZXhwb3J0IGRlZmF1bHQgTWFuYWdlcnMiLCAiaW1wb3J0IE1hbmFnZXJzIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTWFuYWdlcnNcIjtcblxuZXhwb3J0IGNvbnN0IGVudW0gRmllbGRUeXBlIHtcbiAgICAnSW5wdXQnID0gXCJJbnB1dFwiLFxuICAgICdTZWxlY3QnID0gXCJTZWxlY3RcIixcbiAgICAnTXVsdGknID0gXCJNdWx0aVwiLFxuICAgICdDeWNsZScgPSBcIkN5Y2xlXCIsXG4gICAgJ0Jvb2xlYW4nID0gXCJCb29sZWFuXCIsXG4gICAgXCJOdW1iZXJcIiA9IFwiTnVtYmVyXCIsXG4gICAgXCJGaWxlXCIgPSBcIkZpbGVcIixcbiAgICBcIk11bHRpRmlsZVwiID0gXCJNdWx0aUZpbGVcIixcbiAgICBcIkRhdGVcIiA9IFwiRGF0ZVwiLFxuICAgIFwiTG9va3VwXCIgPSBcIkxvb2t1cFwiLFxuICAgIFwiRm9ybXVsYVwiID0gXCJGb3JtdWxhXCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZUxhYmVsTWFwcGluZzogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIEZpZWxkVHlwZT4gPSB7XG4gICAgXCJJbnB1dFwiOiBGaWVsZFR5cGUuSW5wdXQsXG4gICAgXCJTZWxlY3RcIjogRmllbGRUeXBlLlNlbGVjdCxcbiAgICBcIk11bHRpXCI6IEZpZWxkVHlwZS5NdWx0aSxcbiAgICBcIkN5Y2xlXCI6IEZpZWxkVHlwZS5DeWNsZSxcbiAgICBcIkJvb2xlYW5cIjogRmllbGRUeXBlLkJvb2xlYW4sXG4gICAgXCJOdW1iZXJcIjogRmllbGRUeXBlLk51bWJlcixcbiAgICBcIkZpbGVcIjogRmllbGRUeXBlLkZpbGUsXG4gICAgXCJNdWx0aUZpbGVcIjogRmllbGRUeXBlLk11bHRpRmlsZSxcbiAgICBcIkRhdGVcIjogRmllbGRUeXBlLkRhdGUsXG4gICAgXCJMb29rdXBcIjogRmllbGRUeXBlLkxvb2t1cCxcbiAgICBcIkZvcm11bGFcIjogRmllbGRUeXBlLkZvcm11bGFcbn07XG5cbmV4cG9ydCBjb25zdCBGaWVsZFR5cGVUYWdDbGFzczogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJJbnB1dFwiOiBcInNpbmdsZVwiLFxuICAgIFwiU2VsZWN0XCI6IFwic2VsZWN0XCIsXG4gICAgXCJNdWx0aVwiOiBcIm11bHRpXCIsXG4gICAgXCJDeWNsZVwiOiBcImN5Y2xlXCIsXG4gICAgXCJCb29sZWFuXCI6IFwiYm9vbGVhblwiLFxuICAgIFwiTnVtYmVyXCI6IFwibnVtYmVyXCIsXG4gICAgXCJGaWxlXCI6IFwiZmlsZVwiLFxuICAgIFwiTXVsdGlGaWxlXCI6IFwiZmlsZVwiLFxuICAgIFwiRGF0ZVwiOiBcImRhdGVcIixcbiAgICBcIkxvb2t1cFwiOiBcImxvb2t1cFwiLFxuICAgIFwiRm9ybXVsYVwiOiBcImZvcm11bGFcIlxufVxuXG5leHBvcnQgY29uc3QgRmllbGRUeXBlVG9vbHRpcDogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJJbnB1dFwiOiBcIkFjY2VwdCBhbnkgdmFsdWVcIixcbiAgICBcIlNlbGVjdFwiOiBcIkFjY2VwdCBhIHNpbmdsZSB2YWx1ZSBmcm9tIGEgbGlzdFwiLFxuICAgIFwiTXVsdGlcIjogXCJBY2NlcHQgbXVsdGlwbGUgdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJDeWNsZVwiOiBcIkN5Y2xlIHRocm91Z2ggdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJCb29sZWFuXCI6IFwiQWNjZXB0IHRydWUgb2YgZmFsc2VcIixcbiAgICBcIk51bWJlclwiOiBcIkFjY2VwdCBhIG51bWJlclwiLFxuICAgIFwiRmlsZVwiOiBcIkFjY2VwdCBhIGxpbmtcIixcbiAgICBcIk11bHRpRmlsZVwiOiBcIkFjY2VwdCBtdWx0aXBsZSBsaW5rc1wiLFxuICAgIFwiRGF0ZVwiOiBcIkFjY2VwdCBhIGRhdGVcIixcbiAgICBcIkxvb2t1cFwiOiBcIkFjY2VwdCBhIGxvb2t1cCBxdWVyeVwiLFxuICAgIFwiRm9ybXVsYVwiOiBcIkFjY2VwdCBhIGZvcm11bGFcIlxufVxuXG5leHBvcnQgY29uc3QgRmllbGRNYW5hZ2VyOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgYW55PiA9IHtcbiAgICBcIklucHV0XCI6IE1hbmFnZXJzLklucHV0LFxuICAgIFwiU2VsZWN0XCI6IE1hbmFnZXJzLlNlbGVjdCxcbiAgICBcIk11bHRpXCI6IE1hbmFnZXJzLk11bHRpLFxuICAgIFwiQ3ljbGVcIjogTWFuYWdlcnMuQ3ljbGUsXG4gICAgXCJCb29sZWFuXCI6IE1hbmFnZXJzLkJvb2xlYW4sXG4gICAgXCJOdW1iZXJcIjogTWFuYWdlcnMuTnVtYmVyLFxuICAgIFwiRmlsZVwiOiBNYW5hZ2Vycy5GaWxlLFxuICAgIFwiTXVsdGlGaWxlXCI6IE1hbmFnZXJzLk11bHRpRmlsZSxcbiAgICBcIkRhdGVcIjogTWFuYWdlcnMuRGF0ZSxcbiAgICBcIkxvb2t1cFwiOiBNYW5hZ2Vycy5Mb29rdXAsXG4gICAgXCJGb3JtdWxhXCI6IE1hbmFnZXJzLkZvcm11bGFcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkSWNvbjogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIHN0cmluZz4gPSB7XG4gICAgXCJJbnB1dFwiOiBcInBlbmNpbFwiLFxuICAgIFwiU2VsZWN0XCI6IFwicmlnaHQtdHJpYW5nbGVcIixcbiAgICBcIk11bHRpXCI6IFwiYnVsbGV0LWxpc3RcIixcbiAgICBcIkN5Y2xlXCI6IFwic3dpdGNoXCIsXG4gICAgXCJCb29sZWFuXCI6IFwiY2hlY2ttYXJrXCIsXG4gICAgXCJOdW1iZXJcIjogXCJwbHVzLW1pbnVzLWdseXBoXCIsXG4gICAgXCJGaWxlXCI6IFwibGlua1wiLFxuICAgIFwiTXVsdGlGaWxlXCI6IFwibGlua1wiLFxuICAgIFwiRGF0ZVwiOiBcImNhbGVuZGFyLXdpdGgtY2hlY2ttYXJrXCIsXG4gICAgXCJMb29rdXBcIjogXCJmaWxlLXNlYXJjaFwiLFxuICAgIFwiRm9ybXVsYVwiOiBcImZ1bmN0aW9uLXNxdWFyZVwiXG59XG5cbmV4cG9ydCBjb25zdCBGaWVsZEJhY2tncm91bmRDb2xvckNsYXNzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIklucHV0XCI6IFwic2luZ2xlXCIsXG4gICAgXCJTZWxlY3RcIjogXCJzZWxlY3RcIixcbiAgICBcIk11bHRpXCI6IFwibXVsdGlcIixcbiAgICBcIkN5Y2xlXCI6IFwiY3ljbGVcIixcbiAgICBcIkJvb2xlYW5cIjogXCJib29sZWFuXCIsXG4gICAgXCJOdW1iZXJcIjogXCJudW1iZXJcIixcbiAgICBcIkZpbGVcIjogXCJmaWxlXCIsXG4gICAgXCJNdWx0aUZpbGVcIjogXCJmaWxlXCIsXG4gICAgXCJEYXRlXCI6IFwiZGF0ZVwiLFxuICAgIFwiTG9va3VwXCI6IFwibG9va3VwXCIsXG4gICAgXCJGb3JtdWxhXCI6IFwibG9va3VwXCJcbn0iLCAiaW1wb3J0IHsgVEZpbGUsIEJ1dHRvbkNvbXBvbmVudCwgU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5cbmludGVyZmFjZSBMaW5lIHtcbiAgICBsaW5lTnVtYmVyOiBudW1iZXJcbiAgICBsaW5lVGV4dDogc3RyaW5nXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIGNob29zZVNlY3Rpb25Nb2RhbCBleHRlbmRzIFN1Z2dlc3RNb2RhbDxMaW5lPiB7XG5cbiAgICBwcml2YXRlIGFkZEFzTGlzdEl0ZW06IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGFkZEFzQ29tbWVudDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgYWRkQXRFbmRPZkZyb250TWF0dGVyOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBvblNlbGVjdDogKGxpbmVOdW1iZXI6IG51bWJlciwgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgYWZ0ZXI6IGJvb2xlYW4sIGFzTGlzdDogYm9vbGVhbiwgYXNDb21tZW50OiBib29sZWFuKSA9PiB2b2lkLFxuICAgICkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5vblNlbGVjdCA9IG9uU2VsZWN0XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgICAgIHRoaXMucmVzdWx0Q29udGFpbmVyRWwuYWRkQ2xhc3MoXCJzZWN0aW9uc1wiKVxuICAgIH07XG5cbiAgICBvbk9wZW4oKTogdm9pZCB7XG4gICAgICAgIHN1cGVyLm9uT3BlbigpO1xuICAgICAgICBjb25zdCBpbnB1dENvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInN1Z2dlc3Rlci1pbnB1dFwiIH0pXG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuaW5wdXRFbClcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5maW5kKFwiLnByb21wdFwiKS5wcmVwZW5kKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAvLyBpbnNlcnRBc0xpc3RJdGVtXG4gICAgICAgIGNvbnN0IGFkZEFzTGlzdEl0ZW1CdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICBhZGRBc0xpc3RJdGVtQnRuLnNldEljb24oXCJsaXN0XCIpXG4gICAgICAgIGFkZEFzTGlzdEl0ZW1CdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5hZGRBc0xpc3RJdGVtKSB7XG4gICAgICAgICAgICAgICAgYWRkQXNMaXN0SXRlbUJ0bi5yZW1vdmVDdGEoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEFzTGlzdEl0ZW0gPSBmYWxzZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhZGRBc0xpc3RJdGVtQnRuLnNldEN0YSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQXNMaXN0SXRlbSA9IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgYWRkQXNMaXN0SXRlbUJ0bi5zZXREaXNhYmxlZCh0aGlzLmFkZEF0RW5kT2ZGcm9udE1hdHRlcilcbiAgICAgICAgYWRkQXNMaXN0SXRlbUJ0bi5zZXRUb29sdGlwKFwiQWRkIHRoaXMgZmllbGQgYXMgYSBsaXN0IGl0ZW1cIilcblxuICAgICAgICAvLyBpbnNlcnRBc0NvbW1lbnRJdGVtXG5cbiAgICAgICAgY29uc3QgYWRkQXNDb21tZW50SXRlbUJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIGFkZEFzQ29tbWVudEl0ZW1CdG4uc2V0SWNvbihcIm1lc3NhZ2Utc3F1YXJlXCIpXG4gICAgICAgIGFkZEFzQ29tbWVudEl0ZW1CdG4ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5hZGRBc0NvbW1lbnQpIHtcbiAgICAgICAgICAgICAgICBhZGRBc0NvbW1lbnRJdGVtQnRuLnJlbW92ZUN0YSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkQXNDb21tZW50ID0gZmFsc2VcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5zZXRDdGEoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZEFzQ29tbWVudCA9IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5zZXREaXNhYmxlZCh0aGlzLmFkZEF0RW5kT2ZGcm9udE1hdHRlcilcbiAgICAgICAgYWRkQXNDb21tZW50SXRlbUJ0bi5zZXRUb29sdGlwKFwiQWRkIHRoaXMgZmllbGQgYXMgYSBjb21tZW50IGl0ZW1cIilcblxuXG4gICAgICAgIC8vIGluc2VydEFzQ29tbWVudEl0ZW1cblxuICAgICAgICBjb25zdCBhZGRBdEVuZE9mRnJvbnRNYXR0ZXJCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0Q29udGFpbmVyKVxuICAgICAgICBhZGRBdEVuZE9mRnJvbnRNYXR0ZXJCdG4uc2V0SWNvbihcImxpc3QtZW5kXCIpXG4gICAgICAgIGFkZEF0RW5kT2ZGcm9udE1hdHRlckJ0bi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMub25TZWxlY3QoLTIsIHRydWUsIGZhbHNlLCBmYWxzZSwgZmFsc2UpXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGFkZEF0RW5kT2ZGcm9udE1hdHRlckJ0bi5zZXRUb29sdGlwKFwiQWRkIHRoaXMgZmllbGQgYXQgdGhlIGVuZCBvZiB0aGUgZnJvbnRtYXR0ZXJcIilcbiAgICB9XG5cbiAgICBhc3luYyBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxMaW5lW10+IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHRoaXMuZmlsZSlcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnM6IExpbmVbXSA9IFt7XG4gICAgICAgICAgICBsaW5lTnVtYmVyOiAtMSxcbiAgICAgICAgICAgIGxpbmVUZXh0OiBcIi0tLS0tLS0tLS1BZGQgb24gdG9wIG9mIHRoZSBmaWxlLS0tLS0tLS1cIlxuICAgICAgICB9XVxuICAgICAgICBjb250ZW50LnNwbGl0KFwiXFxuXCIpXG4gICAgICAgICAgICAuZm9yRWFjaCgobGluZUNvbnRlbnQsIGkpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobGluZUNvbnRlbnQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgICAgICAgICBzdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXI6IGksXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5lVGV4dDogbGluZUNvbnRlbnQuc3Vic3RyaW5nKDAsIDU3KSArIChsaW5lQ29udGVudC5sZW5ndGggPCA1NyA/IFwiXCIgOiBcIi4uLlwiKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IExpbmUsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5hZGRDbGFzcyhcIml0ZW1cIilcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcImxpbmVcIiB9KTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IGAke3ZhbHVlLmxpbmVOdW1iZXIgKyAxfWAsIGNsczogXCJsaW5lTnVtYmVyXCIgfSk7XG4gICAgICAgIGNvbnRhaW5lci5jcmVhdGVEaXYoeyB0ZXh0OiB2YWx1ZS5saW5lVGV4dCwgY2xzOiBcImxpbmVUZXh0XCIgfSk7XG4gICAgfVxuXG4gICAgb25DaG9vc2VTdWdnZXN0aW9uKGl0ZW06IExpbmUsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodGhpcy5maWxlKT8uZnJvbnRtYXR0ZXJcbiAgICAgICAgY29uc3QgaW5Gcm9udG1hdHRlciA9IGZyb250bWF0dGVyICE9PSB1bmRlZmluZWQgJiYgKGl0ZW0ubGluZU51bWJlciA8PSBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZSlcbiAgICAgICAgY29uc3QgYWZ0ZXIgPSBpdGVtLmxpbmVOdW1iZXIgPT0gLTEgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgIHRoaXMub25TZWxlY3QoaXRlbS5saW5lTnVtYmVyID09IC0xID8gMCA6IGl0ZW0ubGluZU51bWJlcixcbiAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICBhZnRlcixcbiAgICAgICAgICAgIHRoaXMuYWRkQXNMaXN0SXRlbSxcbiAgICAgICAgICAgIHRoaXMuYWRkQXNDb21tZW50KVxuICAgIH1cbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBnZW51aW5lS2V5cyB9IGZyb20gXCJzcmMvdXRpbHMvZGF0YXZpZXdVdGlsc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcIi4vaW5zZXJ0VmFsdWVzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnNlcnRNaXNzaW5nRmllbGRzKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGZpbGVPckZpbGVQYXRoOiBzdHJpbmcgfCBURmlsZSxcbiAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLFxuICAgIGFmdGVyOiBib29sZWFuID0gZmFsc2UsXG4gICAgYXNMaXN0OiBib29sZWFuID0gZmFsc2UsXG4gICAgYXNDb21tZW50OiBib29sZWFuID0gZmFsc2UsXG4gICAgZmlsZUNsYXNzTmFtZT86IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JGaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JGaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPckZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZHZBcGkgPSBwbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgaWYgKGR2QXBpKSB7XG4gICAgICAgIGNvbnN0IGYgPSBwbHVnaW4uZmllbGRJbmRleDtcbiAgICAgICAgY29uc3QgdG0gPSBwbHVnaW4uZmlsZVRhc2tNYW5hZ2VyO1xuICAgICAgICBjb25zdCBmaWVsZHMgPSBmLmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWVsZHNOYW1lcyA9IGdlbnVpbmVLZXlzKGR2QXBpLnBhZ2UoZmlsZS5wYXRoKSlcbiAgICAgICAgY29uc3QgZmlsdGVyZWRDbGFzc0ZpZWxkcyA9IGZpbGVDbGFzc05hbWUgPyBwbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQoZmlsZUNsYXNzTmFtZSk/LmZpbHRlcihmaWVsZCA9PiBmaWVsZC5maWxlQ2xhc3NOYW1lID09PSBmaWxlQ2xhc3NOYW1lKSB8fCB1bmRlZmluZWQgOiB1bmRlZmluZWRcbiAgICAgICAgZmllbGRzPy5maWx0ZXIoZmllbGQgPT4gIWN1cnJlbnRGaWVsZHNOYW1lcy5pbmNsdWRlcyhmaWVsZC5uYW1lKSlcbiAgICAgICAgICAgIC5maWx0ZXIoZmllbGQgPT4gZmlsdGVyZWRDbGFzc0ZpZWxkcyA/IGZpbHRlcmVkQ2xhc3NGaWVsZHMubWFwKGYgPT4gZi5uYW1lKS5pbmNsdWRlcyhmaWVsZC5uYW1lKSA6IHRydWUpXG4gICAgICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgICAgICAuZm9yRWFjaChhc3luYyBmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdG0ucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXMocGx1Z2luLCBmaWxlLnBhdGgsIGZpZWxkLm5hbWUsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGFmdGVyLCBhc0xpc3QsIGFzQ29tbWVudCkgfSlcbiAgICAgICAgICAgIH0pXG4gICAgfVxufSIsICJpbXBvcnQgRmllbGQsIHsgRmllbGRDb21tYW5kIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5jbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBvcmlnaW46IHN0cmluZyxcbiAgICAgICAgcHVibGljIG5hbWU6IHN0cmluZyxcbiAgICAgICAgcHVibGljIHR5cGU6IEZpZWxkVHlwZSA9IEZpZWxkVHlwZS5JbnB1dCxcbiAgICAgICAgcHVibGljIG9wdGlvbnM6IHN0cmluZ1tdIHwgUmVjb3JkPHN0cmluZywgYW55PiA9IFtdLFxuICAgICAgICBwdWJsaWMgZmlsZUNsYXNzTmFtZTogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgY29tbWFuZDogRmllbGRDb21tYW5kXG4gICAgKSB7IH1cblxuICAgIHB1YmxpYyBnZXRGaWVsZCgpIHtcbiAgICAgICAgbGV0IG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5vcHRpb25zKSkge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zPy5mb3JFYWNoKChvcHRpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc1tpbmRleF0gPSBvcHRpb247XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgRmllbGQodGhpcy5uYW1lLCBvcHRpb25zLCB0aGlzLm5hbWUsIHRoaXMudHlwZSwgdGhpcy5maWxlQ2xhc3NOYW1lLCB0aGlzLmNvbW1hbmQpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH07IiwgImltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZSB9IGZyb20gXCIuL2ZpbGVDbGFzc0F0dHJpYnV0ZVwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgU3VnZ2VzdE1vZGFsLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRmllbGRUeXBlLCBGaWVsZFR5cGVMYWJlbE1hcHBpbmcgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGNhcGl0YWxpemUgfSBmcm9tIFwic3JjL3V0aWxzL3RleHRVdGlsc1wiO1xuaW1wb3J0IHsgZ2VudWluZUtleXMgfSBmcm9tIFwic3JjL3V0aWxzL2RhdGF2aWV3VXRpbHNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyBpbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydEZyb250bWF0dGVyV2l0aEZpZWxkc1wiO1xuaW1wb3J0IHsgRmllbGRDb21tYW5kIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcblxuaW50ZXJmYWNlIEZpbGVDbGFzcyB7XG4gICAgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbiAgICBvYmplY3RzOiBGaWxlQ2xhc3NNYW5hZ2VyO1xuICAgIGVycm9yczogc3RyaW5nW107XG4gICAgcGFyZW50PzogRmlsZUNsYXNzO1xuICAgIGV4Y2x1ZGVzPzogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbn1cblxuZXhwb3J0IGNsYXNzIEFkZEZpbGVDbGFzc1RvRmlsZU1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPHN0cmluZz4ge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgZmlsZTogVEZpbGVcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcClcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10gfCBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiBbLi4udGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc05hbWUua2V5cygpXVxuICAgICAgICAgICAgLmZpbHRlcihmaWxlQ2xhc3NOYW1lID0+ICF0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXNcbiAgICAgICAgICAgICAgICAuZ2V0KHRoaXMuZmlsZS5wYXRoKT8ubWFwKGZpbGVDbGFzcyA9PiBmaWxlQ2xhc3MubmFtZSlcbiAgICAgICAgICAgICAgICAuaW5jbHVkZXMoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5maWx0ZXIoZmlsZUNsYXNzTmFtZSA9PiBmaWxlQ2xhc3NOYW1lLnRvTG9jYWxlTG93ZXJDYXNlKCkuY29udGFpbnMocXVlcnkudG9Mb3dlckNhc2UoKSkpXG4gICAgICAgICAgICAuc29ydCgpO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24odmFsdWU6IHN0cmluZywgZWw6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGVsLnNldFRleHQodmFsdWUpO1xuICAgIH1cblxuICAgIG9uQ2hvb3NlU3VnZ2VzdGlvbihpdGVtOiBzdHJpbmcsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgdGhpcy5pbnNlcnRGaWxlQ2xhc3NUb0ZpbGUoaXRlbSlcbiAgICB9XG5cbiAgICBhc3luYyBpbnNlcnRGaWxlQ2xhc3NUb0ZpbGUodmFsdWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzXG4gICAgICAgIGNvbnN0IGN1cnJlbnRGaWxlQ2xhc3NlcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlcy5nZXQodGhpcy5maWxlLnBhdGgpXG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyRmlsZUNsYXNzZXMgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodGhpcy5maWxlKT8uZnJvbnRtYXR0ZXI/LltmaWxlQ2xhc3NBbGlhc107XG4gICAgICAgIGlmIChjdXJyZW50RmlsZUNsYXNzZXMgJiYgZnJvbnRtYXR0ZXJGaWxlQ2xhc3Nlcykge1xuICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBmaWxlQ2xhc3NBbGlhcywgWy4uLmN1cnJlbnRGaWxlQ2xhc3Nlcy5tYXAoZmMgPT4gZmMubmFtZSksIHZhbHVlXS5qb2luKFwiLCBcIikpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpPy5mcm9udG1hdHRlclxuICAgICAgICAgICAgaWYgKGZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGZyb250bWF0dGVyKS5pbmNsdWRlcyhmaWxlQ2xhc3NBbGlhcykpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9maWxlQ2xhc3MgZmllbGQgaXMgZW1wdHksIGhhcyBhbiBlbXB0eSBhcnJheSBvZiBpcyBiYWRseSBmb3JtYXR0ZWQ6IG92ZXJyaWRlIGl0XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmlsZUNsYXNzQWxpYXMsIHZhbHVlKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZnJvbnRtYXR0ZXIgZXhpc3RzIGJ1dCBkb2Vzbid0IGNvbnRhaW4gZmlsZUNsYXNzOiBhZGQgaXRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lIC0gMVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmlsZUNsYXNzQWxpYXMsIHZhbHVlLCBsaW5lTnVtYmVyLCB0cnVlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cbiAgICAgICAgICAgICAgICBmaWVsZHNbZmlsZUNsYXNzQWxpYXNdID0gdmFsdWVcbiAgICAgICAgICAgICAgICBhd2FpdCBpbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgZmllbGRzKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5jbGFzcyBGaWxlQ2xhc3NNYW5hZ2VyIHtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBpbnN0YW5jZTogRmlsZUNsYXNzKSB7IH1cblxuICAgIHB1YmxpYyBhbGwoKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzV2l0aEZpbGVDbGFzc05hbWUgPSB0aGlzLmluc3RhbmNlLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZpbHRlcihmaWxlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSB0aGlzLmluc3RhbmNlLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcztcbiAgICAgICAgICAgIHJldHVybiBjYWNoZT8uZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgICAgICAmJiBPYmplY3Qua2V5cyhjYWNoZS5mcm9udG1hdHRlcikuaW5jbHVkZXMoZmlsZUNsYXNzQWxpYXMpXG4gICAgICAgICAgICAgICAgJiYgY2FjaGUuZnJvbnRtYXR0ZXJbZmlsZUNsYXNzQWxpYXNdID09IHRoaXMuaW5zdGFuY2UubmFtZTtcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGZpbGVzV2l0aEZpbGVDbGFzc05hbWU7XG4gICAgfVxuXG4gICAgcHVibGljIGdldChuYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZmlsZXNXaXRoTmFtZSA9IHRoaXMuYWxsKCkuZmlsdGVyKGZpbGUgPT4gZmlsZS5wYXRoLnJlcGxhY2UoL21kJC8sIFwiXCIpLmVuZHNXaXRoKG5hbWUpKTtcbiAgICAgICAgaWYgKGZpbGVzV2l0aE5hbWUubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJNb3JlIHRoYW4gb25lIHZhbHVlIGZvdW5kXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbGVzV2l0aE5hbWUubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTm8gZmlsZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWxlc1dpdGhOYW1lWzBdO1xuXG4gICAgfVxuXG4gICAgcHVibGljIGdldFBhdGgocGF0aDogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzV2l0aE5hbWUgPSB0aGlzLmFsbCgpLmZpbHRlcihmaWxlID0+IGZpbGUucGF0aCA9PSBwYXRoKTtcbiAgICAgICAgaWYgKGZpbGVzV2l0aE5hbWUubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJNb3JlIHRoYW4gb25lIHZhbHVlIGZvdW5kXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbGVzV2l0aE5hbWUubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTm8gZmlsZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWxlc1dpdGhOYW1lWzBdO1xuXG4gICAgfVxufVxuXG5jbGFzcyBGaWxlQ2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBwbHVnaW46IE1ldGFkYXRhTWVudSwgcHVibGljIG5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLm9iamVjdHMgPSBuZXcgRmlsZUNsYXNzTWFuYWdlcih0aGlzKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gW107XG4gICAgfVxuXG4gICAgcHVibGljIGlzTWFwcGVkV2l0aFRhZygpOiBib29sZWFuIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0ZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICAgICAgY29uc3QgbWFwV2l0aFRhZyA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlQ2xhc3NGaWxlKT8uZnJvbnRtYXR0ZXI/Lm1hcFdpdGhUYWc7XG4gICAgICAgICAgICByZXR1cm4gISFtYXBXaXRoVGFnO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0Q2xhc3NGaWxlKCk6IFRGaWxlIHtcbiAgICAgICAgY29uc3QgZmlsZXNDbGFzc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aDtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7ZmlsZXNDbGFzc1BhdGh9JHt0aGlzLm5hbWV9Lm1kYCk7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgIGBubyBmaWxlIG5hbWVkIDwke3RoaXMubmFtZX0ubWQ+IGluIDwke2ZpbGVzQ2xhc3NQYXRofT4gZm9sZGVyIHRvIG1hdGNoIDwke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfTogJHt0aGlzLm5hbWV9PiBpbiBvbmUgb2YgdGhlc2Ugbm90ZXNgXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRJY29uKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IHBhcmVudHMgPSBbdGhpcy5uYW1lLCAuLi50aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzQW5jZXN0b3JzLmdldCh0aGlzLm5hbWUpIHx8IFtdXVxuICAgICAgICBsZXQgaWNvbjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuICAgICAgICBwYXJlbnRzLnNvbWUoKGZpbGVDbGFzc05hbWUsIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNOYW1lLmdldChmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBmaWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgX2ljb24gPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyPy5pY29uXG4gICAgICAgICAgICAgICAgaWYgKF9pY29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGljb24gPSBfaWNvblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gaWNvblxuICAgIH1cblxuICAgIHN0YXRpYyBnZXRGaWxlQ2xhc3NBdHRyaWJ1dGVzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlQ2xhc3M6IEZpbGVDbGFzcywgZXhjbHVkZXM/OiBzdHJpbmdbXSk6IEZpbGVDbGFzc0F0dHJpYnV0ZVtdIHtcblxuICAgICAgICBjb25zdCBmaWxlID0gZmlsZUNsYXNzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBsZXQgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPiA9IFtdO1xuICAgICAgICBjb25zdCBkdkFwaSA9IHBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zW1wiZGF0YXZpZXdcIl0/LmFwaVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKGR2QXBpKSB7XG4gICAgICAgICAgICBjb25zdCBkdkZpbGUgPSBkdkFwaS5wYWdlKGZpbGUucGF0aClcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZ2VudWluZUtleXMoZHZGaWxlKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChrZXkgIT09IFwiZmlsZVwiICYmICFPYmplY3Qua2V5cyhkdkZpbGUuZmlsZS5mcm9udG1hdHRlciB8fCB7fSkuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHR5cGVvZiBkdkZpbGVba2V5XSAhPT0gXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkoZHZGaWxlW2tleV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBkdkZpbGVba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB0eXBlLCBvcHRpb25zLCBjb21tYW5kIH0gPSBKU09OLnBhcnNlKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkVHlwZSA9IEZpZWxkVHlwZUxhYmVsTWFwcGluZ1tjYXBpdGFsaXplKHR5cGUpIGFzIGtleW9mIHR5cGVvZiBGaWVsZFR5cGVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHIgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlKHRoaXMubmFtZSwga2V5LCBmaWVsZFR5cGUsIG9wdGlvbnMsIGZpbGVDbGFzcy5uYW1lLCBjb21tYW5kKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucHVzaChhdHRyKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZG8gbm90aGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZXhjbHVkZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzLmZpbHRlcihhdHRyID0+ICFleGNsdWRlcy5pbmNsdWRlcyhhdHRyLm5hbWUpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZXNcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHN0YXRpYyBnZXRFeGNsdWRlZEZpZWxkc0Zyb21Gcm9udG1hdHRlcihleGNsdWRlZEZpZWxkczogc3RyaW5nW10gfCBzdHJpbmcgfCB1bmRlZmluZWQpOiBzdHJpbmdbXSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGV4Y2x1ZGVkRmllbGRzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4Y2x1ZGVkRmllbGRzO1xuICAgICAgICB9IGVsc2UgaWYgKGV4Y2x1ZGVkRmllbGRzKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhjbHVkZWRGaWVsZHMuc3BsaXQoXCIsXCIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRBdHRyaWJ1dGVzKGV4Y2x1ZGVQYXJlbnRzOiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICAgICAgY29uc3QgYW5jZXN0b3JzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5nZXQodGhpcy5uYW1lKTtcbiAgICAgICAgICAgIGNvbnN0IF9leGNsdWRlZEZpZWxkcyA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKT8uZnJvbnRtYXR0ZXI/LmV4Y2x1ZGVzXG4gICAgICAgICAgICBsZXQgZXhjbHVkZWRGaWVsZHMgPSBGaWxlQ2xhc3MuZ2V0RXhjbHVkZWRGaWVsZHNGcm9tRnJvbnRtYXR0ZXIoX2V4Y2x1ZGVkRmllbGRzKTtcblxuICAgICAgICAgICAgY29uc3QgYW5jZXN0b3JzQXR0cmlidXRlczogTWFwPHN0cmluZywgRmlsZUNsYXNzQXR0cmlidXRlW10+ID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgYW5jZXN0b3JzQXR0cmlidXRlcy5zZXQodGhpcy5uYW1lLCBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzQXR0cmlidXRlcyh0aGlzLnBsdWdpbiwgdGhpcywgZXhjbHVkZWRGaWVsZHMpKVxuICAgICAgICAgICAgaWYgKCFleGNsdWRlUGFyZW50cykge1xuICAgICAgICAgICAgICAgIGFuY2VzdG9ycz8uZm9yRWFjaChhbmNlc3Rvck5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhbmNlc3RvckZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGAke3RoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRofSR7YW5jZXN0b3JOYW1lfS5tZGApXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFuY2VzdG9yID0gbmV3IEZpbGVDbGFzcyh0aGlzLnBsdWdpbiwgYW5jZXN0b3JOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3JzQXR0cmlidXRlcy5zZXQoYW5jZXN0b3JOYW1lLCBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzQXR0cmlidXRlcyh0aGlzLnBsdWdpbiwgYW5jZXN0b3IsIGV4Y2x1ZGVkRmllbGRzKSlcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGFuY2VzdG9yRmlsZS5leHRlbnNpb24gPT09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX2V4Y2x1ZGVkRmllbGRzID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGFuY2VzdG9yRmlsZSk/LmZyb250bWF0dGVyPy5leGNsdWRlc1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhjbHVkZWRGaWVsZHMgPSBGaWxlQ2xhc3MuZ2V0RXhjbHVkZWRGaWVsZHNGcm9tRnJvbnRtYXR0ZXIoX2V4Y2x1ZGVkRmllbGRzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtmaWxlQ2xhc3NOYW1lLCBmaWxlQ2xhc3NBdHRyaWJ1dGVzXSBvZiBhbmNlc3RvcnNBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnB1c2goLi4uZmlsZUNsYXNzQXR0cmlidXRlcy5maWx0ZXIoYXR0ciA9PiAhdGhpcy5hdHRyaWJ1dGVzLm1hcChfYXR0ciA9PiBfYXR0ci5uYW1lKS5pbmNsdWRlcyhhdHRyLm5hbWUpKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IChlcnJvcik7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyB1cGRhdGVBdHRyaWJ1dGUobmV3VHlwZToga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgbmV3TmFtZTogc3RyaW5nLCBuZXdPcHRpb25zPzogc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlLCBuZXdDb21tYW5kPzogRmllbGRDb21tYW5kKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IGF0dHIgPyB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoYXR0ci5maWxlQ2xhc3NOYW1lKSEgOiB0aGlzXG4gICAgICAgIGNvbnN0IGZpbGUgPSBmaWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuICAgICAgICBpZiAoYXR0cikge1xuICAgICAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICByZXN1bHQuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aChhdHRyLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBzZXR0aW5nc1tcInR5cGVcIl0gPSBuZXdUeXBlO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3T3B0aW9ucykgc2V0dGluZ3NbXCJvcHRpb25zXCJdID0gbmV3T3B0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0NvbW1hbmQpIHNldHRpbmdzW1wiY29tbWFuZFwiXSA9IG5ld0NvbW1hbmQ7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHtuZXdOYW1lfTo6ICR7SlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpfWApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgIGlmIChuZXdPcHRpb25zKSBzZXR0aW5nc1tcIm9wdGlvbnNcIl0gPSBuZXdPcHRpb25zO1xuICAgICAgICAgICAgaWYgKG5ld0NvbW1hbmQpIHNldHRpbmdzW1wiY29tbWFuZFwiXSA9IG5ld0NvbW1hbmQ7XG4gICAgICAgICAgICByZXN1bHQgKz0gKGBcXG4ke25ld05hbWV9OjogJHtKU09OLnN0cmluZ2lmeShzZXR0aW5ncyl9YCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgcmVtb3ZlQXR0cmlidXRlKGF0dHI6IEZpbGVDbGFzc0F0dHJpYnV0ZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgIHJlc3VsdC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgIGlmICghbGluZS5zdGFydHNXaXRoKGF0dHIubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgfVxuXG4gICAgc3RhdGljIGNyZWF0ZUZpbGVDbGFzcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgbmFtZTogc3RyaW5nLCBleGNsdWRlUGFyZW50OiBib29sZWFuID0gZmFsc2UpOiBGaWxlQ2xhc3Mge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBuZXcgRmlsZUNsYXNzKHBsdWdpbiwgbmFtZSk7XG4gICAgICAgIGZpbGVDbGFzcy5nZXRBdHRyaWJ1dGVzKClcbiAgICAgICAgcmV0dXJuIGZpbGVDbGFzc1xuICAgIH1cblxuICAgIHN0YXRpYyBnZXRGaWxlQ2xhc3NOYW1lRnJvbVBhdGgocGx1Z2luOiBNZXRhZGF0YU1lbnUsIHBhdGg6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWVSZWdleCA9IG5ldyBSZWdFeHAoYCR7cGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRofSg/PGZpbGVDbGFzc05hbWU+LiopLm1kYCk7XG4gICAgICAgIHJldHVybiBwYXRoLm1hdGNoKGZpbGVDbGFzc05hbWVSZWdleCk/Lmdyb3Vwcz8uZmlsZUNsYXNzTmFtZVxuICAgIH1cbn1cblxuXG5leHBvcnQgeyBGaWxlQ2xhc3MgfTsiLCAiZXhwb3J0IGNvbnN0IGNhcGl0YWxpemUgPSAoczogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIHMgJiYgc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKTtcbn0iLCAiaW1wb3J0IHsgQXBwLCBGdXp6eU1hdGNoLCBGdXp6eVN1Z2dlc3RNb2RhbCwgc2V0SWNvbiB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbnRlcmZhY2UgT3B0aW9uIHtcbiAgICBpZDogc3RyaW5nLFxuICAgIGFjdGlvbkxhYmVsOiBzdHJpbmcsXG4gICAgYWN0aW9uOiBhbnksXG4gICAgaWNvbj86IHN0cmluZ1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxPcHRpb24+IHtcbiAgICBwdWJsaWMgb3B0aW9uczogT3B0aW9uW10gPSBbXVxuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogT3B0aW9uW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zXG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQoaXRlbTogT3B0aW9uKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uYWN0aW9uTGFiZWxcbiAgICB9XG5cbiAgICBvbkNob29zZUl0ZW0oaXRlbTogT3B0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGl0ZW0uYWN0aW9uKCk7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihpdGVtOiBGdXp6eU1hdGNoPE9wdGlvbj4sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5hZGRDbGFzcyhcInZhbHVlLWNvbnRhaW5lclwiKTtcbiAgICAgICAgY29uc3QgaWNvbkNvbnRhaW5lciA9IGVsLmNyZWF0ZURpdih7IGNsczogXCJpY29uLWNvbnRhaW5lclwiIH0pXG4gICAgICAgIGl0ZW0uaXRlbS5pY29uID8gc2V0SWNvbihpY29uQ29udGFpbmVyLCBpdGVtLml0ZW0uaWNvbikgOiBzZXRJY29uKGljb25Db250YWluZXIsIFwicGVuY2lsXCIpXG4gICAgICAgIGNvbnN0IGFjdGlvbkxhYmVsID0gZWwuY3JlYXRlRGl2KClcbiAgICAgICAgYWN0aW9uTGFiZWwuaW5uZXJIVE1MID0gaXRlbS5pdGVtLmFjdGlvbkxhYmVsXG4gICAgfVxufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWVudSwgTm90aWNlLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5zZXJ0RnJvbnRtYXR0ZXJXaXRoRmllbGRzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRGcm9udG1hdHRlcldpdGhGaWVsZHNcIjtcbmltcG9ydCB7IGluc2VydE1pc3NpbmdGaWVsZHMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydE1pc3NpbmdGaWVsZHNcIjtcbmltcG9ydCB7IGluc2VydFZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NDb21wb25lbnQgfSBmcm9tIFwic3JjL2NvbXBvbmVudHMvZmlsZUNsYXNzVGFibGVcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWxcIjtcbmltcG9ydCBjaG9vc2VTZWN0aW9uTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCI7XG5pbXBvcnQgeyBnZW51aW5lS2V5cyB9IGZyb20gXCJzcmMvdXRpbHMvZGF0YXZpZXdVdGlsc1wiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwiLi9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcblxuZnVuY3Rpb24gaXNNZW51KGxvY2F0aW9uOiBNZW51IHwgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB8IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCk6IGxvY2F0aW9uIGlzIE1lbnUge1xuICAgIHJldHVybiAobG9jYXRpb24gYXMgTWVudSkuYWRkSXRlbSAhPT0gdW5kZWZpbmVkO1xufTtcblxuZnVuY3Rpb24gaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogbG9jYXRpb24gaXMgXCJJbnNlcnRGaWVsZENvbW1hbmRcIiB7XG4gICAgcmV0dXJuIChsb2NhdGlvbiBhcyBzdHJpbmcpID09PSBcIkluc2VydEZpZWxkQ29tbWFuZFwiO1xufVxuXG5mdW5jdGlvbiBpc1N1Z2dlc3QobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKTogbG9jYXRpb24gaXMgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHtcbiAgICByZXR1cm4gKGxvY2F0aW9uIGFzIEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCkuZ2V0SXRlbXMgIT09IHVuZGVmaW5lZDtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVDbGFzc09wdGlvbnNMaXN0IHtcblxuICAgIC8vIGFkZHMgb3B0aW9ucyB0byBjb250ZXh0IG1lbnUgb3IgdG8gYSBkcm9wZG93biBtb2RhbCB0cmlnZ2VyIHdpdGggXCJGaWVsZDogT3B0aW9uc1wiIGNvbW1hbmQgaW4gY29tbWFuZCBwYWxsZXR0ZVxuICAgIHByaXZhdGUgZmlsZUNsYXNzOiBGaWxlQ2xhc3MgfCB1bmRlZmluZWQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSBmaWxlOiBURmlsZSxcbiAgICAgICAgcHJpdmF0ZSBsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwsXG4gICAgICAgIHByaXZhdGUgZnJvbUZpbGU/OiBURmlsZVxuICAgICkge1xuICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNQYXRoLmdldCh0aGlzLmZpbGUucGF0aClcbiAgICB9O1xuXG4gICAgcHVibGljIGNyZWF0ZUV4dHJhT3B0aW9uTGlzdChvcGVuQWZ0ZXJDcmVhdGU6IGJvb2xlYW4gPSB0cnVlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1hcFdpdGhUYWdBY3Rpb24gPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpPy5mcm9udG1hdHRlclxuICAgICAgICAgICAgaWYgKGZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKGZyb250bWF0dGVyKS5pbmNsdWRlcyhcIm1hcFdpdGhUYWdcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9maWxlQ2xhc3MgZmllbGQgaXMgZW1wdHksIGhhcyBhbiBlbXB0eSBhcnJheSBvZiBpcyBiYWRseSBmb3JtYXR0ZWQ6IG92ZXJyaWRlIGl0XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgXCJtYXBXaXRoVGFnXCIsIFwidHJ1ZVwiKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vZnJvbnRtYXR0ZXIgZXhpc3RzIGJ1dCBkb2Vzbid0IGNvbnRhaW4gZmlsZUNsYXNzOiBhZGQgaXRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IGZyb250bWF0dGVyLnBvc2l0aW9uLmVuZC5saW5lIC0gMVxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgXCJtYXBXaXRoVGFnXCIsIFwidHJ1ZVwiLCBsaW5lTnVtYmVyLCB0cnVlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0geyBcIm1hcFdpdGhUYWdcIjogXCJ0cnVlXCIgfVxuICAgICAgICAgICAgICAgIGF3YWl0IGluc2VydEZyb250bWF0dGVyV2l0aEZpZWxkcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBmaWVsZHMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb3BlbkZpbGVDbGFzc1RhYmxlVmlld0FjdGlvbiA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0NvbXBvbmVudCA9IG5ldyBGaWxlQ2xhc3NDb21wb25lbnQodGhpcy5wbHVnaW4sIGZpbGVDbGFzcylcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFkZENoaWxkKGZpbGVDbGFzc0NvbXBvbmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkgeyB0aGlzLmxvY2F0aW9uLmFkZFNlcGFyYXRvcigpOyB9O1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLmZpbGVDbGFzc1xuICAgICAgICBjb25zdCBjdXJyZW50RmllbGRzTmFtZXM6IHN0cmluZ1tdID0gW11cbiAgICAgICAgbGV0IGFkZE1pc3NpbmdGaWVsZHNBY3Rpb24gPSAoKSA9PiB7IG5ldyBOb3RpY2UoXCJTb21ldGhpbmcgd2VudCB3cm9uZywgcGxlYXNlIGNoZWNrIHlvdXIgZmlsZUNsYXNzIGRlZmluaXRpb25zXCIpIH1cbiAgICAgICAgaWYgKHRoaXMuZnJvbUZpbGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgICAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkdkZpbGUgPSBkdkFwaS5wYWdlKHRoaXMuZnJvbUZpbGUucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKGR2RmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50RmllbGRzTmFtZXMucHVzaCguLi5nZW51aW5lS2V5cyhkdkZpbGUpKVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJvbUZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcjogbnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNMaXN0OiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICAgICAgKSA9PiBpbnNlcnRNaXNzaW5nRmllbGRzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR2RmlsZS5maWxlLnBhdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzTGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0NvbW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzPy5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGFkZE1pc3NpbmdGaWVsZHNBY3Rpb24gPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBtaXNzaW5nRmllbGRzID0gZmlsZUNsYXNzICYmIHRoaXMuZnJvbUZpbGUgP1xuICAgICAgICAgICAgIXRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZUNsYXNzZXNGaWVsZHMuZ2V0KGZpbGVDbGFzcy5uYW1lKT8ubWFwKGYgPT4gZi5uYW1lKS5ldmVyeShmaWVsZE5hbWUgPT4gY3VycmVudEZpZWxkc05hbWVzLmluY2x1ZGVzKGZpZWxkTmFtZSkpIDpcbiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgIGlmIChpc0luc2VydEZpZWxkQ29tbWFuZCh0aGlzLmxvY2F0aW9uKSAmJiBmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MpO1xuICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGBkaXNwbGF5X3RhYmxlX3ZpZXdfZm9yXyR7ZmlsZUNsYXNzLm5hbWUucmVwbGFjZShcIi9cIiwgXCJfXCIpfWAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgRGlzcGxheSAke2ZpbGVDbGFzcy5uYW1lfSB0YWJsZSB2aWV3YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBvcGVuRmlsZUNsYXNzVGFibGVWaWV3QWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBcImZpbGUtc3ByZWFkc2hlZXRcIlxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmICFmaWxlQ2xhc3MuaXNNYXBwZWRXaXRoVGFnKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGlkOiBcIm1hcF9maWxlQ2xhc3Nfd2l0aF90YWdcIixcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj5NYXAgPGI+JHtmaWxlQ2xhc3MubmFtZX08L2I+IHdpdGggdGFnIG9mIHNhbWUgbmFtZTwvc3Bhbj5gLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IG1hcFdpdGhUYWdBY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiaGFzaFwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIG1pc3NpbmdGaWVsZHMgJiYgdGhpcy5mcm9tRmlsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGBpbnNlcnRfbWlzc2lnX2ZpZWxkc19mcm9tXyR7ZmlsZUNsYXNzLm5hbWUucmVwbGFjZShcIi9cIiwgXCJfXCIpfWAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+SW5zZXJ0IG1pc3NpbmcgZmllbGRzIGZyb20gPGI+JHtmaWxlQ2xhc3MubmFtZX08L2I+PC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogYWRkTWlzc2luZ0ZpZWxkc0FjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogXCJiYXR0ZXJ5LWZ1bGxcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuXG5cbiAgICAgICAgICAgIGlmIChvcGVuQWZ0ZXJDcmVhdGUpIHRoaXMubG9jYXRpb24ub3BlbigpO1xuICAgICAgICB9IGVsc2UgaWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBEaXNwbGF5ICR7ZmlsZUNsYXNzLm5hbWV9IHRhYmxlIHZpZXdgKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKG9wZW5GaWxlQ2xhc3NUYWJsZVZpZXdBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJmaWxlLXNwcmVhZHNoZWV0XCIpO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7ZmlsZUNsYXNzLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGZpbGVDbGFzcyAmJiAhZmlsZUNsYXNzLmlzTWFwcGVkV2l0aFRhZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYE1hcCAke2ZpbGVDbGFzcy5uYW1lfSB3aXRoIHRhZ2ApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJoYXNoXCIpO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2sobWFwV2l0aFRhZ0FjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHtmaWxlQ2xhc3MubmFtZX0uZmlsZWNsYXNzLWZpZWxkc2ApO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZmlsZUNsYXNzICYmIG1pc3NpbmdGaWVsZHMgJiYgdGhpcy5mcm9tRmlsZSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBJbnNlcnQgbWlzc2luZyBmaWVsZHMgZnJvbSAke2ZpbGVDbGFzcy5uYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJiYXR0ZXJ5LWZ1bGxcIik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljayhhZGRNaXNzaW5nRmllbGRzQWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKGBtZXRhZGF0YS1tZW51LWZpbGVjbGFzcy4ke2ZpbGVDbGFzcy5uYW1lfS5maWxlY2xhc3MtZmllbGRzYCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYnVpbGRGaWVsZE9wdGlvbnMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRGaWVsZE9wdGlvbnNcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYnVpbGRGaWVsZE9wdGlvbnMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzPy5hdHRyaWJ1dGVzLmZvckVhY2goKGF0dHI6IEZpbGVDbGFzc0F0dHJpYnV0ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZUNsYXNzISwgYXR0cilcbiAgICAgICAgICAgIGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgJHt0aGlzLmZpbGVDbGFzcyEubmFtZX0gLSAke2F0dHIubmFtZX1gKVxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oXCJ3cmVuY2hcIilcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7dGhpcy5maWxlQ2xhc3MhLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGB1cGRhdGVfJHthdHRyLm5hbWV9YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uTGFiZWw6IGA8c3Bhbj4ke2F0dHIubmFtZX08L3NwYW4+YCxcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAoKSA9PiBtb2RhbC5vcGVuKCksXG4gICAgICAgICAgICAgICAgICAgIGljb246IFwiZ2VhclwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MhKTtcbiAgICAgICAgY29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpO1xuICAgICAgICBpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pICYmIHRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKFwiQWRkIG5ldyBmaWVsZFwiKVxuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbihcInBsdXMtY2lyY2xlXCIpXG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKGFjdGlvbilcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oYG1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzLiR7dGhpcy5maWxlQ2xhc3MhLm5hbWV9LmZpbGVjbGFzcy1maWVsZHNgKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikgJiYgdGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogXCJhZGRfZmlsZUNsYXNzX2F0dHJpYnV0ZVwiLFxuICAgICAgICAgICAgICAgIGFjdGlvbkxhYmVsOiBgPHNwYW4+SW5zZXJ0IGFuIGF0dHJpYnV0ZSBmb3IgPGI+JHt0aGlzLmZpbGVDbGFzcy5uYW1lfTwvYj4gZmlsZUNsYXNzPC9zcGFuPmAsXG4gICAgICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb24sXG4gICAgICAgICAgICAgICAgaWNvbjogXCJwbHVzLWNpcmNsZVwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufTtcbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBDb21wb25lbnQsIEl0ZW1WaWV3LCBUZXh0RmlsZVZpZXcsIFZpZXcsIFdvcmtzcGFjZUxlYWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCIuLi9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NDaG9pY2VNb2RhbCB9IGZyb20gXCIuLi9maWxlQ2xhc3MvZmlsZUNsYXNzQ2hvaWNlTW9kYWxcIjtcblxuZXhwb3J0IGNvbnN0IEZJTEVDTEFTU19UQUJMRV9WSUVXX1RZUEUgPSBcIkZpbGVDbGFzc1RhYmxlVmlld1wiXG5cbmV4cG9ydCBjbGFzcyBGaWxlQ2xhc3NUYWJsZVZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHVibGljIGxlYWY6IFdvcmtzcGFjZUxlYWYsXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHByaXZhdGUgY29tcG9uZW50OiBGaWxlQ2xhc3NDb21wb25lbnQsXG4gICAgICAgIHB1YmxpYyBuYW1lPzogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgZmlsZUNsYXNzPzogRmlsZUNsYXNzXG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGxlYWYpXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgICAgIHRoaXMubmF2aWdhdGlvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmljb24gPSBcImZpbGUtc3ByZWFkc2hlZXRcIlxuICAgICAgICB0aGlzLm9udW5sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmlld1JlZ2lzdHJ5LnVucmVnaXN0ZXJWaWV3KEZJTEVDTEFTU19UQUJMRV9WSUVXX1RZUEUgKyBcIl9fXCIgKyB0aGlzLmZpbGVDbGFzcy5uYW1lKTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnJlbW92ZUNoaWxkKHRoaXMuY29tcG9uZW50KVxuICAgICAgICAgICAgdGhpcy51bmxvYWQoKVxuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lIHx8IFwiRmlsZUNsYXNzXCJcbiAgICB9XG5cbiAgICBnZXRWaWV3VHlwZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5maWxlQ2xhc3MgPyBGSUxFQ0xBU1NfVEFCTEVfVklFV19UWVBFICsgXCJfX1wiICsgdGhpcy5maWxlQ2xhc3MubmFtZSA6IEZJTEVDTEFTU19UQUJMRV9WSUVXX1RZUEVcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYXN5bmMgb25PcGVuKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBkdkFwaSA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc/LmFwaVxuICAgICAgICB0aGlzLmljb24gPSB0aGlzLmZpbGVDbGFzcz8uZ2V0SWNvbigpIHx8IFwiZmlsZS1zcHJlYWRzaGVldFwiXG4gICAgICAgIGlmIChkdkFwaSkge1xuICAgICAgICAgICAgZHZBcGkuZXhlY3V0ZUpzKHRoaXMuYnVpbGREdkpTUXVlcnkoKSwgdGhpcy5jb250ZW50RWwsIHRoaXMsIFwiXCIpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYnVpbGREdkpTUXVlcnkoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzRmllbGRzLmdldCh0aGlzLmZpbGVDbGFzcy5uYW1lKSB8fCBbXVxuICAgICAgICAgICAgbGV0IGR2UXVlcnkgPSBcImNvbnN0IHtmaWVsZE1vZGlmaWVyOiBmfSA9IHRoaXMuYXBwLnBsdWdpbnMucGx1Z2luc1tcXFwibWV0YWRhdGEtbWVudVxcXCJdLmFwaTtcXG5cIiArXG4gICAgICAgICAgICAgICAgXCJkdi50YWJsZShbXFxcIkZpbGVcXFwiLFwiO1xuICAgICAgICAgICAgZHZRdWVyeSArPSBmaWVsZHMubWFwKGZpZWxkID0+IGBcIiR7ZmllbGQubmFtZX1cImApLmpvaW4oXCIsXCIpO1xuICAgICAgICAgICAgZHZRdWVyeSArPSBgXSwgZHYucGFnZXMoKVxcbmBcbiAgICAgICAgICAgIGR2UXVlcnkgKz0gYCAgICAud2hlcmUocCA9PiBwLmZpbGVDbGFzcyA9PT0gJyR7dGhpcy5uYW1lfScgfHwgcC5maWxlLmV0YWdzLnZhbHVlcy5pbmNsdWRlcygnIyR7dGhpcy5uYW1lfScpKVxcbmBcbiAgICAgICAgICAgIGR2UXVlcnkgKz0gXCIgICAgLm1hcChwID0+IFtcXG4gICAgICAgIHAuZmlsZS5saW5rLFxcblwiO1xuICAgICAgICAgICAgZHZRdWVyeSArPSBmaWVsZHMubWFwKGZpZWxkID0+IGAgICAgICAgIGYoZHYsIHAsIFwiJHtmaWVsZC5uYW1lfVwiLCB7b3B0aW9uczoge2Fsd2F5c09uOiBmYWxzZSwgc2hvd0FkZEZpZWxkOiB0cnVlfX0pYCkuam9pbihcIixcXG5cIik7XG4gICAgICAgICAgICBkdlF1ZXJ5ICs9IFwiICAgIFxcbl0pXFxuKTtcIlxuICAgICAgICAgICAgcmV0dXJuIGR2UXVlcnlcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEZpbGVDbGFzc0NvbXBvbmVudCBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgcHVibGljIGZpbGVDbGFzc1RhYmxlVmlldzogRmlsZUNsYXNzVGFibGVWaWV3O1xuICAgIHB1YmxpYyBmaWxlQ2xhc3NUYWJsZVZpZXdUeXBlOiBzdHJpbmc7XG4gICAgcHVibGljIG5hbWU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3NcbiAgICApIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKCF0aGlzLmZpbGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NUYWJsZVZpZXdUeXBlID0gRklMRUNMQVNTX1RBQkxFX1ZJRVdfVFlQRVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3NUYWJsZVZpZXdUeXBlID0gRklMRUNMQVNTX1RBQkxFX1ZJRVdfVFlQRSArIFwiX19cIiArIHRoaXMuZmlsZUNsYXNzLm5hbWVcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIG9ubG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcblxuICAgICAgICBpZiAodGhpcy5maWxlQ2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IHRoaXMuZmlsZUNsYXNzLm5hbWU7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1RhYmxlVmlld1R5cGUgPSBGSUxFQ0xBU1NfVEFCTEVfVklFV19UWVBFICsgXCJfX1wiICsgdGhpcy5maWxlQ2xhc3MubmFtZVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5vcGVuVGFibGVWaWV3KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCB0YWdzQW5kRmlsZUNsYXNzZXMgPSB0aGlzLmdldEFjdGl2ZUZpbGVUYWdzQW5kRmlsZUNsYXNzZXMoKTtcbiAgICAgICAgICAgIGlmICh0YWdzQW5kRmlsZUNsYXNzZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHRhZ3NBbmRGaWxlQ2xhc3Nlc1swXTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBpbmRleC5maWxlQ2xhc3Nlc05hbWUuZ2V0KGZpbGVDbGFzc05hbWUpIHx8IGluZGV4LnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzLmdldChmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lID0gZmlsZUNsYXNzLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzID0gZmlsZUNsYXNzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1RhYmxlVmlld1R5cGUgPSBGSUxFQ0xBU1NfVEFCTEVfVklFV19UWVBFICsgXCJfX1wiICsgZmlsZUNsYXNzLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vcGVuVGFibGVWaWV3KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4ucmVtb3ZlQ2hpbGQodGhpcylcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxvYWQoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hvaWNlTW9kYWwgPSBuZXcgRmlsZUNsYXNzQ2hvaWNlTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMsIHRhZ3NBbmRGaWxlQ2xhc3NlcylcbiAgICAgICAgICAgICAgICBjaG9pY2VNb2RhbC5vbkNsb3NlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5yZW1vdmVDaGlsZCh0aGlzKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxvYWQoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNob2ljZU1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9udW5sb2FkKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmRldGFjaExlYXZlc09mVHlwZSh0aGlzLmZpbGVDbGFzc1RhYmxlVmlld1R5cGUpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC52aWV3UmVnaXN0cnkudW5yZWdpc3RlclZpZXcodGhpcy5maWxlQ2xhc3NUYWJsZVZpZXdUeXBlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgb3BlblRhYmxlVmlldygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUodGhpcy5maWxlQ2xhc3NUYWJsZVZpZXdUeXBlKTtcblxuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlclZpZXcodGhpcy5maWxlQ2xhc3NUYWJsZVZpZXdUeXBlLFxuICAgICAgICAgICAgKGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IG5ldyBGaWxlQ2xhc3NUYWJsZVZpZXcobGVhZiwgdGhpcy5wbHVnaW4sIHRoaXMsIHRoaXMubmFtZSwgdGhpcy5maWxlQ2xhc3MpXG4gICAgICAgIClcblxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInLCAndmVydGljYWwnKS5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgICAgdHlwZTogdGhpcy5maWxlQ2xhc3NUYWJsZVZpZXdUeXBlLFxuICAgICAgICAgICAgYWN0aXZlOiB0cnVlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKHRoaXMuZmlsZUNsYXNzVGFibGVWaWV3VHlwZSkubGFzdCgpIVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0QWN0aXZlRmlsZVRhZ3NBbmRGaWxlQ2xhc3NlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleFxuICAgICAgICBjb25zdCBhY3RpdmVGaWxlUGF0aCA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpPy5wYXRoXG4gICAgICAgIGNvbnN0IHRhZ3NBbmRGaWxlQ2xhc3NlcyA9IFtdXG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChhY3RpdmVGaWxlUGF0aCAmJiBkdkFwaSkge1xuICAgICAgICAgICAgdGFnc0FuZEZpbGVDbGFzc2VzLnB1c2goLi4uKGR2QXBpLnBhZ2UoYWN0aXZlRmlsZVBhdGgpLmV0YWdzPy5maWx0ZXIoKHRhZzogc3RyaW5nKSA9PiBbLi4uaW5kZXgudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMua2V5cygpXS5pbmNsdWRlcyh0YWcpKSB8fCBbXSkpXG4gICAgICAgICAgICB0YWdzQW5kRmlsZUNsYXNzZXMucHVzaCguLi4oaW5kZXguZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLmdldChhY3RpdmVGaWxlUGF0aCkgfHwgW10pKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbLi4ubmV3IFNldCh0YWdzQW5kRmlsZUNsYXNzZXMpXVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NDb21wb25lbnQsIEZJTEVDTEFTU19UQUJMRV9WSUVXX1RZUEUgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9maWxlQ2xhc3NUYWJsZVwiO1xuXG5leHBvcnQgY2xhc3MgRmlsZUNsYXNzQ2hvaWNlTW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHJpdmF0ZSB0YWJsZTogRmlsZUNsYXNzQ29tcG9uZW50LFxuICAgICAgICBwcml2YXRlIHRhZ3NBbmRGaWxlQ2xhc3Nlczogc3RyaW5nW11cbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpO1xuICAgIH07XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgICAgIGNvbnN0IHZhbHVlczogc3RyaW5nW10gPSBbLi4ubmV3IFNldChcbiAgICAgICAgICAgIFsuLi5pbmRleC5maWxlQ2xhc3Nlc05hbWUua2V5cygpLCAuLi5pbmRleC50YWdzTWF0Y2hpbmdGaWxlQ2xhc3Nlcy5rZXlzKCldXG4gICAgICAgICldXG4gICAgICAgICAgICAuZmlsdGVyKG5hbWUgPT4gbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHF1ZXJ5LnRvTG93ZXJDYXNlKCkpKVxuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGEubG9jYWxlQ29tcGFyZShiKSlcbiAgICAgICAgaWYgKHRoaXMudGFnc0FuZEZpbGVDbGFzc2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcy5maWx0ZXIodmFsdWUgPT4gdGhpcy50YWdzQW5kRmlsZUNsYXNzZXMuaW5jbHVkZXModmFsdWUpKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlc1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbih2YWx1ZTogc3RyaW5nLCBlbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgZWwuc2V0VGV4dCh2YWx1ZSlcbiAgICAgICAgZWwuYWRkQ2xhc3MoXCJ2YWx1ZS1jb250YWluZXJcIik7XG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VTdWdnZXN0aW9uKGl0ZW06IHN0cmluZywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IGluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoaXRlbSkgfHwgaW5kZXgudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMuZ2V0KGl0ZW0pXG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmIChmaWxlQ2xhc3MgJiYgZHZBcGkpIHtcbiAgICAgICAgICAgIHRoaXMudGFibGUubmFtZSA9IGl0ZW1cbiAgICAgICAgICAgIHRoaXMudGFibGUuZmlsZUNsYXNzID0gZmlsZUNsYXNzXG4gICAgICAgICAgICB0aGlzLnRhYmxlLmZpbGVDbGFzc1RhYmxlVmlld1R5cGUgPSBGSUxFQ0xBU1NfVEFCTEVfVklFV19UWVBFICsgXCJfX1wiICsgZmlsZUNsYXNzLm5hbWVcbiAgICAgICAgICAgIHRoaXMudGFibGUub3BlblRhYmxlVmlldygpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xvc2UoKVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBNZW51LCBOb3RpY2UsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRNaXNzaW5nRmllbGRzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgTWFuYWdlcnMgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vyc1wiO1xuaW1wb3J0IHsgQWRkRmlsZUNsYXNzVG9GaWxlTW9kYWwgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCBBZGROZXdGaWxlQ2xhc3NNb2RhbCBmcm9tIFwic3JjL21vZGFscy9hZGROZXdGaWxlQ2xhc3NNb2RhbFwiO1xuaW1wb3J0IElucHV0TW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvZmllbGRzL0lucHV0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkSWNvbiwgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5pbXBvcnQgY2hvb3NlU2VjdGlvbk1vZGFsIGZyb20gXCIuLi9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCI7XG5pbXBvcnQgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIGZyb20gXCIuL0ZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbFwiO1xuaW1wb3J0IEZpbGVDbGFzc09wdGlvbnNMaXN0IGZyb20gXCIuL0ZpbGVDbGFzc09wdGlvbnNMaXN0XCI7XG5cbmZ1bmN0aW9uIGlzTWVudShsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKTogbG9jYXRpb24gaXMgTWVudSB7XG5cdHJldHVybiAobG9jYXRpb24gYXMgTWVudSkuYWRkSXRlbSAhPT0gdW5kZWZpbmVkO1xufTtcblxuZnVuY3Rpb24gaXNJbnNlcnRGaWVsZENvbW1hbmQobG9jYXRpb246IE1lbnUgfCBcIkluc2VydEZpZWxkQ29tbWFuZFwiIHwgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHwgXCJNYW5hZ2VBdEN1cnNvckNvbW1hbmRcIik6IGxvY2F0aW9uIGlzIFwiSW5zZXJ0RmllbGRDb21tYW5kXCIge1xuXHRyZXR1cm4gKGxvY2F0aW9uIGFzIHN0cmluZykgPT09IFwiSW5zZXJ0RmllbGRDb21tYW5kXCI7XG59XG5cbmZ1bmN0aW9uIGlzU3VnZ2VzdChsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKTogbG9jYXRpb24gaXMgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsIHtcblx0cmV0dXJuIChsb2NhdGlvbiBhcyBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpLmdldEl0ZW1zICE9PSB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPcHRpb25zTGlzdCB7XG5cblx0Ly8gYWRkcyBvcHRpb25zIHRvIGNvbnRleHQgbWVudSBvciB0byBhIGRyb3Bkb3duIG1vZGFsIHRyaWdnZXIgd2l0aCBcIkZpZWxkOiBPcHRpb25zXCIgY29tbWFuZCBpbiBjb21tYW5kIHBhbGxldHRlXG5cdHBhdGg6IHN0cmluZztcblx0YXR0cmlidXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcblx0ZmllbGRzRnJvbUluZGV4OiBSZWNvcmQ8c3RyaW5nLCBGaWVsZD4gPSB7fTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuXHRcdHByaXZhdGUgZmlsZTogVEZpbGUsXG5cdFx0cHJpdmF0ZSBsb2NhdGlvbjogTWVudSB8IFwiSW5zZXJ0RmllbGRDb21tYW5kXCIgfCBGaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgfCBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiLFxuXHRcdHByaXZhdGUgaW5jbHVkZWRGaWVsZHM/OiBzdHJpbmdbXVxuXHQpIHtcblx0XHR0aGlzLmZpbGUgPSBmaWxlO1xuXHRcdHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcblx0XHR0aGlzLmF0dHJpYnV0ZXMgPSB7fTtcblx0XHR0aGlzLmluY2x1ZGVkRmllbGRzID0gaW5jbHVkZWRGaWVsZHMgPyBbdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMsIC4uLmluY2x1ZGVkRmllbGRzXSA6IFt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc107XG5cdFx0dGhpcy5nZXRGaWVsZHNGcm9tSW5kZXgoKTtcblx0XHR0aGlzLmdldEZpZWxkc1ZhbHVlcygpO1xuXHR9O1xuXG5cdHByaXZhdGUgZ2V0RmllbGRzVmFsdWVzKCk6IHZvaWQge1xuXHRcdGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdPy5hcGlcblx0XHQvL0B0cy1pZ25vcmVcblx0XHRpZiAoZHZBcGkpIHtcblx0XHRcdGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRnZW51aW5lS2V5cyhkdkZpbGUpLmZvckVhY2goa2V5ID0+IHRoaXMuYWRkQXR0cmlidXRlKGtleSwgZHZGaWxlW2tleV0pKVxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0dGhyb3cgKGVycm9yKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFkZEF0dHJpYnV0ZShrZXk6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xuXHRcdGNvbnN0IGluY2x1ZGVkRmllbGRzID0gdGhpcy5pbmNsdWRlZEZpZWxkcyEuZmlsdGVyKGYgPT4gZiAhPT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMpXG5cdFx0aWYgKGluY2x1ZGVkRmllbGRzLmxlbmd0aCA+IDApIHtcblx0XHRcdGlmIChcblx0XHRcdFx0dGhpcy5pbmNsdWRlZEZpZWxkcyEuaW5jbHVkZXMoa2V5KVxuXHRcdFx0XHQmJlxuXHRcdFx0XHQhdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzLmluY2x1ZGVzKGtleSlcblx0XHRcdCkge1xuXHRcdFx0XHR0aGlzLmF0dHJpYnV0ZXNba2V5XSA9IHZhbHVlXG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzLmluY2x1ZGVzKGtleSkpIHtcblx0XHRcdHRoaXMuYXR0cmlidXRlc1trZXldID0gdmFsdWVcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGdldEZpZWxkc0Zyb21JbmRleCgpOiB2b2lkIHtcblx0XHRjb25zdCBpbmRleCA9IHRoaXMucGx1Z2luLmZpZWxkSW5kZXhcblx0XHRjb25zdCBmaWVsZHMgPSBpbmRleC5maWxlc0ZpZWxkcy5nZXQodGhpcy5maWxlLnBhdGgpXG5cdFx0ZmllbGRzPy5mb3JFYWNoKGZpZWxkID0+IHRoaXMuZmllbGRzRnJvbUluZGV4W2ZpZWxkLm5hbWVdID0gZmllbGQpXG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoZmllbGROYW1lOiBzdHJpbmcpOiB2b2lkIHtcblx0XHRjb25zdCBmaWVsZCA9IHRoaXMuZmllbGRzRnJvbUluZGV4W2ZpZWxkTmFtZV1cblx0XHRpZiAoZmllbGQpIHtcblx0XHRcdGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIGZpZWxkKTtcblx0XHRcdChmaWVsZE1hbmFnZXIgYXMgRikuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwodGhpcy5maWxlLCBmaWVsZC5uYW1lLCB0aGlzLmF0dHJpYnV0ZXNbZmllbGQubmFtZV0pXG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnN0IGRlZmF1bHRGaWVsZCA9IG5ldyBGaWVsZChmaWVsZE5hbWUpXG5cdFx0XHRkZWZhdWx0RmllbGQudHlwZSA9IEZpZWxkVHlwZS5JbnB1dFxuXHRcdFx0aWYgKGZpZWxkTmFtZSA9PT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMpIHtcblx0XHRcdFx0dGhpcy5idWlsZEZpbGVDbGFzc0ZpZWxkT3B0aW9ucyhkZWZhdWx0RmllbGQsIHRoaXMuYXR0cmlidXRlc1tmaWVsZE5hbWVdKVxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLmxvY2F0aW9uID09PSBcIk1hbmFnZUF0Q3Vyc29yQ29tbWFuZFwiKSB7XG5cdFx0XHRcdGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBNYW5hZ2Vycy5JbnB1dCh0aGlzLnBsdWdpbiwgZGVmYXVsdEZpZWxkKSBhcyBGXG5cdFx0XHRcdChmaWVsZE1hbmFnZXIgYXMgRikuY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwodGhpcy5maWxlLCBmaWVsZE5hbWUsIHRoaXMuYXR0cmlidXRlc1tmaWVsZE5hbWVdKVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBjcmVhdGVFeHRyYU9wdGlvbkxpc3Qob3BlbkFmdGVyQ3JlYXRlOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xuXHRcdGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG5cdFx0Y29uc3QgbG9jYXRpb24gPSB0aGlzLmxvY2F0aW9uXG5cdFx0aWYgKGlzTWVudShsb2NhdGlvbikpIHsgbG9jYXRpb24uYWRkU2VwYXJhdG9yKCk7IH07XG5cdFx0aWYgKGlzSW5zZXJ0RmllbGRDb21tYW5kKGxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5hZGRGaWVsZEF0Q3VycmVudFBvc2l0aW9uT3B0aW9uKCk7XG5cdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QobG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmJ1aWxkRmllbGRPcHRpb25zKCk7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRUaGVFbmRPZkZyb250bWF0dGVyT3B0aW9uKCk7XG5cdFx0XHRpZiAoZHZBcGkpIHtcblx0XHRcdFx0Y29uc3QgY3VycmVudEZpZWxkc05hbWVzID0gZ2VudWluZUtleXMoZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aCkpXG5cdFx0XHRcdGlmICghWy4uLnRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXV0ubWFwKGZpZWxkID0+IGZpZWxkLm5hbWUpLmV2ZXJ5KGZpZWxkTmFtZSA9PiBjdXJyZW50RmllbGRzTmFtZXMuaW5jbHVkZXMoZmllbGROYW1lKSkpIHtcblx0XHRcdFx0XHR0aGlzLmFkZEFsbE1pc3NpbmdGaWVsZHNBdFNlY3Rpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y29uc3QgZmlsZUNsYXNzZXMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXVxuXHRcdFx0ZmlsZUNsYXNzZXMuZm9yRWFjaChmaWxlQ2xhc3MgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgPSBuZXcgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKHRoaXMucGx1Z2luLmFwcClcblx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgRmlsZUNsYXNzT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIGZpbGVDbGFzcy5nZXRDbGFzc0ZpbGUoKSwgZmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsLCB0aGlzLmZpbGUpO1xuXHRcdFx0XHRvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoZmFsc2UpO1xuXHRcdFx0XHRsb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuXHRcdFx0XHRcdGlkOiBcIm1hbmFnZV9maWxlQ2xhc3NfYXR0cmlidXRlc1wiLFxuXHRcdFx0XHRcdGFjdGlvbkxhYmVsOiBgPHNwYW4+TWFuYWdlIDxiPiR7ZmlsZUNsYXNzLm5hbWV9PC9iPiBmaWxlQ2xhc3MgZmllbGRzPC9zcGFuPmAsXG5cdFx0XHRcdFx0YWN0aW9uOiAoKSA9PiB7IGZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbC5vcGVuKCkgfSxcblx0XHRcdFx0XHRpY29uOiBcIndyZW5jaFwiXG5cdFx0XHRcdH0pXG5cdFx0XHR9KVxuXHRcdFx0dGhpcy5hZGRGaWxlQ2xhc3NUb0ZpbGVPcHRpb24oKTtcblx0XHRcdHRoaXMuYWRkTmV3RmlsZUNsYXNzT3B0aW9uKCk7XG5cdFx0XHRpZiAob3BlbkFmdGVyQ3JlYXRlKSBsb2NhdGlvbi5vcGVuKCk7XG5cdFx0fSBlbHNlIGlmIChpc01lbnUobG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmJ1aWxkRmllbGRPcHRpb25zKCk7XG5cdFx0XHR0aGlzLmFkZFNlY3Rpb25TZWxlY3RNb2RhbE9wdGlvbigpO1xuXHRcdFx0dGhpcy5hZGRGaWVsZEF0Q3VycmVudFBvc2l0aW9uT3B0aW9uKCk7XG5cdFx0XHR0aGlzLmFkZEZpZWxkQXRUaGVFbmRPZkZyb250bWF0dGVyT3B0aW9uKCk7XG5cdFx0XHRpZiAoZHZBcGkpIHtcblx0XHRcdFx0Y29uc3QgY3VycmVudEZpZWxkc05hbWVzID0gZ2VudWluZUtleXMoZHZBcGkucGFnZSh0aGlzLmZpbGUucGF0aCkpXG5cdFx0XHRcdGlmICghWy4uLnRoaXMucGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXV0ubWFwKGZpZWxkID0+IGZpZWxkLm5hbWUpLmV2ZXJ5KGZpZWxkTmFtZSA9PiBjdXJyZW50RmllbGRzTmFtZXMuaW5jbHVkZXMoZmllbGROYW1lKSkpIHtcblx0XHRcdFx0XHR0aGlzLmFkZEFsbE1pc3NpbmdGaWVsZHNBdFNlY3Rpb24oKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y29uc3QgZmlsZUNsYXNzZXMgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXMuZ2V0KHRoaXMuZmlsZS5wYXRoKSB8fCBbXVxuXHRcdFx0ZmlsZUNsYXNzZXMuZm9yRWFjaChmaWxlQ2xhc3MgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NPcHRpb25zTGlzdCA9IG5ldyBGaWxlQ2xhc3NPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgZmlsZUNsYXNzLmdldENsYXNzRmlsZSgpLCBsb2NhdGlvbiwgdGhpcy5maWxlKVxuXHRcdFx0XHRmaWxlQ2xhc3NPcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoZmFsc2UpO1xuXHRcdFx0fSlcblx0XHRcdHRoaXMuYWRkRmlsZUNsYXNzVG9GaWxlT3B0aW9uKCk7XG5cdFx0XHR0aGlzLmFkZE5ld0ZpbGVDbGFzc09wdGlvbigpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYnVpbGRGaWxlQ2xhc3NGaWVsZE9wdGlvbnMoZmllbGQ6IEZpZWxkLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgSW5wdXRNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBmaWVsZCwgdmFsdWUpO1xuXHRcdG1vZGFsLnRpdGxlRWwuc2V0VGV4dChgQ2hhbmdlIFZhbHVlIGZvciA8JHtmaWVsZC5uYW1lfT5gKTtcblx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRUaXRsZShgVXBkYXRlICR7ZmllbGQubmFtZX1gKTtcblx0XHRcdFx0aXRlbS5zZXRJY29uKFwid3JlbmNoXCIpO1xuXHRcdFx0XHRpdGVtLm9uQ2xpY2soKCkgPT4gbW9kYWwub3BlbigpKTtcblx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdH0pXG5cdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0aWQ6IGB1cGRhdGVfJHtmaWVsZC5uYW1lfWAsXG5cdFx0XHRcdGFjdGlvbkxhYmVsOiBgPHNwYW4+VXBkYXRlIDxiPiR7ZmllbGQubmFtZX08L2I+PC9zcGFuPmAsXG5cdFx0XHRcdGFjdGlvbjogKCkgPT4gbW9kYWwub3BlbigpLFxuXHRcdFx0XHRpY29uOiBGaWVsZEljb25bRmllbGRUeXBlLklucHV0XVxuXHRcdFx0fSk7XG5cdFx0fTtcblx0fVxuXG5cdHByaXZhdGUgYnVpbGRGaWVsZE9wdGlvbnMoKTogdm9pZCB7XG5cdFx0T2JqZWN0LmtleXModGhpcy5hdHRyaWJ1dGVzKS5mb3JFYWNoKChrZXk6IHN0cmluZykgPT4ge1xuXHRcdFx0Y29uc3QgdmFsdWUgPSB0aGlzLmF0dHJpYnV0ZXNba2V5XTtcblx0XHRcdGNvbnN0IGZpZWxkID0gdGhpcy5maWVsZHNGcm9tSW5kZXhba2V5XVxuXG5cdFx0XHRpZiAoZmllbGQpIHtcblx0XHRcdFx0Y29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXSh0aGlzLnBsdWdpbiwgZmllbGQpO1xuXHRcdFx0XHRmaWVsZE1hbmFnZXIuYWRkRmllbGRPcHRpb24oa2V5LCB2YWx1ZSwgdGhpcy5maWxlLCB0aGlzLmxvY2F0aW9uKTtcblx0XHRcdH0gZWxzZSBpZiAoa2V5ICE9PSBcImZpbGVcIiAmJiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pIHx8IGlzTWVudSh0aGlzLmxvY2F0aW9uKSkpIHtcblx0XHRcdFx0Y29uc3QgZGVmYXVsdEZpZWxkID0gbmV3IEZpZWxkKGtleSlcblx0XHRcdFx0ZGVmYXVsdEZpZWxkLnR5cGUgPSBGaWVsZFR5cGUuSW5wdXRcblx0XHRcdFx0aWYgKGtleSA9PT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMpIHtcblx0XHRcdFx0XHR0aGlzLmJ1aWxkRmlsZUNsYXNzRmllbGRPcHRpb25zKGRlZmF1bHRGaWVsZCwgdmFsdWUpXG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IE1hbmFnZXJzLklucHV0KHRoaXMucGx1Z2luLCBkZWZhdWx0RmllbGQpXG5cdFx0XHRcdFx0ZmllbGRNYW5hZ2VyLmFkZEZpZWxkT3B0aW9uKGtleSwgdmFsdWUgfHwgXCJcIiwgdGhpcy5maWxlLCB0aGlzLmxvY2F0aW9uKVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHR9KTtcblx0fVxuXG5cdHByaXZhdGUgYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IGNob29zZVNlY3Rpb25Nb2RhbChcblx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0dGhpcy5maWxlLFxuXHRcdFx0KFxuXHRcdFx0XHRsaW5lTnVtYmVyOiBudW1iZXIsXG5cdFx0XHRcdGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdGFmdGVyOiBib29sZWFuLFxuXHRcdFx0XHRhc0xpc3Q6IGJvb2xlYW4sXG5cdFx0XHRcdGFzQ29tbWVudDogYm9vbGVhblxuXHRcdFx0KSA9PiBGLm9wZW5GaWVsZE1vZGFsKFxuXHRcdFx0XHR0aGlzLnBsdWdpbixcblx0XHRcdFx0dGhpcy5maWxlLFxuXHRcdFx0XHR1bmRlZmluZWQsXG5cdFx0XHRcdFwiXCIsXG5cdFx0XHRcdGxpbmVOdW1iZXIsXG5cdFx0XHRcdGluRnJvbnRtYXR0ZXIsXG5cdFx0XHRcdGFmdGVyLFxuXHRcdFx0XHRhc0xpc3QsXG5cdFx0XHRcdGFzQ29tbWVudFxuXHRcdFx0KVxuXHRcdCk7XG5cdFx0aWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbihcImVudGVyXCIpO1xuXHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiQWRkIGZpZWxkIGF0IHNlY3Rpb24uLi5cIik7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdGlkOiBcImFkZF9maWVsZF9hdF9zZWN0aW9uXCIsXG5cdFx0XHRcdGFjdGlvbkxhYmVsOiBcIkFkZCBmaWVsZCBhdCBzZWN0aW9uLi4uXCIsXG5cdFx0XHRcdGFjdGlvbjogKCkgPT4gbW9kYWwub3BlbigpLFxuXHRcdFx0XHRpY29uOiBcImVudGVyXCJcblx0XHRcdH0pXG5cdFx0fTtcblx0fTtcblxuXHRwcml2YXRlIGFkZEFsbE1pc3NpbmdGaWVsZHNBdFNlY3Rpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcblx0XHRpZiAoZHZBcGkpIHtcblx0XHRcdGNvbnN0IGR2RmlsZSA9IGR2QXBpLnBhZ2UodGhpcy5maWxlLnBhdGgpO1xuXHRcdFx0Y29uc3QgbW9kYWwgPSBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuXHRcdFx0XHR0aGlzLnBsdWdpbixcblx0XHRcdFx0dGhpcy5maWxlLFxuXHRcdFx0XHQoXG5cdFx0XHRcdFx0bGluZU51bWJlcjogbnVtYmVyLFxuXHRcdFx0XHRcdGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdFx0YWZ0ZXI6IGJvb2xlYW4sXG5cdFx0XHRcdFx0YXNMaXN0OiBib29sZWFuLFxuXHRcdFx0XHRcdGFzQ29tbWVudDogYm9vbGVhblxuXHRcdFx0XHQpID0+IGluc2VydE1pc3NpbmdGaWVsZHMoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sXG5cdFx0XHRcdFx0ZHZGaWxlLmZpbGUucGF0aCxcblx0XHRcdFx0XHRsaW5lTnVtYmVyLFxuXHRcdFx0XHRcdGluRnJvbnRtYXR0ZXIsXG5cdFx0XHRcdFx0YWZ0ZXIsXG5cdFx0XHRcdFx0YXNMaXN0LFxuXHRcdFx0XHRcdGFzQ29tbWVudFxuXHRcdFx0XHQpXG5cdFx0XHQpO1xuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldEljb24oXCJiYXR0ZXJ5LWZ1bGxcIik7XG5cdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShcIkFkZCBtaXNzaW5nIGZpZWxkcyBhdCBzZWN0aW9uLi4uXCIpO1xuXHRcdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwibWV0YWRhdGEtbWVudVwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IFwiYWRkX21pc3NpbmdfZmllbGRzX2F0X3NlY3Rpb25cIixcblx0XHRcdFx0XHRhY3Rpb25MYWJlbDogXCJBZGQgbWlzc2luZyBmaWVsZHMgYXQgc2VjdGlvbi4uLlwiLFxuXHRcdFx0XHRcdGFjdGlvbjogKCkgPT4gbW9kYWwub3BlbigpLFxuXHRcdFx0XHRcdGljb246IFwiYmF0dGVyeS1mdWxsXCJcblx0XHRcdFx0fSlcblx0XHRcdH07XG5cdFx0fVxuXHR9O1xuXG5cdHByaXZhdGUgYWRkRmllbGRBdFRoZUVuZE9mRnJvbnRtYXR0ZXJPcHRpb24oKTogdm9pZCB7XG5cdFx0aWYgKHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKHRoaXMuZmlsZS5wYXRoKT8uZnJvbnRtYXR0ZXIpIHtcblx0XHRcdGNvbnN0IGxpbmVOdW1iZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZSh0aGlzLmZpbGUucGF0aCkhLmZyb250bWF0dGVyIS5wb3NpdGlvbi5lbmQubGluZSAtIDFcblx0XHRcdGlmIChpc01lbnUodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwicGluXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgaW4gZnJvbnRtYXR0ZXJcIik7XG5cdFx0XHRcdFx0aXRlbS5vbkNsaWNrKGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdEYub3BlbkZpZWxkTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyICsgMSwgdHJ1ZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSlcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51XCIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24ub3B0aW9ucy5wdXNoKHtcblx0XHRcdFx0XHRpZDogXCJhZGRfZmllbGRfaW5fZnJvbnRtYXR0ZXJcIixcblx0XHRcdFx0XHRhY3Rpb25MYWJlbDogXCJBZGQgYSBmaWVsZCBpbiBmcm9udG1hdHRlci4uLlwiLFxuXHRcdFx0XHRcdGFjdGlvbjogKCkgPT4gRi5vcGVuRmllbGRNb2RhbChcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHVuZGVmaW5lZCwgXCJcIiwgbGluZU51bWJlciArIDEsIHRydWUsIGZhbHNlLCBmYWxzZSwgZmFsc2UpLFxuXHRcdFx0XHRcdGljb246IFwicGluXCJcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFkZEZpZWxkQXRDdXJyZW50UG9zaXRpb25PcHRpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgY3VycmVudFZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdGNvbnN0IGxpbmVOdW1iZXIgPSBjdXJyZW50Vmlldz8uZWRpdG9yLmdldEN1cnNvcigpLmxpbmU7XG5cdFx0aWYgKGxpbmVOdW1iZXIgIT09IHVuZGVmaW5lZCAmJiB0aGlzLmZpbGUucGF0aCA9PSBjdXJyZW50Vmlldz8uZmlsZS5wYXRoKSB7XG5cdFx0XHRsZXQgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlO1xuXHRcdFx0Y29uc3QgZnJvbnRtYXR0ZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodGhpcy5maWxlKT8uZnJvbnRtYXR0ZXJcblx0XHRcdGlmIChmcm9udG1hdHRlcikge1xuXHRcdFx0XHRjb25zdCB7IHBvc2l0aW9uOiB7IHN0YXJ0LCBlbmQgfSB9ID0gZnJvbnRtYXR0ZXJcblx0XHRcdFx0aWYgKGxpbmVOdW1iZXIgPj0gc3RhcnQubGluZSAmJiBsaW5lTnVtYmVyIDwgZW5kLmxpbmUpIGluRnJvbnRtYXR0ZXIgPSB0cnVlXG5cdFx0XHR9XG5cdFx0XHRpZiAoaXNNZW51KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHRcdHRoaXMubG9jYXRpb24uYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcInBpblwiKTtcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiQWRkIGZpZWxkIGF0IGN1cnNvclwiKTtcblx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0Ri5vcGVuRmllbGRNb2RhbChcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdW5kZWZpbmVkLCBcIlwiLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBmYWxzZSwgZmFsc2UsIGZhbHNlKVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnVcIik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIGlmIChpc0luc2VydEZpZWxkQ29tbWFuZCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHRGLm9wZW5GaWVsZE1vZGFsKFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHVuZGVmaW5lZCwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgZmFsc2UsIGZhbHNlLCBmYWxzZSk7XG5cdFx0XHR9IGVsc2UgaWYgKGlzU3VnZ2VzdCh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdFx0aWQ6IFwiYWRkX2ZpZWxkX2F0X2N1cnNvclwiLFxuXHRcdFx0XHRcdGFjdGlvbkxhYmVsOiBcIkFkZCBmaWVsZCBhdCBjdXJzb3IuLi5cIixcblx0XHRcdFx0XHRhY3Rpb246ICgpID0+IEYub3BlbkZpZWxkTW9kYWwoXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB1bmRlZmluZWQsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIGZhbHNlLCBmYWxzZSwgZmFsc2UpLFxuXHRcdFx0XHRcdGljb246IFwicGluXCJcblx0XHRcdFx0fSlcblx0XHRcdH07XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhZGRGaWxlQ2xhc3NUb0ZpbGVPcHRpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgQWRkRmlsZUNsYXNzVG9GaWxlTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSlcblx0XHRjb25zdCBhY3Rpb24gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG5cdFx0aWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0dGhpcy5sb2NhdGlvbi5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0SWNvbihcInBsdXMtc3F1YXJlXCIpO1xuXHRcdFx0XHRpdGVtLnNldFRpdGxlKGBBZGQgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc30gdG8gJHt0aGlzLmZpbGUuYmFzZW5hbWV9YCk7XG5cdFx0XHRcdGl0ZW0ub25DbGljayhhY3Rpb24pO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJtZXRhZGF0YS1tZW51LWZpbGVjbGFzc1wiKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAoaXNTdWdnZXN0KHRoaXMubG9jYXRpb24pKSB7XG5cdFx0XHR0aGlzLmxvY2F0aW9uLm9wdGlvbnMucHVzaCh7XG5cdFx0XHRcdGlkOiBcImFkZF9maWxlY2xhc3NfdG9fZmlsZVwiLFxuXHRcdFx0XHRhY3Rpb25MYWJlbDogYEFkZCAke3RoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzfSB0byAke3RoaXMuZmlsZS5iYXNlbmFtZX1gLFxuXHRcdFx0XHRhY3Rpb246IGFjdGlvbixcblx0XHRcdFx0aWNvbjogXCJwbHVzLXNxdWFyZVwiXG5cdFx0XHR9KVxuXHRcdH07XG5cdH1cblxuXHRwcml2YXRlIGFkZE5ld0ZpbGVDbGFzc09wdGlvbigpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IG5ldyBBZGROZXdGaWxlQ2xhc3NNb2RhbCh0aGlzLnBsdWdpbik7XG5cdFx0Y29uc3QgYWN0aW9uID0gKCkgPT4gbW9kYWwub3BlbigpO1xuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCkge1xuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmxvY2F0aW9uKSkge1xuXHRcdFx0XHR0aGlzLmxvY2F0aW9uLmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldEljb24oXCJmaWxlLXBsdXMtMlwiKTtcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKGBBZGQgYSBuZXcgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc31gKVxuXHRcdFx0XHRcdGl0ZW0ub25DbGljayhhY3Rpb24pO1xuXHRcdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcIm1ldGFkYXRhLW1lbnUtZmlsZWNsYXNzXCIpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSBlbHNlIGlmIChpc1N1Z2dlc3QodGhpcy5sb2NhdGlvbikpIHtcblx0XHRcdFx0dGhpcy5sb2NhdGlvbi5vcHRpb25zLnB1c2goe1xuXHRcdFx0XHRcdGlkOiBcImFkZF9uZXdfZmlsZWNsYXNzXCIsXG5cdFx0XHRcdFx0YWN0aW9uTGFiZWw6IGBBZGQgYSBuZXcgJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc31gLFxuXHRcdFx0XHRcdGFjdGlvbjogYWN0aW9uLFxuXHRcdFx0XHRcdGljb246IFwiZmlsZS1wbHVzLTJcIlxuXHRcdFx0XHR9KVxuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBCdXR0b25Db21wb25lbnQsIE1vZGFsLCBUZXh0Q29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvY3JlYXRlRmlsZUNsYXNzXCI7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWRkTmV3RmlsZUNsYXNzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpXG4gICAgfVxuXG4gICAgb25PcGVuKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkFkZCBhIG5ldyBmaWxlQ2xhc3NcIik7XG4gICAgICAgIHRoaXMuYnVpbGRBZGRGaWxlQ2xhc3NGb3JtKCk7XG4gICAgfVxuXG4gICAgYnVpbGRBZGRGaWxlQ2xhc3NGb3JtKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3Nlc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCFcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc1xuICAgICAgICBjb25zdCBuYW1lQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuXG4gICAgICAgIG5hbWVDb250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogYCR7ZmlsZUNsYXNzQWxpYXN9IG5hbWVgLCBjbHM6IFwibGFiZWxcIiB9KVxuICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChuYW1lQ29udGFpbmVyKTtcbiAgICAgICAgbmFtZUlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJ3aXRoLWxhYmVsXCIpO1xuICAgICAgICBuYW1lSW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG4gICAgICAgIGNvbnN0IG5hbWVFcnJvckNvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmaWVsZC1lcnJvclwiLCB0ZXh0OiBgVGhpcyAke2ZpbGVDbGFzc0FsaWFzfSBmaWxlIGFscmVhZHkgZXhpc3RzYCB9KTtcblxuICAgICAgICBjb25zdCBtYXBXaXRoVGFnQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICBtYXBXaXRoVGFnQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJsYWJlbFwiLCB0ZXh0OiBgTWFwIHRoaXMgJHtmaWxlQ2xhc3NBbGlhc30gZmlsZSB3aXRoIHRoZSB0YWcgb2Ygc2FtZSBuYW1lYCB9KTtcbiAgICAgICAgbWFwV2l0aFRhZ0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwic3BhY2VyXCIgfSk7XG4gICAgICAgIGNvbnN0IG1hcFdpdGhUYWdUb2dnbGVyID0gbmV3IFRvZ2dsZUNvbXBvbmVudChtYXBXaXRoVGFnQ29udGFpbmVyKVxuICAgICAgICBtYXBXaXRoVGFnVG9nZ2xlci5zZXRWYWx1ZShmYWxzZSk7XG4gICAgICAgIG1hcFdpdGhUYWdUb2dnbGVyLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkgeyB0YWdOYW1lc0NvbnRhaW5lci5zaG93KCk7IH0gZWxzZSB7IHRhZ05hbWVzQ29udGFpbmVyLmhpZGUoKTsgfVxuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IHRhZ05hbWVzQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0YWdOYW1lc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwibGFiZWxcIiwgdGV4dDogXCJBbGlhc2VzIChvcHRpb25hbClcIiB9KTtcbiAgICAgICAgY29uc3QgdGFnTmFtZXNJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHRhZ05hbWVzQ29udGFpbmVyKTtcbiAgICAgICAgdGFnTmFtZXNJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwid2l0aC1sYWJlbFwiKTtcbiAgICAgICAgdGFnTmFtZXNJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgdGFnTmFtZXNJbnB1dC5zZXRQbGFjZWhvbGRlcihcIkxlYXZlIGVtcHR5IHRvIG1hcCB3aXRoIHRoZSB0YWcgb2Ygc2FtZSBuYW1lIGFzIGZpbGVjbGFzc1wiKVxuICAgICAgICB0YWdOYW1lc0NvbnRhaW5lci5oaWRlKCk7XG5cbiAgICAgICAgY29uc3QgYWN0aW9uc0NvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJmb290ZXItYWN0aW9uc1wiIH0pO1xuICAgICAgICBhY3Rpb25zQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICBjb25zdCBzYXZlQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChhY3Rpb25zQ29udGFpbmVyKTtcbiAgICAgICAgc2F2ZUJ0bi5zZXREaXNhYmxlZCh0cnVlKTtcbiAgICAgICAgc2F2ZUJ0bi5zZXRJY29uKFwiZmlsZS1wbHVzLTJcIik7XG5cbiAgICAgICAgbmFtZUVycm9yQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgbmFtZUlucHV0Lm9uQ2hhbmdlKGFzeW5jIHZhbHVlID0+IHtcbiAgICAgICAgICAgIG5hbWVFcnJvckNvbnRhaW5lci5oaWRlKCk7XG4gICAgICAgICAgICBzYXZlQnRuLnNldERpc2FibGVkKGZhbHNlKVxuICAgICAgICAgICAgc2F2ZUJ0bi5zZXRDdGEoKVxuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhgJHtmaWxlQ2xhc3Nlc1BhdGh9JHt2YWx1ZX0ubWRgKSkge1xuICAgICAgICAgICAgICAgIG5hbWVFcnJvckNvbnRhaW5lci5zaG93KCk7XG4gICAgICAgICAgICAgICAgc2F2ZUJ0bi5zZXREaXNhYmxlZCh0cnVlKVxuICAgICAgICAgICAgICAgIHNhdmVCdG4ucmVtb3ZlQ3RhKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHNhdmVCdG4uc2V0RGlzYWJsZWQoZmFsc2UpO1xuICAgICAgICAgICAgICAgIHNhdmVCdG4uc2V0Q3RhKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBzYXZlQnRuLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgY3JlYXRlRmlsZUNsYXNzKFxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLFxuICAgICAgICAgICAgICAgIG5hbWVJbnB1dC5nZXRWYWx1ZSgpLFxuICAgICAgICAgICAgICAgIG1hcFdpdGhUYWdUb2dnbGVyLmdldFZhbHVlKCksXG4gICAgICAgICAgICAgICAgdGFnTmFtZXNJbnB1dC5nZXRWYWx1ZSgpLnNwbGl0KFwiLFwiKS5tYXAodCA9PiB0LnRyaW0oKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZywgbWFwV2l0aFRhZzogYm9vbGVhbiA9IGZhbHNlLCB0YWdOYW1lczogc3RyaW5nW10gPSBbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gcGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgaWYgKGNsYXNzRmlsZXNQYXRoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gbWFwV2l0aFRhZyA/IGAtLS1cXG5tYXBXaXRoVGFnOiB0cnVlXFxuJHt0YWdOYW1lcy5sZW5ndGggPyBcInRhZ05hbWVzOiBbXCIgKyB0YWdOYW1lcy5qb2luKFwiLCBcIikgKyBcIl1cXG5cIiA6IFwiXCJ9LS0tXFxuYCA6IFwiXCJcbiAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY3JlYXRlKGAke2NsYXNzRmlsZXNQYXRofSR7bmFtZX0ubWRgLCBjb250ZW50KVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgKGVycm9yKVxuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBDb21wb25lbnQsIE1lbnUsIFBsYXRmb3JtLCByZXF1aXJlQXBpVmVyc2lvbiwgVEFic3RyYWN0RmlsZSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBPcHRpb25zTGlzdCBmcm9tIFwic3JjL29wdGlvbnMvT3B0aW9uc0xpc3RcIjtcbmltcG9ydCBGaWxlQ2xhc3NPcHRpb25zTGlzdCBmcm9tIFwiLi4vb3B0aW9ucy9GaWxlQ2xhc3NPcHRpb25zTGlzdFwiO1xuaW1wb3J0IHsgZnJvbnRNYXR0ZXJMaW5lRmllbGQsIGdldExpbmVGaWVsZHMgfSBmcm9tIFwic3JjL3V0aWxzL3BhcnNlclwiO1xuaW1wb3J0IEZpZWxkQ29tbWFuZFN1Z2dlc3RNb2RhbCBmcm9tIFwiLi4vb3B0aW9ucy9GaWVsZENvbW1hbmRTdWdnZXN0TW9kYWxcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb250ZXh0TWVudSBleHRlbmRzIENvbXBvbmVudCB7XG5cblx0Y29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuXHRcdHN1cGVyKClcblx0fTtcblxuXHRvbmxvYWQoKTogdm9pZCB7XG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtbWVudScsIChtZW51LCBhYnN0cmFjdEZpbGUsIHNvdXJjZSkgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChhYnN0cmFjdEZpbGUucGF0aCk7XG5cdFx0XHRcdHRoaXMuYnVpbGRPcHRpb25zKGZpbGUsIG1lbnUpO1xuXHRcdFx0fSlcblx0XHQpO1xuXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1tZW51JywgKG1lbnUsIGVkaXRvciwgdmlldykgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdGNvbnN0IGluY2x1ZGVkRmllbGRzOiBzdHJpbmdbXSA9IFtdO1xuXHRcdFx0XHRjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh2aWV3LmZpbGUpPy5mcm9udG1hdHRlcjtcblx0XHRcdFx0aWYgKGZyb250bWF0dGVyXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPiBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lXG5cdFx0XHRcdFx0JiYgZWRpdG9yLmdldEN1cnNvcigpLmxpbmUgPCBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRjb25zdCBhdHRyaWJ1dGUgPSBmcm9udE1hdHRlckxpbmVGaWVsZChlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSkpXG5cdFx0XHRcdFx0aWYgKGF0dHJpYnV0ZSkgaW5jbHVkZWRGaWVsZHMucHVzaChhdHRyaWJ1dGUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGdldExpbmVGaWVsZHMoZWRpdG9yLmdldExpbmUoZWRpdG9yLmdldEN1cnNvcigpLmxpbmUpKS5mb3JFYWNoKGZpZWxkID0+IHtcblx0XHRcdFx0XHRcdGlmIChlZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggPD0gZmllbGQuaW5kZXggKyBmaWVsZC5sZW5ndGggJiYgZWRpdG9yLmdldEN1cnNvcigpLmNoID49IGZpZWxkLmluZGV4KSB7XG5cdFx0XHRcdFx0XHRcdGluY2x1ZGVkRmllbGRzLnB1c2goZmllbGQuYXR0cmlidXRlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChpbmNsdWRlZEZpZWxkcy5sZW5ndGgpIHtcblx0XHRcdFx0XHR0aGlzLmJ1aWxkT3B0aW9ucyhmaWxlLCBtZW51LCBpbmNsdWRlZEZpZWxkcyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5idWlsZE9wdGlvbnMoZmlsZSwgbWVudSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0fSlcblx0XHQpXG5cdH1cblxuXHRwcml2YXRlIGJ1aWxkT3B0aW9ucyhmaWxlOiBURmlsZSB8IFRBYnN0cmFjdEZpbGUgfCBudWxsLCBtZW51OiBNZW51LCBpbmNsdWRlZEZpZWxkcz86IHN0cmluZ1tdKTogdm9pZCB7XG5cdFx0Y29uc3QgY2xhc3NGaWxlc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuXHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcblx0XHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUgJiYgcmVxdWlyZUFwaVZlcnNpb24oXCIwLjE2LjBcIikpIHtcblx0XHRcdFx0aWYgKGNsYXNzRmlsZXNQYXRoICYmIGZpbGUucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSkge1xuXHRcdFx0XHRcdGNvbnN0IGZpbGVDbGFzc05hbWUgPSBGaWxlQ2xhc3MuZ2V0RmlsZUNsYXNzTmFtZUZyb21QYXRoKHRoaXMucGx1Z2luLCBmaWxlLnBhdGgpXG5cdFx0XHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRcdFx0bWVudS5zZXRTZWN0aW9uU3VibWVudShgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHtmaWxlQ2xhc3NOYW1lfS5maWxlY2xhc3MtZmllbGRzYCwgeyB0aXRsZTogXCJNYW5hZ2UgZmllbGRzXCIsIGljb246IFwid3JlbmNoXCIgfSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRcdFx0bWVudS5zZXRTZWN0aW9uU3VibWVudShcIm1ldGFkYXRhLW1lbnUuY3VycmVudF9maWVsZFwiLCB7IHRpdGxlOiBcIkN1cnJlbnQgZmllbGRcIiwgaWNvbjogXCJwZW5jaWxcIiB9KVxuXHRcdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRcdG1lbnUuc2V0U2VjdGlvblN1Ym1lbnUoXCJtZXRhZGF0YS1tZW51LmZpZWxkc1wiLCB7IHRpdGxlOiBcIk1hbmFnZSBmaWVsZHNcIiwgaWNvbjogXCJwZW5jaWxcIiB9KVxuXHRcdFx0XHRcdGNvbnN0IGZpbGVDbGFzc2VzID0gdGhpcy5wbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzLmdldChmaWxlLnBhdGgpIHx8IFtdO1xuXHRcdFx0XHRcdGZpbGVDbGFzc2VzLmZvckVhY2goZmlsZUNsYXNzID0+IHtcblx0XHRcdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRcdFx0bWVudS5zZXRTZWN0aW9uU3VibWVudShgbWV0YWRhdGEtbWVudS1maWxlY2xhc3MuJHtmaWxlQ2xhc3MubmFtZX0uZmlsZWNsYXNzLWZpZWxkc2AsIHsgdGl0bGU6IGBNYW5hZ2UgJHtmaWxlQ2xhc3MubmFtZX0gZmllbGRzYCwgaWNvbjogXCJ3cmVuY2hcIiB9KVxuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSkge1xuXHRcdFx0XHQvL0lmIGZpbGVDbGFzc1xuXHRcdFx0XHRpZiAoY2xhc3NGaWxlc1BhdGggJiYgZmlsZS5wYXRoLnN0YXJ0c1dpdGgoY2xhc3NGaWxlc1BhdGgpKSB7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZUNsYXNzT3B0aW9uc0xpc3QgPSBuZXcgRmlsZUNsYXNzT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIGZpbGUsIG1lbnUpXG5cdFx0XHRcdFx0ZmlsZUNsYXNzT3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc3Qgb3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIGZpbGUsIG1lbnUsIGluY2x1ZGVkRmllbGRzKTtcblx0XHRcdFx0XHRvcHRpb25zTGlzdC5jcmVhdGVFeHRyYU9wdGlvbkxpc3QoKTtcblx0XHRcdFx0fTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImxpc3RcIilcblx0XHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiRmllbGQgT3B0aW9uc1wiKVxuXHRcdFx0XHRcdGl0ZW0ub25DbGljaygoKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwgPSBuZXcgRmllbGRDb21tYW5kU3VnZ2VzdE1vZGFsKHRoaXMucGx1Z2luLmFwcClcblx0XHRcdFx0XHRcdGNvbnN0IG9wdGlvbnNMaXN0ID0gbmV3IE9wdGlvbnNMaXN0KHRoaXMucGx1Z2luLCBmaWxlLCBmaWVsZENvbW1hbmRTdWdnZXN0TW9kYWwpO1xuXHRcdFx0XHRcdFx0b3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9O1xuXHR9XG59OyIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBDb21wb25lbnQsIFRGaWxlLCBkZWJvdW5jZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY2xlYXJFeHRyYUF0dHJpYnV0ZXMsIHVwZGF0ZURpdkV4dHJhQXR0cmlidXRlcywgdXBkYXRlRWxMaW5rcywgdXBkYXRlVmlzaWJsZUxpbmtzIH0gZnJvbSBcInNyYy9vcHRpb25zL2xpbmtBdHRyaWJ1dGVzXCI7XG5pbXBvcnQgeyBQcmVjIH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XG5pbXBvcnQgeyBidWlsZENNVmlld1BsdWdpbiB9IGZyb20gXCJzcmMvb3B0aW9ucy9saXZlUHJldmlld1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFeHRyYUJ1dHRvbiBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBwcml2YXRlIG9ic2VydmVyczogW011dGF0aW9uT2JzZXJ2ZXIsIHN0cmluZywgc3RyaW5nXVtdO1xuICAgIHByaXZhdGUgbW9kYWxPYnNlcnZlcnM6IE11dGF0aW9uT2JzZXJ2ZXJbXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgcHVibGljIGNhY2hlVmVyc2lvbjogc3RyaW5nLFxuICAgICAgICBwdWJsaWMgb25DaGFuZ2U6ICgpID0+IHZvaWQsXG5cbiAgICApIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICB9XG5cbiAgICBvbmxvYWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XG4gICAgICAgICAgICB1cGRhdGVFbExpbmtzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4sIGVsLCBjdHgpXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIExpdmUgcHJldmlld1xuICAgICAgICBjb25zdCBleHQgPSBQcmVjLmxvd2VzdChidWlsZENNVmlld1BsdWdpbih0aGlzLnBsdWdpbikpO1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckVkaXRvckV4dGVuc2lvbihleHQpO1xuXG4gICAgICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbCwgY3R4KSA9PiB7XG4gICAgICAgICAgICB1cGRhdGVFbExpbmtzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4sIGVsLCBjdHgpXG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgY29uc3QgcGx1Z2luID0gdGhpcy5wbHVnaW47XG4gICAgICAgIGNvbnN0IHVwZGF0ZUxpbmtzID0gKF9maWxlOiBURmlsZSkgPT4ge1xuICAgICAgICAgICAgdXBkYXRlVmlzaWJsZUxpbmtzKHBsdWdpbi5hcHAsIHBsdWdpbik7XG4gICAgICAgICAgICB0aGlzLm9ic2VydmVycy5mb3JFYWNoKChbb2JzZXJ2ZXIsIHR5cGUsIG93bl9jbGFzc106IFthbnksIGFueSwgYW55XSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlYXZlcyA9IHBsdWdpbi5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSh0eXBlKTtcbiAgICAgICAgICAgICAgICBsZWF2ZXMuZm9yRWFjaCgobGVhZjogYW55KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKGxlYWYudmlldy5jb250YWluZXJFbCwgb3duX2NsYXNzLCB0eXBlKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuXG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmluaXRWaWV3T2JzZXJ2ZXJzKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRNb2RhbE9ic2VydmVycyhkb2N1bWVudCk7XG4gICAgICAgICAgICB1cGRhdGVWaXNpYmxlTGlua3ModGhpcy5wbHVnaW4uYXBwLCB0aGlzLnBsdWdpbik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEluaXRpYWxpemF0aW9uXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsIGRlYm91bmNlKHVwZGF0ZUxpbmtzLCA1MDAsIHRydWUpKSk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJsYXlvdXQtY2hhbmdlXCIsIGRlYm91bmNlKHVwZGF0ZUxpbmtzLCAxMCwgdHJ1ZSkpKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJ3aW5kb3ctb3BlblwiLCAod2luZG93LCB3aW4pID0+IHRoaXMuaW5pdE1vZGFsT2JzZXJ2ZXJzKHdpbmRvdy5nZXRDb250YWluZXIoKSEuZG9jKSkpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbihcImxheW91dC1jaGFuZ2VcIiwgKCkgPT4gdGhpcy5pbml0Vmlld09ic2VydmVycygpKSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKFwibWV0YWRhdGEtbWVudTppbmRleGVkXCIsICgpID0+IHRoaXMucmVsb2FkT2JzZXJ2ZXJzKCkpKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRWaWV3T2JzZXJ2ZXJzKCkge1xuICAgICAgICAvLyBSZXNldCBvYnNlcnZlcnNcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMuZm9yRWFjaCgoW29ic2VydmVyLCB0eXBlXSkgPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcblxuICAgICAgICAvLyBSZWdpc3RlciBuZXcgb2JzZXJ2ZXJzXG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnYmFja2xpbmsnLCBcIi50cmVlLWl0ZW0taW5uZXJcIiwgdHJ1ZSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnb3V0Z29pbmctbGluaycsIFwiLnRyZWUtaXRlbS1pbm5lclwiLCB0cnVlKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXdUeXBlKCdzZWFyY2gnLCBcIi50cmVlLWl0ZW0taW5uZXJcIiwgdHJ1ZSk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnQkMtbWF0cml4JywgJy5CQy1MaW5rJyk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnQkMtZHVja3MnLCAnLmludGVybmFsLWxpbmsnKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXdUeXBlKCdCQy10cmVlJywgJ2EuaW50ZXJuYWwtbGluaycpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlld1R5cGUoJ2dyYXBoLWFuYWx5c2lzJywgJy5pbnRlcm5hbC1saW5rJyk7XG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnc3RhcnJlZCcsICcubmF2LWZpbGUtdGl0bGUtY29udGVudCcsIHRydWUpO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlld1R5cGUoJ2ZpbGUtZXhwbG9yZXInLCAnLm5hdi1maWxlLXRpdGxlLWNvbnRlbnQnLCB0cnVlKTtcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXdUeXBlKCdyZWNlbnQtZmlsZXMnLCAnLm5hdi1maWxlLXRpdGxlLWNvbnRlbnQnLCB0cnVlKTtcbiAgICAgICAgLy8gSWYgYmFja2xpbmtzIGluIGVkaXRvciBpcyBvblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHA/LmludGVybmFsUGx1Z2lucz8ucGx1Z2lucz8uYmFja2xpbms/Lmluc3RhbmNlPy5vcHRpb25zPy5iYWNrbGlua0luRG9jdW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3VHlwZSgnbWFya2Rvd24nLCAnLnRyZWUtaXRlbS1pbm5lcicsIHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0TW9kYWxPYnNlcnZlcnMoZG9jOiBEb2N1bWVudCkge1xuICAgICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgICAgICBzdWJ0cmVlOiBmYWxzZSxcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5tb2RhbE9ic2VydmVycy5wdXNoKG5ldyBNdXRhdGlvbk9ic2VydmVyKHJlY29yZHMgPT4ge1xuICAgICAgICAgICAgcmVjb3Jkcy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbi5hZGRlZE5vZGVzLmZvckVhY2gobiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ2NsYXNzTmFtZScgaW4gbiAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobi5jbGFzc05hbWUuaW5jbHVkZXMoJ21vZGFsLWNvbnRhaW5lcicpICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVF1aWNrU3dpdGNoZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBuLmNsYXNzTmFtZS5pbmNsdWRlcygnc3VnZ2VzdGlvbi1jb250YWluZXInKSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTdWdnZXN0b3IpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdG9yID0gXCIuc3VnZ2VzdGlvbi10aXRsZSwgLnN1Z2dlc3Rpb24tbm90ZSwgLmFub3RoZXItcXVpY2stc3dpdGNoZXJfX2l0ZW1fX3RpdGxlLCAub21uaXNlYXJjaC1yZXN1bHRfX3RpdGxlXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmNsYXNzTmFtZS5pbmNsdWRlcygnc3VnZ2VzdGlvbi1jb250YWluZXInKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IFwiLnN1Z2dlc3Rpb24tdGl0bGUsIC5zdWdnZXN0aW9uLW5vdGVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb250YWluZXIobiBhcyBIVE1MRWxlbWVudCwgc2VsZWN0b3IsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3dhdGNoQ29udGFpbmVyKG51bGwsIG4gYXMgSFRNTEVsZW1lbnQsIHNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5tb2RhbE9ic2VydmVycy5sYXN0KCk/Lm9ic2VydmUoZG9jLmJvZHksIGNvbmZpZyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZWdpc3RlclZpZXdUeXBlKHZpZXdUeXBlTmFtZTogc3RyaW5nLCBzZWxlY3Rvcjogc3RyaW5nLCB1cGRhdGVEeW5hbWljID0gZmFsc2UpIHtcbiAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUodmlld1R5cGVOYW1lKTtcbiAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlYXZlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGxlYXZlc1tpXS52aWV3LmNvbnRhaW5lckVsO1xuICAgICAgICAgICAgICAgIGlmICh1cGRhdGVEeW5hbWljKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dhdGNoQ29udGFpbmVyRHluYW1pYyh2aWV3VHlwZU5hbWUgKyBpLCBjb250YWluZXIsIHNlbGVjdG9yKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2F0Y2hDb250YWluZXIodmlld1R5cGVOYW1lICsgaSwgY29udGFpbmVyLCBzZWxlY3Rvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGxlYXZlcy5sZW5ndGggPCAxKSByZXR1cm47XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gbGVhdmVzWzBdLnZpZXcuY29udGFpbmVyRWw7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRhaW5lcihjb250YWluZXIsIHNlbGVjdG9yLCB2aWV3VHlwZU5hbWUpO1xuICAgICAgICAgICAgaWYgKHVwZGF0ZUR5bmFtaWMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93YXRjaENvbnRhaW5lckR5bmFtaWModmlld1R5cGVOYW1lLCBjb250YWluZXIsIHNlbGVjdG9yKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd2F0Y2hDb250YWluZXIodmlld1R5cGVOYW1lLCBjb250YWluZXIsIHNlbGVjdG9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcsIHZpZXdUeXBlTmFtZTogc3RyaW5nIHwgbnVsbCkge1xuICAgICAgICBjb25zdCBub2RlcyA9IGNvbnRhaW5lci5maW5kQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgY29uc3QgZWwgPSBub2Rlc1tpXSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIHVwZGF0ZURpdkV4dHJhQXR0cmlidXRlcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMucGx1Z2luLCBlbCwgdmlld1R5cGVOYW1lLCBcIlwiKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVtb3ZlRnJvbUNvbnRhaW5lcihjb250YWluZXI6IEhUTUxFbGVtZW50LCBzZWxlY3Rvcjogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gY29udGFpbmVyLmZpbmRBbGwoc2VsZWN0b3IpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBjb25zdCBlbCA9IG5vZGVzW2ldIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgY2xlYXJFeHRyYUF0dHJpYnV0ZXMoZWwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfd2F0Y2hDb250YWluZXIodmlld1R5cGU6IHN0cmluZyB8IG51bGwsIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcpIHtcbiAgICAgICAgbGV0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKHJlY29yZHMsIF8pID0+IHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udGFpbmVyKGNvbnRhaW5lciwgc2VsZWN0b3IsIHZpZXdUeXBlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIG9ic2VydmVyLm9ic2VydmUoY29udGFpbmVyLCB7IHN1YnRyZWU6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgYXR0cmlidXRlczogZmFsc2UgfSk7XG4gICAgICAgIGlmICh2aWV3VHlwZSkge1xuICAgICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChbb2JzZXJ2ZXIsIHZpZXdUeXBlLCBzZWxlY3Rvcl0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfd2F0Y2hDb250YWluZXJEeW5hbWljKHZpZXdUeXBlOiBzdHJpbmcsIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHNlbGVjdG9yOiBzdHJpbmcsIG93bkNsYXNzID0gJ3RyZWUtaXRlbS1pbm5lcicsIHBhcmVudF9jbGFzcyA9ICd0cmVlLWl0ZW0nKSB7XG4gICAgICAgIC8vIFVzZWQgZm9yIGVmZmljaWVudCB1cGRhdGluZyBvZiB0aGUgYmFja2xpbmtzIHBhbmVsXG4gICAgICAgIC8vIE9ubHkgbG9vcHMgdGhyb3VnaCBuZXdseSBhZGRlZCBET00gbm9kZXMgaW5zdGVhZCBvZiBjaGFuZ2luZyBhbGwgb2YgdGhlbVxuICAgICAgICBsZXQgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigocmVjb3JkcywgXykgPT4ge1xuICAgICAgICAgICAgcmVjb3Jkcy5mb3JFYWNoKChtdXRhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbi50eXBlID09PSAnY2hpbGRMaXN0Jykge1xuICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbi5hZGRlZE5vZGVzLmZvckVhY2goKG4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnY2xhc3NOYW1lJyBpbiBuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuLmNsYXNzTmFtZS5pbmNsdWRlcyAmJiB0eXBlb2Ygbi5jbGFzc05hbWUuaW5jbHVkZXMgPT09ICdmdW5jdGlvbicgJiYgbi5jbGFzc05hbWUuaW5jbHVkZXMocGFyZW50X2NsYXNzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlRGl2cyA9IChuIGFzIEhUTUxFbGVtZW50KS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG93bkNsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlRGl2cy5sZW5ndGg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGZpbGVEaXZzW2ldIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGl2RXh0cmFBdHRyaWJ1dGVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5wbHVnaW4sIGxpbmssIHZpZXdUeXBlLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBvYnNlcnZlci5vYnNlcnZlKGNvbnRhaW5lciwgeyBzdWJ0cmVlOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIGF0dHJpYnV0ZXM6IGZhbHNlIH0pO1xuICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKFtvYnNlcnZlciwgdmlld1R5cGUsIHNlbGVjdG9yXSk7XG4gICAgfVxuXG4gICAgcmVsb2FkT2JzZXJ2ZXJzKCkge1xuICAgICAgICB0aGlzLmRpc2Nvbm5lY3RPYnNlcnZlcnMoKTtcbiAgICAgICAgdGhpcy5pbml0TW9kYWxPYnNlcnZlcnMoZG9jdW1lbnQpO1xuICAgICAgICB0aGlzLmluaXRWaWV3T2JzZXJ2ZXJzKCk7XG4gICAgICAgIHVwZGF0ZVZpc2libGVMaW5rcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMucGx1Z2luKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGRpc2Nvbm5lY3RPYnNlcnZlcnMoKSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLmZvckVhY2goKFtvYnNlcnZlciwgdHlwZSwgb3duX2NsYXNzXSkgPT4ge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUodHlwZSk7XG4gICAgICAgICAgICBsZWF2ZXMuZm9yRWFjaChsZWFmID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUZyb21Db250YWluZXIobGVhZi52aWV3LmNvbnRhaW5lckVsLCBvd25fY2xhc3MpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgdGhpcy5tb2RhbE9ic2VydmVycykge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb251bmxvYWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGlzY29ubmVjdE9ic2VydmVycygpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBnZXRMaW5rcGF0aCwgTGlua0NhY2hlLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBNYXJrZG93blZpZXcsIFRGaWxlLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBOb3RlRmllbGRzQ29tcG9uZW50IGZyb20gXCIuLi9jb21wb25lbnRzL05vdGVGaWVsZHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyRXh0cmFBdHRyaWJ1dGVzKGxpbms6IEhUTUxFbGVtZW50KSB7XG4gICAgT2JqZWN0LnZhbHVlcyhsaW5rLmF0dHJpYnV0ZXMpLmZvckVhY2goYXR0ciA9PiB7XG4gICAgICAgIGlmIChhdHRyLm5hbWUuaW5jbHVkZXMoXCJmaWxlY2xhc3MtbmFtZVwiKSkge1xuICAgICAgICAgICAgbGluay5yZW1vdmVBdHRyaWJ1dGUoYXR0ci5uYW1lKVxuICAgICAgICAgICAgY29uc3QgZWwgPSBsaW5rLm5leHRFbGVtZW50U2libGluZ1xuICAgICAgICAgICAgaWYgKGVsPy5oYXNDbGFzcyhcImZpbGVjbGFzcy1pY29uXCIpKSB7XG4gICAgICAgICAgICAgICAgZWwucmVtb3ZlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIHNldExpbmtNZXRhZGF0YUZvcm1CdXR0b24ocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGxpbms6IEhUTUxFbGVtZW50LCBkZXN0TmFtZTogc3RyaW5nLCB2aWV3VHlwZU5hbWU6IHN0cmluZyB8IG51bGwsIGZpbGVDbGFzc05hbWU/OiBzdHJpbmcpIHtcbiAgICBzd2l0Y2ggKHZpZXdUeXBlTmFtZSkge1xuICAgICAgICBjYXNlIFwiYS5pbnRlcm5hbC1saW5rXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZUxpbmtzKSByZXR1cm47IGJyZWFrO1xuICAgICAgICBjYXNlIFwidGFiSGVhZGVyXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZVRhYkhlYWRlcikgcmV0dXJuOyBicmVhaztcbiAgICAgICAgY2FzZSBcInN0YXJyZWRcIjogaWYgKCFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlU3RhcnJlZCkgcmV0dXJuOyBicmVhaztcbiAgICAgICAgY2FzZSBcImZpbGUtZXhwbG9yZXJcIjogaWYgKCFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRmlsZUV4cGxvcmVyKSByZXR1cm47IGJyZWFrO1xuICAgICAgICBjYXNlIFwiYmFja2xpbmtcIjogaWYgKCFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlQmFja2xpbmtzKSByZXR1cm47IGJyZWFrO1xuICAgICAgICBjYXNlIFwic2VhcmNoXCI6IGlmICghcGx1Z2luLnNldHRpbmdzLmVuYWJsZVNlYXJjaCkgcmV0dXJuOyBicmVhaztcbiAgICAgICAgZGVmYXVsdDogcmV0dXJuO1xuICAgIH1cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZm9yIChjb25zdCBhIG9mIGxpbmsuYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoYS5uYW1lLmluY2x1ZGVzKFwiZmlsZWNsYXNzLW5hbWVcIikgJiYgKGEubmFtZSAhPT0gZmlsZUNsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgIGxpbmsucmVtb3ZlQXR0cmlidXRlKGEubmFtZSk7XG4gICAgICAgICAgICBjb25zdCBlbCA9IGxpbmsubmV4dEVsZW1lbnRTaWJsaW5nXG4gICAgICAgICAgICBpZiAoZWw/Lmhhc0NsYXNzKFwiZmlsZWNsYXNzLWljb25cIikpIHtcbiAgICAgICAgICAgICAgICBlbC5yZW1vdmUoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChmaWxlQ2xhc3NOYW1lKSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQoZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgY29uc3QgaWNvbiA9IGZpbGVDbGFzcy5nZXRJY29uKClcbiAgICAgICAgICAgIGxpbmsuc2V0QXR0cmlidXRlKFwiZmlsZWNsYXNzLW5hbWVcIiwgZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIGNvbnN0IGVsID0gbGluay5uZXh0RWxlbWVudFNpYmxpbmdcbiAgICAgICAgICAgIGlmICghZWw/Lmhhc0NsYXNzKFwiZmlsZWNsYXNzLWljb25cIikpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXRhZGF0YU1lbnVCdG4gPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5jb250YWluZXJFbC5jcmVhdGVFbCgnYScsIHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUgZmlsZWNsYXNzLWljb25cIiB9KVxuICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YU1lbnVCdG4pIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0SWNvbihtZXRhZGF0YU1lbnVCdG4sIGljb24gfHwgcGx1Z2luLnNldHRpbmdzLmJ1dHRvbkljb24pXG4gICAgICAgICAgICAgICAgICAgIGxpbmsucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKG1ldGFkYXRhTWVudUJ0biwgbGluay5uZXh0U2libGluZylcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGFNZW51QnRuLm9uY2xpY2sgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChgJHtkZXN0TmFtZX0ubWRgKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90ZUZpZWxkc0NvbXBvbmVudCA9IG5ldyBOb3RlRmllbGRzQ29tcG9uZW50KHBsdWdpbiwgXCIxXCIsICgpID0+IHsgfSwgZmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uYWRkQ2hpbGQobm90ZUZpZWxkc0NvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlTGlua01ldGFkYXRhTWVudUZvcm1CdXR0b24oYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsaW5rOiBIVE1MRWxlbWVudCwgdmlld1R5cGVOYW1lOiBzdHJpbmcgfCBudWxsLCBzb3VyY2U6IHN0cmluZykge1xuICAgIGNvbnN0IGxpbmtIcmVmID0gbGluay5nZXRBdHRyaWJ1dGUoJ2hyZWYnKT8uc3BsaXQoJyMnKVswXTtcbiAgICBjb25zdCBkZXN0ID0gbGlua0hyZWYgJiYgYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGlua0hyZWYsIHNvdXJjZSk7XG5cbiAgICBpZiAoZGVzdCkge1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLmdldChkZXN0LnBhdGgpPy5sYXN0KClcbiAgICAgICAgc2V0TGlua01ldGFkYXRhRm9ybUJ1dHRvbihwbHVnaW4sIGxpbmssIGRlc3QucGF0aC5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSwgdmlld1R5cGVOYW1lLCBmaWxlQ2xhc3NOYW1lKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVEaXZFeHRyYUF0dHJpYnV0ZXMoYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsaW5rOiBIVE1MRWxlbWVudCwgdmlld1R5cGVOYW1lOiBzdHJpbmcgfCBudWxsLCBzb3VyY2VOYW1lOiBzdHJpbmcsIF9saW5rTmFtZT86IHN0cmluZykge1xuICAgIGNvbnN0IGxpbmtOYW1lID0gX2xpbmtOYW1lIHx8IGxpbmsudGV4dENvbnRlbnRcbiAgICBjb25zdCBkZXN0ID0gbGlua05hbWUgJiYgYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoZ2V0TGlua3BhdGgobGlua05hbWUpLCBzb3VyY2VOYW1lKVxuICAgIGlmIChkZXN0KSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWUgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGRlc3QucGF0aCk/Lmxhc3QoKVxuICAgICAgICBzZXRMaW5rTWV0YWRhdGFGb3JtQnV0dG9uKHBsdWdpbiwgbGluaywgZGVzdC5wYXRoLnJlcGxhY2UoLyguKikubWQvLCBcIiQxXCIpLCB2aWV3VHlwZU5hbWUsIGZpbGVDbGFzc05hbWUpO1xuICAgIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlRWxMaW5rcyhhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGVsOiBIVE1MRWxlbWVudCwgY3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0KSB7XG4gICAgY29uc3QgbGlua3MgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCdhLmludGVybmFsLWxpbmsnKTtcbiAgICBjb25zdCBzb3VyY2UgPSBjdHguc291cmNlUGF0aC5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKTtcbiAgICBsaW5rcy5mb3JFYWNoKChsaW5rOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgICB1cGRhdGVMaW5rTWV0YWRhdGFNZW51Rm9ybUJ1dHRvbihhcHAsIHBsdWdpbiwgbGluaywgJ2EuaW50ZXJuYWwtbGluaycsIHNvdXJjZSlcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVZpc2libGVMaW5rcyhhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICBjb25zdCBzZXR0aW5ncyA9IHBsdWdpbi5zZXR0aW5ncztcbiAgICBhcHAud29ya3NwYWNlLml0ZXJhdGVSb290TGVhdmVzKChsZWFmKSA9PiB7XG4gICAgICAgIGlmIChsZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgbGVhZi52aWV3LmZpbGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGU6IFRGaWxlID0gbGVhZi52aWV3LmZpbGU7XG4gICAgICAgICAgICBjb25zdCBjYWNoZWRGaWxlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBmaWxlLnBhdGgucmVwbGFjZSgvKC4qKS5tZC8sIFwiJDFcIilcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uc3QgdGFiSGVhZGVyOiBIVE1MRWxlbWVudCA9IGxlYWYudGFiSGVhZGVySW5uZXJUaXRsZUVsO1xuICAgICAgICAgICAgaWYgKHNldHRpbmdzLmVuYWJsZVRhYkhlYWRlcikge1xuICAgICAgICAgICAgICAgIC8vIFN1cGVyY2hhcmdlIHRhYiBoZWFkZXJzXG4gICAgICAgICAgICAgICAgdXBkYXRlRGl2RXh0cmFBdHRyaWJ1dGVzKGFwcCwgcGx1Z2luLCB0YWJIZWFkZXIsICd0YWJIZWFkZXInLCBmaWxlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjbGVhckV4dHJhQXR0cmlidXRlcyh0YWJIZWFkZXIpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGlmIChjYWNoZWRGaWxlPy5saW5rcyAmJiBzZXR0aW5ncy5lbmFibGVMaW5rcykge1xuICAgICAgICAgICAgICAgIGNhY2hlZEZpbGUubGlua3MuZm9yRWFjaCgobGluazogTGlua0NhY2hlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlc3QgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rLmxpbmssIGZpbGVOYW1lKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZGVzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZGVzdC5wYXRoKT8ubGFzdCgpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGludGVybmFsTGlua3MgPSBsZWFmLnZpZXcuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbChgYS5pbnRlcm5hbC1saW5rW2hyZWY9XCIke2xpbmsubGlua31cIl1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJuYWxMaW5rcy5mb3JFYWNoKChpbnRlcm5hbExpbms6IEhUTUxFbGVtZW50KSA9PiBzZXRMaW5rTWV0YWRhdGFGb3JtQnV0dG9uKHBsdWdpbiwgaW50ZXJuYWxMaW5rLCBmaWxlTmFtZSwgYGEuaW50ZXJuYWwtbGlua2AsIGZpbGVDbGFzc05hbWUpKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59IiwgImltcG9ydCB7IEFwcCwgZWRpdG9yVmlld0ZpZWxkLCBNYXJrZG93blZpZXcsIHNldEljb24sIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBEZWNvcmF0aW9uLCBEZWNvcmF0aW9uU2V0LCBFZGl0b3JWaWV3LCBWaWV3UGx1Z2luLCBWaWV3VXBkYXRlLCBXaWRnZXRUeXBlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IFJhbmdlU2V0QnVpbGRlciB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgc3ludGF4VHJlZSB9IGZyb20gXCJAY29kZW1pcnJvci9sYW5ndWFnZVwiO1xuaW1wb3J0IHsgdG9rZW5DbGFzc05vZGVQcm9wIH0gZnJvbSBcIkBjb2RlbWlycm9yL2xhbmd1YWdlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgTm90ZUZpZWxkc0NvbXBvbmVudCBmcm9tIFwic3JjL2NvbXBvbmVudHMvTm90ZUZpZWxkc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRDTVZpZXdQbHVnaW4ocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICAvLyBJbXBsZW1lbnRzIHRoZSBsaXZlIHByZXZpZXcgc3VwZXJjaGFyZ2luZ1xuICAgIC8vIENvZGUgc3RydWN0dXJlIGJhc2VkIG9uIGh0dHBzOi8vZ2l0aHViLmNvbS9ub3RoaW5naXNsb3N0L29ic2lkaWFuLWNtNi1hdHRyaWJ1dGVzL2Jsb2IvNzQzZDcxYjBhYTYxNjQwNzE0OWEwYjZlYTVmZmVhMjhlMjE1NDE1OC9zcmMvbWFpbi50c1xuICAgIC8vIENvZGUgaGVscCBjcmVkaXRzIHRvIEBOb3RoaW5nSXNMb3N0ISBUaGV5IGhhdmUgYmVlbiBhIGdyZWF0IGhlbHAgZ2V0dGluZyB0aGlzIHRvIHdvcmsgcHJvcGVybHkuXG4gICAgY2xhc3MgSGVhZGVyV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG4gICAgICAgIGZpbGVDbGFzc05hbWU/OiBzdHJpbmdcbiAgICAgICAgYWZ0ZXI6IGJvb2xlYW5cbiAgICAgICAgZGVzdE5hbWU6IHN0cmluZ1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKGZpbGVDbGFzc05hbWU6IHN0cmluZyB8IHVuZGVmaW5lZCwgYWZ0ZXI6IGJvb2xlYW4sIGRlc3ROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc05hbWUgPSBmaWxlQ2xhc3NOYW1lXG4gICAgICAgICAgICB0aGlzLmFmdGVyID0gYWZ0ZXJcbiAgICAgICAgICAgIHRoaXMuZGVzdE5hbWUgPSBkZXN0TmFtZVxuICAgICAgICB9XG5cbiAgICAgICAgdG9ET00oKSB7XG4gICAgICAgICAgICBsZXQgbWV0YWRhdGFNZW51QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICBtZXRhZGF0YU1lbnVCdG4uc2V0QXR0cihcImZpbGVjbGFzcy1uYW1lXCIsIHRoaXMuZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgbWV0YWRhdGFNZW51QnRuLmFkZENsYXNzKCdmaWxlY2xhc3MtaWNvbicpO1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhTWVudUJ0bi5hZGRDbGFzcygnbWV0YWRhdGEtbWVudScpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVDbGFzc2VzTmFtZS5nZXQodGhpcy5maWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWNvbiA9IGZpbGVDbGFzcy5nZXRJY29uKCk7XG4gICAgICAgICAgICAgICAgICAgIHNldEljb24obWV0YWRhdGFNZW51QnRuLCBpY29uIHx8IHNldHRpbmdzLmJ1dHRvbkljb24pXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhTWVudUJ0bi5vbmNsaWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYCR7dGhpcy5kZXN0TmFtZX0ubWRgKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90ZUZpZWxkc0NvbXBvbmVudCA9IG5ldyBOb3RlRmllbGRzQ29tcG9uZW50KHBsdWdpbiwgXCIxXCIsICgpID0+IHsgfSwgZmlsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW4uYWRkQ2hpbGQobm90ZUZpZWxkc0NvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjcmVhdGUgYSBuYWl2ZSBicmVhZCBjcnVtYlxuICAgICAgICAgICAgcmV0dXJuIG1ldGFkYXRhTWVudUJ0bjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlnbm9yZUV2ZW50KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZXR0aW5ncyA9IHBsdWdpbi5zZXR0aW5ncztcbiAgICBjb25zdCB2aWV3UGx1Z2luID0gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG4gICAgICAgIGNsYXNzIHtcbiAgICAgICAgICAgIGRlY29yYXRpb25zOiBEZWNvcmF0aW9uU2V0O1xuXG4gICAgICAgICAgICBjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuYnVpbGREZWNvcmF0aW9ucyh2aWV3KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUudmlld3BvcnRDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModXBkYXRlLnZpZXcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnVpbGREZWNvcmF0aW9ucyh2aWV3OiBFZGl0b3JWaWV3KSB7XG4gICAgICAgICAgICAgICAgbGV0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XG4gICAgICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5lbmFibGVFZGl0b3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJ1aWxkZXIuZmluaXNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IG1kVmlldyA9IHZpZXcuc3RhdGUuZmllbGQoZWRpdG9yVmlld0ZpZWxkKSBhcyBNYXJrZG93blZpZXc7XG4gICAgICAgICAgICAgICAgbGV0IGxhc3RBdHRyaWJ1dGVzID0ge307XG4gICAgICAgICAgICAgICAgbGV0IGljb25EZWNvQWZ0ZXI6IERlY29yYXRpb24gfCBudWxsID0gbnVsbDtcbiAgICAgICAgICAgICAgICBsZXQgaWNvbkRlY29BZnRlcldoZXJlOiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGxldCBtZEFsaWFzRnJvbTogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgbGV0IG1kQWxpYXNUbzogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xuICAgICAgICAgICAgICAgICAgICBzeW50YXhUcmVlKHZpZXcuc3RhdGUpLml0ZXJhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgZnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW50ZXI6IChub2RlKSA9PiB7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuUHJvcHMgPSBub2RlLnR5cGUucHJvcCh0b2tlbkNsYXNzTm9kZVByb3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlblByb3BzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb3BzID0gbmV3IFNldCh0b2tlblByb3BzLnNwbGl0KFwiIFwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTGluayA9IHByb3BzLmhhcyhcImhtZC1pbnRlcm5hbC1saW5rXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0FsaWFzID0gcHJvcHMuaGFzKFwibGluay1hbGlhc1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNQaXBlID0gcHJvcHMuaGFzKFwibGluay1hbGlhcy1waXBlXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSAnYWxpYXMnIG9mIHRoZSBtZCBsaW5rXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTURMaW5rID0gcHJvcHMuaGFzKCdsaW5rJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSAnaW50ZXJuYWwgbGluaycgb2YgdGhlIG1kIGxpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNNRFVybCA9IHByb3BzLmhhcygndXJsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzTURGb3JtYXR0aW5nID0gcHJvcHMuaGFzKCdmb3JtYXR0aW5nLWxpbmsnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNRExpbmsgJiYgIWlzTURGb3JtYXR0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMaW5rOiBUaGUgJ2FsaWFzJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVVJMOiBUaGUgaW50ZXJuYWwgbGlua1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWRBbGlhc0Zyb20gPSBub2RlLmZyb207XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZEFsaWFzVG8gPSBub2RlLnRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1BpcGUgJiYgIWlzQWxpYXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpY29uRGVjb0FmdGVyICYmIGljb25EZWNvQWZ0ZXJXaGVyZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkZXIuYWRkKGljb25EZWNvQWZ0ZXJXaGVyZSwgaWNvbkRlY29BZnRlcldoZXJlLCBpY29uRGVjb0FmdGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyV2hlcmUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0xpbmsgJiYgIWlzQWxpYXMgJiYgIWlzUGlwZSB8fCBpc01EVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbGlua1RleHQgPSB2aWV3LnN0YXRlLmRvYy5zbGljZVN0cmluZyhub2RlLmZyb20sIG5vZGUudG8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua1RleHQgPSBsaW5rVGV4dC5zcGxpdChcIiNcIilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZmlsZSA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChsaW5rVGV4dCwgbWRWaWV3LmZpbGUuYmFzZW5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTURVcmwgJiYgIWZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZGVjb2RlVVJJQ29tcG9uZW50KGxpbmtUZXh0KSkgYXMgVEZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5nZXQoZmlsZS5wYXRoKT8ubGFzdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IHsgXCJmaWxlY2xhc3MtbmFtZVwiOiBmaWxlQ2xhc3NOYW1lIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRlY28gPSBEZWNvcmF0aW9uLm1hcmsoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImZpbGVjbGFzcy10ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpY29uRGVjb0JlZm9yZSA9IERlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldDogbmV3IEhlYWRlcldpZGdldChmaWxlQ2xhc3NOYW1lLCBmYWxzZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyID0gRGVjb3JhdGlvbi53aWRnZXQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkZ2V0OiBuZXcgSGVhZGVyV2lkZ2V0KGZpbGVDbGFzc05hbWUsIHRydWUsIGZpbGUucGF0aC5yZXBsYWNlKC8oLiopLm1kLywgXCIkMVwiKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc01EVXJsICYmIG1kQWxpYXNGcm9tICYmIG1kQWxpYXNUbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgcmV0cm9hY3RpdmVseSB0byB0aGUgYWxpYXMgZm91bmQgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGVjbyA9IERlY29yYXRpb24ubWFyayh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczogYXR0cmlidXRlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogXCJmaWxlY2xhc3MtdGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vYnVpbGRlci5hZGQobWRBbGlhc0Zyb20sIG1kQWxpYXNGcm9tLCBpY29uRGVjb0JlZm9yZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChtZEFsaWFzRnJvbSwgbWRBbGlhc1RvLCBkZWNvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpY29uRGVjb0FmdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobWRBbGlhc1RvLCBtZEFsaWFzVG8sIGljb25EZWNvQWZ0ZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25EZWNvQWZ0ZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25EZWNvQWZ0ZXJXaGVyZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWRBbGlhc0Zyb20gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1kQWxpYXNUbyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZGVyLmFkZChub2RlLmZyb20sIG5vZGUuZnJvbSwgaWNvbkRlY29CZWZvcmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobm9kZS5mcm9tLCBub2RlLnRvLCBkZWNvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29uRGVjb0FmdGVyV2hlcmUgPSBub2RlLnRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0xpbmsgJiYgaXNBbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRlY28gPSBEZWNvcmF0aW9uLm1hcmsoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IGxhc3RBdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBcImZpbGVjbGFzcy10ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobm9kZS5mcm9tLCBub2RlLnRvLCBkZWNvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpY29uRGVjb0FmdGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRlci5hZGQobm9kZS50bywgbm9kZS50bywgaWNvbkRlY29BZnRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvbkRlY29BZnRlcldoZXJlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gYnVpbGRlci5maW5pc2goKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgZGVjb3JhdGlvbnM6IHYgPT4gdi5kZWNvcmF0aW9uc1xuICAgICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gdmlld1BsdWdpbjtcbn0iLCAiaW1wb3J0IHsgQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgcmVzb2x2ZUxvb2t1cHMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3Jlc29sdmVMb29rdXBzXCI7XG5pbXBvcnQgeyB1cGRhdGVMb29rdXBzIH0gZnJvbSBcInNyYy9jb21tYW5kcy91cGRhdGVMb29rdXBzXCI7XG5pbXBvcnQgeyB1cGRhdGVGb3JtdWxhcywgY2xlYW5SZW1vdmVkRm9ybXVsYXNGcm9tSW5kZXggfSBmcm9tIFwic3JjL2NvbW1hbmRzL3VwZGF0ZUZvcm11bGFzXCI7XG5cbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgU3RhdHVzIGFzIExvb2t1cFN0YXR1cywgVHlwZSBhcyBMb29rdXBUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9sb29rdXBUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZEluZGV4IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIHB1YmxpYyBmaWxlQ2xhc3Nlc0ZpZWxkczogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3M6IEZpZWxkW107XG4gICAgcHVibGljIGZpbGVzRmllbGRzRnJvbVRhZ3M6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpZWxkc0Zyb21GaWxlQ2xhc3NRdWVyaWVzOiBNYXA8c3RyaW5nLCBGaWVsZFtdPjtcbiAgICBwdWJsaWMgZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3NlczogTWFwPHN0cmluZywgRmllbGRbXT47XG4gICAgcHVibGljIGZpbGVzRmllbGRzOiBNYXA8c3RyaW5nLCBGaWVsZFtdPjtcbiAgICBwdWJsaWMgZmlsZXNGaWVsZHNFeGlzdHM6IE1hcDxzdHJpbmcsIEZpZWxkW10+O1xuICAgIHB1YmxpYyBmaWxlc0ZpbGVDbGFzc2VzOiBNYXA8c3RyaW5nLCBGaWxlQ2xhc3NbXT47XG4gICAgcHVibGljIGZpbGVzRmlsZUNsYXNzZXNOYW1lczogTWFwPHN0cmluZywgc3RyaW5nW10gfCB1bmRlZmluZWQ+O1xuICAgIHB1YmxpYyBmaWxlQ2xhc3Nlc0FuY2VzdG9yczogTWFwPHN0cmluZywgc3RyaW5nW10+XG4gICAgcHVibGljIGZpbGVDbGFzc2VzUGF0aDogTWFwPHN0cmluZywgRmlsZUNsYXNzPjtcbiAgICBwdWJsaWMgZmlsZUNsYXNzZXNOYW1lOiBNYXA8c3RyaW5nLCBGaWxlQ2xhc3M+O1xuICAgIHB1YmxpYyB2YWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXM6IE1hcDxzdHJpbmcsIHN0cmluZ1tdPjtcbiAgICBwdWJsaWMgdGFnc01hdGNoaW5nRmlsZUNsYXNzZXM6IE1hcDxzdHJpbmcsIEZpbGVDbGFzcz47XG4gICAgcHVibGljIGZpbGVMb29rdXBGaWxlczogTWFwPHN0cmluZywgYW55W10+O1xuICAgIHB1YmxpYyBmaWxlTG9va3VwRmllbGRzU3RhdHVzOiBNYXA8c3RyaW5nLCBMb29rdXBTdGF0dXM+O1xuICAgIHB1YmxpYyBwcmV2aW91c0ZpbGVMb29rdXBGaWxlc1ZhbHVlczogTWFwPHN0cmluZywgbnVtYmVyPjtcbiAgICBwdWJsaWMgZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlOiBNYXA8c3RyaW5nLCBzdHJpbmc+O1xuICAgIHB1YmxpYyBmaWxlTG9va3VwRmllbGRMYXN0T3V0cHV0VHlwZTogTWFwPHN0cmluZywga2V5b2YgdHlwZW9mIExvb2t1cFR5cGU+O1xuICAgIHB1YmxpYyBmaWxlRm9ybXVsYUZpZWxkTGFzdFZhbHVlOiBNYXA8c3RyaW5nLCBzdHJpbmc+O1xuICAgIHB1YmxpYyBsb29rdXBRdWVyaWVzOiBNYXA8c3RyaW5nLCBGaWVsZD47XG4gICAgcHVibGljIGR2OiBhbnk7XG4gICAgcHVibGljIGxhc3RSZXZpc2lvbjogMDtcbiAgICBwdWJsaWMgZmlsZUNoYW5nZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwdWJsaWMgZHZSZWFkeTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHB1YmxpYyBsb2FkVGltZTogbnVtYmVyO1xuICAgIHB1YmxpYyBmaXJzdEluZGV4aW5nRG9uZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgY2xhc3NGaWxlc1BhdGg6IHN0cmluZyB8IG51bGw7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LCBwdWJsaWMgY2FjaGVWZXJzaW9uOiBzdHJpbmcsIHB1YmxpYyBvbkNoYW5nZTogKCkgPT4gdm9pZCkge1xuICAgICAgICBzdXBlcigpXG4gICAgICAgIHRoaXMuZmx1c2hDYWNoZSgpO1xuICAgICAgICB0aGlzLmZpbGVMb29rdXBGaWxlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlTG9va3VwRmllbGRMYXN0VmFsdWUgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUxvb2t1cEZpZWxkc1N0YXR1cyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5wcmV2aW91c0ZpbGVMb29rdXBGaWxlc1ZhbHVlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlTG9va3VwRmllbGRMYXN0T3V0cHV0VHlwZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlRm9ybXVsYUZpZWxkTGFzdFZhbHVlID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmR2ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldztcbiAgICAgICAgdGhpcy5jbGFzc0ZpbGVzUGF0aCA9IHBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aDtcbiAgICB9XG5cbiAgICBhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cbiAgICAgICAgdGhpcy5sb2FkVGltZSA9IERhdGUubm93KCk7XG4gICAgICAgIGF3YWl0IChhc3luYyAoKSA9PiB7IH0pKCk7IC8vb25seSB3YXkgdG8gaGF2ZSBtZXRhZGF0YSBidXR0b24gdG8gc2hvdyB1cCBhdCByZWxvYWQgIT8hXG5cbiAgICAgICAgaWYgKHRoaXMuZHY/LmFwaS5pbmRleC5pbml0aWFsaXplZCkge1xuICAgICAgICAgICAgdGhpcy5kdiA9IHRoaXMucGx1Z2luLmFwcC5wbHVnaW5zLnBsdWdpbnMuZGF0YXZpZXc7XG4gICAgICAgICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMuZHYuYXBpLmluZGV4LnJldmlzaW9uO1xuICAgICAgICAgICAgdGhpcy5kdlJlYWR5ID0gdHJ1ZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZnVsbEluZGV4KFwiZHYgaXMgcnVubmluZ1wiLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbihcImRhdGF2aWV3OmluZGV4LXJlYWR5XCIsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmR2ID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldztcbiAgICAgICAgICAgICAgICB0aGlzLmR2UmVhZHkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZnVsbEluZGV4KFwiZHYgaW5kZXhcIiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdFJldmlzaW9uID0gdGhpcy5kdi5hcGkuaW5kZXgucmV2aXNpb247XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ3Jlc29sdmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJvYnNpZGlhbiByZXNvbHZlZFwiKVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmZ1bGxJbmRleChcImNhY2hlIHJlc29sdmVkXCIsIGZhbHNlLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24gfHwgMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG5cbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2RhdGF2aWV3Om1ldGFkYXRhLWNoYW5nZScsIGFzeW5jIChvcDogYW55LCBmaWxlOiBURmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJzb21lIGZpbGUgY2hhbmdlZFwiLCB0aGlzLmZpbGVDaGFuZ2VkKTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibmV3IHJldmlzaW9uXCIsIHRoaXMuZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbiAgICAgICAgICAgICAgICBpZiAob3AgPT09IFwidXBkYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgLy9kYXRhdmlldyBpcyB0cmlnZ2VyaW5nIFwidXBkYXRlXCIgb24gbWV0YWRhdGFjYWNoZS5vbihcInJlc29sdmVcIikgZXZlbiBpZiBubyBjaGFuZ2UgaW4gdGhlIGZpbGUuIEl0IG9jY3VycyBhdCBhcHAgbGF1bmNoXG4gICAgICAgICAgICAgICAgICAgIC8vY2hlY2sgaWYgdGhlIGZpbGUgbXRpbWUgaXMgb2xkZXIgdGhhdCBwbHVnaW4gbG9hZCAtPiBpbiB0aGlzIGNhc2Ugbm8gZmlsZSBoYXMgY2hhbmdlLCBubyBuZWVkIHRvIHVwbGRhdGUgbG9va3Vwc1xuICAgICAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZmlsZUNhY2hlW2ZpbGUucGF0aF0ubXRpbWUgPj0gdGhpcy5sb2FkVGltZVxuICAgICAgICAgICAgICAgICAgICAmJiB0aGlzLmR2Py5hcGkuaW5kZXgucmV2aXNpb24gIT09IHRoaXMubGFzdFJldmlzaW9uXG4gICAgICAgICAgICAgICAgICAgICYmIHRoaXMuZmlsZUNoYW5nZWRcbiAgICAgICAgICAgICAgICAgICAgJiYgdGhpcy5kdlJlYWR5XG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vbWF5YmUgZnVsbEluZGV4IGRpZG4ndCBjYXRjaCBuZXcgZmlsZXMgdGhhdCBoYXZlIHRvIGJlIHVwZGF0ZWQ6IGxldCdzIHJlYnVpbGQgZ2V0RmlsZUZpZWxkc0V4aXN0IGZvciB0aGlzIGZpbGVcbiAgICAgICAgICAgICAgICAgICAgY2xlYW5SZW1vdmVkRm9ybXVsYXNGcm9tSW5kZXgodGhpcy5wbHVnaW4pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEZpbGVzRmllbGRzRXhpc3RzKGZpbGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jbGFzc0ZpbGVzUGF0aCAmJiBmaWxlLnBhdGguc3RhcnRzV2l0aCh0aGlzLmNsYXNzRmlsZXNQYXRoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mdWxsSW5kZXgoXCJmaWxlQ2xhc3MgY2hhbmdlZFwiKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVGb3JtdWxhcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNvbHZlTG9va3VwcyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLnBsdWdpbiwgZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVMb29rdXBzKGZpbGVDbGFzc05hbWUsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RSZXZpc2lvbiA9IHRoaXMuZHYuYXBpLmluZGV4LnJldmlzaW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLnRyaWdnZXIoXCJtZXRhZGF0YS1tZW51OmluZGV4ZWRcIilcbiAgICB9XG5cblxuICAgIHByaXZhdGUgZmx1c2hDYWNoZSgpIHtcbiAgICAgICAgdGhpcy5maWxlc0ZpZWxkcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0V4aXN0cyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc0ZpZWxkcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzID0gW107XG4gICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tVGFncyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0ZpZWxkc0Zyb21GaWxlQ2xhc3NRdWVyaWVzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVzRmllbGRzRnJvbUlubmVyRmlsZUNsYXNzZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzZXNQYXRoID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLmZpbGVDbGFzc2VzTmFtZSA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9ycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy52YWx1ZXNMaXN0Tm90ZVBhdGhWYWx1ZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3NlcyA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc2VzTmFtZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMubG9va3VwUXVlcmllcyA9IG5ldyBNYXAoKTtcbiAgICB9XG5cbiAgICBhc3luYyBmdWxsSW5kZXgoZXZlbnQ6IHN0cmluZywgZm9yY2VfdXBkYXRlX2FsbCA9IGZhbHNlLCB3aXRob3V0X2xvb2t1cHMgPSBmYWxzZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwic3RhcnQgaW5kZXggW1wiLCBldmVudCwgXCJdXCIsIHRoaXMubGFzdFJldmlzaW9uLCBcIi0+XCIsIHRoaXMuZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbiAgICAgICAgbGV0IHN0YXJ0ID0gRGF0ZS5ub3coKSwgdGltZSA9IERhdGUubm93KClcbiAgICAgICAgdGhpcy5mbHVzaENhY2hlKCk7XG4gICAgICAgIHRoaXMuZ2V0RmlsZUNsYXNzZXNBbmNlc3RvcnMoKTtcbiAgICAgICAgdGhpcy5nZXRHbG9iYWxGaWxlQ2xhc3MoKTtcbiAgICAgICAgdGhpcy5nZXRGaWxlQ2xhc3NlcygpO1xuICAgICAgICB0aGlzLmdldExvb2t1cFF1ZXJpZXMoKTtcbiAgICAgICAgdGhpcy5yZXNvbHZlRmlsZUNsYXNzTWF0Y2hpbmdUYWdzKCk7XG4gICAgICAgIHRoaXMucmVzb2x2ZUZpbGVDbGFzc1F1ZXJpZXMoKTtcbiAgICAgICAgdGhpcy5nZXRGaWxlc0ZpZWxkc0Zyb21GaWxlQ2xhc3MoKTtcbiAgICAgICAgdGhpcy5nZXRGaWxlc0ZpZWxkcygpO1xuICAgICAgICB0aGlzLmdldEZpbGVzRmllbGRzRXhpc3RzKCk7XG4gICAgICAgIGF3YWl0IHRoaXMuZ2V0VmFsdWVzTGlzdE5vdGVQYXRoVmFsdWVzKCk7XG4gICAgICAgIHRoaXMucmVzb2x2ZUxvb2t1cHMod2l0aG91dF9sb29rdXBzKTtcbiAgICAgICAgYXdhaXQgdGhpcy51cGRhdGVMb29rdXBzKFwiZnVsbCBJbmRleFwiLCB3aXRob3V0X2xvb2t1cHMpO1xuICAgICAgICBpZiAoZm9yY2VfdXBkYXRlX2FsbCB8fCAhdGhpcy5maXJzdEluZGV4aW5nRG9uZSkgYXdhaXQgdGhpcy51cGRhdGVGb3JtdWxhcygpOyAvL2NhbGN1bGF0ZSBmb3JtdWxhcyBhdCBzdGFydCBvZiB3aXRoIGZvcmNlIHVwZGF0ZVxuICAgICAgICB0aGlzLmZpcnN0SW5kZXhpbmdEb25lID0gdHJ1ZTtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhcImVuZCBpbmRleCBbXCIsIGV2ZW50LCBcIl1cIiwgdGhpcy5sYXN0UmV2aXNpb24sIFwiLT5cIiwgdGhpcy5kdj8uYXBpLmluZGV4LnJldmlzaW9uLCBgJHsoRGF0ZS5ub3coKSAtIHN0YXJ0KX1tc2ApXG4gICAgfVxuXG4gICAgcmVzb2x2ZUxvb2t1cHMod2l0aG91dF9sb29rdXBzOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGlmICghd2l0aG91dF9sb29rdXBzKSByZXNvbHZlTG9va3Vwcyh0aGlzLnBsdWdpbik7XG4gICAgfVxuXG4gICAgYXN5bmMgdXBkYXRlTG9va3Vwcyhzb3VyY2U6IHN0cmluZyA9IFwiXCIsIHdpdGhvdXRfbG9va3VwczogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXdpdGhvdXRfbG9va3VwcykgYXdhaXQgdXBkYXRlTG9va3Vwcyh0aGlzLnBsdWdpbiwgc291cmNlKTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGVGb3JtdWxhcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdXBkYXRlRm9ybXVsYXModGhpcy5wbHVnaW4pO1xuICAgIH1cblxuICAgIGFzeW5jIGdldFZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc05hbWUuZm9yRWFjaCgoZmlsZUNsYXNzKSA9PiB7XG4gICAgICAgICAgICBmaWxlQ2xhc3MuYXR0cmlidXRlcy5mb3JFYWNoKGFzeW5jIGF0dHIgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0ci5vcHRpb25zID09PSBcIm9iamVjdFwiICYmICEhKGF0dHIub3B0aW9ucyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+KVtcInZhbHVlc0xpc3ROb3RlUGF0aFwiXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcy5zZXQoXG4gICAgICAgICAgICAgICAgICAgICAgICAoYXR0ci5vcHRpb25zIGFzIFJlY29yZDxzdHJpbmcsIGFueT4pLnZhbHVlc0xpc3ROb3RlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IEZpZWxkU2V0dGluZy5nZXRWYWx1ZXNMaXN0RnJvbU5vdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGF0dHIub3B0aW9ucyBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+KS52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKGFzeW5jIHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgaWYgKHNldHRpbmcub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlc0xpc3ROb3RlUGF0aFZhbHVlcy5zZXQoXG4gICAgICAgICAgICAgICAgICAgIHNldHRpbmcub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGgsXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IEZpZWxkU2V0dGluZy5nZXRWYWx1ZXNMaXN0RnJvbU5vdGUoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmcub3B0aW9ucy52YWx1ZXNMaXN0Tm90ZVBhdGhcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBnZXRGaWxlQ2xhc3Nlc0FuY2VzdG9ycygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2xhc3NGaWxlc1BhdGggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aFxuICAgICAgICAvLzEuIGl0ZXJhdGUgb3ZlciBmaWxlQ2xhc3NlcyB0byBpbml0IGZpbGVDbGFzc2VzQW5jZXN0b3JzXG4gICAgICAgIGlmIChjbGFzc0ZpbGVzUGF0aCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZiA9PiBmLnBhdGguaW5jbHVkZXMoY2xhc3NGaWxlc1BhdGgpKVxuICAgICAgICAgICAgICAgIC5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLnBsdWdpbiwgZi5wYXRoKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGYpPy5mcm9udG1hdHRlcj8uZXh0ZW5kc1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGAke2NsYXNzRmlsZXNQYXRofSR7cGFyZW50fS5tZGApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudEZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5zZXQoZmlsZUNsYXNzTmFtZSwgW3BhcmVudF0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc0FuY2VzdG9ycy5zZXQoZmlsZUNsYXNzTmFtZSwgW10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzQW5jZXN0b3JzLnNldChmaWxlQ2xhc3NOYW1lLCBbXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgLy8yLiBmb3IgZWFjaCBmaWxlQ2xhc3MgZ2V0IGFuY2VzdG9ycyByZWN1cnNpdmVseSAtIHN0b3Agd2hlbiBhbiBhbmNlc3RvciBpcyB0aGUgZmlsZUNsYXNzXG4gICAgICAgIFsuLi50aGlzLmZpbGVDbGFzc2VzQW5jZXN0b3JzXS5mb3JFYWNoKChbZmlsZUNsYXNzTmFtZSwgYW5jZXN0b3JzXSkgPT4ge1xuICAgICAgICAgICAgaWYgKGFuY2VzdG9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nZXRBbmNlc3RvcnNSZWN1cnNpdmVseShmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuXG4gICAgZ2V0QW5jZXN0b3JzUmVjdXJzaXZlbHkoZmlsZUNsYXNzTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGFuY2VzdG9ycyA9IHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMuZ2V0KGZpbGVDbGFzc05hbWUpXG4gICAgICAgIGlmIChhbmNlc3RvcnMgJiYgYW5jZXN0b3JzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgbGFzdEFuY2VzdG9yID0gYW5jZXN0b3JzLmxhc3QoKTtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RBbmNlc3RvclBhcmVudCA9IHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMuZ2V0KGxhc3RBbmNlc3RvciEpPy5bMF07XG4gICAgICAgICAgICBpZiAobGFzdEFuY2VzdG9yUGFyZW50ICYmIGxhc3RBbmNlc3RvclBhcmVudCAhPT0gZmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzZXNBbmNlc3RvcnMuc2V0KGZpbGVDbGFzc05hbWUsIFsuLi5hbmNlc3RvcnMsIGxhc3RBbmNlc3RvclBhcmVudF0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0QW5jZXN0b3JzUmVjdXJzaXZlbHkoZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRHbG9iYWxGaWxlQ2xhc3MoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGdsb2JhbEZpbGVDbGFzcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzc1xuICAgICAgICBpZiAoIWdsb2JhbEZpbGVDbGFzcykge1xuICAgICAgICAgICAgdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzID0gW11cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzID0gRmlsZUNsYXNzXG4gICAgICAgICAgICAgICAgICAgIC5jcmVhdGVGaWxlQ2xhc3MoXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbEZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgLmF0dHJpYnV0ZXMubWFwKGF0dHIgPT4gYXR0ci5nZXRGaWVsZCgpKVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0RmlsZUNsYXNzZXMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNsYXNzRmlsZXNQYXRoID0gdGhpcy5jbGFzc0ZpbGVzUGF0aFxuICAgICAgICBpZiAoY2xhc3NGaWxlc1BhdGgpIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKClcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGYgPT4gZi5wYXRoLmluY2x1ZGVzKGNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChmID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IEZpbGVDbGFzcy5nZXRGaWxlQ2xhc3NOYW1lRnJvbVBhdGgodGhpcy5wbHVnaW4sIGYucGF0aClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gRmlsZUNsYXNzLmNyZWF0ZUZpbGVDbGFzcyh0aGlzLnBsdWdpbiwgZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzRmllbGRzLnNldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUNsYXNzLmF0dHJpYnV0ZXMubWFwKGF0dHIgPT4gYXR0ci5nZXRGaWVsZCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc2VzUGF0aC5zZXQoZi5wYXRoLCBmaWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3Nlc05hbWUuc2V0KGZpbGVDbGFzcy5uYW1lLCBmaWxlQ2xhc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlPy5mcm9udG1hdHRlcj8ubWFwV2l0aFRhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyPy50YWdOYW1lcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX3RhZ05hbWVzID0gY2FjaGU/LmZyb250bWF0dGVyPy50YWdOYW1lcyBhcyBzdHJpbmcgfCBzdHJpbmdbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRhZ05hbWVzID0gQXJyYXkuaXNBcnJheShfdGFnTmFtZXMpID8gWy4uLl90YWdOYW1lc10gOiBfdGFnTmFtZXMuc3BsaXQoXCIsXCIpLm1hcCh0ID0+IHQudHJpbSgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnTmFtZXMuZm9yRWFjaCh0YWcgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFnLmluY2x1ZGVzKFwiIFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzLnNldCh0YWcsIGZpbGVDbGFzcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFmaWxlQ2xhc3NOYW1lLmluY2x1ZGVzKFwiIFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YWdzTWF0Y2hpbmdGaWxlQ2xhc3Nlcy5zZXQoZmlsZUNsYXNzTmFtZSwgZmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycm9yKSBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRMb29rdXBRdWVyaWVzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmlsdGVyKGZpZWxkID0+IGZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5Mb29rdXApLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICAgICAgdGhpcy5sb29rdXBRdWVyaWVzLnNldChgcHJlc2V0RmllbGRfX18ke2ZpZWxkLm5hbWV9YCwgZmllbGQpXG4gICAgICAgIH0pO1xuICAgICAgICBbLi4udGhpcy5maWxlQ2xhc3Nlc0ZpZWxkc10uZm9yRWFjaCgoW2ZpbGVDbGFzc05hbWUsIGZpZWxkc10pID0+IHtcbiAgICAgICAgICAgIGZpZWxkcy5maWx0ZXIoZmllbGQgPT4gZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLkxvb2t1cCkuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb29rdXBRdWVyaWVzLnNldChgJHtmaWxlQ2xhc3NOYW1lfV9fXyR7ZmllbGQubmFtZX1gLCBmaWVsZClcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcmVzb2x2ZUZpbGVDbGFzc01hdGNoaW5nVGFncygpOiB2b2lkIHtcbiAgICAgICAgaWYgKCFbLi4udGhpcy50YWdzTWF0Y2hpbmdGaWxlQ2xhc3Nlc10ubGVuZ3RoKSByZXR1cm5cbiAgICAgICAgLy9BbHRlcm5hdGl2ZSB3YXlcbiAgICAgICAgY29uc3QgbWFwcGVkVGFncyA9IFsuLi50aGlzLnRhZ3NNYXRjaGluZ0ZpbGVDbGFzc2VzLmtleXMoKV1cbiAgICAgICAgY29uc3QgZmlsZXNXaXRoTWFwcGVkVGFnUXVlcnkgPSBtYXBwZWRUYWdzLm1hcCh0ID0+IGAjJHt0fWApLmpvaW4oXCIgb3IgXCIpXG4gICAgICAgIHRoaXMuZHYuYXBpLnBhZ2VzKGZpbGVzV2l0aE1hcHBlZFRhZ1F1ZXJ5KS5mb3JFYWNoKChkdkZpbGU6IGFueSkgPT4ge1xuICAgICAgICAgICAgZHZGaWxlLmZpbGUudGFncy5mb3JFYWNoKChfdGFnOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0YWcgPSBfdGFnLnJlcGxhY2UoL15cXCMvLCBcIlwiKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMudGFnc01hdGNoaW5nRmlsZUNsYXNzZXMuZ2V0KHRhZyk7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBkdkZpbGUuZmlsZS5wYXRoO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc2VzLnNldChmaWxlUGF0aCwgWy4uLm5ldyBTZXQoWy4uLih0aGlzLmZpbGVzRmlsZUNsYXNzZXMuZ2V0KGZpbGVQYXRoKSB8fCBbXSksIGZpbGVDbGFzc10pXSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuc2V0KGR2RmlsZS5maWxlLnBhdGgsIFsuLi5uZXcgU2V0KFsuLi4odGhpcy5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGZpbGVQYXRoKSB8fCBbXSksIGZpbGVDbGFzcy5uYW1lXSldKVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21UYWcgPSB0aGlzLmZpbGVDbGFzc2VzRmllbGRzLmdldChmaWxlQ2xhc3MubmFtZSlcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEZpZWxkcyA9IHRoaXMuZmlsZXNGaWVsZHNGcm9tVGFncy5nZXQoZmlsZVBhdGgpXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21UYWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkcyA9IFsuLi5maWxlRmlsZUNsYXNzZXNGaWVsZHNGcm9tVGFnXVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRDdXJyZW50RmllbGRzID0gY3VycmVudEZpZWxkcz8uZmlsdGVyKGZpZWxkID0+ICFuZXdGaWVsZHMubWFwKGYgPT4gZi5uYW1lKS5pbmNsdWRlcyhmaWVsZC5uYW1lKSkgfHwgW11cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkcy5wdXNoKC4uLmZpbHRlcmVkQ3VycmVudEZpZWxkcylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tVGFncy5zZXQoZmlsZVBhdGgsIG5ld0ZpZWxkcylcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcmVzb2x2ZUZpbGVDbGFzc1F1ZXJpZXMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc1F1ZXJpZXMuZm9yRWFjaChzZmNxID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZjcSA9IG5ldyBGaWxlQ2xhc3NRdWVyeShzZmNxLm5hbWUsIHNmY3EuaWQsIHNmY3EucXVlcnksIHNmY3EuZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgIGZjcS5nZXRSZXN1bHRzKGR2QXBpKS5mb3JFYWNoKChyZXN1bHQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMuZmlsZUNsYXNzZXNOYW1lLmdldChmY3EuZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGYgPSByZXN1bHQuZmlsZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXMuc2V0KGYucGF0aCwgWy4uLm5ldyBTZXQoWy4uLih0aGlzLmZpbGVzRmlsZUNsYXNzZXMuZ2V0KGYucGF0aCkgfHwgW10pLCBmaWxlQ2xhc3NdKV0pXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLnNldChmLnBhdGgsIFsuLi5uZXcgU2V0KFsuLi4odGhpcy5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGYucGF0aCkgfHwgW10pLCBmaWxlQ2xhc3MubmFtZV0pXSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpbGVDbGFzc2VzRmllbGRzRnJvbVF1ZXJ5ID0gdGhpcy5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQoZmNxLmZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVGaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21RdWVyeSkgdGhpcy5maWxlc0ZpZWxkc0Zyb21GaWxlQ2xhc3NRdWVyaWVzLnNldChyZXN1bHQuZmlsZS5wYXRoLCBmaWxlRmlsZUNsYXNzZXNGaWVsZHNGcm9tUXVlcnkpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEZpbGVzRmllbGRzRnJvbUZpbGVDbGFzcygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKVxuICAgICAgICAgICAgLmZpbHRlcihmID0+ICF0aGlzLmNsYXNzRmlsZXNQYXRoXG4gICAgICAgICAgICAgICAgfHwgIWYucGF0aC5pbmNsdWRlcyh0aGlzLmNsYXNzRmlsZXNQYXRoKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmZvckVhY2goZiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpbGVDbGFzc2VzTmFtZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3Nlc0NhY2hlOiBzdHJpbmdbXSB8IHN0cmluZyA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmKT8uZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc11cbiAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzZXNDYWNoZSkge1xuICAgICAgICAgICAgICAgICAgICBBcnJheS5pc0FycmF5KGZpbGVDbGFzc2VzQ2FjaGUpID9cbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVGaWxlQ2xhc3Nlc05hbWVzLnB1c2goLi4uZmlsZUNsYXNzZXNDYWNoZSkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZUZpbGVDbGFzc2VzTmFtZXMucHVzaCguLi5maWxlQ2xhc3Nlc0NhY2hlLnNwbGl0KCcsJykubWFwKGZjbiA9PiBmY24udHJpbSgpKSlcbiAgICAgICAgICAgICAgICAgICAgZmlsZUZpbGVDbGFzc2VzTmFtZXMuZm9yRWFjaChmaWxlRmlsZUNsYXNzTmFtZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSB0aGlzLmZpbGVDbGFzc2VzTmFtZS5nZXQoZmlsZUZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFsuLi5uZXcgU2V0KFsuLi4odGhpcy5maWxlc0ZpbGVDbGFzc2VzLmdldChmLnBhdGgpIHx8IFtdKSwgZmlsZUNsYXNzXSldKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWxlQ2xhc3Nlc05hbWVzLnNldChmLnBhdGgsIFsuLi5uZXcgU2V0KFsuLi4odGhpcy5maWxlc0ZpbGVDbGFzc2VzTmFtZXMuZ2V0KGYucGF0aCkgfHwgW10pLCBmaWxlQ2xhc3MubmFtZV0pXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21GaWxlID0gdGhpcy5maWxlQ2xhc3Nlc0ZpZWxkcy5nZXQoZmlsZUZpbGVDbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEZpZWxkcyA9IHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5nZXQoZi5wYXRoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3Nlc0ZpZWxkc0Zyb21GaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0ZpZWxkcyA9IFsuLi5maWxlQ2xhc3Nlc0ZpZWxkc0Zyb21GaWxlXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJlZEN1cnJlbnRGaWVsZHMgPSBjdXJyZW50RmllbGRzPy5maWx0ZXIoZmllbGQgPT4gIW5ld0ZpZWxkcy5tYXAoZiA9PiBmLm5hbWUpLmluY2x1ZGVzKGZpZWxkLm5hbWUpKSB8fCBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5maWx0ZXJlZEN1cnJlbnRGaWVsZHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBuZXdGaWVsZHMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFtdKTsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgdGhpcy5maWxlc0ZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzLnNldChmLnBhdGgsIFtdKTsgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7IHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5zZXQoZi5wYXRoLCBbXSk7IH1cbiAgICAgICAgICAgIH0pXG4gICAgfVxuXG4gICAgZ2V0RmlsZXNGaWVsZHMoKTogdm9pZCB7XG4gICAgICAgIC8qXG4gICAgICAgIFByaW9yaXR5IG9yZGVyOlxuICAgICAgICAxLiBJbm5lciBmaWxlQ2xhc3NcbiAgICAgICAgMi4gVGFnIG1hdGNoXG4gICAgICAgIDMuIGZpbGVDbGFzc1F1ZXJ5IG1hdGNoXG4gICAgICAgIDQuIEdsb2JhbCBmaWxlQ2xhc3NcbiAgICAgICAgNS4gc2V0dGluZ3MgcHJlc2V0IGZpZWxkc1xuICAgICAgICAqL1xuICAgICAgICB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpXG4gICAgICAgICAgICAuZmlsdGVyKGYgPT4gIXRoaXMuY2xhc3NGaWxlc1BhdGggfHwgIWYucGF0aC5pbmNsdWRlcyh0aGlzLmNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgICAgIC5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3NlcyA9IHRoaXMuZmlsZXNGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcy5nZXQoZi5wYXRoKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVGaWVsZHNGcm9tUXVlcnkgPSB0aGlzLmZpbGVzRmllbGRzRnJvbUZpbGVDbGFzc1F1ZXJpZXMuZ2V0KGYucGF0aCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUZpZWxkc0Zyb21UYWcgPSB0aGlzLmZpbGVzRmllbGRzRnJvbVRhZ3MuZ2V0KGYucGF0aCk7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGVGaWVsZHNGcm9tSW5uZXJGaWxlQ2xhc3Nlcz8ubGVuZ3RoIHx8XG4gICAgICAgICAgICAgICAgICAgIGZpbGVGaWVsZHNGcm9tUXVlcnk/Lmxlbmd0aCB8fFxuICAgICAgICAgICAgICAgICAgICBmaWxlRmllbGRzRnJvbVRhZz8ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVzRmllbGRzOiBGaWVsZFtdID0gZmlsZUZpZWxkc0Zyb21Jbm5lckZpbGVDbGFzc2VzIHx8IFtdO1xuICAgICAgICAgICAgICAgICAgICBmaWxlc0ZpZWxkcy5wdXNoKC4uLihmaWxlRmllbGRzRnJvbVRhZyB8fCBbXSkuZmlsdGVyKGZpZWxkID0+ICFmaWxlc0ZpZWxkcy5tYXAoZiA9PiBmLm5hbWUpLmluY2x1ZGVzKGZpZWxkLm5hbWUpKSlcbiAgICAgICAgICAgICAgICAgICAgZmlsZXNGaWVsZHMucHVzaCguLi4oZmlsZUZpZWxkc0Zyb21RdWVyeSB8fCBbXSkuZmlsdGVyKGZpZWxkID0+ICFmaWxlc0ZpZWxkcy5tYXAoZiA9PiBmLm5hbWUpLmluY2x1ZGVzKGZpZWxkLm5hbWUpKSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlc0ZpZWxkcy5zZXQoZi5wYXRoLCBmaWxlc0ZpZWxkcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpZWxkc0Zyb21HbG9iYWxGaWxlQ2xhc3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHMuc2V0KGYucGF0aCwgdGhpcy5maWVsZHNGcm9tR2xvYmFsRmlsZUNsYXNzKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXMuc2V0KGYucGF0aCwgW3RoaXMuZmlsZUNsYXNzZXNOYW1lLmdldCh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MhKSFdKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmlsZUNsYXNzZXNOYW1lcy5zZXQoZi5wYXRoLCBbdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzIV0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLm1hcChwcm9wID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwcm9wZXJ0eSwgcHJvcCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmllbGRzLnNldChmLnBhdGgsIGZpZWxkcylcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIGdldEZpbGVzRmllbGRzRXhpc3RzKGZpbGU/OiBURmlsZSk6IHZvaWQge1xuICAgICAgICBsZXQgZmlsZUZpZWxkczogQXJyYXk8W3N0cmluZywgRmllbGRbXV0+XG4gICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICBmaWxlRmllbGRzID0gW1tmaWxlLnBhdGgsIHRoaXMuZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCkgfHwgW11dXVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmlsZUZpZWxkcyA9IFsuLi50aGlzLmZpbGVzRmllbGRzXVxuICAgICAgICB9XG4gICAgICAgIGZpbGVGaWVsZHMuZm9yRWFjaCgoW2ZpbGVQYXRoLCBmaWVsZHNdKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkdkZpbGUgPSB0aGlzLmR2LmFwaS5wYWdlKGZpbGVQYXRoKVxuICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdGaWVsZHM6IEZpZWxkW10gPSBbXVxuICAgICAgICAgICAgZmllbGRzLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkdkZpbGUgJiYgZHZGaWxlW2ZpZWxkLm5hbWVdICE9PSB1bmRlZmluZWQpIHsgZXhpc3RpbmdGaWVsZHMucHVzaChmaWVsZCkgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGlmIChleGlzdGluZ0ZpZWxkcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVzRmllbGRzRXhpc3RzLnNldChmaWxlUGF0aCwgZXhpc3RpbmdGaWVsZHMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNGaWVsZHNFeGlzdHMuZGVsZXRlKGZpbGVQYXRoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBOb3RpY2UsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmNsYXNzIEZpbGVDbGFzc1F1ZXJ5IHtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgbmFtZTogc3RyaW5nID0gXCJcIixcbiAgICAgICAgcHVibGljIGlkOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICBwdWJsaWMgcXVlcnk6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIHB1YmxpYyBmaWxlQ2xhc3NOYW1lOiBzdHJpbmcgPSBcIlwiXG4gICAgKSB7IH07XG5cbiAgICAvL0B0cy1pZ25vcmVcbiAgICBwdWJsaWMgZ2V0UmVzdWx0cyhhcGk6IERhdGF2aWV3UGx1Z2luW1wiYXBpXCJdKTogYW55IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgYHJldHVybiAke3RoaXMucXVlcnl9YCkpKGFwaSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFdyb25nIHF1ZXJ5IGZvciA8JHt0aGlzLm5hbWV9Pi4gQ2hlY2sgeW91ciBzZXR0aW5nc2ApO1xuICAgICAgICAgICAgcmV0dXJuIFtdXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHVibGljIG1hdGNoRmlsZShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuXG4gICAgICAgIGNvbnN0IGRhdGF2aWV3ID0gYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlld1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKHRoaXMucXVlcnkgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZURhdGF2aWV3SnMgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZUlubGluZURhdGF2aWV3SnMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZXNQYXRoID0gdGhpcy5nZXRSZXN1bHRzKGRhdGF2aWV3LmFwaSkudmFsdWVzLm1hcCgodjogYW55KSA9PiB2LmZpbGUucGF0aCkgYXMgc3RyaW5nW11cbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsZXNQYXRoLmluY2x1ZGVzKGZpbGUucGF0aCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHN0YXRpYyBjb3B5UHJvcGVydHkodGFyZ2V0OiBGaWxlQ2xhc3NRdWVyeSwgc291cmNlOiBGaWxlQ2xhc3NRdWVyeSkge1xuICAgICAgICB0YXJnZXQuaWQgPSBzb3VyY2UuaWQ7XG4gICAgICAgIHRhcmdldC5uYW1lID0gc291cmNlLm5hbWU7XG4gICAgICAgIHRhcmdldC5xdWVyeSA9IHNvdXJjZS5xdWVyeTtcbiAgICAgICAgdGFyZ2V0LmZpbGVDbGFzc05hbWUgPSBzb3VyY2UuZmlsZUNsYXNzTmFtZVxuICAgIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBGaWxlQ2xhc3NRdWVyeTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBTdGF0dXMgfSBmcm9tIFwic3JjL3R5cGVzL2xvb2t1cFR5cGVzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNvbHZlTG9va3VwcyhwbHVnaW46IE1ldGFkYXRhTWVudSwgc291cmNlOiBzdHJpbmcgPSBcIlwiKTogdm9pZCB7XG4gICAgY29uc3QgZiA9IHBsdWdpbi5maWVsZEluZGV4O1xuICAgIC8vZmlyc3QgcmVzb2x2ZSBhbGwgZXhpc3RpbmcgbG9va3VwIHF1ZXJpZXMgZnJvbSB0aGVpciBkZWZpbml0aW9ucyBpbiBmaWxlQ2xhc3NlcyBhbmQgc2V0dGluZ3NcbiAgICBjb25zdCBsb29rdXBRdWVyeVJlc3VsdHM6IE1hcDxzdHJpbmcsIGFueVtdPiA9IG5ldyBNYXAoKTtcbiAgICBbLi4uZi5sb29rdXBRdWVyaWVzXS5mb3JFYWNoKChbbG9va3VwTmFtZSwgZmllbGRdKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5UmVsYXRlZERWRmlsZXMgPSAobmV3IEZ1bmN0aW9uKFwiZHZcIiwgYHJldHVybiAke2ZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZ31gKSkoZi5kdi5hcGkpLnZhbHVlcyBhcyBBcnJheTxhbnk+O1xuICAgICAgICBsb29rdXBRdWVyeVJlc3VsdHMuc2V0KGxvb2t1cE5hbWUsIHF1ZXJ5UmVsYXRlZERWRmlsZXMpO1xuXG4gICAgfSk7XG4gICAgLy90aGVuIGFzc2lnbiByZXN1bHRzIHRvIGFsbCBmaWxlcyBoYXZpbmcgaW1wbGVtZW50ZWQgYSBsb29rdXBmaWVsZFxuICAgIFsuLi5mLmZpbGVzRmllbGRzRXhpc3RzXS5mb3JFYWNoKChbZmlsZVBhdGgsIGZpZWxkc10pID0+IHtcbiAgICAgICAgZmllbGRzLmZpbHRlcihmaWVsZCA9PiBmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuTG9va3VwKS5mb3JFYWNoKGxvb2t1cEZpZWxkID0+IHtcbiAgICAgICAgICAgIC8vZm9yIGFsbCBsb29rdXAgZmllbGRzIGluIGZpbGVzIHRoYXQgaGF2ZSBsb29rdXBmaWVsZHM6XG4gICAgICAgICAgICAvLzEuIGdldCB0aGUgcXVlcnkgcmVzdWx0c1xuICAgICAgICAgICAgY29uc3QgcXVlcnlSZWxhdGVkRFZGaWxlcyA9IGxvb2t1cFF1ZXJ5UmVzdWx0cy5nZXQoYCR7bG9va3VwRmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X19fJHtsb29rdXBGaWVsZC5uYW1lfWApIHx8IFtdO1xuICAgICAgICAgICAgLy8yLiBmaWx0ZXIgdGhvc2UgcmVzdWx0cyBieSB0aGVpciB0YXJnZXRGaWVsZCBjb250ZW50IGluY2x1ZGluZyB0aGlzIGZpbGUgLy9cbiAgICAgICAgICAgIGNvbnN0IGZpbGVSZWxhdGVkRFZGaWxlcyA9IHF1ZXJ5UmVsYXRlZERWRmlsZXMuZmlsdGVyKGR2RmlsZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSBkdkZpbGVbbG9va3VwRmllbGQub3B0aW9ucy50YXJnZXRGaWVsZE5hbWVdO1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRhcmdldFZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0VmFsdWUuZmlsdGVyKHYgPT4gZi5kdi5hcGkudmFsdWUuaXNMaW5rKHYpKS5tYXAodiA9PiB2LnBhdGgpLmluY2x1ZGVzKGZpbGVQYXRoKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRWYWx1ZT8ucGF0aCA9PT0gZmlsZVBhdGhcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy8zLiBhc3NpZ24gdGhvc2UgcmVzdWx0cyB0byBmaWxlTG9va3VwRmlsZXNcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0ZWRGaWVsZE5hbWUgPSBgJHtmaWxlUGF0aH1fX3JlbGF0ZWRfXyR7bG9va3VwRmllbGQuZmlsZUNsYXNzTmFtZSB8fCBcInByZXNldEZpZWxkXCJ9X19fJHtsb29rdXBGaWVsZC5uYW1lfWBcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRmlsZUxvb2t1cEZpZWxkcyA9IGYuZmlsZUxvb2t1cEZpbGVzLmdldChyZWxhdGVkRmllbGROYW1lKVxuICAgICAgICAgICAgZi5maWxlTG9va3VwRmlsZXMuc2V0KHJlbGF0ZWRGaWVsZE5hbWUsIGZpbGVSZWxhdGVkRFZGaWxlcylcbiAgICAgICAgICAgIC8vNC4gcmVzZXQgUHJldmlvdXMgcmVzdWx0cyBjb3VudCB0byBjdXJyZW50IHZhbHVlXG4gICAgICAgICAgICBpZiAoIShmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuZ2V0KGAke2ZpbGVQYXRofV9fJHtsb29rdXBGaWVsZC5uYW1lfWApID09PSBTdGF0dXMuY2hhbmdlZCkpIGYucHJldmlvdXNGaWxlTG9va3VwRmlsZXNWYWx1ZXMuc2V0KHJlbGF0ZWRGaWVsZE5hbWUsIChleGlzdGluZ0ZpbGVMb29rdXBGaWVsZHMgfHwgZmlsZVJlbGF0ZWREVkZpbGVzKS5sZW5ndGgpXG4gICAgICAgICAgICAvLzUuIGNoYW5nZSB0aGUgc3RhdHVzIG9mIHRoaXMgbG9va3VwIGZpZWxkXG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuc2V0KGAke2ZpbGVQYXRofV9fJHtsb29rdXBGaWVsZC5uYW1lfWAsIFN0YXR1cy5jaGFuZ2VkKVxuICAgICAgICB9KVxuICAgIH0pXG4gICAgLy9yZW1vdmUgbm9uIGV4aXN0aW5nIGxvb2t1cCBmaWVsZHMgZnJvbSBpbmRleCwgc2luY2UgdGhvc2UgaW5kZXhlcyBhcmVuJ3QgZmx1c2hlZCBlYWNoIHRpbWVcbiAgICBmb3IgKGxldCBpZCBvZiBmLmZpbGVMb29rdXBGaWxlcy5rZXlzKCkpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hSZWdleCA9IC8oPzxmaWxlUGF0aD4uKilfX3JlbGF0ZWRfXyg/PGZpbGVDbGFzc05hbWU+LiopX19fKD88ZmllbGROYW1lPi4qKS9cbiAgICAgICAgY29uc3QgeyBmaWxlUGF0aCwgZmlsZUNsYXNzTmFtZSwgZmllbGROYW1lIH0gPSBpZC5tYXRjaChtYXRjaFJlZ2V4KT8uZ3JvdXBzIHx8IHt9XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nTG9va0ZpZWxkV2l0aE5hbWVBbmRGaWxlQ2xhc3NOYW1lID0gZi5maWxlc0ZpZWxkc1xuICAgICAgICAgICAgLmdldChmaWxlUGF0aCk/LmZpbmQoZmllbGQgPT5cbiAgICAgICAgICAgICAgICAoZmllbGQubmFtZSA9PT0gZmllbGROYW1lKSAmJlxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgKGZpZWxkLmZpbGVDbGFzc05hbWUgPT09IHVuZGVmaW5lZCAmJiBmaWxlQ2xhc3NOYW1lID09PSBcInByZXNldEZpZWxkXCIpIHx8XG4gICAgICAgICAgICAgICAgICAgIChmaWVsZC5maWxlQ2xhc3NOYW1lID09PSBmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgY29uc3QgZHZQYWdlID0gZi5kdi5hcGkucGFnZShmaWxlUGF0aCk7XG4gICAgICAgIGlmIChkdlBhZ2UgPT09IHVuZGVmaW5lZCB8fCBkdlBhZ2VbZmllbGROYW1lXSA9PT0gdW5kZWZpbmVkIHx8ICFleGlzdGluZ0xvb2tGaWVsZFdpdGhOYW1lQW5kRmlsZUNsYXNzTmFtZSkge1xuICAgICAgICAgICAgZi5maWxlTG9va3VwRmlsZXMuZGVsZXRlKGlkKTtcbiAgICAgICAgICAgIGYuZmlsZUxvb2t1cEZpZWxkTGFzdFZhbHVlLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZExhc3RPdXRwdXRUeXBlLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLnByZXZpb3VzRmlsZUxvb2t1cEZpbGVzVmFsdWVzLmRlbGV0ZShpZCk7XG4gICAgICAgICAgICBmLmZpbGVMb29rdXBGaWVsZHNTdGF0dXMuZGVsZXRlKGAke2ZpbGVQYXRofV9fJHtmaWVsZE5hbWV9YClcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCIuL3JlcGxhY2VWYWx1ZXNcIjtcblxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYW5SZW1vdmVkRm9ybXVsYXNGcm9tSW5kZXgoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbik6IHZvaWQge1xuICAgIGNvbnN0IGYgPSBwbHVnaW4uZmllbGRJbmRleDtcbiAgICBmb3IgKGxldCBpZCBvZiBmLmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUua2V5cygpKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoUmVnZXggPSAvKD88ZmlsZVBhdGg+LiopX19jYWxjdWxhdGVkX18oPzxmaWxlQ2xhc3NOYW1lPi4qKV9fXyg/PGZpZWxkTmFtZT4uKikvXG4gICAgICAgIGNvbnN0IHsgZmlsZVBhdGgsIGZpbGVDbGFzc05hbWUsIGZpZWxkTmFtZSB9ID0gaWQubWF0Y2gobWF0Y2hSZWdleCk/Lmdyb3VwcyB8fCB7fVxuICAgICAgICBjb25zdCBleGlzdGluZ0Zvcm11bGFGaWVsZFdpdGhOYW1lQW5kRmlsZUNsYXNzTmFtZSA9IGYuZmlsZXNGaWVsZHNcbiAgICAgICAgICAgIC5nZXQoZmlsZVBhdGgpPy5maW5kKGZpZWxkID0+XG4gICAgICAgICAgICAgICAgKGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSkgJiZcbiAgICAgICAgICAgICAgICAoXG4gICAgICAgICAgICAgICAgICAgIChmaWVsZC5maWxlQ2xhc3NOYW1lID09PSB1bmRlZmluZWQgJiYgZmlsZUNsYXNzTmFtZSA9PT0gXCJwcmVzZXRGaWVsZFwiKSB8fFxuICAgICAgICAgICAgICAgICAgICAoZmllbGQuZmlsZUNsYXNzTmFtZSA9PT0gZmlsZUNsYXNzTmFtZSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgIGNvbnN0IGR2UGFnZSA9IGYuZHYuYXBpLnBhZ2UoZmlsZVBhdGgpO1xuICAgICAgICBpZiAoZHZQYWdlID09PSB1bmRlZmluZWQgfHwgZHZQYWdlW2ZpZWxkTmFtZV0gPT09IHVuZGVmaW5lZCB8fCAhZXhpc3RpbmdGb3JtdWxhRmllbGRXaXRoTmFtZUFuZEZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIGYuZmlsZUZvcm11bGFGaWVsZExhc3RWYWx1ZS5kZWxldGUoaWQpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlRm9ybXVsYXMoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnVcbik6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpXG4gICAgLy9jb25zb2xlLmxvZyhcInN0YXJ0IHVwZGF0ZSBmb3JtdWxhc1wiLCBwbHVnaW4uZmllbGRJbmRleC5sYXN0UmV2aXNpb24sIFwiLT5cIiwgcGx1Z2luLmZpZWxkSW5kZXguZHY/LmFwaS5pbmRleC5yZXZpc2lvbilcbiAgICBjb25zdCBmID0gcGx1Z2luLmZpZWxkSW5kZXg7XG4gICAgbGV0IHJlbmRlcmluZ0Vycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICAvLzEuIGZsYXR0ZW4gYWxsIGZpbGVfX2Zvcm11bGFGaWVsZCBpbiBhIE1hcFxuICAgIGNvbnN0IGZpbGVGb3JtdWxhc0ZpZWxkczogTWFwPHN0cmluZywgRmllbGQ+ID0gbmV3IE1hcCgpO1xuICAgIFsuLi5mLmZpbGVzRmllbGRzRXhpc3RzXS5mb3JFYWNoKChbZmlsZVBhdGgsIGZpZWxkc10pID0+IHtcbiAgICAgICAgZmllbGRzLmZpbHRlcihmaWVsZCA9PiBmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuRm9ybXVsYSkuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICBmaWxlRm9ybXVsYXNGaWVsZHMuc2V0KGAke2ZpbGVQYXRofV9fY2FsY3VsYXRlZF9fJHtmaWVsZC5maWxlQ2xhc3NOYW1lIHx8IFwicHJlc2V0RmllbGRcIn1fX18ke2ZpZWxkLm5hbWV9YCwgZmllbGQpXG4gICAgICAgIH0pXG4gICAgfSk7XG4gICAgLy8yLiBjYWxjdWxhdGUgZm9ybXVsYSBhbmQgdXBkYXRlIGZpbGUgaWYgdmFsdWUgaGFzIGNoYW5nZWRcbiAgICBbLi4uZmlsZUZvcm11bGFzRmllbGRzXS5mb3JFYWNoKGFzeW5jIChbaWQsIGZpZWxkXSkgPT4ge1xuICAgICAgICBjb25zdCBtYXRjaFJlZ2V4ID0gLyg/PGZpbGVQYXRoPi4qKV9fY2FsY3VsYXRlZF9fKD88ZmlsZUNsYXNzTmFtZT4uKilfX18oPzxmaWVsZE5hbWU+LiopL1xuICAgICAgICBjb25zdCB7IGZpbGVQYXRoLCBmaWxlQ2xhc3NOYW1lLCBmaWVsZE5hbWUgfSA9IGlkLm1hdGNoKG1hdGNoUmVnZXgpPy5ncm91cHMgfHwge31cbiAgICAgICAgY29uc3QgZHZGaWxlID0gZi5kdi5hcGkucGFnZShmaWxlUGF0aClcbiAgICAgICAgY29uc3QgY3VycmVudGR2VmFsdWUgPSBkdkZpbGUgJiYgZHZGaWxlW2ZpZWxkLm5hbWVdXG5cbiAgICAgICAgY29uc3QgY3VycmVudFZhbHVlID0gY3VycmVudGR2VmFsdWUgPyBjdXJyZW50ZHZWYWx1ZS50b1N0cmluZygpIDogXCJcIlxuICAgICAgICBmLmZpbGVGb3JtdWxhRmllbGRMYXN0VmFsdWUuc2V0KGlkLCBjdXJyZW50VmFsdWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAobmV3IEZ1bmN0aW9uKFwiY3VycmVudCwgZHZcIiwgYHJldHVybiAke2ZpZWxkLm9wdGlvbnMuZm9ybXVsYX1gKSkoZHZGaWxlLCBmLmR2LmFwaSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGlmICgoIWN1cnJlbnRWYWx1ZSAmJiBuZXdWYWx1ZSAhPT0gXCJcIikgfHwgY3VycmVudFZhbHVlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHBsdWdpbi5maWxlVGFza01hbmFnZXIucHVzaFRhc2soKCkgPT4gcmVwbGFjZVZhbHVlcyhwbHVnaW4sIGZpbGVQYXRoLCBmaWVsZC5uYW1lLCBuZXdWYWx1ZSkpO1xuICAgICAgICAgICAgICAgIGYuZmlsZUZvcm11bGFGaWVsZExhc3RWYWx1ZS5zZXQoaWQsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICBpZiAocmVuZGVyaW5nRXJyb3JzLmluY2x1ZGVzKGZpZWxkLm5hbWUpKSByZW5kZXJpbmdFcnJvcnMucHVzaChmaWVsZC5uYW1lKVxuICAgICAgICB9XG4gICAgfSlcbiAgICBpZiAocmVuZGVyaW5nRXJyb3JzLmxlbmd0aCkgbmV3IE5vdGljZShgVGhvc2UgZmllbGRzIGhhdmUgaW5jb3JyZWN0IG91dHB1dCByZW5kZXJpbmcgZnVuY3Rpb25zOlxcbiR7cmVuZGVyaW5nRXJyb3JzLmpvaW4oXCIsXFxuXCIpfWApO1xuICAgIC8vY29uc29sZS5sb2coXCJmaW5pc2hlZCB1cGRhdGUgZm9ybXVsYXNcIiwgcGx1Z2luLmZpZWxkSW5kZXgubGFzdFJldmlzaW9uLCBcIi0+XCIsIHBsdWdpbi5maWVsZEluZGV4LmR2Py5hcGkuaW5kZXgucmV2aXNpb24sIGAkeyhEYXRlLm5vdygpIC0gc3RhcnQpfW1zYClcbiAgICAvLzMgcmVtb3ZlIG5vbiBleGlzdGluZyBmb3JtdWxhIGZpZWxkcyBmcm9tIGluZGV4LCBzaW5jZSB0aG9zZSBpbmRleGVzIGFyZW4ndCBmbHVzaGVkIGVhY2ggdGltZVxuICAgIGNsZWFuUmVtb3ZlZEZvcm11bGFzRnJvbUluZGV4KHBsdWdpbik7XG59XG4iLCAiaW1wb3J0IHsgQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnO1xuXG5cbmV4cG9ydCBjbGFzcyBUYXNrIHtcbiAgICBwdWJsaWMgc3RhdHVzOiBcInBlbmRpbmdcIiB8IFwib25nb2luZ1wiIHwgXCJkb25lXCI7XG4gICAgcHVibGljIGlkOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZm46ICgpID0+IGFueSkge1xuICAgICAgICB0aGlzLnN0YXR1cyA9IFwicGVuZGluZ1wiXG4gICAgICAgIHRoaXMuaWQgPSB1dWlkdjQoKVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZVRhc2tNYW5hZ2VyIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIHB1YmxpYyBxdWV1ZTogTWFwPHN0cmluZywgVGFzaz47XG4gICAgcHVibGljIGJ1c3k6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHB1YmxpYyBjYWNoZVZlcnNpb246IHN0cmluZywgcHVibGljIG9uQ2hhbmdlOiAoKSA9PiB2b2lkKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMucXVldWUgPSBuZXcgTWFwKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdyZXNvbHZlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJvYnNpZGlhbiByZXNvbHZlZFwiKTtcbiAgICAgICAgICAgIHRoaXMuYnVzeSA9IGZhbHNlO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5leGVjdXRlTmV4dCgpO1xuICAgICAgICB9KSlcbiAgICB9XG5cblxuICAgIHB1YmxpYyBhc3luYyBwdXNoVGFzayhmbjogKCkgPT4gYW55KSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSBuZXcgVGFzayhmbik7XG4gICAgICAgIHRoaXMucXVldWUuc2V0KHRhc2suaWQsIHRhc2spO1xuICAgICAgICBpZiAoIXRoaXMuYnVzeSkgYXdhaXQgdGhpcy5leGVjdXRlTmV4dCgpO1xuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBleGVjdXRlTmV4dCgpIHtcbiAgICAgICAgY29uc3QgW2ZpcnN0VGFza0luUXVldWVJZCwgZmlyc3RUYXNrSW5RdWV1ZV0gPSBbLi4udGhpcy5xdWV1ZV1bMF0gfHwgW3VuZGVmaW5lZCwgdW5kZWZpbmVkXVxuICAgICAgICBpZiAoZmlyc3RUYXNrSW5RdWV1ZSAmJiAhdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuaW5Qcm9ncmVzc1Rhc2tDb3VudCkge1xuICAgICAgICAgICAgdGhpcy5idXN5ID0gdHJ1ZTtcbiAgICAgICAgICAgIGZpcnN0VGFza0luUXVldWUuc3RhdHVzID0gXCJvbmdvaW5nXCJcbiAgICAgICAgICAgIGF3YWl0IGZpcnN0VGFza0luUXVldWUuZm4oKVxuICAgICAgICAgICAgZmlyc3RUYXNrSW5RdWV1ZS5zdGF0dXMgPSBcImRvbmVcIlxuICAgICAgICAgICAgdGhpcy5xdWV1ZS5kZWxldGUoZmlyc3RUYXNrSW5RdWV1ZUlkKVxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImRvbmU6IFwiLCBmaXJzdFRhc2tJblF1ZXVlSWQpXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwicmVtYWluaW5nXCIsIFsuLi50aGlzLnF1ZXVlXS5sZW5ndGgpXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuaW5Qcm9ncmVzc1Rhc2tDb3VudCkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgd2FpdCAuLi4gJHt0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5pblByb2dyZXNzVGFza0NvdW50fSB0YXNrcyBpbiBwcm9ncmVzc2ApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwibm90aGluZyBlbHNlIHRvIGRvXCIpXG4gICAgICAgIH1cbiAgICB9XG59IiwgIi8vIFVuaXF1ZSBJRCBjcmVhdGlvbiByZXF1aXJlcyBhIGhpZ2ggcXVhbGl0eSByYW5kb20gIyBnZW5lcmF0b3IuIEluIHRoZSBicm93c2VyIHdlIHRoZXJlZm9yZVxuLy8gcmVxdWlyZSB0aGUgY3J5cHRvIEFQSSBhbmQgZG8gbm90IHN1cHBvcnQgYnVpbHQtaW4gZmFsbGJhY2sgdG8gbG93ZXIgcXVhbGl0eSByYW5kb20gbnVtYmVyXG4vLyBnZW5lcmF0b3JzIChsaWtlIE1hdGgucmFuZG9tKCkpLlxubGV0IGdldFJhbmRvbVZhbHVlcztcbmNvbnN0IHJuZHM4ID0gbmV3IFVpbnQ4QXJyYXkoMTYpO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcm5nKCkge1xuICAvLyBsYXp5IGxvYWQgc28gdGhhdCBlbnZpcm9ubWVudHMgdGhhdCBuZWVkIHRvIHBvbHlmaWxsIGhhdmUgYSBjaGFuY2UgdG8gZG8gc29cbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAvLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG8gaW1wbGVtZW50YXRpb24uXG4gICAgZ2V0UmFuZG9tVmFsdWVzID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcblxuICAgIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59IiwgImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIChieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXSkudG9Mb3dlckNhc2UoKTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZ2lmaWVkIFVVSUQgaXMgaW52YWxpZCcpO1xuICB9XG5cbiAgcmV0dXJuIHV1aWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHN0cmluZ2lmeTsiLCAiY29uc3QgcmFuZG9tVVVJRCA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5yYW5kb21VVUlEICYmIGNyeXB0by5yYW5kb21VVUlELmJpbmQoY3J5cHRvKTtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgcmFuZG9tVVVJRFxufTsiLCAiaW1wb3J0IG5hdGl2ZSBmcm9tICcuL25hdGl2ZS5qcyc7XG5pbXBvcnQgcm5nIGZyb20gJy4vcm5nLmpzJztcbmltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgaWYgKG5hdGl2ZS5yYW5kb21VVUlEICYmICFidWYgJiYgIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmF0aXZlLnJhbmRvbVVVSUQoKTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBjb25zdCBybmRzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IHJuZykoKTsgLy8gUGVyIDQuNCwgc2V0IGJpdHMgZm9yIHZlcnNpb24gYW5kIGBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkYFxuXG4gIHJuZHNbNl0gPSBybmRzWzZdICYgMHgwZiB8IDB4NDA7XG4gIHJuZHNbOF0gPSBybmRzWzhdICYgMHgzZiB8IDB4ODA7IC8vIENvcHkgYnl0ZXMgdG8gYnVmZmVyLCBpZiBwcm92aWRlZFxuXG4gIGlmIChidWYpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgYnVmW29mZnNldCArIGldID0gcm5kc1tpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmO1xuICB9XG5cbiAgcmV0dXJuIHVuc2FmZVN0cmluZ2lmeShybmRzKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdjQ7IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCBjaG9vc2VTZWN0aW9uTW9kYWwgZnJvbSBcInNyYy9tb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCI7XG5pbXBvcnQgeyBzZXRJY29uLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5mdW5jdGlvbiBidWlsZEFuZE9wZW5Nb2RhbChcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBmaWxlOiBURmlsZSxcbiAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuKTogdm9pZCB7XG4gICAgaWYgKGF0dHJzPy5vcHRpb25zPy5pbkZyb250bWF0dGVyICYmIHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZShmaWxlLnBhdGgpPy5mcm9udG1hdHRlcikge1xuICAgICAgICBjb25zdCBsaW5lTnVtYmVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKGZpbGUucGF0aCkhLmZyb250bWF0dGVyIS5wb3NpdGlvbi5lbmQubGluZSAtIDFcbiAgICAgICAgRi5vcGVuRmllbGRNb2RhbChwbHVnaW4sIGZpbGUsIGZpZWxkTmFtZSwgXCJcIiwgbGluZU51bWJlciwgdHJ1ZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKFxuICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgZmlsZSxcbiAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICBhZnRlcjogYm9vbGVhbixcbiAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgYXNDb21tZW50OiBib29sZWFuXG4gICAgICAgICAgICApID0+IEYub3BlbkZpZWxkTW9kYWwoXG4gICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgZmllbGROYW1lLFxuICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgbGluZU51bWJlcixcbiAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyLFxuICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgIGFzTGlzdCxcbiAgICAgICAgICAgICAgICBhc0NvbW1lbnRcbiAgICAgICAgICAgIClcbiAgICAgICAgKS5vcGVuKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVEdkZpZWxkKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGR2OiBhbnksXG4gICAgcDogYW55LFxuICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuKTogdm9pZCB7XG4gICAgY29uc3QgZmllbGQgPSBwbHVnaW4uZmllbGRJbmRleC5maWxlc0ZpZWxkcy5nZXQocC5maWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICBpZiAoZmllbGQ/LnR5cGUpIHtcbiAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXShwbHVnaW4sIGZpZWxkKTtcbiAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUR2RmllbGQoZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gRi5jcmVhdGVEZWZhdWx0KHBsdWdpbiwgZmllbGROYW1lKTtcbiAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUR2RmllbGQoZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmllbGRNb2RpZmllcihcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICBkdjogYW55LFxuICAgIHA6IGFueSxcbiAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuKTogSFRNTEVsZW1lbnQge1xuXG4gICAgLyogZmllbGRDb250YWluZXIqL1xuICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCA9IGR2LmVsKFwiZGl2XCIsIFwiXCIpXG4gICAgZmllbGRDb250YWluZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1jb250YWluZXJcIilcblxuICAgIC8qIGNyZWF0ZSBmaWVsZE1vZGlmaWVyIGRlcGVuZGluZyBvbiBmaWxlQ2xhc3MgdHlwZSBvciBwcmVzZXQgdmFsdWUqL1xuXG4gICAgaWYgKHBbZmllbGROYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghYXR0cnM/Lm9wdGlvbnM/LnNob3dBZGRGaWVsZCkge1xuICAgICAgICAgICAgY29uc3QgZW1wdHlGaWVsZCA9IGR2LmVsKFwic3BhblwiLCBudWxsLCBhdHRycyk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChlbXB0eUZpZWxkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGFkZEZpZWxkQnRuID0gZHYuZWwoXCJidXR0b25cIiwgYXR0cnMpO1xuICAgICAgICAgICAgc2V0SWNvbihhZGRGaWVsZEJ0biwgXCJwbHVzLXdpdGgtY2lyY2xlXCIpXG4gICAgICAgICAgICBhZGRGaWVsZEJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHAuZmlsZS5wYXRoKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gcGx1Z2luLmZpZWxkSW5kZXguZmlsZXNGaWVsZHMuZ2V0KGZpbGUucGF0aCk/LmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gZmllbGROYW1lKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkQW5kT3Blbk1vZGFsKHBsdWdpbiwgZmlsZSwgZmllbGROYW1lLCBhdHRycylcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyOiBudW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyOiBib29sZWFuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3Q6IGJvb2xlYW4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudDogYm9vbGVhblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgPT4gRi5vcGVuRmllbGRNb2RhbChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmVOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc0xpc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzQ29tbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICAgICAgICAgICAgICApLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChhZGRGaWVsZEJ0bik7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocC5maWxlLnBhdGgpXG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUR2RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGRDb250YWluZXIsIGZpZWxkTmFtZSwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChwbHVnaW4sIGZpZWxkTmFtZSk7XG4gICAgICAgICAgICAgICAgZmllbGRNYW5hZ2VyLmNyZWF0ZUR2RmllbGQoZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkQ29udGFpbmVyXG59OyAiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdlbnVpbmVLZXlzIH0gZnJvbSBcInNyYy91dGlscy9kYXRhdmlld1V0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWVsZEluZm8ge1xuICAgIHByb3RlY3RlZCB0eXBlPzogRmllbGRUeXBlID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBzb3VyY2VUeXBlPzogXCJmaWxlQ2xhc3NcIiB8IFwic2V0dGluZ3NcIiA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgZmlsZUNsYXNzPzogc3RyaW5nID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB8IHN0cmluZ1tdID0gdW5kZWZpbmVkO1xuICAgIHByb3RlY3RlZCBpc1ZhbGlkPzogYm9vbGVhbiA9IHVuZGVmaW5lZDtcbiAgICBwcm90ZWN0ZWQgaWdub3JlSW5NZW51OiBib29sZWFuXG4gICAgcHJvdGVjdGVkIHZhbHVlOiBzdHJpbmcgPSBcIlwiO1xuICAgIHByb3RlY3RlZCB2YWx1ZXNMaXN0Tm90ZVBhdGg/OiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgcHVibGljIHVuaXF1ZTogYm9vbGVhbiA9IHRydWVcblxuICAgIHB1YmxpYyBzZXRJbmZvcyhcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGZpbGU6IFRGaWxlLFxuICAgICAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICAgICAgdmFsdWU6IHN0cmluZyxcbiAgICAgICAgbWF0Y2hpbmdGaWxlQ2xhc3NRdWVyeT86IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgICk6IHZvaWQge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuaWdub3JlSW5NZW51ID0gcGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpO1xuICAgICAgICBjb25zdCBmaWVsZCA9IHBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChmaWxlLnBhdGgpPy5maW5kKGZpZWxkID0+IGZpZWxkLm5hbWUgPT09IGZpZWxkTmFtZSlcbiAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKHBsdWdpbiwgZmllbGQpO1xuICAgICAgICAgICAgdGhpcy5pc1ZhbGlkID0gZmllbGRNYW5hZ2VyLnZhbGlkYXRlVmFsdWUodmFsdWUpXG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IGZpZWxkLmZpbGVDbGFzc05hbWU7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSBmaWVsZC50eXBlO1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9IGZpZWxkLmZpbGVDbGFzc05hbWUgPyBcImZpbGVDbGFzc1wiIDogXCJzZXR0aW5nc1wiXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWxlRmllbGRzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlT3JmaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcpOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+IHtcbiAgICAvKlxuICAgIHJldHVybnMgYWxsIGZpZWxkcyB3aXRoIHNvdXJjZSwgdHlwZSwgb3B0aW9ucywgaXNWYWxpZCwgaWdub3JlZFxuICAgICovXG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JmaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JmaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVPcmZpbGVQYXRoKVxuICAgICAgICBpZiAoX2ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBfZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBmaWxlID0gX2ZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInBhdGggZG9lc24ndCBjb3JyZXNwb25kIHRvIGEgcHJvcGVyIGZpbGVcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZmllbGRzOiBSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+ID0ge31cbiAgICBjb25zdCBkdkFwaSA9IHBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBpZiAoZHZBcGkpIHtcbiAgICAgICAgY29uc3QgZHZGaWxlID0gZHZBcGkucGFnZShmaWxlLnBhdGgpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBnZW51aW5lS2V5cyhkdkZpbGUpLmZvckVhY2goYXN5bmMga2V5ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ICE9PSBcImZpbGVcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBuZXcgRmllbGRJbmZvO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZEluZm8udW5pcXVlID0gIU9iamVjdC5rZXlzKGZpZWxkcykuaW5jbHVkZXMoa2V5KTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzW2tleV0gPSBmaWVsZEluZm87XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkSW5mby5zZXRJbmZvcyhwbHVnaW4sIGZpbGUsIGtleSwgZHZGaWxlW2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpZWxkcztcbn0iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgeyBnZXRWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9nZXRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IGZpZWxkTW9kaWZpZXIgfSBmcm9tIFwiLi9jb21tYW5kcy9maWVsZE1vZGlmaWVyXCI7XG5pbXBvcnQgeyBmaWxlRmllbGRzLCBGaWVsZEluZm8gfSBmcm9tIFwiLi9jb21tYW5kcy9maWxlRmllbGRzXCI7XG5pbXBvcnQgeyBpbnNlcnRNaXNzaW5nRmllbGRzIH0gZnJvbSBcIi4vY29tbWFuZHMvaW5zZXJ0TWlzc2luZ0ZpZWxkc1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIElNZXRhZGF0YU1lbnVBcGkge1xuICAgIGdldFZhbHVlczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nW10+O1xuICAgIHJlcGxhY2VWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuICAgIGluc2VydFZhbHVlczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgZmllbGROYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCBhZnRlcj86IGJvb2xlYW4sIGFzTGlzdD86IGJvb2xlYW4sIGFzQ29tbWVudD86IGJvb2xlYW4pID0+IFByb21pc2U8dm9pZD5cbiAgICBmaWxlRmllbGRzOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nKSA9PiBQcm9taXNlPFJlY29yZDxzdHJpbmcsIEZpZWxkSW5mbz4+O1xuICAgIGZpZWxkTW9kaWZpZXI6IChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gSFRNTEVsZW1lbnQ7XG4gICAgaW5zZXJ0TWlzc2luZ0ZpZWxkczogKGZpbGVPckZpbGVQYXRoOiBzdHJpbmcgfCBURmlsZSwgbGluZU51bWJlcjogbnVtYmVyLCBpbkZyb250bWF0dGVyOiBib29sZWFuLCBhZnRlcjogYm9vbGVhbiwgYXNMaXN0OiBib29sZWFuLCBhc0NvbW1lbnQ6IGJvb2xlYW4sIGZpbGVDbGFzc05hbWU/OiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD5cbn1cblxuZXhwb3J0IGNsYXNzIE1ldGFkYXRhTWVudUFwaSB7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51KSB7IH1cblxuICAgIHB1YmxpYyBtYWtlKCk6IElNZXRhZGF0YU1lbnVBcGkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0VmFsdWVzOiB0aGlzLmdldFZhbHVlcygpLFxuICAgICAgICAgICAgcmVwbGFjZVZhbHVlczogdGhpcy5yZXBsYWNlVmFsdWVzKCksXG4gICAgICAgICAgICBpbnNlcnRWYWx1ZXM6IHRoaXMuaW5zZXJ0VmFsdWVzKCksXG4gICAgICAgICAgICBmaWVsZE1vZGlmaWVyOiB0aGlzLmZpZWxkTW9kaWZpZXIoKSxcbiAgICAgICAgICAgIGZpbGVGaWVsZHM6IHRoaXMuZmlsZUZpZWxkcygpLFxuICAgICAgICAgICAgaW5zZXJ0TWlzc2luZ0ZpZWxkczogdGhpcy5pbnNlcnRNaXNzaW5nRmllbGRzKClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldFZhbHVlcygpOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZykgPT4gUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpID0+IGdldFZhbHVlcyh0aGlzLnBsdWdpbiwgZmlsZU9yRmlsZVBhdGgsIGF0dHJpYnV0ZSlcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlcGxhY2VWYWx1ZXMoKTogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpID0+IGF3YWl0IHRoaXMucGx1Z2luLmZpbGVUYXNrTWFuYWdlci5wdXNoVGFzaygoKSA9PiB7IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGVPckZpbGVQYXRoLCBhdHRyaWJ1dGUsIGlucHV0KSB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgaW5zZXJ0VmFsdWVzKCk6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKSA9PiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIGFzeW5jIChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgYWZ0ZXI/OiBib29sZWFuLCBhc0xpc3Q/OiBib29sZWFuLCBhc0NvbW1lbnQ/OiBib29sZWFuKSA9PiBhd2FpdCB0aGlzLnBsdWdpbi5maWxlVGFza01hbmFnZXIucHVzaFRhc2soKCkgPT4geyBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4sIGZpbGVPckZpbGVQYXRoLCBmaWVsZE5hbWUsIHZhbHVlLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQpIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaWVsZE1vZGlmaWVyKCk6IChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzPzogc3RyaW5nLCBhdHRyPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gSFRNTEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gKGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM/OiBzdHJpbmcsIGF0dHI/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSA9PiBmaWVsZE1vZGlmaWVyKHRoaXMucGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBhdHRycylcbiAgICB9XG5cbiAgICBwcml2YXRlIGZpbGVGaWVsZHMoKTogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+PiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nKSA9PiBmaWxlRmllbGRzKHRoaXMucGx1Z2luLCBmaWxlT3JGaWxlUGF0aClcbiAgICB9XG5cbiAgICBwcml2YXRlIGluc2VydE1pc3NpbmdGaWVsZHMoKTogKGZpbGVPckZpbGVQYXRoOiBzdHJpbmcgfCBURmlsZSwgbGluZU51bWJlcjogbnVtYmVyLCBpbkZyb250bWF0dGVyOiBib29sZWFuLCBhZnRlcjogYm9vbGVhbiwgYXNMaXN0OiBib29sZWFuLCBhc0NvbW1lbnQ6IGJvb2xlYW4sIGZpbGVDbGFzc05hbWU/OiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBzdHJpbmcgfCBURmlsZSwgbGluZU51bWJlcjogbnVtYmVyLCBpbkZyb250bWF0dGVyOiBib29sZWFuLCBhZnRlcjogYm9vbGVhbiwgYXNMaXN0OiBib29sZWFuLCBhc0NvbW1lbnQ6IGJvb2xlYW4sIGZpbGVDbGFzc05hbWU/OiBzdHJpbmcpID0+IGluc2VydE1pc3NpbmdGaWVsZHModGhpcy5wbHVnaW4sIGZpbGVPckZpbGVQYXRoLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCBhZnRlciwgYXNMaXN0LCBhc0NvbW1lbnQsIGZpbGVDbGFzc05hbWUpXG4gICAgfVxufSIsICJpbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NRdWVyeVwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1ldGFkYXRhTWVudVNldHRpbmdzIHtcblx0cHJlc2V0RmllbGRzOiBBcnJheTxGaWVsZD47XG5cdGZpbGVDbGFzc1F1ZXJpZXM6IEFycmF5PEZpbGVDbGFzc1F1ZXJ5Pjtcblx0ZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnU6IGJvb2xlYW47XG5cdGdsb2JhbGx5SWdub3JlZEZpZWxkczogQXJyYXk8c3RyaW5nPjtcblx0Y2xhc3NGaWxlc1BhdGg6IHN0cmluZyB8IG51bGw7XG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiBib29sZWFuO1xuXHRmaWxlQ2xhc3NBbGlhczogc3RyaW5nO1xuXHRzZXR0aW5nc1ZlcnNpb24/OiBudW1iZXI7XG5cdGdsb2JhbEZpbGVDbGFzcz86IHN0cmluZztcblx0Zmlyc3REYXlPZldlZWs6IG51bWJlcjtcblx0ZW5hYmxlTGlua3M6IGJvb2xlYW47XG5cdGVuYWJsZVRhYkhlYWRlcjogYm9vbGVhbjtcblx0ZW5hYmxlRWRpdG9yOiBib29sZWFuO1xuXHRlbmFibGVCYWNrbGlua3M6IGJvb2xlYW47XG5cdGVuYWJsZVN0YXJyZWQ6IGJvb2xlYW47XG5cdGVuYWJsZUZpbGVFeHBsb3JlcjogYm9vbGVhbjtcblx0ZW5hYmxlU2VhcmNoOiBib29sZWFuO1xuXHRidXR0b25JY29uOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBNZXRhZGF0YU1lbnVTZXR0aW5ncyA9IHtcblx0cHJlc2V0RmllbGRzOiBbXSxcblx0ZmlsZUNsYXNzUXVlcmllczogW10sXG5cdGRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51OiB0cnVlLFxuXHRnbG9iYWxseUlnbm9yZWRGaWVsZHM6IFtdLFxuXHRjbGFzc0ZpbGVzUGF0aDogbnVsbCxcblx0aXNBdXRvc3VnZ2VzdEVuYWJsZWQ6IHRydWUsXG5cdGZpbGVDbGFzc0FsaWFzOiBcImZpbGVDbGFzc1wiLFxuXHRzZXR0aW5nc1ZlcnNpb246IHVuZGVmaW5lZCxcblx0Z2xvYmFsRmlsZUNsYXNzOiB1bmRlZmluZWQsXG5cdGZpcnN0RGF5T2ZXZWVrOiAxLFxuXHRlbmFibGVMaW5rczogdHJ1ZSxcblx0ZW5hYmxlVGFiSGVhZGVyOiB0cnVlLFxuXHRlbmFibGVFZGl0b3I6IHRydWUsXG5cdGVuYWJsZUJhY2tsaW5rczogdHJ1ZSxcblx0ZW5hYmxlU3RhcnJlZDogdHJ1ZSxcblx0ZW5hYmxlRmlsZUV4cGxvcmVyOiB0cnVlLFxuXHRlbmFibGVTZWFyY2g6IHRydWUsXG5cdGJ1dHRvbkljb246IFwiY2xpcGJvYXJkLWxpc3RcIlxufTsiLCAiaW1wb3J0IHsgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgQnV0dG9uQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQsIE1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgbW9tZW50LCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IEZvbGRlclN1Z2dlc3QgfSBmcm9tIFwic3JjL3N1Z2dlc3Rlci9Gb2xkZXJTdWdnZXN0ZXJcIjtcbmltcG9ydCB7IEZpbGVTdWdnZXN0IH0gZnJvbSBcInNyYy9zdWdnZXN0ZXIvRmlsZVN1Z2dlc3RlclwiO1xuaW1wb3J0IEZpbGVDbGFzc1F1ZXJ5IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc1F1ZXJ5XCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnlTZXR0aW5nc01vZGFsIGZyb20gXCIuL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ01vZGFsXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnlTZXR0aW5nIGZyb20gXCIuL0ZpbGVDbGFzc1F1ZXJ5U2V0dGluZ1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIilcblx0XHR0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwic2V0dGluZ3NcIilcblx0fTtcblxuXHRwcml2YXRlIGNyZWF0ZVNldHRpbmdHcm91cCh0aXRsZTogc3RyaW5nLCBzdWJUaXRsZT86IHN0cmluZywgd2l0aEJ1dHRvbjogYm9vbGVhbiA9IGZhbHNlKTogSFRNTERpdkVsZW1lbnQge1xuXHRcdGNvbnN0IHNldHRpbmdIZWFkZXIgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKVxuXHRcdGNvbnN0IHNldHRpbmdIZWFkZXJDb250YWluZXIgPSBzZXR0aW5nSGVhZGVyLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcImhlYWRlci1jb250YWluZXJcIiB9KTtcblx0XHRjb25zdCBzZXR0aW5nSGVhZGVyVGV4dENvbnRhaW5lciA9IHNldHRpbmdIZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwidGV4dC1jb250YWluZXJcIiB9KTtcblx0XHRzZXR0aW5nSGVhZGVyVGV4dENvbnRhaW5lci5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6IHRpdGxlLCBjbHM6IFwic2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRpZiAoc3ViVGl0bGUpIHNldHRpbmdIZWFkZXJUZXh0Q29udGFpbmVyLmNyZWF0ZUVsKCdkaXYnLCB7IHRleHQ6IHN1YlRpdGxlLCBjbHM6IFwic2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uXCIgfSk7XG5cblx0XHRjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIik7XG5cdFx0aWYgKHdpdGhCdXR0b24pIHtcblx0XHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbkNvbnRhaW5lciA9IHNldHRpbmdIZWFkZXJDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwic2V0dGluZy1pdGVtLWNvbnRyb2xcIiB9KTtcblx0XHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoc2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uQ29udGFpbmVyKTtcblx0XHRcdHNldHRpbmdzQ29udGFpbmVyU2hvd0J1dHRvbi5idXR0b25FbC5hZGRDbGFzcyhcInNldHRpbmctaXRlbS1jb250cm9sXCIpO1xuXHRcdFx0c2V0dGluZ3NDb250YWluZXIuaGlkZSgpO1xuXHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnNldEN0YSgpO1xuXHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnNldEljb24oXCJjaGV2cm9ucy11cC1kb3duXCIpO1xuXG5cdFx0XHRjb25zdCB0b2dnbGVTdGF0ZSA9ICgpID0+IHtcblx0XHRcdFx0aWYgKHNldHRpbmdzQ29udGFpbmVyLmlzU2hvd24oKSkge1xuXHRcdFx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmhpZGUoKTtcblx0XHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24uc2V0SWNvbihcImNoZXZyb25zLXVwLWRvd25cIik7XG5cdFx0XHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnNldEN0YSgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNldHRpbmdzQ29udGFpbmVyLnNob3coKTtcblx0XHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24uc2V0SWNvbihcImNoZXZyb25zLWRvd24tdXBcIik7XG5cdFx0XHRcdFx0c2V0dGluZ3NDb250YWluZXJTaG93QnV0dG9uLnJlbW92ZUN0YSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRzZXR0aW5nc0NvbnRhaW5lclNob3dCdXR0b24ub25DbGljaygoKSA9PiB0b2dnbGVTdGF0ZSgpKTtcblx0XHR9XG5cblxuXHRcdHJldHVybiBzZXR0aW5nc0NvbnRhaW5lclxuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRHbG9iYWwgU2V0dGluZ3MgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdGNvbnN0IGdsb2JhbFNldHRpbmdzID0gdGhpcy5jcmVhdGVTZXR0aW5nR3JvdXAoXG5cdFx0XHQnR2xvYmFsIHNldHRpbmdzJyxcblx0XHRcdFwiR2xvYmFsIHNldHRpbmdzIHRvIGFwcGx5IHRvIHlvdXIgd2hvbGUgdmF1bHRcIixcblx0XHRcdHRydWVcblx0XHQpXG5cblx0XHQvKiBNYW5hZ2UgbWVudSBvcHRpb25zIGRpc3BsYXkqL1xuXHRcdG5ldyBTZXR0aW5nKGdsb2JhbFNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJEaXNwbGF5IGZpZWxkIG9wdGlvbnMgaW4gY29udGV4dCBtZW51XCIpXG5cdFx0XHQuc2V0RGVzYyhcIkNob29zZSB0byBzaG93IG9yIGhpZGUgZmllbGRzIG9wdGlvbnMgaW4gdGhlIGNvbnRleHQgbWVudSBvZiBhIGxpbmsgb3IgYSBmaWxlXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGU6IFRvZ2dsZUNvbXBvbmVudCkgPT4ge1xuXHRcdFx0XHR0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnUpXG5cdFx0XHRcdHRvZ2dsZS5vbkNoYW5nZShhc3luYyB2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZGlzcGxheUZpZWxkc0luQ29udGV4dE1lbnUgPSB2YWx1ZVxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXHRcdC8qIEV4Y2x1ZGUgRmllbGRzIGZyb20gY29udGV4dCBtZW51Ki9cblx0XHRjb25zdCBnbG9iYWxseUlnbm9yZWRGaWVsZHNTZXR0aW5nID0gbmV3IFNldHRpbmcoZ2xvYmFsU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnR2xvYmFsbHkgaWdub3JlZCBmaWVsZHMnKVxuXHRcdFx0LnNldERlc2MoJ0ZpZWxkcyB0byBiZSBpZ25vcmVkIGJ5IHRoZSBwbHVnaW4gd2hlbiBhZGRpbmcgb3B0aW9ucyB0byB0aGUgY29udGV4dCBtZW51Jylcblx0XHRcdC5hZGRUZXh0QXJlYSgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBmaWVsZHMgYXMgc3RyaW5nLCBjb21tYSBzZXBhcmF0ZWQnKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMuam9pbignLCAnKSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChpdGVtID0+IGl0ZW0udHJpbSgpKTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwucm93cyA9IDY7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5jb2xzID0gMjU7XG5cdFx0XHR9KVxuXHRcdGdsb2JhbGx5SWdub3JlZEZpZWxkc1NldHRpbmcuc2V0dGluZ0VsLmFkZENsYXNzKFwidnN0YWNrZWRcIik7XG5cdFx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzU2V0dGluZy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cdFx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzU2V0dGluZy5jb250cm9sRWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuXG5cdFx0LyogRmlyc3QgZGF5IG9mIHdlZWsgKGZvciBEYXRlIEZpZWxkcyovXG5cdFx0bmV3IFNldHRpbmcoZ2xvYmFsU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnRmlyc3QgZGF5IG9mIHdlZWsnKVxuXHRcdFx0LnNldERlc2MoJ0ZvciBkYXRlIGZpZWxkcywgd2hpY2ggZGF5IHRoZSBkYXRlIHBpY2tlclxcJ3Mgd2VlayBzaG91bGQgc3RhcnQgd2l0aCcpXG5cdFx0XHQuYWRkRHJvcGRvd24oKGNiOiBEcm9wZG93bkNvbXBvbmVudCkgPT4ge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuXHRcdFx0XHRcdGNiLmFkZE9wdGlvbihpLnRvU3RyaW5nKCksIG1vbWVudCgpLmRheShpKS5mb3JtYXQoXCJkZGRkXCIpKVxuXHRcdFx0XHR9XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0RGF5T2ZXZWVrLnRvU3RyaW5nKCkgfHwgXCIxXCIpXG5cdFx0XHRcdGNiLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZpcnN0RGF5T2ZXZWVrID0gcGFyc2VJbnQodmFsdWUpO1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgcHJlZGVmaW5lZCBvcHRpb25zIGZvciBwcm9wZXJ0aWVzIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ki9cblx0XHQvKiBBZGQgbmV3IHByb3BlcnR5IGZvciB3aGljaCB3ZSB3YW50IHRvIHByZXNldCBvcHRpb25zKi9cblx0XHRjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic2V0dGluZy1kaXZpZGVyXCIgfSlcblx0XHRjb25zdCBwcmVzZXRGaWVsZHNTZXR0aW5ncyA9IHRoaXMuY3JlYXRlU2V0dGluZ0dyb3VwKFxuXHRcdFx0J1ByZXNldCBGaWVsZHMgc2V0dGluZ3MnLFxuXHRcdFx0XCJNYW5hZ2UgZ2xvYmFsbHkgcHJlZGVmaW5lZCB0eXBlIGFuZCBvcHRpb25zIGZvciBhIGZpZWxkIHRocm91Z2hvdXQgeW91ciB3aG9sZSB2YXVsdFwiLFxuXHRcdFx0dHJ1ZVxuXHRcdClcblx0XHRuZXcgU2V0dGluZyhwcmVzZXRGaWVsZHNTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiQWRkIE5ldyBGaWVsZCBTZXR0aW5nXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkFkZCBhIG5ldyBGcm9udG1hdHRlciBwcm9wZXJ0eSBmb3Igd2hpY2ggeW91IHdhbnQgcHJlc2V0IG9wdGlvbnMuXCIpXG5cdFx0XHQuYWRkQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG5cdFx0XHRcdHJldHVybiBidXR0b25cblx0XHRcdFx0XHQuc2V0VG9vbHRpcChcIkFkZCBOZXcgUHJvcGVydHkgTWFuYWdlclwiKVxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiQWRkIG5ld1wiKVxuXHRcdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGxldCBtb2RhbCA9IG5ldyBGaWVsZFNldHRpbmdzTW9kYWwodGhpcy5wbHVnaW4sIHByZXNldEZpZWxkc1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblxuXHRcdC8qIE1hbmFnZWQgcHJvcGVydGllcyB0aGF0IGN1cnJlbnRseSBoYXZlIHByZXNldCBvcHRpb25zICovXG5cdFx0dGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcblx0XHRcdG5ldyBGaWVsZFNldHRpbmcocHJlc2V0RmllbGRzU2V0dGluZ3MsIHByb3BlcnR5LCB0aGlzLnBsdWdpbik7XG5cdFx0fSk7XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdE1hbmFnaW5nIGZpbGVDbGFzcyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cblx0XHQvKiBTZXQgY2xhc3NGaWxlcyBQYXRoKi9cblx0XHRjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwic2V0dGluZy1kaXZpZGVyXCIgfSk7XG5cdFx0Y29uc3QgY2xhc3NGaWxlc1NldHRpbmdzID0gdGhpcy5jcmVhdGVTZXR0aW5nR3JvdXAoXG5cdFx0XHQnRmlsZUNsYXNzIHNldHRpbmdzJyxcblx0XHRcdFwiTWFuYWdlIGZpbGVDbGFzcyBmb2xkZXIgYW5kIGFsaWFzLiBcIiArXG5cdFx0XHRcIldoZW4gYSBub3RlIGhhcyBhIGZpbGVDbGFzcyBkZWZpbmVkLCBmaWxlQ2xhc3MgZmllbGQgcHJvcGVydGllcyB3aWxsIG92ZXJyaWRlIFwiICtcblx0XHRcdFwiZ2xvYmFsIHByZXNldCBmaWVsZHMgc2V0dGluZ3MgZm9yIHRoZSBzYW1lIGZpZWxkIG5hbWVcIixcblx0XHRcdHRydWVcblx0XHQpXG5cblx0XHRjb25zdCBwYXRoID0gbmV3IFNldHRpbmcoY2xhc3NGaWxlc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoJ2NsYXNzIEZpbGVzIHBhdGgnKVxuXHRcdFx0LnNldERlc2MoJ1BhdGggdG8gdGhlIGZpbGVzIGNvbnRhaW5pbmcgdGhlIGF1dGhvcml6ZWQgZmllbGRzIGZvciBhIHR5cGUgb2Ygbm90ZScpXG5cdFx0XHQuYWRkU2VhcmNoKChjZnMpID0+IHtcblx0XHRcdFx0bmV3IEZvbGRlclN1Z2dlc3QodGhpcy5wbHVnaW4sIGNmcy5pbnB1dEVsKTtcblx0XHRcdFx0Y2ZzLnNldFBsYWNlaG9sZGVyKFwiRm9sZGVyXCIpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoIHx8IFwiXCIpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKChuZXdfZm9sZGVyKSA9PiB7XG5cdFx0XHRcdFx0XHRjb25zdCBuZXdQYXRoID0gbmV3X2ZvbGRlci5lbmRzV2l0aChcIi9cIikgfHwgIW5ld19mb2xkZXIgPyBuZXdfZm9sZGVyIDogbmV3X2ZvbGRlciArIFwiL1wiO1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGggPSBuZXdQYXRoIHx8IG51bGw7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdHBhdGguc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXHRcdHBhdGguc2V0dGluZ0VsLmFkZENsYXNzKFwibmFycm93LXRpdGxlXCIpO1xuXHRcdHBhdGguY29udHJvbEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcblxuXHRcdGNvbnN0IGFsaWFzID0gbmV3IFNldHRpbmcoY2xhc3NGaWxlc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoJ2ZpbGVDbGFzcyBmaWVsZCBhbGlhcycpXG5cdFx0XHQuc2V0RGVzYygnQ2hvb3NlIGFub3RoZXIgbmFtZSBmb3IgZmlsZUNsYXNzIGZpZWxkIGluIGZyb250bWF0dGVyIChleGFtcGxlOiBDYXRlZ29yeSwgdHlwZSwgLi4uJylcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXMgPSB2YWx1ZSB8fCBcImZpbGVDbGFzc1wiO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KVxuXHRcdGFsaWFzLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblx0XHRhbGlhcy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuYXJyb3ctdGl0bGVcIik7XG5cdFx0YWxpYXMuY29udHJvbEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcblxuXHRcdC8qIFxuXG5cdFx0LyogU2V0IGdsb2JhbCBmaWxlQ2xhc3MqL1xuXHRcdGNvbnN0IGdsb2JhbCA9IG5ldyBTZXR0aW5nKGNsYXNzRmlsZXNTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdnbG9iYWwgZmlsZUNsYXNzJylcblx0XHRcdC5zZXREZXNjKCdDaG9vc2Ugb25lIGZpbGVDbGFzcyB0byBiZSBhcHBsaWNhYmxlIHRvIGFsbCBmaWxlcyAnICtcblx0XHRcdFx0JyhldmVuIGl0IGlzIG5vdCBwcmVzZW50IGFzIGEgZmlsZUNsYXNzIGF0dHJpYnV0ZSBpbiB0aGVpciBmcm9udG1hdHRlcikuICcgK1xuXHRcdFx0XHQnVGhpcyB3aWxsIG92ZXJyaWRlIHRoZSBwcmVzZXQgRmllbGRzIGRlZmluZWQgYWJvdmUnKVxuXHRcdFx0LmFkZFNlYXJjaCgoY2ZzKSA9PiB7XG5cdFx0XHRcdG5ldyBGaWxlU3VnZ2VzdChcblx0XHRcdFx0XHRjZnMuaW5wdXRFbCxcblx0XHRcdFx0XHR0aGlzLnBsdWdpbixcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCB8fCBcIlwiXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGNmcy5zZXRQbGFjZWhvbGRlcihcIkdsb2JhbCBmaWxlQ2xhc3NcIilcblx0XHRcdFx0Y2ZzLnNldFZhbHVlKFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyA/XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCArIHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyArIFwiLm1kXCIgOlxuXHRcdFx0XHRcdFx0XCJcIlxuXHRcdFx0XHQpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKChuZXdQYXRoKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MgPSBuZXdQYXRoID9cblx0XHRcdFx0XHRcdFx0bmV3UGF0aC5zcGxpdCgnXFxcXCcpLnBvcCgpIS5zcGxpdCgnLycpLnBvcCgpPy5yZXBsYWNlKFwiLm1kXCIsIFwiXCIpIDpcblx0XHRcdFx0XHRcdFx0XCJcIjtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSlcblx0XHRnbG9iYWwuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXHRcdGdsb2JhbC5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuYXJyb3ctdGl0bGVcIik7XG5cdFx0Z2xvYmFsLmNvbnRyb2xFbC5hZGRDbGFzcyhcImZ1bGwtd2lkdGhcIik7XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdE1hbmFnaW5nIGV4dHJhIGJ1dHRvbiBkaXNwbGF5IG9wdGlvbnNcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcInNldHRpbmctZGl2aWRlclwiIH0pO1xuXHRcdGNvbnN0IG1ldGFkYXRhTWVudUJ0blNldHRpbmdzID0gdGhpcy5jcmVhdGVTZXR0aW5nR3JvdXAoXG5cdFx0XHQnTWV0YWRhdGEgTWVudSBidXR0b24nLFxuXHRcdFx0J1Nob3cgZXh0cmEgYnV0dG9uIHRvIGFjY2VzcyBtZXRhZGF0YSBtZW51IG1vZGFsIG9mIGZpZWxkcycsXG5cdFx0XHR0cnVlKVxuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIk1ldGFkYXRhIE1lbnUgYnV0dG9uIGljb25cIilcblx0XHRcdC5zZXREZXNjKFwibmFtZSBvZiB0aGUgZGVmYXVsdCBpY29uIHdoZW4gbm90IGRlZmluZWQgaW4gZmlsZUNsYXNzXCIpXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmJ1dHRvbkljb24pXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuYnV0dG9uSWNvbiA9IHZhbHVlIHx8IFwiY2xpcGJvYXJkLWxpc3RcIjtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIlJlYWRpbmcgbW9kZSBsaW5rc1wiKVxuXHRcdFx0LnNldERlc2MoXCJEaXNwbGF5IGFuIGV4dHJhIGJ1dHRvbiB0byBhY2Nlc3MgbWV0YWRhdGEgbWVudSBmb3JtIGFmdGVyIGEgbGluayBpbiByZWFkaW5nIG1vZGVcIilcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xuXHRcdFx0XHRjYi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaW5rcyk7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVMaW5rcyA9IHZhbHVlO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkxpdmUgcHJldmlldyBtb2RlXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgYW4gZXh0cmEgYnV0dG9uIHRvIGFjY2VzcyBtZXRhZGF0YSBtZW51IGZvcm0gYWZ0ZXIgYSBsaW5rIGluIGxpdmUgcHJldmlld1wiKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUVkaXRvcik7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVFZGl0b3IgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblxuXHRcdG5ldyBTZXR0aW5nKG1ldGFkYXRhTWVudUJ0blNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJUYWIgaGVhZGVyXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgYW4gZXh0cmEgYnV0dG9uIHRvIGFjY2VzcyBtZXRhZGF0YSBtZW51IGZvcm0gaW4gdGhlIHRhYiBoZWFkZXJcIilcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xuXHRcdFx0XHRjYi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVUYWJIZWFkZXIpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZSh2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlVGFiSGVhZGVyID0gdmFsdWU7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KS5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJuby1ib3JkZXJcIik7XG5cblx0XHRuZXcgU2V0dGluZyhtZXRhZGF0YU1lbnVCdG5TZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiQmFja2xpbmtzXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgYW4gZXh0cmEgYnV0dG9uIHRvIGFjY2VzcyBtZXRhZGF0YSBtZW51IGZvcm0gaW4gdGhlIGJhY2tsaW5rcyBwYW5lbFwiKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUJhY2tsaW5rcyk7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVCYWNrbGlua3MgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblxuXHRcdG5ldyBTZXR0aW5nKG1ldGFkYXRhTWVudUJ0blNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJTZWFyY2hcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBpbiB0aGUgc2VhcmNoIHBhbmVsXCIpXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlU2VhcmNoKTtcblx0XHRcdFx0Y2Iub25DaGFuZ2UodmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVNlYXJjaCA9IHZhbHVlO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KVxuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0bmV3IFNldHRpbmcobWV0YWRhdGFNZW51QnRuU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkZpbGUgZXhwbG9yZXJcIilcblx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBhbiBleHRyYSBidXR0b24gdG8gYWNjZXNzIG1ldGFkYXRhIG1lbnUgZm9ybSBpbiB0aGUgZmlsZSBleHBsb3JlclwiKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZpbGVFeHBsb3Jlcik7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKHZhbHVlID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGaWxlRXhwbG9yZXIgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblxuXHRcdG5ldyBTZXR0aW5nKG1ldGFkYXRhTWVudUJ0blNldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJTdGFycmVkXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgYW4gZXh0cmEgYnV0dG9uIHRvIGFjY2VzcyBtZXRhZGF0YSBtZW51IGZvcm0gaW4gdGhlIHN0YXJyZWQgcGFuZWxcIilcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xuXHRcdFx0XHRjYi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTdGFycmVkKTtcblx0XHRcdFx0Y2Iub25DaGFuZ2UodmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVN0YXJyZWQgPSB2YWx1ZTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pLnNldHRpbmdFbC5hZGRDbGFzcyhcIm5vLWJvcmRlclwiKTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgcHJlZGVmaW5lZCBmaWxlQ2xhc3MgZm9yIHF1ZXJ5J3MgbWF0Y2hpbmcgZmlsZXMgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIEFkZCBuZXcgcXVlcnkgZm9yIHdoaWNoIG1hdGNoaW5nIGZpbGVzIHdpbGwgYmUgYXBwbGllZCB0aGUgZmlsZUNsYXNzKi9cblxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJzZXR0aW5nLWRpdmlkZXJcIiB9KTtcblx0XHRjb25zdCBxdWVyeUZpbGVDbGFzc1NldHRpbmdzID0gdGhpcy5jcmVhdGVTZXR0aW5nR3JvdXAoXG5cdFx0XHQnUXVlcnkgYmFzZWQgRmlsZUNsYXNzIHNldHRpbmdzJyxcblx0XHRcdFwiTWFuYWdlIGdsb2JhbGx5IHByZWRlZmluZWQgdHlwZSBhbmQgb3B0aW9ucyBmb3IgYSBmaWVsZCBtYXRjaGluZyB0aGlzIHF1ZXJ5XCIsXG5cdFx0XHR0cnVlXG5cdFx0KVxuXHRcdG5ldyBTZXR0aW5nKHF1ZXJ5RmlsZUNsYXNzU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkFkZCBOZXcgUXVlcnkgZm9yIGZpbGVDbGFzc1wiKVxuXHRcdFx0LnNldERlc2MoXCJBZGQgYSBuZXcgcXVlcnkgYW5kIGEgRmlsZUNsYXNzIHRoYXQgd2lsbCBhcHBseSB0byBmaWxlcyBtYXRjaGluZyB0aGlzIHF1ZXJ5LlwiKVxuXHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYnV0dG9uXG5cdFx0XHRcdFx0LnNldFRvb2x0aXAoXCJBZGQgTmV3IGZpbGVDbGFzcyBxdWVyeVwiKVxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiQWRkIG5ld1wiKVxuXHRcdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGxldCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NRdWVyeVNldHRpbmdzTW9kYWwodGhpcy5wbHVnaW4sIHF1ZXJ5RmlsZUNsYXNzU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSkuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpO1xuXG5cdFx0LyogTWFuYWdlZCBwcm9wZXJ0aWVzIHRoYXQgY3VycmVudGx5IGhhdmUgcHJlc2V0IG9wdGlvbnMgKi9cblx0XHR0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllc1xuXHRcdFx0LmZvckVhY2gocXVlcnkgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NRdWVyeSA9IG5ldyBGaWxlQ2xhc3NRdWVyeSgpO1xuXHRcdFx0XHRPYmplY3QuYXNzaWduKGZpbGVDbGFzc1F1ZXJ5LCBxdWVyeSk7XG5cdFx0XHRcdG5ldyBGaWxlQ2xhc3NRdWVyeVNldHRpbmcocXVlcnlGaWxlQ2xhc3NTZXR0aW5ncywgZmlsZUNsYXNzUXVlcnksIHRoaXMucGx1Z2luKTtcblx0XHRcdH0pO1xuXHR9O1xufTtcbiIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBUQWJzdHJhY3RGaWxlLCBURm9sZGVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBUZXh0SW5wdXRTdWdnZXN0IH0gZnJvbSBcIi4vc3VnZ2VzdFwiO1xuXG5leHBvcnQgY2xhc3MgRm9sZGVyU3VnZ2VzdCBleHRlbmRzIFRleHRJbnB1dFN1Z2dlc3Q8VEZvbGRlcj4ge1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIHB1YmxpYyBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudFxuICAgICkge1xuICAgICAgICBzdXBlcihpbnB1dEVsKTtcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhpbnB1dFN0cjogc3RyaW5nKTogVEZvbGRlcltdIHtcbiAgICAgICAgY29uc3QgYWJzdHJhY3RGaWxlcyA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpO1xuICAgICAgICBjb25zdCBmb2xkZXJzOiBURm9sZGVyW10gPSBbXTtcbiAgICAgICAgY29uc3QgbG93ZXJDYXNlSW5wdXRTdHIgPSBpbnB1dFN0ci50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGFic3RyYWN0RmlsZXMuZm9yRWFjaCgoZm9sZGVyOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlciAmJlxuICAgICAgICAgICAgICAgIGZvbGRlci5wYXRoLnRvTG93ZXJDYXNlKCkuY29udGFpbnMobG93ZXJDYXNlSW5wdXRTdHIpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBmb2xkZXJzLnB1c2goZm9sZGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZvbGRlcnM7XG4gICAgfVxuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihmaWxlOiBURm9sZGVyLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuc2V0VGV4dChmaWxlLnBhdGgpO1xuICAgIH1cblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24oZmlsZTogVEZvbGRlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSBmaWxlLnBhdGg7XG4gICAgICAgIHRoaXMuaW5wdXRFbC50cmlnZ2VyKFwiaW5wdXRcIik7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQnV0dG9uQ29tcG9uZW50LCBEcm9wZG93bkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQsIE1vZGFsLCBTZXR0aW5nLCBUZXh0QXJlYUNvbXBvbmVudCwgVGV4dENvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnkgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnlcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeVNldHRpbmcgZnJvbSBcIi4vRmlsZUNsYXNzUXVlcnlTZXR0aW5nXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVDbGFzc1F1ZXJ5U2V0dGluZ3NNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIHNhdmVkOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBmaWxlQ2xhc3NRdWVyeTogRmlsZUNsYXNzUXVlcnk7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmlsZUNsYXNzUXVlcnk6IEZpbGVDbGFzc1F1ZXJ5O1xuICAgIHByaXZhdGUgbmV3OiBib29sZWFuID0gdHJ1ZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmdDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHBhcmVudFNldHRpbmc/OiBGaWxlQ2xhc3NRdWVyeVNldHRpbmcsXG4gICAgICAgIGZpbGVDbGFzc1F1ZXJ5PzogRmlsZUNsYXNzUXVlcnlcbiAgICApIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5ID0gbmV3IEZpbGVDbGFzc1F1ZXJ5KCk7XG4gICAgICAgIGlmIChmaWxlQ2xhc3NRdWVyeSkge1xuICAgICAgICAgICAgdGhpcy5uZXcgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzUXVlcnkgPSBmaWxlQ2xhc3NRdWVyeTtcbiAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBuZXdJZCA9IDE7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5mb3JFYWNoKHByb3AgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChwcm9wLmlkKSAmJiBwYXJzZUludChwcm9wLmlkKSA+PSBuZXdJZCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdJZCA9IHBhcnNlSW50KHByb3AuaWQpICsgMTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5ID0gbmV3IEZpbGVDbGFzc1F1ZXJ5KCk7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5LmlkID0gbmV3SWQudG9TdHJpbmcoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzUXVlcnkubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IGEgZmlsZUNsYXNzIGFuZCBhZGQgYW4gYXBwbGljYWJsZSBxdWVyeWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYE1hbmFnZSAke3RoaXMuZmlsZUNsYXNzUXVlcnkubmFtZX0gc2V0dGluZ3NgKTtcbiAgICAgICAgfTtcbiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVGb3JtKCk7XG4gICAgfTtcblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWxlQ2xhc3NRdWVyeSwgdGhpcy5pbml0aWFsRmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICBpZiAoIXRoaXMubmV3ICYmIHRoaXMucGFyZW50U2V0dGluZykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnRTZXR0aW5nLnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2F2ZWQpIHtcbiAgICAgICAgICAgIG5ldyBGaWxlQ2xhc3NRdWVyeVNldHRpbmcodGhpcy5wYXJlbnRTZXR0aW5nQ29udGFpbmVyLCB0aGlzLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLnBsdWdpbik7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlbmFtZUlucHV0Q29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ2xhYmVsJywgdGV4dDogYEZpbGVDbGFzcyBRdWVyeSBOYW1lOmAgfSk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgaW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcIndpdGgtbGFiZWxcIik7XG4gICAgICAgIGlucHV0LmlucHV0RWwuYWRkQ2xhc3MoXCJmdWxsLXdpZHRoXCIpO1xuICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5maWxlQ2xhc3NRdWVyeS5uYW1lO1xuICAgICAgICBpbnB1dC5zZXRWYWx1ZShuYW1lKTtcbiAgICAgICAgaW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJOYW1lIG9mIHRoaXMgZmlsZUNsYXNzIHF1ZXJ5XCIpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5Lm5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBNYW5hZ2Ugb3B0aW9ucyBmb3IgJHt0aGlzLmZpbGVDbGFzc1F1ZXJ5Lm5hbWV9YCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlRmlsZUNsYXNzU2VsZWN0b3JDb250YWluZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImxhYmVsXCIsIHRleHQ6IGBGaWxlY2xhc3M6YCB9KTtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ3NwYWNlcicgfSk7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICBjb25zdCBjbGFzc0ZpbGVzUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc2VzID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0XG4gICAgICAgICAgICAuZ2V0RmlsZXMoKVxuICAgICAgICAgICAgLmZpbHRlcihmID0+IGNsYXNzRmlsZXNQYXRoICYmIGYucGF0aC5zdGFydHNXaXRoKGNsYXNzRmlsZXNQYXRoKSlcbiAgICAgICAgICAgIC5yZXZlcnNlKCk7XG4gICAgICAgIHNlbGVjdC5hZGRPcHRpb24oXCItLVNlbGVjdCBhIGZpbGVDbGFzcy0tXCIsIFwiLS1TZWxlY3QgYSBmaWxlQ2xhc3MtLVwiKVxuICAgICAgICBmaWxlQ2xhc3Nlcy5mb3JFYWNoKGZpbGVDbGFzcyA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gRmlsZUNsYXNzLmdldEZpbGVDbGFzc05hbWVGcm9tUGF0aCh0aGlzLnBsdWdpbiwgZmlsZUNsYXNzLnBhdGgpO1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzc05hbWUpIHNlbGVjdC5hZGRPcHRpb24oZmlsZUNsYXNzTmFtZSwgZmlsZUNsYXNzTmFtZSk7XG4gICAgICAgIH0pXG4gICAgICAgIGlmICh0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUpIHtcbiAgICAgICAgICAgIHNlbGVjdC5zZXRWYWx1ZSh0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgIT0gXCItLVNlbGVjdCBhIGZpbGVDbGFzcy0tXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgPSB2YWx1ZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWUgPSBcIlwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVRdWVyeUlucHV0Q29udGFpbmVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29udGFpbmVyLmNyZWF0ZURpdih7IHRleHQ6IFwiZGF0YXZpZXdKUyBxdWVyeTpcIiB9KTtcbiAgICAgICAgY29uc3QgcXVlcnlTdHJpbmdJbnB1dENvbnRhaW5lciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSlcbiAgICAgICAgY29uc3QgcXVlcnlTdHJpbmdJbnB1dCA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChxdWVyeVN0cmluZ0lucHV0Q29udGFpbmVyKTtcbiAgICAgICAgcXVlcnlTdHJpbmdJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiZnVsbC13aWR0aFwiKTtcbiAgICAgICAgcXVlcnlTdHJpbmdJbnB1dC5pbnB1dEVsLnJvd3MgPSA0XG4gICAgICAgIHF1ZXJ5U3RyaW5nSW5wdXQuc2V0VmFsdWUodGhpcy5maWxlQ2xhc3NRdWVyeS5xdWVyeSk7XG4gICAgICAgIHF1ZXJ5U3RyaW5nSW5wdXQub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5maWxlQ2xhc3NRdWVyeS5xdWVyeSA9IHZhbHVlKVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlRm9ybSgpOiBQcm9taXNlPHZvaWQ+IHtcblxuICAgICAgICAvKiBTZWN0aW9ucyAqL1xuICAgICAgICBjb25zdCBuYW1lQ29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLWNvbnRhaW5lclwiIH0pO1xuICAgICAgICB0aGlzLmNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihuYW1lQ29udGFpbmVyKTtcblxuICAgICAgICBjb25zdCBmaWxlQ2xhc3NTZWxlY3RDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmllbGQtY29udGFpbmVyXCIgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlRmlsZUNsYXNzU2VsZWN0b3JDb250YWluZXIoZmlsZUNsYXNzU2VsZWN0Q29udGFpbmVyKVxuXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc1F1ZXJ5Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcInZzdGFja2VkXCIgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlUXVlcnlJbnB1dENvbnRhaW5lcihmaWxlQ2xhc3NRdWVyeUNvbnRhaW5lcik7XG5cbiAgICAgICAgLyogZm9vdGVyIGJ1dHRvbnMqL1xuICAgICAgICBjb25zdCBmb290ZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZm9vdGVyLWFjdGlvbnNcIiB9KTtcbiAgICAgICAgZm9vdGVyLmNyZWF0ZURpdih7IGNsczogXCJzcGFjZXJcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZVNhdmVCdXR0b24oZm9vdGVyKTtcbiAgICAgICAgdGhpcy5jcmVhdGVDYW5jZWxCdXR0b24oZm9vdGVyKTtcblxuICAgICAgICAvKiBpbml0IHN0YXRlICovXG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlU2F2ZUJ1dHRvbihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGIgPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcilcbiAgICAgICAgYi5zZXRUb29sdGlwKFwiU2F2ZVwiKTtcbiAgICAgICAgYi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBiLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzUXVlcnkuZmlsZUNsYXNzTmFtZSAmJiB0aGlzLmZpbGVDbGFzc1F1ZXJ5Lm5hbWUgJiYgdGhpcy5maWxlQ2xhc3NRdWVyeS5xdWVyeSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5ID0gdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXNcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihwID0+IHAuaWQgPT0gdGhpcy5maWxlQ2xhc3NRdWVyeS5pZClbMF07XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ0ZpbGVDbGFzc1F1ZXJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eShjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMucHVzaCh0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIEZpbGVDbGFzc1F1ZXJ5LmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWxlQ2xhc3NRdWVyeSwgdGhpcy5maWxlQ2xhc3NRdWVyeSlcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wYXJlbnRTZXR0aW5nKSBGaWxlQ2xhc3NRdWVyeS5jb3B5UHJvcGVydHkodGhpcy5wYXJlbnRTZXR0aW5nLmZpbGVDbGFzc1F1ZXJ5LCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudFNldHRpbmc/LnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlQ2FuY2VsQnV0dG9uKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKVxuICAgICAgICBiLnNldEljb24oXCJjcm9zc1wiKVxuICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJDYW5jZWxcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLyogcmVzZXQgb3B0aW9ucyBmcm9tIHNldHRpbmdzICovXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5Lm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZmlsZUNsYXNzUXVlcnksIHRoaXMuaW5pdGlhbEZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmlsZUNsYXNzUXVlcnkgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzUXVlcnlcIjtcbmltcG9ydCBGaWxlQ2xhc3NRdWVyeVNldHRpbmdzTW9kYWwgZnJvbSBcIi4vRmlsZUNsYXNzUXVlcnlTZXR0aW5nTW9kYWxcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZUNsYXNzUXVlcnlTZXR0aW5nIGV4dGVuZHMgU2V0dGluZyB7XG4gICAgcHVibGljIGZpbGVDbGFzc1F1ZXJ5OiBGaWxlQ2xhc3NRdWVyeTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcbiAgICAgICAgcHJvcGVydHk6IEZpbGVDbGFzc1F1ZXJ5LFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51XG4gICAgKSB7XG4gICAgICAgIHN1cGVyKGNvbnRhaW5lckVsKTtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3NRdWVyeSA9IHByb3BlcnR5O1xuICAgICAgICB0aGlzLnNldFRleHRDb250ZW50V2l0aG5hbWUoKTtcbiAgICAgICAgdGhpcy5hZGRFZGl0QnV0dG9uKCk7XG4gICAgICAgIHRoaXMuYWRkRGVsZXRlQnV0dG9uKCk7XG4gICAgICAgIHRoaXMuYWRkTW92ZVVwQnV0dG9uKCk7XG4gICAgICAgIHRoaXMuc2V0dGluZ0VsLmFkZENsYXNzKFwibm8tYm9yZGVyXCIpXG4gICAgfTtcblxuICAgIHB1YmxpYyBzZXRUZXh0Q29udGVudFdpdGhuYW1lKCk6IHZvaWQge1xuXG4gICAgICAgIHRoaXMuaW5mb0VsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgdGhpcy5pbmZvRWwuYWRkQ2xhc3MoXCJzZXR0aW5nLWl0ZW1cIilcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzUXVlcnlDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVEaXYoKTtcblxuICAgICAgICBjb25zdCBuYW1lQ29udGFpbmVyID0gZmlsZUNsYXNzUXVlcnlDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgXCJuYW1lXCIpXG4gICAgICAgIG5hbWVDb250YWluZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHt0aGlzLmZpbGVDbGFzc1F1ZXJ5Lm5hbWV9PC9zdHJvbmc+YFxuXG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc05hbWVDb250YWluZXIgPSBmaWxlQ2xhc3NRdWVyeUNvbnRhaW5lci5jcmVhdGVFbChcImRpdlwiKVxuICAgICAgICBmaWxlQ2xhc3NOYW1lQ29udGFpbmVyLmlubmVySFRNTCA9IGA8c3Bhbj5GaWxlQ2xhc3M8L3NwYW4+IDogJHt0aGlzLmZpbGVDbGFzc1F1ZXJ5LmZpbGVDbGFzc05hbWV9YFxuXG4gICAgICAgIGNvbnN0IHF1ZXJ5Q29udGFpbmVyID0gZmlsZUNsYXNzUXVlcnlDb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIilcbiAgICAgICAgcXVlcnlDb250YWluZXIuaW5uZXJIVE1MID0gYDxzcGFuPlF1ZXJ5PC9zcGFuPiA6ICR7dGhpcy5maWxlQ2xhc3NRdWVyeS5xdWVyeX1gXG5cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGRFZGl0QnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwicGVuY2lsXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJFZGl0XCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbW9kYWwgPSBuZXcgRmlsZUNsYXNzUXVlcnlTZXR0aW5nc01vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmNvbnRhaW5lckVsLCB0aGlzLCB0aGlzLmZpbGVDbGFzc1F1ZXJ5KTtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGREZWxldGVCdXR0b24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWRkQnV0dG9uKChiKSA9PiB7XG4gICAgICAgICAgICBiLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRGVsZXRlXCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSA9IHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLmZpbmQocCA9PiBwLmlkID09IHRoaXMuZmlsZUNsYXNzUXVlcnkuaWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nRmlsZUNsYXNzUXVlcnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLnJlbW92ZShjdXJyZW50RXhpc3RpbmdGaWxlQ2xhc3NRdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ0VsLnBhcmVudEVsZW1lbnQ/LnJlbW92ZUNoaWxkKHRoaXMuc2V0dGluZ0VsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFkZE1vdmVVcEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInVwLWNoZXZyb24tZ2x5cGhcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIk1vdmUgdXAgKGxvd2VyIHByaW9yaXR5KVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEZpbGVDbGFzc1F1ZXJ5SW5kZXggPSB0aGlzLnBsdWdpbi5pbml0aWFsRmlsZUNsYXNzUXVlcmllcy5tYXAoZmNxID0+IGZjcS5pZCkuaW5kZXhPZih0aGlzLmZpbGVDbGFzc1F1ZXJ5LmlkKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRGaWxlQ2xhc3NRdWVyeUluZGV4ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJFbC5pbnNlcnRCZWZvcmUodGhpcy5zZXR0aW5nRWwsIHRoaXMuc2V0dGluZ0VsLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbEZpbGVDbGFzc1F1ZXJpZXMuc3BsaWNlKGN1cnJlbnRGaWxlQ2xhc3NRdWVyeUluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxGaWxlQ2xhc3NRdWVyaWVzLnNwbGljZShjdXJyZW50RmlsZUNsYXNzUXVlcnlJbmRleCAtIDEsIDAsIHRoaXMuZmlsZUNsYXNzUXVlcnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIlxuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9maWVsZHMvRmllbGRcIlxuaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCJcbmltcG9ydCAqIGFzIHNlbGVjdFZhbHVlc1NvdXJjZSBmcm9tIFwiLi4vdHlwZXMvc2VsZWN0VmFsdWVzU291cmNlVHlwZXNcIlxuXG5pbnRlcmZhY2UgVjFGaWVsZCBleHRlbmRzIEZpZWxkIHtcbiAgICBpc011bHRpPzogYm9vbGVhbixcbiAgICBpc0N5Y2xlPzogYm9vbGVhbixcbiAgICBpc0Jvb2xlYW4/OiBib29sZWFuLFxuICAgIHZhbHVlcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuaW50ZXJmYWNlIFYyRmllbGQgZXh0ZW5kcyBGaWVsZCB7XG4gICAgdmFsdWVzTGlzdE5vdGVQYXRoPzogc3RyaW5nXG59XG5cbmV4cG9ydCBjb25zdCBtaWdyYXRlU2V0dGluZ3NWMXRvVjIgPSBhc3luYyAocGx1Z2luOiBNZXRhZGF0YU1lbnUpID0+IHtcbiAgICBjb25zdCBwcmVzZXRGaWVsZHMgPSBwbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzXG4gICAgcHJlc2V0RmllbGRzLmZvckVhY2goKHA6IFYxRmllbGQpID0+IHtcbiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhwKS5jb250YWlucyhcInR5cGVcIikpIHtcbiAgICAgICAgICAgIGlmIChwLmlzTXVsdGkpIHAudHlwZSA9IEZpZWxkVHlwZS5NdWx0aVxuICAgICAgICAgICAgZWxzZSBpZiAocC5pc0N5Y2xlKSBwLnR5cGUgPSBGaWVsZFR5cGUuQ3ljbGVcbiAgICAgICAgICAgIGVsc2UgaWYgKHAuaXNCb29sZWFuKSBwLnR5cGUgPSBGaWVsZFR5cGUuQm9vbGVhblxuICAgICAgICAgICAgZWxzZSBpZiAocC5vcHRpb25zICYmIE9iamVjdC5rZXlzKHAub3B0aW9ucykubGVuZ3RoID4gMCkgcC50eXBlID0gRmllbGRUeXBlLlNlbGVjdFxuICAgICAgICAgICAgZWxzZSBwLnR5cGUgPSBGaWVsZFR5cGUuSW5wdXRcbiAgICAgICAgfVxuICAgICAgICAvL2VyYXNlIGlzTXVsdGksIGlzQ3ljbGUsIGlzQm9vbGVhbiBpZiBleGlzdHNcbiAgICAgICAgZGVsZXRlIHAuaXNNdWx0aTtcbiAgICAgICAgZGVsZXRlIHAuaXNDeWNsZTtcbiAgICAgICAgZGVsZXRlIHAuaXNCb29sZWFuXG4gICAgICAgIC8vcmVuYW1lIFwidmFsdWVzXCIgaW4gXCJvcHRpb25cIlxuICAgICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwLCBcInZhbHVlc1wiKSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkocCwgXCJvcHRpb25zXCIsXG4gICAgICAgICAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihwLCBcInZhbHVlc1wiKSEpO1xuICAgICAgICAgICAgZGVsZXRlIHBbXCJ2YWx1ZXNcIl07XG4gICAgICAgIH1cbiAgICB9KVxuICAgIHBsdWdpbi5zZXR0aW5ncy5zZXR0aW5nc1ZlcnNpb24gPSAyXG4gICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKHBsdWdpbi5zZXR0aW5ncylcbiAgICBjb25zb2xlLmxvZyhcIk1ldGFkYXRhIG1lbnUgc2V0dGluZ3MgbWlncmF0ZWQgdG8gdmVyc2lvbiAyXCIpXG59XG5cbmV4cG9ydCBjb25zdCBtaWdyYXRlU2V0dGluZ3NWMnRvVjMgPSBhc3luYyAocGx1Z2luOiBNZXRhZGF0YU1lbnUpID0+IHtcbiAgICBjb25zdCBwcmVzZXRGaWVsZHMgPSBwbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzXG4gICAgcHJlc2V0RmllbGRzLmZvckVhY2goKHA6IFYyRmllbGQpID0+IHtcbiAgICAgICAgaWYgKFtGaWVsZFR5cGUuU2VsZWN0LCBGaWVsZFR5cGUuTXVsdGldLmluY2x1ZGVzKHAudHlwZSkpIHtcbiAgICAgICAgICAgIC8vU3RlcDA6IG1vZGlmeSBvcHRpb25zIGZvciBTZWxlY3QgYW5kIE11bHRpU2VsZWN0XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50T3B0aW9uS2V5cyA9IE9iamVjdC5rZXlzKHAub3B0aW9ucyk7XG4gICAgICAgICAgICBwLm9wdGlvbnMudmFsdWVzTGlzdCA9IHt9XG4gICAgICAgICAgICBjdXJyZW50T3B0aW9uS2V5cy5mb3JFYWNoKGtleSA9PiBwLm9wdGlvbnMudmFsdWVzTGlzdFtrZXldID0gcC5vcHRpb25zW2tleV0pXG4gICAgICAgICAgICAvL1N0ZXAxOiBzZXQgdGhlIHZhbHVlc1NvdXJjZVR5cGVcbiAgICAgICAgICAgIGlmIChwLnZhbHVlc0xpc3ROb3RlUGF0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdFR5cGUgPSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0Tm90ZVBhdGg7XG4gICAgICAgICAgICAgICAgcC5vcHRpb25zLnNvdXJjZVR5cGUgPSBzZWxlY3RUeXBlO1xuICAgICAgICAgICAgICAgIHAub3B0aW9uc1tzZWxlY3RWYWx1ZXNTb3VyY2UuS2V5W3NlbGVjdFR5cGVdXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcC5vcHRpb25zLnNvdXJjZVR5cGUgPSBzZWxlY3RWYWx1ZXNTb3VyY2UuVHlwZS5WYWx1ZXNMaXN0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL1N0ZXAyOiBtb3ZlIHZhbHVlc0xpc3ROb3RlUGF0aFxuICAgICAgICAgICAgcC5vcHRpb25zLnZhbHVlc0xpc3ROb3RlUGF0aCA9IHAudmFsdWVzTGlzdE5vdGVQYXRoXG4gICAgICAgICAgICAvL1N0ZXAzOiBkZWxldGUgbGVnYWN5IG9wdGlvbnNcbiAgICAgICAgICAgIGN1cnJlbnRPcHRpb25LZXlzLmZvckVhY2goa2V5ID0+IGRlbGV0ZSBwLm9wdGlvbnNba2V5XSlcbiAgICAgICAgICAgIC8vU3RlcDQ6IHBvcHVsYXRlIHZhbHVlc0Zyb21EVlF1ZXJ5IG9wdGlvbiB3aXRoIGVtcHR5IHN0cmluZ1xuICAgICAgICAgICAgcC5vcHRpb25zLnZhbHVlc0Zyb21EVlF1ZXJ5ID0gXCJcIlxuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZSBwLnZhbHVlc0xpc3ROb3RlUGF0aFxuICAgIH0pXG4gICAgcGx1Z2luLnNldHRpbmdzLnNldHRpbmdzVmVyc2lvbiA9IDNcbiAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEocGx1Z2luLnNldHRpbmdzKVxuICAgIGNvbnNvbGUubG9nKFwiTWV0YWRhdGEgbWVudSBzZXR0aW5ncyBtaWdyYXRlZCB0byB2ZXJzaW9uIDNcIilcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHtcbiAgICBFZGl0b3IsXG4gICAgRWRpdG9yUG9zaXRpb24sXG4gICAgRWRpdG9yU3VnZ2VzdCxcbiAgICBFZGl0b3JTdWdnZXN0Q29udGV4dCxcbiAgICBFZGl0b3JTdWdnZXN0VHJpZ2dlckluZm8sXG4gICAgTWFya2Rvd25WaWV3LFxuICAgIFRGaWxlLFxuICAgIHBhcnNlWWFtbCxcbiAgICBOb3RpY2UsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IGdlbmVyaWNGaWVsZFJlZ2V4LCBnZXRMaW5lRmllbGRzLCBlbmNvZGVMaW5rIH0gZnJvbSBcIi4uL3V0aWxzL3BhcnNlclwiO1xuaW1wb3J0IEZpbGVGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0ZpbGVGaWVsZFwiO1xuaW1wb3J0IEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9BYnN0cmFjdExpc3RCYXNlZEZpZWxkXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9maWVsZHMvRmllbGRcIjtcblxuaW50ZXJmYWNlIElWYWx1ZUNvbXBsZXRpb24ge1xuICAgIHZhbHVlOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWYWx1ZVN1Z2dlc3QgZXh0ZW5kcyBFZGl0b3JTdWdnZXN0PElWYWx1ZUNvbXBsZXRpb24+IHtcbiAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgaW5GdWxsTGluZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgaW5TZW50ZW5jZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgZGlkU2VsZWN0OiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBmaWVsZD86IEZpZWxkO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnNldEluc3RydWN0aW9ucyhbeyBjb21tYW5kOiBcIlNoaWZ0XCIsIHB1cnBvc2U6IFwicHV0IGEgc3BhY2UgYWZ0ZXI6OlwiIH1dKTtcblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW1wiU2hpZnRcIl0sIFwiRW50ZXJcIiwgKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy51c2VTZWxlY3RlZEl0ZW0oZXZ0KTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIG9uVHJpZ2dlcihcbiAgICAgICAgY3Vyc29yOiBFZGl0b3JQb3NpdGlvbixcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsXG4gICAgICAgIGZpbGU6IFRGaWxlXG4gICAgKTogRWRpdG9yU3VnZ2VzdFRyaWdnZXJJbmZvIHwgbnVsbCB7XG4gICAgICAgIGlmICh0aGlzLmRpZFNlbGVjdCkge1xuICAgICAgICAgICAgdGhpcy5kaWRTZWxlY3QgPSBmYWxzZVxuICAgICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmlzQXV0b3N1Z2dlc3RFbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXIgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyO1xuICAgICAgICBjb25zdCBmdWxsTGluZSA9IGVkaXRvci5nZXRMaW5lKGVkaXRvci5nZXRDdXJzb3IoKS5saW5lKVxuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSAhIWZyb250bWF0dGVyICYmXG4gICAgICAgICAgICBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lIDwgY3Vyc29yLmxpbmUgJiZcbiAgICAgICAgICAgIGN1cnNvci5saW5lIDwgZnJvbnRtYXR0ZXIucG9zaXRpb24uZW5kLmxpbmVcbiAgICAgICAgaWYgKHRoaXMuaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06KD88dmFsdWVzPi4qKWAsIFwidVwiKTtcbiAgICAgICAgICAgIGlmICghcmVnZXgudGVzdChmdWxsTGluZSkpIHJldHVybiBudWxsO1xuICAgICAgICB9IGVsc2UgaWYgKGdldExpbmVGaWVsZHMoZnVsbExpbmUpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN0YXJ0OiBjdXJzb3IsXG4gICAgICAgICAgICBlbmQ6IGN1cnNvcixcbiAgICAgICAgICAgIHF1ZXJ5OiBlZGl0b3IuZ2V0TGluZShjdXJzb3IubGluZSksXG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHByaXZhdGUgZmlsdGVyT3B0aW9uID0gKGZpcnN0VmFsdWVzOiBzdHJpbmdbXSB8IHVuZGVmaW5lZCwgbGFzdFZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQsIG9wdGlvbjogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiAhZmlyc3RWYWx1ZXMgfHxcbiAgICAgICAgICAgICFmaXJzdFZhbHVlcz8uY29udGFpbnMoZW5jb2RlTGluayhvcHRpb24pKSAmJiAoIWxhc3RWYWx1ZSB8fFxuICAgICAgICAgICAgICAgICEhbGFzdFZhbHVlICYmIGVuY29kZUxpbmsob3B0aW9uKS5pbmNsdWRlcyhsYXN0VmFsdWUpKVxuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0QWxpYXModEZpbGU6IFRGaWxlKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgbGV0IGFsaWFzOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChkdkFwaSAmJiB0aGlzLmZpZWxkPy5vcHRpb25zLmN1c3RvbVJlbmRlcmluZykge1xuICAgICAgICAgICAgYWxpYXMgPSBuZXcgRnVuY3Rpb24oXCJwYWdlXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nfWApKGR2QXBpLnBhZ2UodEZpbGUucGF0aCkpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsaWFzXG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0U3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBQcm9taXNlPElWYWx1ZUNvbXBsZXRpb25bXT4ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9ucyA9IGF3YWl0IHRoaXMuZ2V0VmFsdWVTdWdnZXN0aW9ucyhjb250ZXh0KTtcbiAgICAgICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuXG4gICAgYXN5bmMgZ2V0VmFsdWVTdWdnZXN0aW9ucyhjb250ZXh0OiBFZGl0b3JTdWdnZXN0Q29udGV4dCk6IFByb21pc2U8SVZhbHVlQ29tcGxldGlvbltdPiB7XG4gICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBjb250ZXh0LnN0YXJ0LmxpbmU7XG4gICAgICAgIGNvbnN0IG1hdGNoRmllbGQ6IHsgYXR0cmlidXRlPzogc3RyaW5nLCB2YWx1ZXM/OiBzdHJpbmcgfSA9IHsgYXR0cmlidXRlOiB1bmRlZmluZWQsIHZhbHVlczogXCJcIiB9XG4gICAgICAgIGNvbnN0IGR2QXBpID0gdGhpcy5wbHVnaW4uYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpXG4gICAgICAgIGlmICghdGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lRmllbGRzID0gZ2V0TGluZUZpZWxkcyhlbmNvZGVMaW5rKGNvbnRleHQuZWRpdG9yLmdldExpbmUobGluZU51bWJlcikpKTtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gY29udGV4dC5lZGl0b3IuZ2V0Q3Vyc29yKCkuY2hcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUxpbmVGaWVsZCA9IGxpbmVGaWVsZHMuZmluZChsaW5lRmllbGQgPT4gbGluZUZpZWxkLmluZGV4IDw9IHBvc2l0aW9uICYmIGxpbmVGaWVsZC5pbmRleCArIGxpbmVGaWVsZC5sZW5ndGggPj0gcG9zaXRpb24pXG4gICAgICAgICAgICBpZiAoYWN0aXZlTGluZUZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pblNlbnRlbmNlID0gYWN0aXZlTGluZUZpZWxkLmluZGV4ID4gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmluRnVsbExpbmUgPSBhY3RpdmVMaW5lRmllbGQuaW5kZXggPT09IDA7XG4gICAgICAgICAgICAgICAgbWF0Y2hGaWVsZC5hdHRyaWJ1dGUgPSBhY3RpdmVMaW5lRmllbGQuYXR0cmlidXRlO1xuICAgICAgICAgICAgICAgIG1hdGNoRmllbGQudmFsdWVzID0gYWN0aXZlTGluZUZpZWxkLnZhbHVlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9Oig/PHZhbHVlcz4uKyk/YCwgXCJ1XCIpO1xuICAgICAgICAgICAgY29uc3QgcmVnZXhSZXN1bHQgPSBjb250ZXh0LmVkaXRvci5nZXRSYW5nZSh7IGxpbmU6IGxpbmVOdW1iZXIsIGNoOiAwIH0sIGNvbnRleHQuZW5kKS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAocmVnZXhSZXN1bHQ/Lmdyb3Vwcykge1xuICAgICAgICAgICAgICAgIG1hdGNoRmllbGQuYXR0cmlidXRlID0gcmVnZXhSZXN1bHQuZ3JvdXBzLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLnZhbHVlcyA9IHJlZ2V4UmVzdWx0Lmdyb3Vwcy52YWx1ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoRmllbGQuYXR0cmlidXRlKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE5hbWUgPSBtYXRjaEZpZWxkLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSB0aGlzLnBsdWdpbi5maWVsZEluZGV4LmZpbGVzRmllbGRzLmdldChjb250ZXh0LmZpbGUucGF0aCk/LmZpbmQoZiA9PiBmLm5hbWUgPT09IGZpZWxkTmFtZSk7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZXNMaXN0ID0gbWF0Y2hGaWVsZC52YWx1ZXM/LnJlcGxhY2UoL15cXFt8Xlxcc1xcW3xeXFwofF5cXHNcXCgvLCAnJylcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxdJHxcXCkkLywgJycpXG4gICAgICAgICAgICAgICAgLnNwbGl0KFwiLFwiKS5tYXAobyA9PiBlbmNvZGVMaW5rKG8udHJpbSgpKSlcbiAgICAgICAgICAgIGNvbnN0IGxhc3RWYWx1ZSA9IHZhbHVlc0xpc3Q/Lmxhc3QoKVxuICAgICAgICAgICAgY29uc3QgZmlyc3RWYWx1ZXMgPSB2YWx1ZXNMaXN0Py5zbGljZSgwLCAtMSlcbiAgICAgICAgICAgIC8vdGFncyBzcGVjaWZpYyBjYXNlXG4gICAgICAgICAgICBpZiAoZmllbGROYW1lID09PSBcInRhZ3NcIiAmJiB0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0VGFncygpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKHQgPT4gbGFzdFZhbHVlID8gdC5jb250YWlucyhsYXN0VmFsdWUpIDogdClcbiAgICAgICAgICAgICAgICAgICAgLnNvcnQoKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHRhZyA9PiBPYmplY3QoeyB2YWx1ZTogdGFnLnJlcGxhY2UoL14jLywgXCJcIikgfSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZCAmJiBbRmllbGRUeXBlLkN5Y2xlLCBGaWVsZFR5cGUuTXVsdGksIEZpZWxkVHlwZS5TZWxlY3RdLmNvbnRhaW5zKHRoaXMuZmllbGQudHlwZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKGZpZWxkTWFuYWdlciBhcyBBYnN0cmFjdExpc3RCYXNlZEZpZWxkKVxuICAgICAgICAgICAgICAgICAgICAuZ2V0T3B0aW9uc0xpc3QoZHZBcGkucGFnZSh0aGlzLmNvbnRleHQ/LmZpbGUucGF0aCkpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIob3B0aW9uID0+IHRoaXMuZmlsdGVyT3B0aW9uKGZpcnN0VmFsdWVzLCBsYXN0VmFsdWUsIG9wdGlvbikpXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoX3ZhbHVlID0+IE9iamVjdCh7IHZhbHVlOiBfdmFsdWUgfSkpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZmllbGQgJiYgW0ZpZWxkVHlwZS5GaWxlLCBGaWVsZFR5cGUuTXVsdGlGaWxlXS5pbmNsdWRlcyh0aGlzLmZpZWxkLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc29ydGluZ01ldGhvZCA9IG5ldyBGdW5jdGlvbihcImFcIiwgXCJiXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tU29ydGluZ31gKSB8fCBmdW5jdGlvbiAoYTogVEZpbGUsIGI6IFRGaWxlKSB7IHJldHVybiBhLmJhc2VuYW1lIDwgYi5iYXNlbmFtZSA/IC0xIDogMSB9XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyOiBGaWxlRmllbGQgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5wbHVnaW4sIHRoaXMuZmllbGQpXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZXMgPSBmaWVsZE1hbmFnZXIuZ2V0RmlsZXModGhpcy5jb250ZXh0Py5maWxlKS5zb3J0KHNvcnRpbmdNZXRob2QgYXMgKGE6IFRGaWxlLCBiOiBURmlsZSkgPT4gbnVtYmVyKTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWxlc1xuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihmID0+IGYuYmFzZW5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhsYXN0VmFsdWUpIHx8IHRoaXMuZ2V0QWxpYXMoZik/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobGFzdFZhbHVlKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoZiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdCh7IHZhbHVlOiBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIGNvbnRleHQuZmlsZSwgZi5iYXNlbmFtZSwgdGhpcy5nZXRBbGlhcyhmKSkgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWxlc1xuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYWxpYXM6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHZBcGkgJiYgdGhpcy5maWVsZD8ub3B0aW9ucy5jdXN0b21SZW5kZXJpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxpYXMgPSBuZXcgRnVuY3Rpb24oXCJwYWdlXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nfWApKGR2QXBpLnBhZ2UoZi5wYXRoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdCh7IHZhbHVlOiBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5wbHVnaW4sIGNvbnRleHQuZmlsZSwgZi5iYXNlbmFtZSwgYWxpYXMpIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogSVZhbHVlQ29tcGxldGlvbiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKVxuICAgICAgICBlbC5hZGRDbGFzcyhcInN1Z2dlc3RlclwiKVxuICAgICAgICBjb25zdCBbcmF3VmFsdWUsIGFsaWFzXSA9IHN1Z2dlc3Rpb24udmFsdWUucmVwbGFjZSgvXlxcW1xcWy8sIFwiXCIpLnJlcGxhY2UoL1xcXVxcXSQvLCBcIlwiKS5zcGxpdChcInxcIilcbiAgICAgICAgY29uc3QgdGFyZ2V0RmlsZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHJhd1ZhbHVlLCB0aGlzLmNvbnRleHQhLmZpbGUucGF0aClcbiAgICAgICAgY29uc3QgZHZBcGkgPSB0aGlzLnBsdWdpbi5hcHAucGx1Z2lucy5wbHVnaW5zLmRhdGF2aWV3Py5hcGlcbiAgICAgICAgaWYgKGR2QXBpICYmIHRoaXMuZmllbGQgJiYgdGhpcy5maWVsZC5vcHRpb25zLmN1c3RvbVJlbmRlcmluZyAmJiB0YXJnZXRGaWxlKSB7XG4gICAgICAgICAgICBpZiAoYWxpYXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGFpbmVyID0gZWwuY3JlYXRlRGl2KHsgY2xzOiBcIml0ZW0td2l0aC1hbGlhc1wiIH0pO1xuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KHsgdGV4dDogYWxpYXMgfSlcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IHN1Z2dlc3Rpb25Db250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIml0ZW0td2l0aC1hbGlhcy1maWxlcGF0aFwiIH0pXG4gICAgICAgICAgICAgICAgZmlsZVBhdGguc2V0VGV4dChyYXdWYWx1ZSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZWwuc2V0VGV4dChuZXcgRnVuY3Rpb24oXCJwYWdlXCIsIGByZXR1cm4gJHt0aGlzLmZpZWxkLm9wdGlvbnMuY3VzdG9tUmVuZGVyaW5nfWApKGR2QXBpLnBhZ2UodGFyZ2V0RmlsZS5wYXRoKSkpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlbC5zZXRUZXh0KHJhd1ZhbHVlKVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogSVZhbHVlQ29tcGxldGlvbiwgZXZlbnQ6IEtleWJvYXJkRXZlbnQgfCBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKCFhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xuICAgICAgICBjb25zdCBhY3RpdmVMaW5lID0gZWRpdG9yLmdldExpbmUodGhpcy5jb250ZXh0IS5zdGFydC5saW5lKTtcblxuICAgICAgICBpZiAodGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAvL2Zvcm1hdCBsaXN0IGlmIGluIGZyb250bWF0dGVyXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGxldCBwYXJzZWRGaWVsZDogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgc3RyaW5nW10gfCBudWxsPiA9IHBhcnNlWWFtbChhY3RpdmVMaW5lKVxuICAgICAgICAgICAgICAgIGxldCBbYXR0ciwgcGFzdFZhbHVlc10gPSBPYmplY3QuZW50cmllcyhwYXJzZWRGaWVsZClbMF1cbiAgICAgICAgICAgICAgICBsZXQgbmV3RmllbGQ6IHN0cmluZ1xuICAgICAgICAgICAgICAgIGlmICghcGFzdFZhbHVlcykge1xuICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogXCIgKyBzdWdnZXN0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHBhc3RWYWx1ZXMgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXN0VmFsdWVzLmNvbnRhaW5zKFwiLFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFwiICsgc3VnZ2VzdGlvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBwYXN0VmFsdWVzLnNwbGl0KFwiLFwiKS5tYXAobyA9PiBvLnRyaW0oKSkuc2xpY2UoMCwgLTEpLmpvaW4oJywgJykgKyBcIiwgXCIgKyBzdWdnZXN0aW9uLnZhbHVlICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocGFzdFZhbHVlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGl2ZUxpbmUuZW5kc1dpdGgoXCIsXVwiKSB8fCBhY3RpdmVMaW5lLmVuZHNXaXRoKFwiLCBdXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3ZhbHVlIGNhbiBiZSBkaXJlY3RseSBhZGRlZCBzaW5jZSBwYXJzZVlhbWwgd29udCBjcmVhdGUgYW4gZW1wdHkgbGFzdCBpdGVtIGluIHBhc3RWYWx1ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBbLi4ucGFzdFZhbHVlcywgc3VnZ2VzdGlvbi52YWx1ZV0uam9pbihcIiwgXCIpICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3dlIGhhdmUgdHlwZWQgc29tZXRoaW5nIHRoYXQgd2UgYWh2ZSB0byByZW1vdmUgdG8gcmVwbGFjZSB3aXRoIHNlbGVjdGVkIHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXMuc2xpY2UoMCwgLTEpLCBzdWdnZXN0aW9uLnZhbHVlXS5qb2luKFwiLCBcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIFsuLi5wYXN0VmFsdWVzXS5qb2luKFwiLCBcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdGaWVsZCwgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiAwIH0sIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogYWN0aXZlTGluZS5sZW5ndGggfSk7XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocGFzdFZhbHVlcykgfHwgdHlwZW9mIHBhc3RWYWx1ZXMgPT09ICdzdHJpbmcnICYmIHBhc3RWYWx1ZXMuY29udGFpbnMoXCIsXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBuZXdGaWVsZC5sZW5ndGggLSAxIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5ld0ZpZWxkLmxlbmd0aCB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkZyb250bWF0dGVyIHdyb25nbHkgZm9ybWF0dGVkXCIsIDIwMDApXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pbkZ1bGxMaW5lKSB7XG4gICAgICAgICAgICBsZXQgY2xlYW5lZExpbmUgPSBhY3RpdmVMaW5lXG4gICAgICAgICAgICB3aGlsZSAoIVsnLCcsICc6J10uY29udGFpbnMoY2xlYW5lZExpbmUuY2hhckF0KGNsZWFuZWRMaW5lLmxlbmd0aCAtIDEpKSkge1xuICAgICAgICAgICAgICAgIGNsZWFuZWRMaW5lID0gY2xlYW5lZExpbmUuc2xpY2UoMCwgLTEpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKGAke2NsZWFuZWRMaW5lfSR7ZXZlbnQuc2hpZnRLZXkgPyBcIiBcIiA6IFwiXCJ9YCArIHN1Z2dlc3Rpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiAwIH0sIHRoaXMuY29udGV4dCEuZW5kKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmluU2VudGVuY2UpIHtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5jb250ZXh0Py5lZGl0b3IuZ2V0Q3Vyc29yKCkuY2ggfHwgMFxuICAgICAgICAgICAgbGV0IGJlZm9yZUN1cnNvciA9IGFjdGl2ZUxpbmUuc2xpY2UoMCwgcG9zaXRpb24pXG4gICAgICAgICAgICBsZXQgYWZ0ZXJDdXJzb3IgPSBhY3RpdmVMaW5lLnNsaWNlKHBvc2l0aW9uKVxuICAgICAgICAgICAgbGV0IHNlcGFyYXRvclBvcyA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgbGV0IGN1cnJlbnRWYWx1ZUxlbmd0aCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoIWJlZm9yZUN1cnNvci5lbmRzV2l0aChcIjo6XCIpICYmICFiZWZvcmVDdXJzb3IuZW5kc1dpdGgoXCIsXCIpICYmIGJlZm9yZUN1cnNvci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBzZXBhcmF0b3JQb3MgPSBzZXBhcmF0b3JQb3MgLSAxO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZUxlbmd0aCA9IGN1cnJlbnRWYWx1ZUxlbmd0aCArIDFcbiAgICAgICAgICAgICAgICBiZWZvcmVDdXJzb3IgPSBiZWZvcmVDdXJzb3Iuc2xpY2UoMCwgLTEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IG5leHRCcmFja2V0UG9zID0gcG9zaXRpb247XG4gICAgICAgICAgICB3aGlsZSAoIWVuY29kZUxpbmsoYWZ0ZXJDdXJzb3IpLm1hdGNoKFwiKFxcXFxdfFxcXFwpKS4qXCIpICYmIGFmdGVyQ3Vyc29yLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIG5leHRCcmFja2V0UG9zID0gbmV4dEJyYWNrZXRQb3MgKyAxO1xuICAgICAgICAgICAgICAgIGFmdGVyQ3Vyc29yID0gYWZ0ZXJDdXJzb3Iuc2xpY2UobmV4dEJyYWNrZXRQb3MgLSBwb3NpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKFxuICAgICAgICAgICAgICAgIHN1Z2dlc3Rpb24udmFsdWUsXG4gICAgICAgICAgICAgICAgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBzZXBhcmF0b3JQb3MgfSxcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5leHRCcmFja2V0UG9zIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBuZXh0QnJhY2tldFBvcyAtIGN1cnJlbnRWYWx1ZUxlbmd0aCArIHN1Z2dlc3Rpb24udmFsdWUubGVuZ3RoIH0pXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kaWRTZWxlY3QgPSB0cnVlXG4gICAgICAgIHRoaXMuY2xvc2UoKVxuICAgIH07XG59OyJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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
